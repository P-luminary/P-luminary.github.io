
<!DOCTYPE html>
<html lang="zh_CH ">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P-luminary || </title>
    <meta name="author" content="Asuna">
    <meta name="description" content=" ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/https://raw.githubusercontent.com/P-luminary/images/master/data/asuna.jpg">
    <link rel="stylesheet" href="/css/antd.min.css">
    
    <link rel="stylesheet" href="/css/maiden-theme.css">
    
    <script src="/js/vue.js"></script>
    <script src="/js/antd.min.js"></script>
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

    <div id="loading"
        style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div
            style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent"
                style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p>åŠ è½½è¿‡æ…¢è¯·å¼€å¯ç¼“å­˜(æµè§ˆå™¨é»˜è®¤å¼€å¯)</p>
                    <div>
                        <img src="/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">P-luminary</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled" />
            </span>
            <span>home</span>
        </a>
        
        <a href="/tags/è¯­æ³•">
            <span>
                <a-icon type="tags" theme="filled" />
            </span>
            <span>tags</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled" />
            </span>
            <span>P-luminary</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">home</div>
                </div>
            </a>
            
            <a href="/tags/è¯­æ³•">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="tags" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">tags</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                    <div id="home-head" style=background-image:url('home.jpg')>
    <script>
        var menu = document.getElementById("menu")
        menu.className += " menu-color"
    </script>
     
    <div id="home-info" class="home-info" @click="home_click">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>P-luminary</h1>
                <h3></h3>
                <h5></h5>
            </div>
        </span>
    </div>
     
</div>



<div id="home-posts-wrap" class=>
    <div id="home-posts">

        <div id="posts">
            

<div class="post">

    <a href="/2025/03/19/AI/RAGFlowæ‰§è¡Œæµç¨‹è§£æcanvas/">
        <h2>
            RAGFlowæ‰§è¡Œæµç¨‹è§£æcanvas
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/3/19
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h4 id="Canvas-py"><a href="#Canvas-py" class="headerlink" title="Canvas.py"></a>Canvas.py</h4><pre><code class="python">import logging
import json
from copy import deepcopy
from functools import partial

import pandas as pd

from agent.component import component_class
from agent.component.base import ComponentBase


class Canvas:
    &quot;&quot;&quot;
    dsl = &#123;
        &quot;components&quot;: &#123;
            &quot;begin&quot;: &#123;
                &quot;obj&quot;:&#123;
                    &quot;component_name&quot;: &quot;Begin&quot;,
                    &quot;params&quot;: &#123;&#125;,
                &#125;,
                &quot;downstream&quot;: [&quot;answer_0&quot;],
                &quot;upstream&quot;: [],
            &#125;,
            &quot;answer_0&quot;: &#123;
                &quot;obj&quot;: &#123;
                    &quot;component_name&quot;: &quot;Answer&quot;,
                    &quot;params&quot;: &#123;&#125;
                &#125;,
                &quot;downstream&quot;: [&quot;retrieval_0&quot;],
                &quot;upstream&quot;: [&quot;begin&quot;, &quot;generate_0&quot;],
            &#125;,
            &quot;retrieval_0&quot;: &#123;
                &quot;obj&quot;: &#123;
                    &quot;component_name&quot;: &quot;Retrieval&quot;,
                    &quot;params&quot;: &#123;&#125;
                &#125;,
                &quot;downstream&quot;: [&quot;generate_0&quot;],
                &quot;upstream&quot;: [&quot;answer_0&quot;],
            &#125;,
            &quot;generate_0&quot;: &#123;
                &quot;obj&quot;: &#123;
                    &quot;component_name&quot;: &quot;Generate&quot;,
                    &quot;params&quot;: &#123;&#125;
                &#125;,
                &quot;downstream&quot;: [&quot;answer_0&quot;],
                &quot;upstream&quot;: [&quot;retrieval_0&quot;],
            &#125;
        &#125;,
        &quot;history&quot;: [],
        &quot;messages&quot;: [],
        &quot;reference&quot;: [],
        &quot;path&quot;: [[&quot;begin&quot;]],
        &quot;answer&quot;: []
    &#125;
    &quot;&quot;&quot;
    # dslæ˜¯ç»„ä»¶æµçš„JSONæ ¼å¼å­—ç¬¦ä¸² å®šä¹‰äº†ç»„ä»¶çš„è¿æ¥å…³ç³»
    # tenant_idå¤šç§Ÿæˆ·ç®¡ç†
    # componentå­˜å‚¨æ‰€æœ‰ç»„ä»¶å®ä¾‹
    def __init__(self, dsl: str, tenant_id=None):
        self.path = []
        self.history = []
        self.messages = []
        self.answer = []
        self.components = &#123;&#125;
        # å¦‚æœæä¾›äº†dslåˆ™è§£æJSON å¦åˆ™ä½¿ç”¨é»˜è®¤çš„DSLç»“æ„ï¼ˆåŒ…å« Begin ç»„ä»¶ï¼‰
        self.dsl = json.loads(dsl) if dsl else &#123;
            &quot;components&quot;: &#123;
                &quot;begin&quot;: &#123;
                    &quot;obj&quot;: &#123;
                        &quot;component_name&quot;: &quot;Begin&quot;,
                        &quot;params&quot;: &#123;
                            &quot;prologue&quot;: &quot;Hi there!&quot;
                        &#125;
                    &#125;,
                    &quot;downstream&quot;: [],
                    &quot;upstream&quot;: [],
                    &quot;parent_id&quot;: &quot;&quot;
                &#125;
            &#125;,
            &quot;history&quot;: [],
            &quot;messages&quot;: [],
            &quot;reference&quot;: [],
            &quot;path&quot;: [],
            &quot;answer&quot;: []
        &#125;
        self._tenant_id = tenant_id
        self._embed_id = &quot;&quot;
        self.load()

    # åŠ è½½dsl
    def load(self):
      # è§£ædsl[&quot;components&quot;]å­˜å‚¨ç»„ä»¶å®ä¾‹ å¹¶æ£€æŸ¥å¿…è¦ç»„ä»¶æ˜¯å¦å­˜åœ¨
        # ç»„ä»¶å­—å…¸å­˜å…¥self.components
        self.components = self.dsl[&quot;components&quot;]
        # cpn_nmsè®°å½•ç»„ä»¶åç§°é›†åˆ
        cpn_nms = set([])

        # éå†ç»„ä»¶ æå–åç§°
        for k, cpn in self.components.items():
            cpn_nms.add(cpn[&quot;obj&quot;][&quot;component_name&quot;])
        # ç¡®ä¿Beginå’ŒAnswerç»„ä»¶å­˜åœ¨ å¦åˆ™æŠ›å‡ºé”™è¯¯
        assert &quot;Begin&quot; in cpn_nms, &quot;There have to be an &#39;Begin&#39; component.&quot;
        assert &quot;Answer&quot; in cpn_nms, &quot;There have to be an &#39;Answer&#39; component.&quot;

        # forå¾ªç¯ä¾¿åˆ©self.componentsè¿™ä¸ªå­—å…¸
        # å…¶ä¸­é”®kæ˜¯ç»„ä»¶æ ‡è¯†ç¬¦ cpnæ˜¯ä¸€ä¸ªåŒ…å«ç»„ä»¶è¯¦ç»†ä¿¡æ¯çš„å­—å…¸
        for k, cpn in self.components.items():
            # å°†ç»„ä»¶åç§°æ·»åŠ åˆ°cpn_nmsé›†åˆä¸­
            cpn_nms.add(cpn[&quot;obj&quot;][&quot;component_name&quot;])
            # é€šè¿‡component_classåŠ¨æ€åˆ›å»º æ‹¼æ¥param
            param = component_class(cpn[&quot;obj&quot;][&quot;component_name&quot;] + &quot;Param&quot;)()
            # æ›´æ–°paramå®ä¾‹çš„å±æ€§ å°†cpn[&quot;obj&quot;][&quot;params&quot;]å­—å…¸ä¸­çš„é”®å€¼å¯¹åº”ç”¨åˆ°paramå®ä¾‹ä¸Š
            param.update(cpn[&quot;obj&quot;][&quot;params&quot;])
            param.check()
          # ä½¿ç”¨component_classåŠ¨æ€åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç»„ä»¶å®ä¾‹ å¹¶å°†å…¶èµ‹å€¼ç»™cpn[&quot;obj&quot;]
            # æ–°å®ä¾‹çš„åˆ›å»ºä½¿ç”¨äº†å½“å‰ç±»å®ä¾‹selfã€ç»„ä»¶æ ‡è¯†ç¬¦kå’Œå‚æ•°å®ä¾‹param
            cpn[&quot;obj&quot;] = component_class(cpn[&quot;obj&quot;][&quot;component_name&quot;])(self, k, param)
            # æ£€æŸ¥å½“å‰ç»„ä»¶çš„åç§°æ˜¯å¦ä¸º&quot;Categorize&quot;
            if cpn[&quot;obj&quot;].component_name == &quot;Categorize&quot;:
                # ç»„ä»¶æ˜¯&quot;Categorize&quot; åˆ™éå†param.category_descriptionå­—å…¸ è¿™ä¸ªå­—å…¸åŒ…å«äº†åˆ†ç±»æè¿°
                for _, desc in param.category_description.items():
                    # è¿™ä¸¤è¡Œä»£ç æ£€æŸ¥desc[&quot;to&quot;]ï¼ˆå¯èƒ½æ˜¯ä¸‹æ¸¸ç»„ä»¶çš„æ ‡è¯†ç¬¦ï¼‰æ˜¯å¦å·²ç»åœ¨cpn[&quot;downstream&quot;]åˆ—è¡¨ä¸­
                    if desc[&quot;to&quot;] not in cpn[&quot;downstream&quot;]:
                        # å¦‚æœä¸åœ¨ï¼Œå°±å°†å…¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­
                        cpn[&quot;downstream&quot;].append(desc[&quot;to&quot;])
        # å°†self.dsl[&quot;path&quot;]çš„å€¼èµ‹ç»™self.pathå±æ€§
        self.path = self.dsl[&quot;path&quot;]
        self.history = self.dsl[&quot;history&quot;]
        self.messages = self.dsl[&quot;messages&quot;]
        self.answer = self.dsl[&quot;answer&quot;]
        self.reference = self.dsl[&quot;reference&quot;]
        self._embed_id = self.dsl.get(&quot;embed_id&quot;, &quot;&quot;)

    # å®šä¹‰äº†ç±»çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ é€šå¸¸ç”¨äºæ‰“å°å¯¹è±¡æ—¶æ˜¾ç¤ºçš„ä¿¡æ¯
    # è¿™å‡ è¡Œä»£ç å°†ç±»çš„å±æ€§å€¼èµ‹ç»™self.dslå­—å…¸ä¸­çš„ç›¸åº”é”®
    def __str__(self):
        self.dsl[&quot;path&quot;] = self.path
        self.dsl[&quot;history&quot;] = self.history
        self.dsl[&quot;messages&quot;] = self.messages
        self.dsl[&quot;answer&quot;] = self.answer
        self.dsl[&quot;reference&quot;] = self.reference
        self.dsl[&quot;embed_id&quot;] = self._embed_id
        # åˆ›å»ºä¸€ä¸ªæ–°çš„å­—å…¸dsl å…¶ä¸­åŒ…å«ä¸€ä¸ªé”®components å…¶å€¼ä¸ºä¸€ä¸ªç©ºå­—å…¸
        dsl = &#123;
            &quot;components&quot;: &#123;&#125;
        &#125;
        # éå†self.dslå­—å…¸çš„é”® å¦‚æœé”®ä¸æ˜¯components åˆ™å°†å…¶å€¼æ·±æ‹·è´åˆ°æ–°çš„dslå­—å…¸ä¸­
        for k in self.dsl.keys():
            if k in [&quot;components&quot;]:
                continue
            dsl[k] = deepcopy(self.dsl[k])

        # éå†self.componentså­—å…¸ å°†æ¯ä¸ªç»„ä»¶çš„ä¿¡æ¯æ·±æ‹·è´åˆ°dslå­—å…¸çš„componentsé”®ä¸‹
        # å¯¹äºobjé”® å°†å…¶å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²åå†è§£æä¸ºJSON
        for k, cpn in self.components.items():
            if k not in dsl[&quot;components&quot;]:
                dsl[&quot;components&quot;][k] = &#123;&#125;
            for c in cpn.keys():
                if c == &quot;obj&quot;:
                    dsl[&quot;components&quot;][k][c] = json.loads(str(cpn[&quot;obj&quot;]))
                    continue
                dsl[&quot;components&quot;][k][c] = deepcopy(cpn[c])
        # è¿”å›dslå­—å…¸çš„JSONå­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ ensure_ascii=Falseç¡®ä¿éASCIIå­—ç¬¦å¯ä»¥æ­£ç¡®æ˜¾ç¤º
        return json.dumps(dsl, ensure_ascii=False)

    # å°†ç±»çš„å±æ€§é‡ç½®ä¸ºç©ºåˆ—è¡¨
    def reset(self):
        self.path = []
        self.history = []
        self.messages = []
        self.answer = []
        self.reference = []
        # éå†self.componentså­—å…¸ å¹¶è°ƒç”¨æ¯ä¸ªç»„ä»¶çš„resetæ–¹æ³•
        for k, cpn in self.components.items():
            self.components[k][&quot;obj&quot;].reset()
        # å°†_embed_idå±æ€§é‡ç½®ä¸ºç©ºå­—ç¬¦ä¸²
        self._embed_id = &quot;&quot;

    # è¿™ä¸ªæ–¹æ³•ç”¨äºæ ¹æ®ç»„ä»¶IDè·å–ç»„ä»¶åç§°
    def get_component_name(self, cid):
        # éå†self.dslå­—å…¸ä¸­çš„graphé”®ä¸‹çš„nodesåˆ—è¡¨
        # å¦‚æœæ‰¾åˆ°åŒ¹é…çš„ID åˆ™è¿”å›ç›¸åº”çš„ç»„ä»¶åç§°
        for n in self.dsl[&quot;graph&quot;][&quot;nodes&quot;]:
            if cid == n[&quot;id&quot;]:
                return n[&quot;data&quot;][&quot;name&quot;]
        # å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ID åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²
        return &quot;&quot;

    def run(self, **kwargs):
        # å¦‚æœself.answeråˆ—è¡¨ä¸ä¸ºç©º
        if self.answer:
            # ç”¨äºå­˜å‚¨æ¥ä¸‹æ¥è¦æ‰§è¡Œçš„ç»„ä»¶ID
            cpn_id = self.answer[0]
            # å­˜å®Œå°±ä»åˆ—è¡¨ä¸­ç§»é™¤
            self.answer.pop(0)
            try:
                # å°è¯•æ‰§è¡Œ self.components å­—å…¸ä¸­å¯¹åº” cpn_id çš„ç»„ä»¶å¯¹è±¡çš„ run æ–¹æ³•
                # å¹¶ä¼ å…¥ self.history å’Œ **kwargs ä½œä¸ºå‚æ•°
                ans = self.components[cpn_id][&quot;obj&quot;].run(self.history, **kwargs)
                # å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸
            except Exception as e:
                # æ•è·è¯¥å¼‚å¸¸å¹¶ä½¿ç”¨ ComponentBase.be_output æ–¹æ³•å¤„ç†å¼‚å¸¸ä¿¡æ¯
                ans = ComponentBase.be_output(str(e))
            # å°†æ‰§è¡Œè¿‡çš„ç»„ä»¶IDæ·»åŠ åˆ° self.path åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸­
            # self.path ä¼¼ä¹ç”¨äºè®°å½•æ‰§è¡Œè·¯å¾„
            self.path[-1].append(cpn_id)
            # å¦‚æœ kwargs ä¸­åŒ…å«å…³é”®å­— â€œstreamâ€
            # åˆ™å‡è®¾ ans æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨ éå†å®ƒå¹¶é€ä¸ª yield å‡ºæ¥
            # å¦‚æœä¸æ˜¯ åˆ™ç›´æ¥ yield ans
            if kwargs.get(&quot;stream&quot;):
                for an in ans():
                    yield an
            else:
                yield ans
            return
        # å¦‚æœ self.path ä¸ºç©º åˆ™æ‰§è¡Œåä¸º â€œbeginâ€ çš„ç»„ä»¶çš„ run æ–¹æ³• å¹¶å°† â€œbeginâ€ æ·»åŠ åˆ° self.path ä¸­
        if not self.path:
            self.components[&quot;begin&quot;][&quot;obj&quot;].run(self.history, **kwargs)
            self.path.append([&quot;begin&quot;])
        # å‘ self.path æ·»åŠ ä¸€ä¸ªç©ºåˆ—è¡¨ ä¸ºæ¥ä¸‹æ¥çš„ç»„ä»¶æ‰§è¡Œåšå‡†å¤‡
        self.path.append([])

        ran = -1
        waiting = []
        without_dependent_checking = []

        # å½“æœ‰ä¸‹æ¸¸ç»„ä»¶downstreamæ—¶
        # å®ƒæ¥å—ä¸€ä¸ªç»„ä»¶åˆ—è¡¨ cpns ä½œä¸ºå‚æ•°
        def prepare2run(cpns):
            # è¿™äº›å˜é‡åœ¨å‡½æ•°å¤–éƒ¨å®šä¹‰ ä½†åœ¨å‡½æ•°å†…éƒ¨å¯ä»¥è¢«ä¿®æ”¹
            nonlocal ran, ans
            # éå† cpns åˆ—è¡¨ä¸­çš„æ¯ä¸ªç»„ä»¶ID c
            # å¦‚æœ c å·²ç»æ˜¯ self.path ä¸­æœ€åä¸€ä¸ªåˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´  åˆ™è·³è¿‡å½“å‰å¾ªç¯
            for c in cpns:
                if self.path[-1] and c == self.path[-1][-1]:
                    continue
                # ä» self.components å­—å…¸ä¸­è·å–ç»„ä»¶ID c å¯¹åº”çš„ç»„ä»¶å¯¹è±¡
                cpn = self.components[c][&quot;obj&quot;]
                # å¦‚æœç»„ä»¶çš„åç§°æ˜¯ â€œAnswerâ€ åˆ™å°†ç»„ä»¶ID c æ·»åŠ åˆ° self.answer åˆ—è¡¨ä¸­
                if cpn.component_name == &quot;Answer&quot;:
                    self.answer.append(c)
                else:
                    # å¦‚æœç»„ä»¶ä¸æ˜¯ â€œAnswerâ€ åˆ™è®°å½•è°ƒè¯•ä¿¡æ¯ æ£€æŸ¥ç»„ä»¶æ˜¯å¦æœ‰æœªæ‰§è¡Œçš„ä¾èµ–ç»„ä»¶
                    # å¦‚æœæœ‰ å°†ç»„ä»¶IDæ·»åŠ åˆ° waiting åˆ—è¡¨ å¹¶è·³è¿‡å½“å‰å¾ªç¯
                    logging.debug(f&quot;Canvas.prepare2run: &#123;c&#125;&quot;)
                    if c not in without_dependent_checking:
                        cpids = cpn.get_dependent_components()
                        if any([cc not in self.path[-1] for cc in cpids]):
                            if c not in waiting:
                                waiting.append(c)
                            continue
                    yield &quot;*&#39;&#123;&#125;&#39;* is running...ğŸ•&quot;.format(self.get_component_name(c))
                    # å¦‚æœç»„ä»¶æ˜¯ â€œIterationâ€ åˆ™è·å–å…¶å¼€å§‹ç»„ä»¶ å¹¶æ£€æŸ¥æ˜¯å¦å·²ç»ç»“æŸ å¦‚æœæ²¡æœ‰ç»“æŸ åˆ™æ›´æ–° cpn å’Œ c ä¸ºå¼€å§‹ç»„ä»¶
                    if cpn.component_name.lower() == &quot;iteration&quot;:
                        st_cpn = cpn.get_start()
                        assert st_cpn, &quot;Start component not found for Iteration.&quot;
                        if not st_cpn[&quot;obj&quot;].end():
                            cpn = st_cpn[&quot;obj&quot;]
                            c = cpn._id
                    # å°è¯•è¿è¡Œç»„ä»¶
                    try:
                        ans = cpn.run(self.history, **kwargs)
                    # å¹¶æ•è·ä»»ä½•å¼‚å¸¸ å¦‚æœå‘ç”Ÿå¼‚å¸¸ è®°å½•é”™è¯¯å¹¶æ›´æ–° ran ç„¶åé‡æ–°æŠ›å‡ºå¼‚å¸¸
                    except Exception as e:
                        logging.exception(f&quot;Canvas.run got exception: &#123;e&#125;&quot;)
                        self.path[-1].append(c)
                        ran += 1
                        raise e
                    # å°†ç»„ä»¶ID c æ·»åŠ åˆ° self.path çš„æœ€åä¸€ä¸ªåˆ—è¡¨ä¸­
                    self.path[-1].append(c)
            # å¢åŠ  ran è®¡æ•°å™¨çš„å€¼
            ran += 1
        &quot;&quot;&quot;
        æ¥ä¸‹æ¥çš„ä»£ç å—å¤„ç†ä¸‹æ¸¸ç»„ä»¶çš„è¿è¡Œ å¾ªç¯æ£€æµ‹ ä»¥åŠç»„ä»¶è¾“å‡ºçš„åˆå¹¶
        è¿™éƒ¨åˆ†ä»£ç æ¶‰åŠåˆ°æ›´å¤æ‚çš„é€»è¾‘ï¼Œå¦‚å¤„ç†å¾ªç¯ã€æ¡ä»¶åˆ†æ”¯ã€ç»„ä»¶è¾“å‡ºç­‰
        &quot;&quot;&quot;
        # è·å–ä¸Šä¸€ä¸ªç»„ä»¶çš„ä¸‹æ¸¸ç»„ä»¶åˆ—è¡¨
        downstream = self.components[self.path[-2][-1]][&quot;downstream&quot;]
        # å¦‚æœæ²¡æœ‰ä¸‹æ¸¸ç»„ä»¶ ä½†å­˜åœ¨çˆ¶ç»„ä»¶ID åˆ™åˆå¹¶çˆ¶ç»„ä»¶å’Œå½“å‰ç»„ä»¶çš„è¾“å‡º
        if not downstream and self.components[self.path[-2][-1]].get(&quot;parent_id&quot;):
            cid = self.path[-2][-1]
            pid = self.components[cid][&quot;parent_id&quot;]
            o, _ = self.components[cid][&quot;obj&quot;].output(allow_partial=False)
            oo, _ = self.components[pid][&quot;obj&quot;].output(allow_partial=False)
            self.components[pid][&quot;obj&quot;].set_output(pd.concat([oo, o], ignore_index=True).dropna())
            downstream = [pid]
        # é€’å½’è°ƒç”¨ prepare2run å‡½æ•°å¤„ç†ä¸‹æ¸¸ç»„ä»¶ å¹¶ç”Ÿæˆè¿è¡ŒçŠ¶æ€ä¿¡æ¯
        for m in prepare2run(downstream):
            yield &#123;&quot;content&quot;: m, &quot;running_status&quot;: True&#125;

        # åœ¨ ran çš„å€¼æœ‰æ•ˆæ—¶ å¤„ç†å¾ªç¯å’Œç»„ä»¶è¿è¡Œ
        # ran çš„å€¼åœ¨ 0 å’Œ self.path[-1] çš„é•¿åº¦ä¹‹é—´æ—¶ç»§ç»­æ‰§è¡Œ
        while 0 &lt;= ran &lt; len(self.path[-1]):
            logging.debug(f&quot;Canvas.run: &#123;ran&#125; &#123;self.path&#125;&quot;)
            # ä» self.path ä¸­è·å–å½“å‰è¦å¤„ç†çš„ç»„ä»¶ID cpn_id
            # å¹¶é€šè¿‡ get_component æ–¹æ³•è·å–ç»„ä»¶å¯¹è±¡
            cpn_id = self.path[-1][ran]
            cpn = self.get_component(cpn_id)
            # å¦‚æœå½“å‰ç»„ä»¶æ²¡æœ‰ä¸‹æ¸¸ç»„ä»¶ã€æ²¡æœ‰çˆ¶ç»„ä»¶ID å¹¶ä¸”æ²¡æœ‰ç­‰å¾…å¤„ç†çš„ç»„ä»¶ åˆ™é€€å‡ºå¾ªç¯
            if not any([cpn[&quot;downstream&quot;], cpn.get(&quot;parent_id&quot;), waiting]):
                break

            # è°ƒç”¨ _find_loop æ–¹æ³•æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¾ªç¯ å¦‚æœå­˜åœ¨åˆ™æŠ›å‡º OverflowError å¼‚å¸¸
            loop = self._find_loop()
            if loop:
                raise OverflowError(f&quot;Too much loops: &#123;loop&#125;&quot;)
            # å¦‚æœç»„ä»¶çš„åç§°æ˜¯ â€œswitchâ€ã€â€œcategorizeâ€ æˆ– â€œrelevantâ€ åˆ™å¤„ç†è¿™äº›ç‰¹å®šç±»å‹çš„ç»„ä»¶
            if cpn[&quot;obj&quot;].component_name.lower() in [&quot;switch&quot;, &quot;categorize&quot;, &quot;relevant&quot;]:
                switch_out = cpn[&quot;obj&quot;].output()[1].iloc[0, 0]
                assert switch_out in self.components, \
                    &quot;&#123;&#125;&#39;s output: &#123;&#125; not valid.&quot;.format(cpn_id, switch_out)
                # é€’å½’è°ƒç”¨ prepare2run å‡½æ•°å¤„ç†ç‰¹å®šç»„ä»¶çš„è¾“å‡º å¹¶ç”Ÿæˆè¿è¡ŒçŠ¶æ€ä¿¡æ¯ ç„¶åç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯
                for m in prepare2run([switch_out]):
                    yield &#123;&quot;content&quot;: m, &quot;running_status&quot;: True&#125;
                continue

            # å¤„ç†çˆ¶ç»„ä»¶è¾“å‡ºåˆå¹¶
            downstream = cpn[&quot;downstream&quot;]
            # å¦‚æœæ²¡æœ‰ä¸‹æ¸¸ç»„ä»¶ä½†æœ‰çˆ¶ç»„ä»¶ID åˆ™åˆå¹¶çˆ¶ç»„ä»¶å’Œå½“å‰ç»„ä»¶çš„è¾“å‡º
            if not downstream and cpn.get(&quot;parent_id&quot;):
                pid = cpn[&quot;parent_id&quot;]
                _, o = cpn[&quot;obj&quot;].output(allow_partial=False)
                _, oo = self.components[pid][&quot;obj&quot;].output(allow_partial=False)
                self.components[pid][&quot;obj&quot;].set_output(pd.concat([oo.dropna(axis=1), o.dropna(axis=1)], ignore_index=True))
                downstream = [pid]
            # é€’å½’è°ƒç”¨ prepare2run å‡½æ•°å¤„ç†ä¸‹æ¸¸ç»„ä»¶ å¹¶ç”Ÿæˆè¿è¡ŒçŠ¶æ€ä¿¡æ¯
            for m in prepare2run(downstream):
                yield &#123;&quot;content&quot;: m, &quot;running_status&quot;: True&#125;

            # å¦‚æœ ran çš„å€¼ç­‰äºæˆ–è¶…è¿‡ self.path[-1] çš„é•¿åº¦
            # å¹¶ä¸”æœ‰ç­‰å¾…å¤„ç†çš„ç»„ä»¶ åˆ™å¤„ç†è¿™äº›ç»„ä»¶ å¹¶æ›´æ–° ran çš„å€¼
            if ran &gt;= len(self.path[-1]) and waiting:
                without_dependent_checking = waiting
                waiting = []
                for m in prepare2run(without_dependent_checking):
                    yield &#123;&quot;content&quot;: m, &quot;running_status&quot;: True&#125;
                without_dependent_checking = []
                ran -= 1
        # å¦‚æœ self.answer åˆ—è¡¨éç©º å¤„ç†ç­”æ¡ˆç»„ä»¶
        if self.answer:
            cpn_id = self.answer[0]
            self.answer.pop(0)
            ans = self.components[cpn_id][&quot;obj&quot;].run(self.history, **kwargs)
            self.path[-1].append(cpn_id)
            # å¦‚æœ self.answer åˆ—è¡¨ä¸ºç©º æŠ›å‡ºå¼‚å¸¸ æç¤ºéœ€è¦åœ¨æµç¨‹æœ«å°¾æ·»åŠ äº¤äº’ç»„ä»¶
            if kwargs.get(&quot;stream&quot;):
                assert isinstance(ans, partial)
                for an in ans():
                    yield an
            else:
                yield ans

        else:
            raise Exception(&quot;The dialog flow has no way to interact with you. Please add an &#39;Interact&#39; component to the end of the flow.&quot;)

    def get_component(self, cpn_id):
        return self.components[cpn_id]

    def get_tenant_id(self):
        return self._tenant_id
    # å®šä¹‰ä¸€ä¸ªåä¸º get_history çš„æ–¹æ³• å®ƒæ¥å—ä¸€ä¸ªå‚æ•° window_size è¿™ä¸ªå‚æ•°ç”¨äºç¡®å®šéœ€è¦è¿”å›å¤šå°‘æ¡å†å²è®°å½•
    def get_history(self, window_size):
        # åˆå§‹åŒ–ä¸€ä¸ªç©ºåˆ—è¡¨convs  ç”¨äºå­˜å‚¨æ ¼å¼åŒ–åçš„å¯¹è¯è®°å½•
        convs = []
        # ä½¿ç”¨ä¸€ä¸ª for å¾ªç¯éå† self.history çš„æœ€å window_size æ¡è®°å½•
        # self.history åº”è¯¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ å…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªåŒ…å«è§’è‰²å’Œå¯¹è±¡ï¼ˆå¯¹è¯å†…å®¹ï¼‰çš„å…ƒç»„
        &quot;&quot;&quot;
            role æ˜¯å¯¹è¯ä¸­çš„è§’è‰²ï¼Œä¾‹å¦‚ â€œuserâ€ æˆ– â€œassistantâ€ã€‚
            obj æ˜¯ä¸è¯¥è§’è‰²ç›¸å…³çš„å¯¹è¯å†…å®¹ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªåˆ—è¡¨æˆ–å•ä¸ªå¯¹è±¡
        &quot;&quot;&quot;
        for role, obj in self.history[window_size * -1:]:
            if isinstance(obj, list) and obj and all([isinstance(o, dict) for o in obj]):
                convs.append(&#123;&quot;role&quot;: role, &quot;content&quot;: &#39;\n&#39;.join([str(s.get(&quot;content&quot;, &quot;&quot;)) for s in obj])&#125;)
            else:
                convs.append(&#123;&quot;role&quot;: role, &quot;content&quot;: str(obj)&#125;)
        return convs

    def add_user_input(self, question):
        self.history.append((&quot;user&quot;, question))

    def set_embedding_model(self, embed_id):
        self._embed_id = embed_id

    def get_embedding_model(self):
        return self._embed_id
 # å®šä¹‰ä¸€ä¸ªåä¸º _find_loop çš„æ–¹æ³• å®ƒæ¥å—ä¸€ä¸ªå¯é€‰å‚æ•° max_loopsé»˜è®¤å€¼ä¸º6 è¿™ä¸ªå‚æ•°ç”¨äºé™åˆ¶å¾ªç¯æ£€æµ‹çš„æ¬¡æ•°
    def _find_loop(self, max_loops=6):
        # è·å– self.path åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆå³å½“å‰è·¯å¾„ï¼‰å¹¶å°†å…¶åè½¬ ä»¥ä¾¿ä»åå¾€å‰æ£€æŸ¥
        path = self.path[-1][::-1]
        # å¦‚æœè·¯å¾„çš„é•¿åº¦å°äº2 åˆ™æ²¡æœ‰è¶³å¤Ÿçš„å…ƒç´ å½¢æˆå¾ªç¯ å› æ­¤ç›´æ¥è¿”å› False
        if len(path) &lt; 2:
            return False
        # éå†è·¯å¾„ï¼Œå¦‚æœæ‰¾åˆ°ä»¥ â€œanswerâ€ æˆ– â€œiterationitemâ€ å¼€å¤´çš„å…ƒç´ 
        # åˆ™ä»è·¯å¾„ä¸­ç§»é™¤è¯¥å…ƒç´ åŠå…¶åé¢çš„æ‰€æœ‰å…ƒç´ 
        # å› ä¸ºè¿™äº›å…ƒç´ å¯èƒ½è¡¨ç¤ºå¾ªç¯çš„ç»“æŸ
        for i in range(len(path)):
            if path[i].lower().find(&quot;answer&quot;) == 0 or path[i].lower().find(&quot;iterationitem&quot;) == 0:
                path = path[:i]
                break
        # å†æ¬¡æ£€æŸ¥è·¯å¾„é•¿åº¦ å¦‚æœç§»é™¤ç‰¹å®šå…ƒç´ åé•¿åº¦å°äº2 åˆ™è¿”å› False
        if len(path) &lt; 2:
            return False
        # ä½¿ç”¨ä¸€ä¸ªå¾ªç¯æ¥æ£€æŸ¥è·¯å¾„çš„ä¸åŒå­åºåˆ— loc æ˜¯å­åºåˆ—çš„é•¿åº¦
        # ä» 2 å¼€å§‹ ç›´åˆ°è·¯å¾„é•¿åº¦çš„ä¸€åŠ
        for loc in range(2, len(path) // 2):
            # åˆ›å»ºä¸€ä¸ªå­åºåˆ—pat å®ƒæ˜¯è·¯å¾„çš„å‰locä¸ªå…ƒç´  ç”¨é€—å·è¿æ¥
            pat = &quot;,&quot;.join(path[0:loc])
            # åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸² path_str å®ƒæ˜¯æ•´ä¸ªè·¯å¾„ ç”¨é€—å·è¿æ¥
            path_str = &quot;,&quot;.join(path)
            # å¦‚æœå­åºåˆ—patçš„é•¿åº¦å¤§äºæˆ–ç­‰äºæ•´ä¸ªè·¯å¾„å­—ç¬¦ä¸² ath_strçš„é•¿åº¦ åˆ™ä¸å¯èƒ½å½¢æˆå¾ªç¯ å› æ­¤è¿”å› False
            if len(pat) &gt;= len(path_str):
                return False
            &quot;&quot;&quot;
            ä½¿ç”¨ä¸€ä¸ª while å¾ªç¯æ¥æ£€æŸ¥ path_str æ˜¯å¦ä»¥ pat å¼€å¤´ 
            å¦‚æœæ˜¯ åˆ™å‡å°‘ loop è®¡æ•° å¹¶ä» path_str ä¸­ç§»é™¤ pat å’Œéšåçš„é€—å·
            å¦‚æœ loop è®¡æ•°é™åˆ° 0 ä»¥ä¸‹ è¯´æ˜æ‰¾åˆ°äº†å¾ªç¯
            &quot;&quot;&quot;
            loop = max_loops
            while path_str.find(pat) == 0 and loop &gt;= 0:
                loop -= 1
                if len(pat)+1 &gt;= len(path_str):
                    return False
                path_str = path_str[len(pat)+1:]
                # å¦‚æœæ‰¾åˆ°äº†å¾ªç¯ åˆ™åˆ›å»ºä¸€ä¸ªå¾ªç¯æ¨¡å¼çš„å­—ç¬¦ä¸² ä½¿ç”¨ &quot; =&gt; &quot; ä½œä¸ºåˆ†éš”ç¬¦
                # å¹¶å°†è·¯å¾„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„å‰åŠéƒ¨åˆ†ï¼ˆåœ¨å†’å·ä¹‹å‰çš„éƒ¨åˆ†ï¼‰è¿æ¥èµ·æ¥
                # æœ€å è¿”å›ä¸€ä¸ªè¡¨ç¤ºå¾ªç¯çš„æ¨¡å¼å­—ç¬¦ä¸²
            if loop &lt; 0:
                pat = &quot; =&gt; &quot;.join([p.split(&quot;:&quot;)[0] for p in path[0:loc]])
                return pat + &quot; =&gt; &quot; + pat

        return False

    def get_prologue(self):
        return self.components[&quot;begin&quot;][&quot;obj&quot;]._param.prologue

    def set_global_param(self, **kwargs):
        for k, v in kwargs.items():
            for q in self.components[&quot;begin&quot;][&quot;obj&quot;]._param.query:
                if k != q[&quot;key&quot;]:
                    continue
                q[&quot;value&quot;] = v

    def get_preset_param(self):
        return self.components[&quot;begin&quot;][&quot;obj&quot;]._param.query

    def get_component_input_elements(self, cpnnm):
        return self.components[cpnnm][&quot;obj&quot;].get_input_elements()
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#879cff>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/03/19/AI/RAGFlowæ‰§è¡Œæµç¨‹è§£æcanvas/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/03/19/AI/RAGFlowä»£ç†ç»„ä»¶æŠ€æœ¯/">
        <h2>
            RAGFlowä»£ç†ç»„ä»¶æŠ€æœ¯
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/3/19
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h4 id="å¦‚æœè¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç»„ä»¶å¹¶ä¸”ä½¿ç”¨"><a href="#å¦‚æœè¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç»„ä»¶å¹¶ä¸”ä½¿ç”¨" class="headerlink" title="å¦‚æœè¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç»„ä»¶å¹¶ä¸”ä½¿ç”¨"></a><span style = "color:red">å¦‚æœè¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç»„ä»¶å¹¶ä¸”ä½¿ç”¨</span></h4><h6 id="è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ç±»-è‡ªå®šä¹‰æ–°çš„ç»„ä»¶å‚æ•°"><a href="#è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ç±»-è‡ªå®šä¹‰æ–°çš„ç»„ä»¶å‚æ•°" class="headerlink" title="è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ç±» + è‡ªå®šä¹‰æ–°çš„ç»„ä»¶å‚æ•°"></a>è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ç±» + è‡ªå®šä¹‰æ–°çš„ç»„ä»¶å‚æ•°</h6><p>â‘  <code>agent/component/xxxx.py</code> åœ¨é‡Œé¢<strong>ç»§æ‰¿</strong> <code>ComponentParamBase</code> +  <code>ComponentBase</code> ç±» è¿™æ ·å°±å¯ä»¥é‡ç”¨å…¶ä¸­çš„å¤§éƒ¨åˆ†æ–¹æ³•å’Œé€»è¾‘<br>â‘¡ æ–°ç»„ä»¶ç±»éœ€è¦å®ç° <code>_run</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå®šä¹‰ç»„ä»¶çš„å…·ä½“ä¸šåŠ¡é€»è¾‘</p>
<pre><code class="python">BaiduFanyiParam â†’â†’ ComponentBase â†’ base.py
â˜…â˜…â˜… base.pyã€é‡Œé¢çš„outputæ˜¯è¾“å‡ºä¸ºå…ƒç»„(DataFrame) 
å†é€šè¿‡åºåˆ—åŒ–è½¬æ¢ä¸º(å­—å…¸)(def as_dict(self))JSONã€‘ â˜…â˜…â˜…

    æ‰©å±•æ€§ï¼šä¸åŒçš„å­ç±»å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚å®ç°è‡ªå·±çš„ _run æ–¹æ³•
           ä¸åŒçš„ä¸šåŠ¡é€»è¾‘å¯èƒ½éœ€è¦ä¸åŒçš„æ•°æ®å¤„ç†æ–¹å¼å’Œè®¡ç®—æ–¹æ³•
    çµæ´»é…ç½®ï¼škwargs å‚æ•°æä¾›äº†æ–¹æ³•è°ƒç”¨æ—¶çµæ´»ä¼ é€’å‚æ•°çš„èƒ½åŠ›ï¼Œå¯ä»¥æ ¹æ®éœ€è¦åœ¨ä¸åŒæƒ…å†µä¸‹è°ƒæ•´è¡Œä¸ºã€‚
    è°ƒè¯•å’Œç›‘æ§ï¼šé€šè¿‡ logging.debug å’Œ set_output è®°å½•è¾“å…¥å’Œè¾“å‡ºï¼Œå¯ä»¥åœ¨è°ƒè¯•å’Œç”Ÿäº§ç¯å¢ƒä¸­è·Ÿè¸ªç¨‹åºçš„è¡Œä¸ºï¼Œå¹¶åŠæ—¶å‘ç°é—®é¢˜ã€‚
    
    def run(self, history, **kwargs):
        logging.debug(&quot;&#123;&#125;, history: &#123;&#125;, kwargs: &#123;&#125;&quot;.format(self, json.dumps(history, ensure_ascii=False),
                                                              json.dumps(kwargs, ensure_ascii=False)))
        self._param.debug_inputs = []
        try:
            res = self._run(history, **kwargs)
            self.set_output(res)
        except Exception as e:
            self.set_output(pd.DataFrame([&#123;&quot;content&quot;: str(e)&#125;]))
            raise e

        return res

    def _run(self, history, **kwargs):
        raise NotImplementedError()
</code></pre>
<pre><code class="python">ã€è‡ªå®šä¹‰ç»„ä»¶ã€‘BaiduFanyi â†’â†’ ComponentBase â†’ abc.py ã€Pythonçš„æŠ½è±¡åŸºç±»(ç±»ä¼¼äºJavaçš„æ¥å£)ã€‘
ç¡®ä¿æŸäº›ç±»åœ¨ç»§æ‰¿æŠ½è±¡åŸºç±»æ—¶éµå¾ªç‰¹å®šçš„åè®® è¿™åœ¨è®¾è®¡å¤§å‹ç³»ç»Ÿæˆ–è€…æ¡†æ¶æ—¶éå¸¸æœ‰ç”¨
â˜… æ¥å£å®šä¹‰ï¼šå®šä¹‰äº†ç»„ä»¶å¿…é¡»å®ç°çš„æ–¹æ³• =&gt; `_run` =&gt; ç»„ä»¶æ‰§è¡Œå…¶ä»»åŠ¡çš„åœ°æ–¹
â˜… ç»„ä»¶å‘½åï¼šé€šè¿‡ component_name ç±»å±æ€§ï¼Œå®ƒæä¾›äº†ç»„ä»¶çš„åç§°ï¼Œè¿™æœ‰åŠ©äºåœ¨ç³»ç»Ÿä¸­è¯†åˆ«å’Œç®¡ç†ç»„ä»¶
â˜… è¿è¡Œé€»è¾‘ï¼š`_run` æ–¹æ³•æ˜¯ç»„ä»¶çš„æ ¸å¿ƒï¼Œå®ƒåŒ…å«äº†ç»„ä»¶çš„æ‰§è¡Œé€»è¾‘ï¼Œä¾‹å¦‚å¦‚ä½•ä½¿ç”¨å‚æ•°ã€å¦‚ä½•å¤„ç†è¾“å…¥ã€å¦‚ä½•è°ƒç”¨å¤–éƒ¨APIç­‰
â˜… è¾“å…¥/è¾“å‡ºå¤„ç†ï¼šoutput â†’ base.py ç”¨äºå¤„ç†ç»„ä»¶çš„è¾“å‡ºï¼Œç¡®ä¿æ‰€æœ‰ç»„ä»¶çš„è¾“å‡ºæ ¼å¼ä¸€è‡´
------------------------------------------------------------------------------
ã€è‡ªå®šä¹‰ç»„ä»¶å‚æ•°ã€‘BaiduFanyiParam â†’â†’ ComponentParamBase â†’ base.py ã€åˆå§‹åŒ–+æ ¡éªŒã€‘
å®šä¹‰äº†ç™¾åº¦ç¿»è¯‘ç»„ä»¶æ‰€éœ€çš„å‚æ•°ï¼Œä¾‹å¦‚ appidã€secret_keyã€trans_type ç­‰ï¼Œå®ƒè¿˜å®ç°äº†ä¸€ä¸ª check æ–¹æ³•ï¼Œç”¨äºéªŒè¯å‚æ•°çš„æœ‰æ•ˆæ€§ã€‚
â˜… å‚æ•°å°è£…ï¼šå®ƒå°è£…äº†ç»„ä»¶è¿è¡Œæ‰€éœ€çš„æ‰€æœ‰å‚æ•°ï¼Œä½¿å¾—å‚æ•°ç®¡ç†æ›´åŠ é›†ä¸­æ–¹ä¾¿
â˜… å‚æ•°éªŒè¯ï¼šé€šè¿‡ check æ–¹æ³•ï¼Œå¯ä»¥ç¡®ä¿åœ¨ç»„ä»¶è¿è¡Œå‰æ‰€æœ‰å¿…è¦çš„å‚æ•°éƒ½è¢«æ­£ç¡®è®¾ç½®ï¼Œå¹¶ä¸”æ˜¯æœ‰æ•ˆçš„
â˜… å¯æ‰©å±•æ€§ï¼šå…¶ä»–ç»„ä»¶çš„å‚æ•°ç±»å¯ä»¥ç»§æ‰¿ ComponentParamBase å¹¶æ ¹æ®éœ€è¦æ·»åŠ æˆ–ä¿®æ”¹å‚æ•°
</code></pre>
<pre><code class="python">import random
# æŠ½è±¡åŸºç±»æ¨¡å— ç”¨äºå®šä¹‰ç»„ä»¶çš„åŸºç±»
from abc import ABC
# ç”¨äºå‘é€ HTTP è¯·æ±‚ï¼Œä¸ ç™¾åº¦ç¿»è¯‘ API äº¤äº’
import requests
# åŸºç¡€ç»„ä»¶ç±»ï¼Œäºæ„å»ºæ­¤ç»„ä»¶çš„çˆ¶ç±»ï¼Œå®šä¹‰ç»„ä»¶çš„åŸºæœ¬ç»“æ„å’Œå‚æ•°ã€‚
from agent.component.base import ComponentBase, ComponentParamBase
# ç”¨äºç”Ÿæˆç™¾åº¦ç¿»è¯‘ API è¯·æ±‚ç­¾åï¼ˆåŠ å¯†å“ˆå¸Œï¼‰
from hashlib import md5

# ç™¾åº¦ç¿»è¯‘ç»„ä»¶çš„å‚æ•°å®šä¹‰ç±» ç»§æ‰¿ComponentParamBase
class BaiduFanyiParam(ComponentParamBase):
    &quot;&quot;&quot;
    Define the BaiduFanyi component parameters.
    &quot;&quot;&quot;

    def __init__(self):
        super().__init__()
   # appid å’Œ secret_key æ˜¯ç™¾åº¦ç¿»è¯‘ API çš„ èº«ä»½éªŒè¯ ä¿¡æ¯ï¼ˆéœ€è¦åœ¨ç™¾åº¦ç¿»è¯‘å¼€æ”¾å¹³å°è·å–ï¼‰
        self.appid = &quot;xxx&quot;
        self.secret_key = &quot;xxx&quot;
   # translateï¼šæ™®é€šç¿»è¯‘   fieldtranslateï¼šä¸“ä¸šé¢†åŸŸç¿»è¯‘
        self.trans_type = &#39;translate&#39;
        self.parameters = []
   # source_lang ç¿»è¯‘çš„æºè¯­è¨€   target_lang ç¿»è¯‘çš„ç›®æ ‡è¯­è¨€
        self.source_lang = &#39;auto&#39;
        self.target_lang = &#39;auto&#39;
   # domain å¦‚æœä½¿ç”¨ä¸“ä¸šé¢†åŸŸç¿»è¯‘ï¼Œéœ€æŒ‡å®šé¢†åŸŸï¼ˆå¦‚ finance è¡¨ç¤º é‡‘è é¢†åŸŸï¼‰
        self.domain = &#39;finance&#39;
# æ£€æŸ¥å‚æ•°åˆæ³•æ€§
    def check(self):
    # check_empty()ï¼šç¡®ä¿ appid å’Œ secret_key ä¸èƒ½ä¸ºç©ºã€‚
        self.check_empty(self.appid, &quot;BaiduFanyi APPID&quot;)
        self.check_empty(self.secret_key, &quot;BaiduFanyi Secret Key&quot;)
# check_valid_value()ï¼šç¡®ä¿ trans_typeã€source_langã€target_langã€domain çš„å€¼åœ¨åˆæ³•é€‰é¡¹ä¹‹å†…
        self.check_valid_value(self.trans_type, &quot;Translate type&quot;, [&#39;translate&#39;, &#39;fieldtranslate&#39;])
# ä»¥ä¸‹æ˜¯åˆ—ä¸¾å„ç§è¯­è¨€
        self.check_valid_value(self.source_lang, &quot;Source language&quot;,
                               [&#39;auto&#39;, &#39;zh&#39;, &#39;en&#39;, &#39;yue&#39;, &#39;wyw&#39;, &#39;jp&#39;, &#39;kor&#39;, &#39;fra&#39;, &#39;spa&#39;, &#39;th&#39;, &#39;ara&#39;, &#39;ru&#39;, &#39;pt&#39;,
                                &#39;de&#39;, &#39;it&#39;, &#39;el&#39;, &#39;nl&#39;, &#39;pl&#39;, &#39;bul&#39;, &#39;est&#39;, &#39;dan&#39;, &#39;fin&#39;, &#39;cs&#39;, &#39;rom&#39;, &#39;slo&#39;, &#39;swe&#39;,
                                &#39;hu&#39;, &#39;cht&#39;, &#39;vie&#39;])
        self.check_valid_value(self.target_lang, &quot;Target language&quot;,
                               [&#39;auto&#39;, &#39;zh&#39;, &#39;en&#39;, &#39;yue&#39;, &#39;wyw&#39;, &#39;jp&#39;, &#39;kor&#39;, &#39;fra&#39;, &#39;spa&#39;, &#39;th&#39;, &#39;ara&#39;, &#39;ru&#39;, &#39;pt&#39;,
                                &#39;de&#39;, &#39;it&#39;, &#39;el&#39;, &#39;nl&#39;, &#39;pl&#39;, &#39;bul&#39;, &#39;est&#39;, &#39;dan&#39;, &#39;fin&#39;, &#39;cs&#39;, &#39;rom&#39;, &#39;slo&#39;, &#39;swe&#39;,
                                &#39;hu&#39;, &#39;cht&#39;, &#39;vie&#39;])
# ä»¥ä¸‹æ˜¯åˆ—ä¸¾ä¸åŒä¸“ä¸šé¢†åŸŸ
        self.check_valid_value(self.domain, &quot;Translate field&quot;,
                               [&#39;it&#39;, &#39;finance&#39;, &#39;machinery&#39;, &#39;senimed&#39;, &#39;novel&#39;, &#39;academic&#39;, &#39;aerospace&#39;, &#39;wiki&#39;,
                                &#39;news&#39;, &#39;law&#39;, &#39;contract&#39;])

# ç»§æ‰¿ComponentBaseå’ŒABC


# -------------------------------------------------------------------------------- #


class BaiduFanyi(ComponentBase, ABC):
 # å®šä¹‰ç»„ä»¶åç§°åœ¨ç³»ç»Ÿå†…å”¯ä¸€æ ‡è¯†è¯¥ç»„ä»¶
    component_name = &quot;BaiduFanyi&quot;
    # _run()æ˜¯ç»„ä»¶çš„ æ ¸å¿ƒæ‰§è¡Œå‡½æ•°ï¼Œç”¨äºå¤„ç†ç¿»è¯‘è¯·æ±‚ã€‚
# **kwargsï¼šå¯ä»¥è®©å‡½æ•°æ›´åŠ çµæ´»ï¼Œå› ä¸ºå®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‘½åå‚æ•°
# åœ¨å‡½æ•°å†…éƒ¨ï¼Œkwargs æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†æ‰€æœ‰ä¼ é€’ç»™å‡½æ•°çš„é¢å¤–å‘½åå‚æ•°ã€‚
    def _run(self, history, **kwargs):
&#39;&#39;&#39;
self.get_input() è·å–è¾“å…¥å†…å®¹ã€‚
å¦‚æœ content å­˜åœ¨ï¼Œåˆ™ç”¨ - è¿æ¥å¤šä¸ªå†…å®¹ï¼ˆæ‹¼æ¥æˆå•ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚
å¦‚æœ ans ä¸ºç©ºï¼Œç›´æ¥è¿”å› &quot;&quot;
&#39;&#39;&#39;
        ans = self.get_input()
        ans = &quot; - &quot;.join(ans[&quot;content&quot;]) if &quot;content&quot; in ans else &quot;&quot;
        if not ans:
            return BaiduFanyi.be_output(&quot;&quot;)

        try:
&#39;&#39;&#39;
source_lang å’Œ target_langï¼šæ¥æºå’Œç›®æ ‡è¯­è¨€ã€‚
appidï¼šç™¾åº¦ç¿»è¯‘ API çš„ åº”ç”¨ IDã€‚
saltï¼šéšæœºæ•°ï¼ˆç™¾åº¦ API éœ€è¦æ­¤å‚æ•°ï¼‰ã€‚
secret_keyï¼šç™¾åº¦ API çš„ å¯†é’¥
&#39;&#39;&#39;
            source_lang = self._param.source_lang
            target_lang = self._param.target_lang
            appid = self._param.appid
            salt = random.randint(32768, 65536)
            secret_key = self._param.secret_key
-------------------------- â˜† æ™®é€šç¿»è¯‘APIè¯·æ±‚ â˜† --------------------------
            if self._param.trans_type == &#39;translate&#39;:
            # md5ç­¾åï¼Œé˜²æ­¢è¯·æ±‚è¢«ç¯¡æ”¹
                sign = md5((appid + ans + salt + secret_key).encode(&#39;utf-8&#39;)).hexdigest()
     # å‘é€ HTTP POST è¯·æ±‚ è®¿é—® ç™¾åº¦ç¿»è¯‘ API
                url = &#39;http://api.fanyi.baidu.com/api/trans/vip/translate?&#39; + &#39;q=&#39; + ans + &#39;&amp;from=&#39; + source_lang + &#39;&amp;to=&#39; + target_lang + &#39;&amp;appid=&#39; + appid + &#39;&amp;salt=&#39; + salt + &#39;&amp;sign=&#39; + sign
                headers = &#123;&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;&#125;
            # è§£æè¿”å›ç»“æœ
                response = requests.post(url=url, headers=headers).json()

                if response.get(&#39;error_code&#39;):
                    BaiduFanyi.be_output(&quot;**Error**:&quot; + response[&#39;error_msg&#39;])

                return BaiduFanyi.be_output(response[&#39;trans_result&#39;][0][&#39;dst&#39;])
-------------------------- â˜… ä¸“ä¸šç¿»è¯‘APIè¯·æ±‚ â˜… --------------------------
            elif self._param.trans_type == &#39;fieldtranslate&#39;:
                domain = self._param.domain
                sign = md5((appid + ans + salt + domain + secret_key).encode(&#39;utf-8&#39;)).hexdigest()
                url = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate?&#39; + &#39;q=&#39; + ans + &#39;&amp;from=&#39; + source_lang + &#39;&amp;to=&#39; + target_lang + &#39;&amp;appid=&#39; + appid + &#39;&amp;salt=&#39; + salt + &#39;&amp;domain=&#39; + domain + &#39;&amp;sign=&#39; + sign
                headers = &#123;&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;&#125;
                response = requests.post(url=url, headers=headers).json()

                if response.get(&#39;error_code&#39;):
                    BaiduFanyi.be_output(&quot;**Error**:&quot; + response[&#39;error_msg&#39;])

                return BaiduFanyi.be_output(response[&#39;trans_result&#39;][0][&#39;dst&#39;])
        # æ•è· æ‰€æœ‰å¼‚å¸¸ï¼Œé˜²æ­¢ç¨‹åºå´©æºƒ
        except Exception as e:
            BaiduFanyi.be_output(&quot;**Error**:&quot; + str(e))
</code></pre>
<h6 id="é’ˆå¯¹äºè‡ªå®šä¹‰ç»„ä»¶å‚æ•°-ComponentParamBase-ä¸ºä»€ä¹ˆé‡Œé¢æ˜¯ç”¨çš„Jsonæ ¼å¼ï¼Ÿ"><a href="#é’ˆå¯¹äºè‡ªå®šä¹‰ç»„ä»¶å‚æ•°-ComponentParamBase-ä¸ºä»€ä¹ˆé‡Œé¢æ˜¯ç”¨çš„Jsonæ ¼å¼ï¼Ÿ" class="headerlink" title="é’ˆå¯¹äºè‡ªå®šä¹‰ç»„ä»¶å‚æ•°[ComponentParamBase] ä¸ºä»€ä¹ˆé‡Œé¢æ˜¯ç”¨çš„Jsonæ ¼å¼ï¼Ÿ"></a>é’ˆå¯¹äºè‡ªå®šä¹‰ç»„ä»¶å‚æ•°[ComponentParamBase] ä¸ºä»€ä¹ˆé‡Œé¢æ˜¯ç”¨çš„Jsonæ ¼å¼ï¼Ÿ</h6><ul>
<li><p><strong>æ–¹ä¾¿åºåˆ—åŒ–</strong>ï¼š<code>json.dumps()</code>å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¯ä»¥è½»æ¾åœ°ä¿å­˜æˆ–ä¼ è¾“å¯¹è±¡æ•°æ®ã€‚</p>
<pre><code class="python">base.py
    def __str__(self):
        &quot;&quot;&quot;
        &#123;
            &quot;component_name&quot;: &quot;Begin&quot;,
            &quot;params&quot;: &#123;&#125;
        &#125;
        &quot;&quot;&quot;
        # .format()å°†å˜é‡æ’å…¥åˆ°å­—ç¬¦ä¸²æ¨¡æ¿ä¸­çš„å ä½ç¬¦ä½ç½®  &#123;&#123;&#125;&#125;è½¬ä¹‰&#123;&#125;
        return &quot;&quot;&quot;&#123;&#123;
              "component_name": "&#123;&#125;",
              "params": &#123;&#125;,
              "output": &#123;&#125;,
              "inputs": &#123;&#125;
          &#125;&#125;&quot;&quot;&quot;.format(self.component_name,
                     self._param,
# json.dumps(...): å°†è·å–çš„ &quot;output&quot; å’Œ &quot;inputs&quot; å€¼åºåˆ—åŒ–ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²
# json.loads(str(self._param)): å°† self._param è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åå°†å…¶è§£æä¸º JSON å¯¹è±¡
# self._param è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åå°†å…¶è§£æä¸º JSON å¯¹è±¡
# ä» JSON å¯¹è±¡ä¸­è·å– &quot;output&quot; é”®å¯¹åº”çš„å€¼ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›ç©ºå­—å…¸ &#123;&#125;
                     json.dumps(json.loads(str(self._param)).get(&quot;output&quot;, &#123;&#125;), ensure_ascii=False),
                     json.dumps(json.loads(str(self._param)).get(&quot;inputs&quot;, []), ensure_ascii=False)
        )
</code></pre>
</li>
<li><p><strong>æ–¹ä¾¿è°ƒè¯•å’Œå±•ç¤º</strong>ï¼šåœ¨ <code>__str__</code> æ–¹æ³•ä¸­è¿”å› JSON å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹å¯¹è±¡çš„å†…å®¹ã€‚å°¤å…¶æ˜¯åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œç›´æ¥æ‰“å°å‡ºå¯¹è±¡çš„ JSON æ ¼å¼å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å¿«é€ŸæŸ¥çœ‹å¯¹è±¡çš„çŠ¶æ€åŠå…¶å†…éƒ¨æ•°æ®ç»“æ„</p>
<pre><code class="python"># å°†å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
    def __str__(self):
        return json.dumps(self.as_dict(), ensure_ascii=False)
# é€’å½’åœ°å°†å¯¹è±¡çš„å±æ€§è½¬æ¢æˆå­—å…¸ é€‚ç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æˆ–è¿›è¡Œå…¶ä»–æ“ä½œ
    def as_dict(self):
        def _recursive_convert_obj_to_dict(obj):
            ret_dict = &#123;&#125;
            for attr_name in list(obj.__dict__):
                if attr_name in [_FEEDED_DEPRECATED_PARAMS, _DEPRECATED_PARAMS, _USER_FEEDED_PARAMS, _IS_RAW_CONF]:
                    continue
                # get attr
                attr = getattr(obj, attr_name)
                if isinstance(attr, pd.DataFrame):
                    ret_dict[attr_name] = attr.to_dict()
                    continue
                if attr and type(attr).__name__ not in dir(builtins):
                    ret_dict[attr_name] = _recursive_convert_obj_to_dict(attr)
                else:
                    ret_dict[attr_name] = attr
            return ret_dict
        return _recursive_convert_obj_to_dict(self)
</code></pre>
</li>
<li><p><strong>ä¸å¤§æ¨¡å‹äº¤äº’</strong>ï¼šå½“æ¶‰åŠåˆ°ä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPTï¼‰æˆ–å…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹çš„äº¤äº’æ—¶ï¼ŒJSON æ ¼å¼çš„æ•°æ®é€šå¸¸æ˜¯æ ‡å‡†çš„è¾“å…¥å’Œè¾“å‡ºæ ¼å¼ã€‚å°†å¯¹è±¡è½¬ä¸º JSON å­—ç¬¦ä¸²ï¼Œèƒ½å¤Ÿæ›´å®¹æ˜“åœ°å°†æ•°æ®ä¼ é€’ç»™æ¨¡å‹è¿›è¡Œå¤„ç†æˆ–åˆ†æï¼Œæ¨¡å‹é€šå¸¸ä¼šæ¥å— JSON æ ¼å¼çš„æ•°æ®è¿›è¡Œè®­ç»ƒæˆ–æ¨ç†ã€‚</p>
</li>
</ul>
<h5 id="å¦‚ä½•å»è¿ç”¨ï¼Ÿ"><a href="#å¦‚ä½•å»è¿ç”¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•å»è¿ç”¨ï¼Ÿ"></a>å¦‚ä½•å»è¿ç”¨ï¼Ÿ</h5><ul>
<li><strong>æ•°æ®äº¤æ¢</strong>ï¼šå¯ä»¥å°†è¿™ä¸ª JSON å­—ç¬¦ä¸²ç”¨ä½œ API è¯·æ±‚æˆ–å“åº”çš„æ•°æ®æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†è¿™ä¸ªå¯¹è±¡ä½œä¸º HTTP è¯·æ±‚çš„ body å‘é€ï¼Œæˆ–è€…ä»ç½‘ç»œä¸­è·å– JSON æ ¼å¼çš„æ•°æ®ï¼Œç„¶åè§£æå›å¯¹è±¡ã€‚</li>
<li><strong>æŒä¹…åŒ–å­˜å‚¨</strong>ï¼šå¦‚æœä½ éœ€è¦å°†å¯¹è±¡æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼ŒJSON æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­˜å‚¨æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œå°†å¯¹è±¡æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ä¸­æˆ–æ•°æ®åº“è¡¨çš„ JSON ç±»å‹å­—æ®µä¸­ï¼Œä¾¿äºæœªæ¥è¯»å–å’Œæ“ä½œã€‚</li>
<li><strong>é…ç½®å’Œå‚æ•°æ›´æ–°</strong>ï¼š<code>update</code> æ–¹æ³•ä¸­æ¥æ”¶åˆ°çš„ <code>conf</code> å‚æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—å…¸å¯¹è±¡ï¼Œå®ƒé€šè¿‡é€’å½’çš„æ–¹å¼æ›´æ–°å¯¹è±¡çš„å±æ€§ã€‚å¦‚æœä½ å°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æ ¼å¼åï¼Œå¯ä»¥å°† JSON ä½œä¸ºé…ç½®æ–‡ä»¶ä¼ é€’ç»™åº”ç”¨ï¼Œåº”ç”¨æ ¹æ®è¯¥é…ç½®åŠ¨æ€è°ƒæ•´å…¶è¡Œä¸ºã€‚è¿™ä½¿å¾—ç³»ç»Ÿæ›´åŠ çµæ´»å’Œå¯é…ç½®ã€‚</li>
<li><strong>éªŒè¯ä¸æ ¡éªŒ</strong>ï¼š<code>validate</code> æ–¹æ³•åˆ©ç”¨å­˜å‚¨åœ¨ JSON æ–‡ä»¶ä¸­çš„è§„åˆ™å¯¹å¯¹è±¡è¿›è¡Œå‚æ•°éªŒè¯ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„æ–¹å¼æ¥ç¡®ä¿è¾“å…¥çš„æ•°æ®ç¬¦åˆç‰¹å®šçš„æ ¼å¼æˆ–é™åˆ¶ã€‚å¯ä»¥é€šè¿‡åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶æ¥éªŒè¯å¯¹è±¡çš„æ•°æ®ï¼Œä¿è¯æ•°æ®çš„åˆæ³•æ€§ã€‚</li>
</ul>
<h5 id="æ•°æ®è¾“å‡º-å…ƒç»„-åŠè½¬æ¢-JSON"><a href="#æ•°æ®è¾“å‡º-å…ƒç»„-åŠè½¬æ¢-JSON" class="headerlink" title="æ•°æ®è¾“å‡º(å…ƒç»„)åŠè½¬æ¢(JSON)"></a>æ•°æ®è¾“å‡º(å…ƒç»„)åŠè½¬æ¢(JSON)</h5><pre><code class="python">----------------------------------- è¾“å‡ºä¸ºå…ƒç»„ -----------------------------------    
    def output(self, allow_partial=True) -&gt; Tuple[str, Union[pd.DataFrame, partial]]:
        o = getattr(self._param, self._param.output_var_name)
        if not isinstance(o, partial):
            if not isinstance(o, pd.DataFrame):
                if isinstance(o, list):
                    return self._param.output_var_name, pd.DataFrame(o)
                if o is None:
                    return self._param.output_var_name, pd.DataFrame()
                return self._param.output_var_name, pd.DataFrame([&#123;&quot;content&quot;: str(o)&#125;])
            return self._param.output_var_name, o

        if allow_partial or not isinstance(o, partial):
            if not isinstance(o, partial) and not isinstance(o, pd.DataFrame):
                return pd.DataFrame(o if isinstance(o, list) else [o])
            return self._param.output_var_name, o

        outs = None
        for oo in o():
            if not isinstance(oo, pd.DataFrame):
                # æœ€ç»ˆè¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç»„
                outs = pd.DataFrame(oo if isinstance(oo, list) else [oo])
            else:
                outs = oo
        return self._param.output_var_name, outs

----------------------------------- åºåˆ—åŒ–ä¸ºJSON -----------------------------------
 # å°†å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
    def __str__(self):
        return json.dumps(self.as_dict(), ensure_ascii=False)

    # é€’å½’åœ°å°†å¯¹è±¡çš„å±æ€§è½¬æ¢æˆå­—å…¸ é€‚ç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æˆ–è¿›è¡Œå…¶ä»–æ“ä½œ
    def as_dict(self):
        def _recursive_convert_obj_to_dict(obj):
            ret_dict = &#123;&#125;
            for attr_name in list(obj.__dict__):
                if attr_name in [_FEEDED_DEPRECATED_PARAMS, _DEPRECATED_PARAMS,
                                 _USER_FEEDED_PARAMS, _IS_RAW_CONF]:
                    continue
                # get attr
                attr = getattr(obj, attr_name)
                if isinstance(attr, pd.DataFrame):
                    ret_dict[attr_name] = attr.to_dict()
                    continue
                if attr and type(attr).__name__ not in dir(builtins):
                    ret_dict[attr_name] = _recursive_convert_obj_to_dict(attr)
                else:
                    ret_dict[attr_name] = attr

            return ret_dict

        return _recursive_convert_obj_to_dict(self)
    
--------------------------------------------------------------------------------------
def get_stream_input(self)ï¼š
def get_input_elements(self):
    
def get_input(self)ï¼š
# ä¸Šæ¸¸ç»„ä»¶çš„è¾“å‡ºï¼šå®ƒä¼šæ£€æŸ¥å½“å‰ç»„ä»¶çš„ä¸Šæ¸¸ç»„ä»¶ï¼Œå¹¶å°è¯•ä»è¿™äº›ç»„ä»¶è·å–è¾“å‡ºæ•°æ®ä½œä¸ºå½“å‰çš„è¾“å…¥
# å¦‚æœ _param.query å­˜åœ¨ï¼Œå®ƒä¼šéå†æŸ¥è¯¢å‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°çš„ç±»å‹ï¼ˆå¦‚ç»„ä»¶ IDï¼‰æ¥å†³å®šå¦‚ä½•è·å–ç›¸åº”çš„è¾“å…¥æ•°æ®
# inputåå†é€šè¿‡DataFrameè½¬æ¢ä¸ºå…ƒç»„ å†å»è½¬æ¢ä¸ºå­—å…¸
# æ¥å›æ¥è½¬æ¢æ˜¯ä¸ºäº†æ»¡è¶³ç‰¹å®šçš„æ¥å£è¦æ±‚æˆ–è€…ä¸ºäº†ç¡®ä¿æ•°æ®åœ¨ä¸åŒå±‚ä¹‹é—´ä¼ è¾“æ—¶çš„å…¼å®¹æ€§



&#39;&#39;&#39;
                           ä½¿ç”¨Pandasåº“æ¥å¤„ç†æ•°æ®
â˜… get_inputå‡½æ•°: è¿™ä¸ªå‡½æ•°é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰è°ƒè¯•è¾“å…¥ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿”å›ä¸€ä¸ªåŒ…å«è°ƒè¯•è¾“å…¥å†…å®¹çš„DataFrameã€‚ç„¶åï¼Œå®ƒå¤„ç†æŸ¥è¯¢è¾“å…¥ï¼Œæ ¹æ®æŸ¥è¯¢ä¸­çš„ä¸åŒæ¡ä»¶ï¼ˆå¦‚component_idã€valueç­‰ï¼‰ï¼Œè°ƒç”¨å…¶ä»–å‡½æ•°è·å–ç›¸åº”çš„è¾“å…¥å†…å®¹ï¼Œå¹¶å°†è¿™äº›å†…å®¹æ·»åŠ åˆ°self._param.inputsåˆ—è¡¨ä¸­ã€‚æœ€åï¼Œå®ƒé€šè¿‡pd.concatå‡½æ•°å°†æ‰€æœ‰ä¸Šæ¸¸ç»„ä»¶[ç»“åˆhistory]çš„è¾“å‡ºåˆå¹¶æˆä¸€ä¸ªDataFrameï¼Œå¹¶è¿”å›ã€‚

â˜… get_input_elementså‡½æ•°: è¿™ä¸ªå‡½æ•°æ ¹æ®self._param.queryä¸­çš„æŸ¥è¯¢ï¼Œæ„å»ºä¸€ä¸ªè¾“å…¥å…ƒç´ åˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ åŒ…å«åç§°ã€é”®å’Œå€¼ã€‚

â˜…get_stream_inputå‡½æ•°: è¿™ä¸ªå‡½æ•°å¤„ç†æµå¼è¾“å…¥ï¼Œæ ¹æ®ç»„ä»¶è·¯å¾„ï¼Œè°ƒç”¨å…¶ä»–å‡½æ•°è·å–ç›¸åº”çš„è¾“å…¥å†…å®¹ï¼Œå¹¶è¿”å›ã€‚

ä¸»è¦æ˜¯å¤„ç†è¾“å…¥å‚æ•°ï¼Œå¹¶æ ¹æ®ä¸åŒçš„æ¡ä»¶è·å–ç›¸åº”çš„è¾“å…¥å†…å®¹ã€‚å®ƒå¹¶æ²¡æœ‰ç›´æ¥æ¥å—ä¸åŒç§ç±»ç±»å‹çš„å…¥å‚ï¼Œè€Œæ˜¯æ ¹æ®ä¼ å…¥çš„æŸ¥è¯¢å‚æ•°æ¥è·å–è¾“å…¥å†…å®¹ã€‚
&#39;&#39;&#39;
</code></pre>
<hr>
<p>â‘  <span style = "color:red">agent&#x2F;component&#x2F;baidufanyi.py</span> ã€åç«¯ä»£ç ã€‘<br>â‘¡ <span style = "color:red">agent&#x2F;component&#x2F;_ _ init _ _.py</span>  ã€åˆå§‹åŒ–ã€‘<br>â‘¢ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsxã€è¡¨å•æŠ½å±‰ç»„ä»¶ UIå±•ç¤ºã€‘<br>â‘£ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;form&#x2F;baidu-fanyi-form&#x2F;index.tsx ã€æä¾›ç”¨æˆ·ç•Œé¢è®©ç”¨æˆ·èƒ½é…ç½®å¹¶æäº¤å‚æ•°ã€‘<br>â‘¤ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;constant.tsx ã€å®šä¹‰ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å„ç§å›¾æ ‡ã€å¸¸é‡ã€æšä¸¾ã€æ¥å£ã€çŠ¶æ€å’Œå‡½æ•°ã€‘<br>â‘¥ web&#x2F;src&#x2F;locales&#x2F;zh.ts ã€æŠŠæ‰€æœ‰è¦æ˜¾ç¤ºçš„æåˆ°zh.tsä¸­(å‰ç«¯ç»„ä»¶æè¿°)ã€‘<br>â‘¦ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;constant.tsxã€å¼•å…¥ç»„ä»¶æ‰€éœ€çš„å„ç§å›¾æ ‡ã€ä»¥åŠæ“ä½œé¡¹çš„æ ·å¼ã€åˆå§‹å€¼ã€è¯­è¨€ç­‰ã€‘<br>â‘§ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;form-sheet&#x2F;use-form-config-map.tsx ã€è¡¨å•é…ç½®æ˜ å°„ã€é…ç½®ä¸åŒæ“ä½œå¯¹åº”è¡¨å•ç»„ä»¶ã€‘<br>â‘¨ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;form&#x2F;baidu-fanyi-form&#x2F;index.tsx ã€æ„å»ºé…ç½®è¡¨å• ã€‘<br>â‘© web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;hooks.tsx ã€ç®¡ç†å›¾å½¢ç•Œé¢æµç¨‹å›¾ å„ç§é’©å­ â†’ å»ºæ•°æ®å¤„ç†æµç¨‹ã€‘</p>
<hr>
<hr>
<hr>
<hr>
<h1 id="åˆ›å»ºåŠ¨æ€ä»£ç†ç»„ä»¶-å®æˆ˜"><a href="#åˆ›å»ºåŠ¨æ€ä»£ç†ç»„ä»¶-å®æˆ˜" class="headerlink" title="åˆ›å»ºåŠ¨æ€ä»£ç†ç»„ä»¶ [å®æˆ˜]"></a><span style = "color:red">åˆ›å»ºåŠ¨æ€ä»£ç†ç»„ä»¶ [å®æˆ˜]</span></h1><h2 id="ğŸ“Œ-å®ç°æ­¥éª¤"><a href="#ğŸ“Œ-å®ç°æ­¥éª¤" class="headerlink" title="ğŸ“Œ å®ç°æ­¥éª¤"></a><strong>ğŸ“Œ å®ç°æ­¥éª¤</strong></h2><ol>
<li><strong>åç«¯ï¼ˆPython FastAPIï¼‰</strong><ul>
<li>åˆ›å»ºä¸€ä¸ª API æœåŠ¡å™¨ï¼Œæä¾›ç»„ä»¶æ³¨å†Œã€æŸ¥è¯¢ã€è¿è¡Œæ¥å£ã€‚</li>
<li>ç»„ä»¶ä¿¡æ¯å­˜å‚¨åœ¨å†…å­˜ï¼ˆå¯æ‰©å±•åˆ°æ•°æ®åº“ï¼‰ã€‚</li>
<li>ç»„ä»¶ä»£ç åŠ¨æ€æ‰§è¡Œï¼Œæ”¯æŒ <code>exec()</code> åŠ è½½ã€‚</li>
</ul>
</li>
<li><strong>å‰ç«¯ï¼ˆHTML + JavaScriptï¼‰</strong><ul>
<li>æä¾›ä¸€ä¸ªè¡¨å•ï¼Œå…è®¸ç”¨æˆ·è¾“å…¥<strong>ç»„ä»¶åç§°</strong>ã€<strong>å‚æ•°</strong>ã€<strong>Python ä»£ç </strong>ã€‚</li>
<li>æäº¤è¡¨å•åï¼Œé€šè¿‡ <code>fetch()</code> å‘é€ <code>POST</code> è¯·æ±‚ç»™åç«¯ã€‚</li>
<li>ç»„ä»¶åˆ›å»ºæˆåŠŸåï¼Œå‰ç«¯å¯ä»¥è°ƒç”¨ <code>run</code> æ¥å£æµ‹è¯•ç»„ä»¶ã€‚</li>
</ul>
</li>
<li><strong>Postman æµ‹è¯•</strong><ul>
<li>å…ˆåˆ›å»ºç»„ä»¶ <code>POST /api/components/create</code></li>
<li>å†è¿è¡Œç»„ä»¶ <code>POST /api/components/run</code></li>
</ul>
</li>
</ol>
<hr>
<h1 id="1ï¸âƒ£-åç«¯ä»£ç ï¼ˆFastAPIï¼‰"><a href="#1ï¸âƒ£-åç«¯ä»£ç ï¼ˆFastAPIï¼‰" class="headerlink" title="1ï¸âƒ£ åç«¯ä»£ç ï¼ˆFastAPIï¼‰"></a><strong>1ï¸âƒ£ åç«¯ä»£ç ï¼ˆFastAPIï¼‰</strong></h1><p>åˆ›å»º <code>server.py</code>ï¼Œè¿™ä¸ªæ–‡ä»¶ç”¨äºå¯åŠ¨ FastAPI æœåŠ¡å™¨ï¼Œå¹¶æä¾› API ç«¯ç‚¹ã€‚</p>
<blockquote>
<p><strong>å®‰è£…ä¾èµ–ï¼ˆå¦‚æœæœªå®‰è£… FastAPI å’Œ Uvicornï¼‰ï¼š</strong></p>
<pre><code class="python">pip install fastapi uvicorn pandas
</code></pre>
</blockquote>
<p>ğŸ“Œ <strong>ä»£ç ï¼ˆserver.pyï¼‰ï¼š</strong></p>
<pre><code class="python">from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
import pandas as pd

app = FastAPI()

# ç»„ä»¶å­˜å‚¨ï¼ˆæ¨¡æ‹Ÿæ•°æ®åº“ï¼‰
components = &#123;&#125;

class ComponentData(BaseModel):
    name: str
    params: dict
    code: str

@app.post(&quot;/api/components/create&quot;)
def create_component(component: ComponentData):
    &quot;&quot;&quot;
    åˆ›å»ºæ–°çš„åŠ¨æ€ç»„ä»¶ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä½¿ç”¨ exec() åŠ è½½ç»„ä»¶ä»£ç 
    &quot;&quot;&quot;
    if component.name in components:
        raise HTTPException(status_code=400, detail=&quot;ç»„ä»¶å·²å­˜åœ¨&quot;)
    
    # å®‰å…¨åœ°æ‰§è¡Œä»£ç ï¼Œå­˜å‚¨ç±»å®šä¹‰
    local_vars = &#123;&#125;
    exec(component.code, globals(), local_vars)
    
    if component.name not in local_vars:
        raise HTTPException(status_code=400, detail=&quot;ä»£ç ä¸­å¿…é¡»å®šä¹‰åŒåç±»&quot;)
    
    components[component.name] = &#123;
        &quot;params&quot;: component.params,
        &quot;class&quot;: local_vars[component.name]
    &#125;
    return &#123;&quot;message&quot;: f&quot;ç»„ä»¶ &#123;component.name&#125; åˆ›å»ºæˆåŠŸ&quot;&#125;

@app.get(&quot;/api/components&quot;)
def list_components():
    &quot;&quot;&quot;
    è·å–æ‰€æœ‰æ³¨å†Œçš„ç»„ä»¶
    &quot;&quot;&quot;
    return &#123;&quot;components&quot;: list(components.keys())&#125;

class RunRequest(BaseModel):
    component_name: str
    history: list
    params: dict

@app.post(&quot;/api/components/run&quot;)
def run_component(request: RunRequest):
    &quot;&quot;&quot;
    è¿è¡ŒæŒ‡å®šçš„ç»„ä»¶ï¼Œå¹¶è¿”å›å…¶è¾“å‡º
    &quot;&quot;&quot;
    if request.component_name not in components:
        raise HTTPException(status_code=404, detail=&quot;ç»„ä»¶ä¸å­˜åœ¨&quot;)

    component_class = components[request.component_name][&quot;class&quot;]
    component_instance = component_class()
    
    # è°ƒç”¨ _run æ–¹æ³•ï¼Œæ¨¡æ‹Ÿè¿è¡Œ
    try:
        result = component_instance._run(request.history, **request.params)
    except Exception as e:
        raise HTTPException(status_code=500, detail=f&quot;ç»„ä»¶æ‰§è¡Œé”™è¯¯: &#123;str(e)&#125;&quot;)
    
    return &#123;&quot;result&quot;: result.to_dict(orient=&quot;records&quot;)&#125;

# è¿è¡ŒæœåŠ¡å™¨ï¼ˆå¯é€‰ï¼šæ‰‹åŠ¨æ‰§è¡Œ uvicorn server:app --reloadï¼‰
if __name__ == &quot;__main__&quot;:
    import uvicorn
    uvicorn.run(app, host=&quot;0.0.0.0&quot;, port=8000)
</code></pre>
<hr>
<h1 id="2ï¸âƒ£-å‰ç«¯ä»£ç "><a href="#2ï¸âƒ£-å‰ç«¯ä»£ç " class="headerlink" title="2ï¸âƒ£ å‰ç«¯ä»£ç "></a><strong>2ï¸âƒ£ å‰ç«¯ä»£ç </strong></h1><h3 id="ğŸ“Œ-HTML-é¡µé¢"><a href="#ğŸ“Œ-HTML-é¡µé¢" class="headerlink" title="ğŸ“Œ HTML é¡µé¢"></a><strong>ğŸ“Œ HTML é¡µé¢</strong></h3><p>ğŸ“Œ <strong>ä»£ç ï¼ˆindex.htmlï¼‰ï¼š</strong></p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;åŠ¨æ€ç»„ä»¶ç®¡ç†&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;åˆ›å»ºåŠ¨æ€ç»„ä»¶&lt;/h2&gt;
    &lt;form id=&quot;componentForm&quot;&gt;
        &lt;label&gt;ç»„ä»¶åç§°ï¼š&lt;/label&gt;
        &lt;input type=&quot;text&quot; id=&quot;componentName&quot; required&gt;&lt;br&gt;&lt;br&gt;

        &lt;label&gt;å‚æ•° (JSON æ ¼å¼)ï¼š&lt;/label&gt;
        &lt;textarea id=&quot;componentParams&quot; required&gt;&#123;&quot;param1&quot;: &quot;value1&quot;&#125;&lt;/textarea&gt;&lt;br&gt;&lt;br&gt;

        &lt;label&gt;Python ä»£ç ï¼š&lt;/label&gt;
        &lt;textarea id=&quot;componentCode&quot; required&gt;
class TestComponent:
    def _run(self, history, **kwargs):
        return pd.DataFrame([&#123;&#39;content&#39;: &#39;Hello, this is a test!&#39;&#125;])
        &lt;/textarea&gt;&lt;br&gt;&lt;br&gt;

        &lt;button type=&quot;button&quot; onclick=&quot;submitNewComponent()&quot;&gt;æäº¤ç»„ä»¶&lt;/button&gt;
    &lt;/form&gt;

    &lt;h2&gt;è¿è¡Œç»„ä»¶&lt;/h2&gt;
    &lt;label&gt;ç»„ä»¶åç§°ï¼š&lt;/label&gt;
    &lt;input type=&quot;text&quot; id=&quot;runComponentName&quot; required&gt;&lt;br&gt;&lt;br&gt;
    &lt;button type=&quot;button&quot; onclick=&quot;runComponent()&quot;&gt;è¿è¡Œç»„ä»¶&lt;/button&gt;

    &lt;h3&gt;è¿è¡Œç»“æœï¼š&lt;/h3&gt;
    &lt;pre id=&quot;result&quot;&gt;&lt;/pre&gt;

    &lt;script src=&quot;test.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<hr>
<h3 id="ğŸ“Œ-JavaScript-ä»£ç "><a href="#ğŸ“Œ-JavaScript-ä»£ç " class="headerlink" title="ğŸ“Œ JavaScript ä»£ç "></a><strong>ğŸ“Œ JavaScript ä»£ç </strong></h3><p>ğŸ“Œ <strong>ä»£ç ï¼ˆtest.jsï¼‰ï¼š</strong></p>
<pre><code class="js">const apiBaseUrl = &quot;http://localhost:8000/api&quot;;  // æ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨åœ°å€

function submitNewComponent() &#123;
    const name = document.getElementById(&quot;componentName&quot;).value;
    const params = document.getElementById(&quot;componentParams&quot;).value;
    const code = document.getElementById(&quot;componentCode&quot;).value;

    fetch(`$&#123;apiBaseUrl&#125;/components/create`, &#123;
        method: &quot;POST&quot;,
        headers: &#123; &quot;Content-Type&quot;: &quot;application/json&quot; &#125;,
        body: JSON.stringify(&#123;
            name: name,
            params: JSON.parse(params),
            code: code
        &#125;)
    &#125;)
    .then(response =&gt; response.json())
    .then(data =&gt; alert(data.message || JSON.stringify(data)))
    .catch(error =&gt; console.error(&quot;Error:&quot;, error));
&#125;

function runComponent() &#123;
    const componentName = document.getElementById(&quot;runComponentName&quot;).value;

    fetch(`$&#123;apiBaseUrl&#125;/components/run`, &#123;
        method: &quot;POST&quot;,
        headers: &#123; &quot;Content-Type&quot;: &quot;application/json&quot; &#125;,
        body: JSON.stringify(&#123;
            component_name: componentName,
            history: [],
            params: &#123;&#125;
        &#125;)
    &#125;)
    .then(response =&gt; response.json())
    .then(data =&gt; &#123;
        document.getElementById(&quot;result&quot;).innerText = JSON.stringify(data, null, 2);
    &#125;)
    .catch(error =&gt; console.error(&quot;Error:&quot;, error));
&#125;
</code></pre>
<hr>
<h1 id="3ï¸âƒ£-ä½¿ç”¨-Postman-æµ‹è¯•"><a href="#3ï¸âƒ£-ä½¿ç”¨-Postman-æµ‹è¯•" class="headerlink" title="3ï¸âƒ£ ä½¿ç”¨ Postman æµ‹è¯•"></a><strong>3ï¸âƒ£ ä½¿ç”¨ Postman æµ‹è¯•</strong></h1><p>å¯åŠ¨æœåŠ¡å™¨åï¼Œå¯ä»¥ä½¿ç”¨ Postman æµ‹è¯• APIã€‚</p>
<h3 id="ï¼ˆ1ï¼‰åˆ›å»ºåŠ¨æ€ç»„ä»¶"><a href="#ï¼ˆ1ï¼‰åˆ›å»ºåŠ¨æ€ç»„ä»¶" class="headerlink" title="ï¼ˆ1ï¼‰åˆ›å»ºåŠ¨æ€ç»„ä»¶"></a><strong>ï¼ˆ1ï¼‰åˆ›å»ºåŠ¨æ€ç»„ä»¶</strong></h3><ul>
<li><p><strong>æ–¹æ³•</strong>ï¼š<code>POST</code></p>
</li>
<li><p><strong>URL</strong>ï¼š<code>http://localhost:8000/api/components/create</code></p>
</li>
<li><p>Bodyï¼ˆJSONï¼‰</p>
<pre><code class="python">&#123;
  &quot;name&quot;: &quot;TestComponent&quot;,
  &quot;params&quot;: &#123;
    &quot;param1&quot;: &quot;value1&quot;
  &#125;,
  &quot;code&quot;: &quot;class TestComponent:\n    def _run(self, history, **kwargs):\n        return pd.DataFrame([&#123;&#39;content&#39;: &#39;Hello, world!&#39;&#125;])&quot;
&#125;
</code></pre>
</li>
<li><p>æœŸæœ›ç»“æœ</p>
<pre><code class="python">&#123;
  &quot;message&quot;: &quot;ç»„ä»¶ TestComponent åˆ›å»ºæˆåŠŸ&quot;
&#125;
</code></pre>
</li>
</ul>
<h3 id="ï¼ˆ2ï¼‰è¿è¡Œç»„ä»¶"><a href="#ï¼ˆ2ï¼‰è¿è¡Œç»„ä»¶" class="headerlink" title="ï¼ˆ2ï¼‰è¿è¡Œç»„ä»¶"></a><strong>ï¼ˆ2ï¼‰è¿è¡Œç»„ä»¶</strong></h3><ul>
<li><p><strong>æ–¹æ³•</strong>ï¼š<code>POST</code></p>
</li>
<li><p><strong>URL</strong>ï¼š<code>http://localhost:8000/api/components/run</code></p>
</li>
<li><p>Bodyï¼ˆJSONï¼‰</p>
<p>ï¼š</p>
<pre><code class="python">&#123;
  &quot;component_name&quot;: &quot;TestComponent&quot;,
  &quot;history&quot;: [],
  &quot;params&quot;: &#123;&#125;
&#125;
</code></pre>
</li>
<li><p>æœŸæœ›ç»“æœ</p>
<p>ï¼š</p>
<pre><code class="python">&#123;
  &quot;result&quot;: [&#123;&quot;content&quot;: &quot;Hello, world!&quot;&#125;]
&#125;
</code></pre>
</li>
</ul>
<hr>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><ul>
<li><strong>åç«¯</strong>ï¼šFastAPI å®ç°äº†ç»„ä»¶åˆ›å»ºã€æŸ¥è¯¢ã€è¿è¡Œçš„ APIã€‚</li>
<li><strong>å‰ç«¯</strong>ï¼šHTML + JS æä¾›äº¤äº’ç•Œé¢ï¼Œç”¨æˆ·å¯è¾“å…¥å‚æ•°å’Œä»£ç ã€‚</li>
<li><strong>æµ‹è¯•</strong>ï¼šå¯ç”¨ Postman è°ƒè¯•ï¼Œç¡®ä¿ç»„ä»¶èƒ½è¢«åŠ¨æ€åˆ›å»ºå’Œè¿è¡Œã€‚</li>
</ul>
<p>ğŸš€ <strong>ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨ Postman æˆ–å‰ç«¯ç•Œé¢ä¸­æµ‹è¯•ä½ çš„åŠ¨æ€ç»„ä»¶åŠŸèƒ½äº†ï¼</strong></p>
<hr>
<p><span style = "color:red"><strong>çº¯åç«¯æƒ…å†µå¦‚ä½•æ·»åŠ è‡ªå®šä¹‰ç»„ä»¶å‘¢</strong></span></p>
<p>è¿™é‡Œä»¥æˆ‘ç¢ç£¨çš„<strong>JSONPath</strong>è‡ªå®šä¹‰ç»„ä»¶ä¸ºä¾‹</p>
<p>é¦–å…ˆè¦æ¸…æ¥šRAGFlowçš„æ‰§è¡Œæµç¨‹ è¦äº†è§£ç”»å¸ƒçš„æµç¨‹ æ¨èå…ˆçœ‹ä¸€éRAGFlowæ‰§è¡Œæµç¨‹çš„æ–‡æ¡£ ç„¶åäº†è§£ä¸€ä¸‹canvas.pyå’Œcanvas_app.pyçš„æºç  æŒæ¡æ•´ä½“æµç¨‹ã€‚</p>
<p>è¿™é‡Œæœ€é‡è¦çš„ä¸€ä¸ªæ€æƒ³è¦æ˜ç™½ ç°åœ¨ä½ åªæœ‰åç«¯ ä½ æ²¡æœ‰å‰ç«¯ ä½ åœ¨RAGFlowå›¾å½¢åŒ–ç•Œé¢æ‹–æ‹½è¿›å»çš„å½¢å¼å·²ç»æ— æ³•é’ˆå¯¹äºçº¯åç«¯æ·»åŠ è‡ªå®šä¹‰ç»„ä»¶äº† é‚£æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹æ€è·¯ æˆ‘ä»¬æƒ³è¦ä»€ä¹ˆï¼Ÿæˆ‘ä»¬æƒ³è¦å›¾å½¢åŒ–ç•Œé¢æ‹–æ‹½è¿‡åçš„æ•´ä½“æ•°æ® ä¹Ÿå°±æ˜¯æ•°æ®åº“é‡Œçš„dslï¼Œæˆ‘ä»¬è¦æ‹¿åˆ°å®ƒ ç„¶åç”¨æˆ‘ä»¬è‡ªå·±å¼€å‘çš„è‡ªå®šä¹‰ç»„ä»¶å»è§£æè¿™ä¸ªå¤§å¤§çš„JSONã€‚é‚£ä¹ˆè¿™é‡Œå°±æ¶‰åŠåˆ°æ²¡æœ‰å‰ç«¯ ä½ å¦‚ä½•å»åç«¯å»æ·»åŠ è‡ªå·±åšçš„è‡ªå®šä¹‰ç»„ä»¶ï¼å½“ç„¶å¸¸è§„æ–¹æ³• å»å›¾å½¢åŒ–ç•Œé¢æ‹–æ‹½å·²ç»æ— æ³•å®Œæˆè¿™ç§æ“ä½œ ä½ åªèƒ½æŠŠå¸Œæœ›å¯„æ‰˜åœ¨æ•°æ®åº“ </p>
<p>æˆ‘ä»¬æ¥æ‰“å¼€æ•°æ®åº“ æ­¤æ—¶ä½ éœ€è¦ä¸€ä¸ªç»„ä»¶çš„æ•°æ®è¡¨ component</p>
<p>â€“ rag_flow.component definition</p>
<p>CREATE TABLE <code>component</code> (</p>
<p>  <code>id</code> varchar(32) NOT NULL,</p>
<p>  <code>create_time</code> bigint DEFAULT NULL,</p>
<p>  <code>create_date</code> datetime DEFAULT NULL,</p>
<p>  <code>update_time</code> bigint DEFAULT NULL,</p>
<p>  <code>update_date</code> datetime DEFAULT NULL,</p>
<p>  <code>tenant_id</code> varchar(32) NOT NULL,</p>
<p>  <code>module</code> varchar(255) NOT NULL,</p>
<p>  <code>created_by</code> varchar(32) NOT NULL,</p>
<p>  <code>is_deleted</code> tinyint DEFAULT â€˜0â€™,</p>
<p>  PRIMARY KEY (<code>id</code>)</p>
<p>) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8mb4 COLLATE&#x3D;utf8mb4_0900_ai_ci;</p>
<p>è¿™æ˜¯åˆ›å»ºè¡¨çš„ä¿¡æ¯ ç›®å‰æˆ‘ä»¬åªéœ€è¦å…³æ³¨moduleé‡Œé¢çš„ æˆ‘ä»¬è¦æŠŠæˆ‘ä»¬è‡ªå·±å¼€å‘çš„ç»„ä»¶æŒ‰ç…§é‚£äº›å½¢å¼æ·»åŠ è¿›å» æˆ‘çš„ç»„ä»¶å«:â€jsonpathâ€ é‚£ä¹ˆæˆ‘çš„moduleé‡Œé¢å°±åº”è¯¥æ˜¯agent.component.jsonpath å½“ç„¶ä½ è¦æŒ‰ç…§å®ƒçš„é£æ ¼æŠŠç»„ä»¶æ”¾åœ¨è¿™ä¸ªåŒ…é‡Œé¢ã€‚</p>
<p>å…¶æ¬¡è¿˜è¦æ³¨æ„åœ¨è¿™ä¸ªåŒ…é‡Œé¢çš„__init__.py </p>
<p>æŠŠä½ çš„ç»„ä»¶åŠ è¿›å» â€œjsonpathâ€:â€JSONPathâ€</p>
<p>æ­¤æ—¶å¹¶éä¸‡äº‹å¤§å‰ å› ä¸ºæˆ‘ä»¬ç›®å‰åªæœ‰çº¯åç«¯ æ²¡æœ‰å‰ç«¯é‚£äº› æ‰€ä»¥å›åˆ°å¼€å¤´æ‰€è¯´ ä½ è¦è‡ªå·±æŠŠä½ çš„ç»„ä»¶ä»¥jsonçš„æ ¼å¼æ‰‹åŠ¨åŠ å…¥åˆ°æ•°æ®åº“çš„dslä¸­ å› ä¸ºå¾ˆé•¿æ‰€ä»¥ä½ éœ€è¦<a target="_blank" rel="noopener" href="https://www.json.cn/">JSONåœ¨çº¿è§£ææ ¼å¼åŒ–éªŒè¯ - JSON.cn</a>å»è®©å®ƒå±•ç¤ºçš„æ›´ç›´è§‚</p>
<p>è¿™æ˜¯æˆ‘ç»„ä»¶éœ€è¦çš„json ä½ è¦æ‰‹åŠ¨çš„å»æ·»åŠ åˆ°dsl æ­¥éª¤å°±æ˜¯å…ˆå¤åˆ¶æ•°æ®åº“çš„dsl ç„¶åæ”¾åœ¨è§£æå™¨é‡Œé¢ <strong>æ‰‹åŠ¨çš„å»æ·»åŠ è‡ªå·±çš„ç»„ä»¶</strong></p>
<p>â€œJSONPath:PathProcessorâ€: {â€œobjâ€: {â€œcomponent_nameâ€: â€œJSONPathâ€,â€paramsâ€: {â€œoutput_var_nameâ€: â€œoutputâ€,â€jsonpath_exprâ€: â€œ$.components[*].obj.component_nameâ€,â€debug_modeâ€: true,â€queryâ€: [],â€inputsâ€: [],â€debug_inputsâ€: [],â€outputâ€: {â€œcontentâ€: {â€œ0â€: â€œâ€}}}},â€downstreamâ€: [â€œGenerate:TwelveClocksSpeakâ€],â€upstreamâ€: []}</p>
<p>è¿™åªæ˜¯æˆ‘çš„ç»„ä»¶json ä½ éœ€è¦åœ¨å®Œæ•´çš„dslæŠŠå®ƒæ’å…¥è¿›å» æŒ‰ç…§å®ƒä»¬å½¢æˆçš„æ ¼å¼ è¿™é‡Œè¯´æ˜ä¸€ä¸‹ dslå°±æ˜¯ä½ åœ¨å›¾å½¢åŒ–ç•Œé¢åˆ›å»ºagentçš„æ—¶å€™é‡Œé¢å„å„ç»„ä»¶çš„ç›¸å…³ä¿¡æ¯ å½“ç„¶ä½ è¿˜è¦æ³¨æ„è‡ªå·±å†™çš„ç»„ä»¶ç±»å‹ æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ ä½ æ‰èƒ½å»åšåˆ°å¯¹åº”ç›¸åº”çš„å¤„ç† æ¯”å¦‚è¯´æˆ‘è¿™ä¸ªæ˜¯è§£æjsonçš„ é‚£æˆ‘å°±ä¸èƒ½å»æ‹¿ä¸Šä¸‹æ–‡ç»„ä»¶çš„è¾“å…¥æˆ–è¾“å‡º æ­£å¸¸çš„æµç¨‹æ˜¯è¿çº¿åä½ è¦æ‹¿åˆ°ä¸Šæ¸¸çš„è¾“å‡ºç»“æœ ä½œä¸ºä½ ç»„ä»¶çš„è¾“å…¥ç»“æœã€‚æˆ‘è¿™ä¸ªåˆ™æ˜¯æ‹¿åˆ°å…¨å±€ç”»å¸ƒcanvas_dataæ•°æ®å†å»è¿›è¡Œè§£æ</p>
<p>æ‰€ä»¥è¦æ˜ç™½éœ€æ±‚æ‰èƒ½å»æ›´å¥½çš„èå…¥ä»£ç ä¸­ ç»è¿‡è¿™å‡ å¤©çš„å­¦ä¹ çœŸçš„æ„Ÿè§‰ åªæœ‰è‡ªå·±ä¸€ç‚¹ç‚¹çš„æ‘¸ç´¢è¿‡åæ‰èƒ½çœŸæ­£çš„å°è±¡æ·±åˆ» æ‰èƒ½æ…¢æ…¢å˜å¾—å¼ºå¤§ï¼</p>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#1bccbc>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/03/19/AI/RAGFlowä»£ç†ç»„ä»¶æŠ€æœ¯/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/03/07/AI/RAGFlowå·¥å…·æŠ€æœ¯æ–‡æ¡£/">
        <h2>
            RAGFlowå·¥å…·æŠ€æœ¯æ–‡æ¡£
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/3/7
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h4 id="RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ"><a href="#RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ" class="headerlink" title="RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ"></a>RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ</h4><ul>
<li><strong>é›†æˆå¤–éƒ¨æ•°æ®æº</strong>ï¼šé€šè¿‡æ£€ç´¢æ¨¡å—æ¥ç»§æ‰¿å¤–éƒ¨çŸ¥è¯†åº“ã€æ•°æ®åº“ã€æ–‡æ¡£ç­‰å†…å®¹ï¼Œå¢å¼ºæ¨¡å‹çš„å›ç­”èƒ½åŠ›</li>
<li><strong>ç”Ÿæˆå¼ä»»åŠ¡å¤„ç†</strong>ï¼šåˆ©ç”¨æ¨¡å‹ç”Ÿæˆçš„èƒ½åŠ›ï¼ŒåŸºäºç”¨æˆ·çš„æŸ¥è¯¢è¿”å›è‡ªç„¶è¯­è¨€çš„å›ç­”</li>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šRAGFlowæ”¯æŒçµæ´»çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥é€šè¿‡é…ç½®å’Œé›†æˆä¸åŒçš„ç»„ä»¶æ¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚</li>
</ul>
<h4 id="RAGFlowä»£ç†ç»„ä»¶"><a href="#RAGFlowä»£ç†ç»„ä»¶" class="headerlink" title="RAGFlowä»£ç†ç»„ä»¶"></a>RAGFlowä»£ç†ç»„ä»¶</h4><p>RAGFlow çš„ä»£ç†ç»„ä»¶æ˜¯å…¶æ¶æ„ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œè´Ÿè´£ç®¡ç†ä¸<strong>å¤–éƒ¨æ•°æ®æº</strong>å’Œ<strong>ç”Ÿæˆæ¨¡å‹</strong>çš„äº¤äº’ã€‚ä»£ç†ç»„ä»¶ä¸ä»…å¯ä»¥ä»ä¸åŒçš„å¤–éƒ¨æ•°æ®æºä¸­è·å–çŸ¥è¯†ï¼Œè¿˜èƒ½å°†æ£€ç´¢åˆ°çš„ä¿¡æ¯ä¸ç”Ÿæˆæ¨¡å‹ç»“åˆï¼Œä»è€Œç”Ÿæˆæ›´åŠ å‡†ç¡®çš„å›ç­”ã€‚</p>
<h4 id="ä»£ç†ç»„ä»¶çš„åŠŸèƒ½"><a href="#ä»£ç†ç»„ä»¶çš„åŠŸèƒ½" class="headerlink" title="ä»£ç†ç»„ä»¶çš„åŠŸèƒ½"></a>ä»£ç†ç»„ä»¶çš„åŠŸèƒ½</h4><ul>
<li><strong>æ•°æ®æ£€ç´¢</strong>ï¼šä»£ç†ç»„ä»¶ä¼šä»å¤šä¸ªå¤–éƒ¨æ•°æ®æºï¼ˆå¦‚æ•°æ®åº“ã€æ–‡æ¡£ã€APIç­‰ï¼‰è¿›è¡Œæ•°æ®æ£€ç´¢ï¼Œè·å–ä¸ç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„ä¿¡æ¯ã€‚</li>
<li><strong>ç”Ÿæˆæ¨¡å‹çš„è°ƒç”¨</strong>ï¼šå°†æ£€ç´¢åˆ°çš„ä¿¡æ¯ä¸ç”Ÿæˆæ¨¡å‹ç»“åˆï¼Œé€šè¿‡ç”Ÿæˆæ¨¡å‹æä¾›ä¸€ä¸ªæµç•…ä¸”å‡†ç¡®çš„ç­”æ¡ˆã€‚</li>
<li><strong>å¤šæºæ•°æ®èåˆ</strong>ï¼šåœ¨ç”Ÿæˆå›ç­”æ—¶ï¼Œä»£ç†ç»„ä»¶èƒ½å¤Ÿå¤„ç†å¤šæ¥æºçš„æ•°æ®ï¼Œå¹¶å°†å…¶èåˆæˆæœ€ç»ˆçš„ç­”æ¡ˆã€‚</li>
</ul>
<h3 id="ç»„ä»¶-â†’-web-x2F-src-x2F-utils-å¾…å®š"><a href="#ç»„ä»¶-â†’-web-x2F-src-x2F-utils-å¾…å®š" class="headerlink" title="ç»„ä»¶ â†’ web&#x2F;src&#x2F;utils  *å¾…å®š"></a>ç»„ä»¶ â†’ <u>web&#x2F;src&#x2F;utils</u>  *å¾…å®š</h3><p><strong>ç»„ä»¶å‰ç«¯äº¤äº’ä¸­å¿ƒ</strong>ï¼š<code>web/src/utils/api.ts</code><br>å®ƒå®šä¹‰äº†ä¸€äº›ä¸â€œç”»å¸ƒâ€ç›¸å…³çš„ API æ¥å£åœ°å€ï¼Œç”¨äºä¸åç«¯è¿›è¡Œé€šä¿¡ã€‚é€šè¿‡è¿™äº›æ¥å£ï¼Œå‰ç«¯åº”ç”¨å¯ä»¥è¿›è¡Œä¸åŒæ“ä½œï¼Œå¦‚è·å–æ¨¡æ¿ã€æ“ä½œç”»å¸ƒã€è°ƒè¯•ç­‰</p>
<blockquote>
<p><strong>listTemplates</strong>: ç”¨äºè·å–æ‰€æœ‰ç”»å¸ƒæ¨¡æ¿çš„åˆ—è¡¨ï¼Œå‘é€è¯·æ±‚åˆ° <code>/canvas/templates</code>ã€‚<br><strong>listCanvas</strong>: è·å–ç”»å¸ƒåˆ—è¡¨çš„æ¥å£ï¼Œå‘é€è¯·æ±‚åˆ° <code>/canvas/list</code></p>
</blockquote>
<h4 id="Beginç»„ä»¶"><a href="#Beginç»„ä»¶" class="headerlink" title="Beginç»„ä»¶"></a>Beginç»„ä»¶</h4><p><strong>Begin</strong> ç»„ä»¶è®¾ç½®å¼€åœºé—®å€™è¯­æˆ–æ¥å—ç”¨æˆ·çš„è¾“å…¥ã€‚å½“æ‚¨åˆ›å»ºä»£ç†æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å¡«å……åˆ°ç”»å¸ƒä¸Šï¼Œæ— è®ºæ˜¯ä»æ¨¡æ¿è¿˜æ˜¯ä»å¤´å¼€å§‹ï¼ˆä»ç©ºç™½æ¨¡æ¿ï¼‰ã€‚å·¥ä½œæµç¨‹ä¸­åº”è¯¥åªæœ‰ä¸€ä¸ª <strong>Begin</strong> ç»„ä»¶ã€‚</p>
<blockquote>
<p><code>api/ragflow/web/src/locales/zh.ts</code><br>â€¦â€¦<br><strong>setAnOpenerInitial</strong>: <code>ä½ å¥½ï¼ æˆ‘æ˜¯ä½ çš„åŠ©ç†ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°ä½ çš„å—ï¼Ÿ</code>,</p>
</blockquote>
<p><strong>é™æ€æ¶ˆæ¯</strong>: <code>/v1/canvas/set</code><br><strong>ç”Ÿæˆé—®ç­”ã€é—®é¢˜ä¼˜åŒ–ã€é—®é¢˜ç±»å‹ã€å…³é”®è¯</strong>ï¼š<code>/v1/llm/list</code><br><strong>çŸ¥è¯†æ£€ç´¢</strong>ï¼š<code>/v1/llm/list</code> + <code>/v1/kb/list</code></p>
<p>ä»¥**é—®é¢˜ä¼˜åŒ– **(RewriteQuestion:MoodyCrabsPeel) ä¸ºä¾‹ï¼š</p>
<hr>
<h6 id="åç«¯å†…å®¹"><a href="#åç«¯å†…å®¹" class="headerlink" title="åç«¯å†…å®¹"></a>åç«¯å†…å®¹</h6><p><strong>çŸ¥è¯†æ£€ç´¢</strong>ï¼š<code>Retrieval</code>        è·¯å¾„â†’<code>agent/component/retrieval.py</code></p>
<pre><code class="python"># è®°å½•æ—¥å¿—
import logging
# æŠ½è±¡åŸºç±»æ¨¡å—
from abc import ABC
# ç”¨äºæ•°æ®å¤„ç†ï¼Œå°¤å…¶æ˜¯å¤„ç†æ•°æ®æ¡†ï¼ˆDataFrameï¼‰
import pandas as pd
# ä»æ•°æ®åº“ç›¸å…³æ¨¡å—å¯¼å…¥ LLMTypeï¼Œè¿™ä¸ªå¯èƒ½æ˜¯ç”¨æ¥å®šä¹‰ LLMï¼ˆè¯­è¨€æ¨¡å‹ï¼‰ç±»å‹çš„æšä¸¾
from api.db import LLMType
# ä»æ•°æ®åº“æœåŠ¡æ¨¡å—ä¸­å¯¼å…¥ï¼Œåˆ†åˆ«ç”¨äºçŸ¥è¯†åº“æœåŠ¡å’Œ LLM é…ç½®çš„å°è£…
from api.db.services.knowledgebase_service import KnowledgebaseService
from api.db.services.llm_service import LLMBundle
# åŠ è½½åº”ç”¨ç¨‹åºçš„è®¾ç½®
from api import settings
# åŸºç¡€ç»„ä»¶ç±»ï¼Œç”¨äºæ„å»ºæ­¤ç»„ä»¶çš„çˆ¶ç±»
from agent.component.base import ComponentBase, ComponentParamBase
# ä»æ ‡ç­¾æ¨¡å—ä¸­å¯¼å…¥ï¼Œç”¨äºå¯¹æŸ¥è¯¢è¿›è¡Œæ ‡è®°
from rag.app.tag import label_question


class RetrievalParam(ComponentParamBase):

    &quot;&quot;&quot;
    Define the Retrieval component parameters.
    &quot;&quot;&quot;
    def __init__(self):
        super().__init__()
        # ç›¸ä¼¼åº¦é˜ˆå€¼
        self.similarity_threshold = 0.2
        # å…³é”®å­—ç›¸ä¼¼åº¦çš„æƒé‡
        self.keywords_similarity_weight = 0.5
        # æ£€ç´¢æ—¶è¿”å›çš„ç»“æœæ•°
        self.top_n = 8
        # åœ¨æ£€ç´¢æ—¶è€ƒè™‘çš„æœ€å¤§æ•°é‡
        self.top_k = 1024
        # çŸ¥è¯†åº“çš„ ID åˆ—è¡¨
        self.kb_ids = []
        # é‡æ–°æ’åºæ¨¡å‹çš„ ID (å¯èƒ½ä¸ºç©º)
        self.rerank_id = &quot;&quot;
        # å½“æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç»“æœæ—¶çš„å“åº”æ–‡æœ¬
        self.empty_response = &quot;&quot;
#### check_decimal_float???
   # check()ï¼šå¯¹å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿ç›¸ä¼¼åº¦é˜ˆå€¼å’Œæƒé‡ä¸ºæœ‰æ•ˆçš„å°æ•°ï¼Œä¸” top_n æ˜¯æ­£æ•°ã€‚
    def check(self):
        # &quot;ç›¸ä¼¼æ€§é˜ˆå€¼&quot;
        self.check_decimal_float(self.similarity_threshold, &quot;[Retrieval] Similarity threshold&quot;)
        # &quot;å…³é”®è¯ç›¸ä¼¼åº¦æƒé‡&quot;
        self.check_decimal_float(self.keywords_similarity_weight, &quot;[Retrieval] Keyword similarity weight&quot;)
        self.check_positive_number(self.top_n, &quot;[Retrieval] Top N&quot;)

# Retrieval ç±»ç»§æ‰¿è‡ª ComponentBase å’Œ ABCï¼ˆæŠ½è±¡åŸºç±»ï¼‰
# è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶å®ç°äº†æŠ½è±¡æ–¹æ³•
class Retrieval(ComponentBase, ABC):
    component_name = &quot;Retrieval&quot;

##### history, **kwargs???
    # _runä¸ºæ ¸å¿ƒæ–¹æ³• 
# queryè¾“å…¥æŸ¥è¯¢å†…å®¹ åŒ…æ‹¬&#39;content&#39;é”® æå–ç¬¬ä¸€ä¸ªå†…å®¹é¡¹ å°†æŸ¥è¯¢å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²
    def _run(self, history, **kwargs):
        query = self.get_input()
        query = str(query[&quot;content&quot;][0]) if &quot;content&quot; in query else &quot;&quot;
    # ä»çŸ¥è¯†åº“æœåŠ¡ä¸­è·å–æŒ‡å®š ID çš„çŸ¥è¯†åº“ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„çŸ¥è¯†åº“ï¼Œè¿”å›ç©ºçš„å“åº”ã€‚
        kbs = KnowledgebaseService.get_by_ids(self._param.kb_ids)
        if not kbs:
            return Retrieval.be_output(&quot;&quot;)
# è·å–æ‰€æœ‰çŸ¥è¯†åº“çš„åµŒå…¥æ¨¡å‹ IDï¼ˆembd_idï¼‰ï¼Œç¡®ä¿æ‰€æœ‰çŸ¥è¯†åº“ä½¿ç”¨ç›¸åŒçš„åµŒå…¥æ¨¡å‹ã€‚
# å¦‚æœä½¿ç”¨çš„åµŒå…¥æ¨¡å‹ä¸ä¸€è‡´ï¼ŒæŠ›å‡ºå¼‚å¸¸
        embd_nms = list(set([kb.embd_id for kb in kbs]))
        assert len(embd_nms) == 1, &quot;Knowledge bases use different embedding models.&quot;

##### LLMBundle???
# åˆ›å»º LLMBundle å®ä¾‹æ¥å°è£…åµŒå…¥æ¨¡å‹ï¼Œä½¿ç”¨ç”»å¸ƒçš„ç§Ÿæˆ· ID å’ŒåµŒå…¥æ¨¡å‹çš„ ID é…ç½®åµŒå…¥æ¨¡å‹ï¼Œå¹¶è®¾ç½®åˆ°ç”»å¸ƒ
        embd_mdl = LLMBundle(self._canvas.get_tenant_id(), LLMType.EMBEDDING, embd_nms[0])
        self._canvas.set_embedding_model(embd_nms[0])

   # è‹¥æä¾›äº† rerank_idï¼Œåˆ™åŠ è½½é‡æ–°æ’åºçš„æ¨¡å‹
        rerank_mdl = None
        if self._param.rerank_id:
            rerank_mdl = LLMBundle(kbs[0].tenant_id, LLMType.RERANK, self._param.rerank_id)

  # ä½¿ç”¨ settings.retrievaler.retrieval æ–¹æ³•æ‰§è¡ŒçŸ¥è¯†æ£€ç´¢æ“ä½œï¼Œä¼ å…¥æŸ¥è¯¢å’Œå„ç§é…ç½®å‚æ•°
# query:ç”¨æˆ·æŸ¥è¯¢   embd_mdl:åµŒå…¥æ¨¡å‹    å…¶ä»–å‚æ•°åŒ…æ‹¬çŸ¥è¯†åº“ IDã€ç›¸ä¼¼åº¦é˜ˆå€¼ã€å…³é”®è¯ç›¸ä¼¼åº¦æƒé‡ç­‰
        kbinfos = settings.retrievaler.retrieval(query, embd_mdl, kbs[0].tenant_id, self._param.kb_ids,
                                        1, self._param.top_n,
                                        self._param.similarity_threshold, 1 - self._param.keywords_similarity_weight,
                                        aggs=False, rerank_mdl=rerank_mdl,
                                        rank_feature=label_question(query, kbs))
# å¦‚æœæ£€ç´¢ç»“æœä¸ºç©ºï¼ˆæ²¡æœ‰æ‰¾åˆ°ç›¸å…³å†…å®¹ï¼‰ï¼Œåˆ™è¿”å›ç©ºå“åº”
# å¦‚æœè®¾ç½®äº† empty_responseï¼Œåˆ™åœ¨å“åº”ä¸­è¿”å›è¯¥å†…å®¹ã€‚
        if not kbinfos[&quot;chunks&quot;]:
            df = Retrieval.be_output(&quot;&quot;)
            if self._param.empty_response and self._param.empty_response.strip():
                df[&quot;empty_response&quot;] = self._param.empty_response
            return df
&#39;&#39;&#39;
å¦‚æœæœ‰æ£€ç´¢ç»“æœï¼Œå°†ç»“æœè½¬æ¢ä¸º Pandas çš„ DataFrame æ ¼å¼ã€‚
å°† content_with_weight é‡å‘½åä¸º contentï¼Œç„¶ååˆ é™¤ content_with_weight åˆ—ã€‚
è¾“å‡ºè°ƒè¯•æ—¥å¿—ï¼Œè®°å½•æŸ¥è¯¢å’Œæ£€ç´¢ç»“æœã€‚
&#39;&#39;&#39;
        df = pd.DataFrame(kbinfos[&quot;chunks&quot;])
        df[&quot;content&quot;] = df[&quot;content_with_weight&quot;]
        del df[&quot;content_with_weight&quot;]
        logging.debug(&quot;&#123;&#125; &#123;&#125;&quot;.format(query, df))
        return df
</code></pre>
<blockquote>
<p>å¦‚æœä½ éœ€è¦ä¸€ä¸ª <strong>å®šåˆ¶çš„ä»£ç†ç»„ä»¶</strong>ï¼Œæˆ‘å¯ä»¥åŸºäºè¿™ä¸ª <code>Retrieval</code> ç»„ä»¶çš„æ¶æ„ï¼Œä¸ºä½ è®¾è®¡ä¸€ä¸ªç±»ä¼¼çš„ç»„ä»¶ï¼Œæ»¡è¶³ä½ çš„ç‰¹å®šéœ€æ±‚ã€‚</p>
<p>ä½ å¯ä»¥å‘Šè¯‰æˆ‘ï¼š</p>
<ol>
<li><strong>ä»£ç†ç»„ä»¶çš„å…·ä½“ç”¨é€”</strong>ï¼ˆæ¯”å¦‚ï¼šè¯·æ±‚è½¬å‘ã€æ™ºèƒ½è·¯ç”±ã€æµé‡æ§åˆ¶ã€è´Ÿè½½å‡è¡¡ã€èº«ä»½éªŒè¯ç­‰ï¼‰ã€‚</li>
<li><strong>éœ€è¦æ”¯æŒçš„å‚æ•°</strong>ï¼ˆæ¯”å¦‚ï¼šä»£ç†åœ°å€ã€è¶…æ—¶æ—¶é—´ã€è®¤è¯æ–¹å¼ç­‰ï¼‰ã€‚</li>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼ˆæ¯”å¦‚ï¼šæ—¥å¿—è®°å½•ã€è¯·æ±‚ç¼“å­˜ã€æ•…éšœæ¢å¤ç­‰ï¼‰ã€‚</li>
<li><strong>é›†æˆçš„å…¶ä»–æœåŠ¡</strong>ï¼ˆæ¯”å¦‚ï¼šRedisã€RabbitMQã€æ•°æ®åº“ç­‰ï¼‰ã€‚</li>
</ol>
<p>å¦‚æœä½ å¸Œæœ›å®ƒéµå¾ª <code>ComponentBase</code> ç»„ä»¶æ¡†æ¶ï¼Œæˆ‘å¯ä»¥æŒ‰ç…§è¯¥æ¨¡å¼æ¥å®ç°ï¼Œè®©å®ƒå¯ä»¥ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼å¯¹æ¥ï¼</p>
</blockquote>
<h6 id="ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„"><a href="#ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„" class="headerlink" title="ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„"></a>ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•<del>ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„</del></h6><p><code>retrieval.py</code> â†’ <code>base.py</code></p>
<pre><code class="python">**kwargs å…è®¸è°ƒç”¨ _run() æ–¹æ³•æ—¶ ä¼ å…¥ä»»æ„æ•°é‡çš„é¢å¤–å‚æ•°ï¼Œå³ä½¿è¿™äº›å‚æ•°æ²¡æœ‰åœ¨æ–¹æ³•ç­¾åä¸­æ˜¾å¼åˆ—å‡º#ä¸Šæ–¹ä»£ç ç´¢å¼•ï¼š#### check_decimal_float???
# check()ï¼šå¯¹å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿ã€ç›¸ä¼¼åº¦é˜ˆå€¼ã€‘å’Œã€æƒé‡ã€‘ä¸ºæœ‰æ•ˆçš„å°æ•°ï¼Œä¸” top_n æ˜¯æ­£æ•°ã€‚
    def check(self):
        # &quot;ç›¸ä¼¼æ€§é˜ˆå€¼&quot;
        self.check_decimal_float(self.similarity_threshold, &quot;[Retrieval] Similarity threshold&quot;)
        # &quot;å…³é”®è¯ç›¸ä¼¼åº¦æƒé‡&quot;
        self.check_decimal_float(self.keywords_similarity_weight, &quot;[Retrieval] Keyword similarity weight&quot;)
        self.check_positive_number(self.top_n, &quot;[Retrieval] Top N&quot;)
---------------------------  â˜† ä¸Šæ–¹ä»£ç å—ç‰‡æ®µ â˜†  ---------------------------

# æ ¡éªŒæ£€ç´¢ç›¸å…³å‚æ•°çš„åˆæ³•æ€§
# è¿™æ˜¯ä¸€ä¸ª é™æ€æ–¹æ³•ï¼Œç”¨äºæ ¡éªŒå‚æ•° param æ˜¯å¦æ˜¯ 0 åˆ° 1 ä¹‹é—´çš„æµ®ç‚¹æ•°æˆ–æ•´æ•°

&#39;&#39;&#39;
æ ¡éªŒé€»è¾‘ï¼š
param å¿…é¡»æ˜¯ float æˆ– int ç±»å‹ï¼ˆä¸å…è®¸ strã€list ç­‰ï¼‰ã€‚
param éœ€è¦åœ¨ [0, 1] ä¹‹é—´ï¼Œå¦åˆ™æŠ›å‡º ValueError å¼‚å¸¸ï¼Œå¹¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­åŒ…å« descr æè¿°ã€‚
&#39;&#39;&#39;
# è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯0-1 ä¸èƒ½è¶…è¿‡1ï¼Ÿ å¦‚æœ similarity_threshold = 1.2ï¼Œä¼šè§¦å‘ check_decimal_float çš„å¼‚å¸¸æŠ›å‡ºï¼Œæç¤ºè¶…å‡º [0,1] èŒƒå›´ã€‚è€Œä¸”åœ¨å‰ç«¯çš„æ‹–æ‹‰ä¸­ä¹Ÿåªä¼šæ˜¯0~1ä¹‹é—´ã€‚å› ä¸ºè¿™äº›å‚æ•°ä»£è¡¨ å½’ä¸€åŒ–ï¼ˆnormalizedï¼‰åçš„æ¯”ä¾‹æˆ–æƒé‡ï¼Œå®ƒä»¬çš„å€¼é€šå¸¸ä¸èƒ½è¶…è¿‡ 1
# ã€0è¡¨ç¤ºç¤ºå®Œå…¨ç›¸åŒã€‘
    @staticmethod
    def check_decimal_float(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;] or param &lt; 0 or param &gt; 1:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be a float number in range [0, 1]&quot;.format(
                    param
                )
            )
&#39;&#39;&#39;
è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ @staticmethodï¼Ÿ
1. é¿å…åˆ›å»ºå¯¹è±¡ï¼Œæé«˜æ•ˆç‡ ğŸ‘‰ ç”±äºé™æ€æ–¹æ³•ä¸ä¾èµ–å®ä½“å±æ€§æˆ–æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥ç›´æ¥é€šè¿‡ç±»è°ƒç”¨ï¼Œè€Œä¸å¿…åˆ›å»ºå¯¹è±¡
2. ä»£ç ç»„ç»‡æ¸…æ™° ğŸ‘‰ é€‚ç”¨äºé€»è¾‘ç‹¬ç«‹çš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä»£ç æ›´å®¹æ˜“è¯»ã€æ›´ç»“æ„åŒ–
3. é˜²æ­¢ä¿®æ”¹å®ä¾‹çŠ¶æ€ ğŸ‘‰ ç”±äºé™æ€æ–¹æ³•ä¸èƒ½è®¿é—®selfï¼Œå› æ­¤ä¸ä¼šä¿®æ”¹å®ä¾‹çš„çŠ¶æ€ï¼Œä¿è¯äº†æ–¹æ³•çš„çº¯å‡½æ•°ç‰¹å¾
-------- -------- -------- ç»“åˆä»£ç è§£æ -------- -------- -------- 
4. è¿™ä¸ªæ–¹æ³• ä¸è®¿é—®å®ä¾‹å˜é‡ï¼Œå®ƒåª æ£€æŸ¥å‚æ•° æ˜¯å¦ç¬¦åˆ 0~1 ä¹‹é—´çš„èŒƒå›´
5. é€‚ç”¨äº å·¥å…·æ–¹æ³•ï¼Œå±äº æ•°æ®éªŒè¯é€»è¾‘ï¼Œä¸ä¾èµ– self
6. å¯ä»¥ç›´æ¥é€šè¿‡ç±»è°ƒç”¨ï¼š
Retrieval.check_decimal_float(0.8, &quot;Threshold&quot;)  # æ­£å¸¸
Retrieval.check_decimal_float(1.2, &quot;Threshold&quot;)  # æŠ›å‡º ValueError
&#39;&#39;&#39;
==========================================================================
#ä¸Šæ–¹ä»£ç ç´¢å¼•ï¼š##### history, **kwargs???
    def _run(self, history, **kwargs):
        query = self.get_input()
        query = str(query[&quot;content&quot;][0]) if &quot;content&quot; in query else &quot;&quot;
        ......
# è®²è§£é‡ç‚¹ï¼šã€**kwargsã€‘
# [**kwargs] å…è®¸è°ƒç”¨ _run() æ–¹æ³•æ—¶ ä¼ å…¥ä»»æ„æ•°é‡çš„é¢å¤–å‚æ•°ï¼Œå³ä½¿è¿™äº›å‚æ•°æ²¡æœ‰åœ¨æ–¹æ³•ç­¾åä¸­æ˜¾å¼åˆ—å‡º æ¯”å¦‚ï¼šğŸ‘‡
    _run(self, history, user_id=123, debug=True, mode=&quot;fast&quot;)
# åœ¨ _run() æ–¹æ³•å†…éƒ¨ï¼Œè¿™äº›å‚æ•°å¯ä»¥é€šè¿‡ kwargs[&quot;user_id&quot;]ã€kwargs[&quot;debug&quot;] è®¿é—®ï¼Œä½† å½“å‰ä»£ç é‡Œæ²¡æœ‰ä½¿ç”¨ kwargsï¼Œæ‰€ä»¥å®ƒåªæ˜¯ç”¨æ¥å…¼å®¹å¯èƒ½çš„æ‰©å±•ã€‚
&#39;&#39;&#39;
ç›®å‰ **kwargs æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š

æ‰©å±•æ€§ï¼šå¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°è€Œä¸ä¿®æ”¹å‡½æ•°ç­¾å
å…¼å®¹æ€§ï¼šå…è®¸ä¸åŒè°ƒç”¨æ–¹ä¼ é€’ä¸åŒçš„å‚æ•°ï¼Œè€Œ _run() ä»èƒ½æ­£å¸¸è¿è¡Œ
é€‚ç”¨åœºæ™¯ï¼šæœªæ¥éœ€è¦é¢å¤–å‚æ•°
ç›®å‰ **kwargs åªæ˜¯ å ä½ç¬¦ï¼Œä½†å®ƒæä¾›äº†æœªæ¥æ‰©å±•çš„å¯èƒ½æ€§
&#39;&#39;&#39;
</code></pre>
<table>
<thead>
<tr>
<th align="center">ç‰¹å¾</th>
<th align="center">æ™®é€šæ–¹æ³•(self)</th>
<th align="center">é™æ€æ–¹æ³•(@staticmethod)</th>
<th align="center">ç±»æ–¹æ³•(@classmethod)</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ä¾èµ–å®ä¾‹(self)</td>
<td align="center">âˆš</td>
<td align="center">Ã—</td>
<td align="center">Ã—</td>
</tr>
<tr>
<td align="center">ä¾èµ–ç±»(cls)</td>
<td align="center">Ã—</td>
<td align="center">Ã—</td>
<td align="center">âˆš</td>
</tr>
<tr>
<td align="center">è®¿é—®å®ä¾‹å˜é‡</td>
<td align="center">âˆš</td>
<td align="center">Ã—</td>
<td align="center">Ã—</td>
</tr>
<tr>
<td align="center">è®¿é—®ç±»å˜é‡</td>
<td align="center">âˆš</td>
<td align="center">Ã—</td>
<td align="center">âˆš</td>
</tr>
<tr>
<td align="center">é€‚ç”¨äº</td>
<td align="center">éœ€è¦è®¿é—®å®ä¾‹</td>
<td align="center">å·¥å…·æ–¹æ³•ã€éªŒè¯æ–¹æ³•</td>
<td align="center">éœ€è¦ä¿®æ”¹ç±»å˜é‡</td>
</tr>
</tbody></table>
<p><code>retrieval.py</code> â†’ </p>
<hr>
<hr>
<hr>
<h6 id="è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹"><a href="#è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹" class="headerlink" title="è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹"></a><span style="color:green">è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹</span></h6><p><strong>ç™¾åº¦ç¿»è¯‘</strong>ï¼š<code>baidufanyi.py</code>      è·¯å¾„ â†’ <code>agent/component/baidufanyi.py</code></p>
<pre><code class="python"># 
import random
# æŠ½è±¡åŸºç±»æ¨¡å— ç”¨äºå®šä¹‰ç»„ä»¶çš„åŸºç±»
from abc import ABC
# ç”¨äºå‘é€ HTTP è¯·æ±‚ï¼Œä¸ ç™¾åº¦ç¿»è¯‘ API äº¤äº’
import requests
# åŸºç¡€ç»„ä»¶ç±»ï¼Œäºæ„å»ºæ­¤ç»„ä»¶çš„çˆ¶ç±»ï¼Œå®šä¹‰ç»„ä»¶çš„åŸºæœ¬ç»“æ„å’Œå‚æ•°ã€‚
from agent.component.base import ComponentBase, ComponentParamBase
# ç”¨äºç”Ÿæˆç™¾åº¦ç¿»è¯‘ API è¯·æ±‚ç­¾åï¼ˆåŠ å¯†å“ˆå¸Œï¼‰
from hashlib import md5

# ç™¾åº¦ç¿»è¯‘ç»„ä»¶çš„å‚æ•°å®šä¹‰ç±» ç»§æ‰¿ComponentParamBase
class BaiduFanyiParam(ComponentParamBase):
    &quot;&quot;&quot;
    Define the BaiduFanyi component parameters.
    &quot;&quot;&quot;

    def __init__(self):
        super().__init__()
   # appid å’Œ secret_key æ˜¯ç™¾åº¦ç¿»è¯‘ API çš„ èº«ä»½éªŒè¯ ä¿¡æ¯ï¼ˆéœ€è¦åœ¨ç™¾åº¦ç¿»è¯‘å¼€æ”¾å¹³å°è·å–ï¼‰
        self.appid = &quot;xxx&quot;
        self.secret_key = &quot;xxx&quot;
   # translateï¼šæ™®é€šç¿»è¯‘   fieldtranslateï¼šä¸“ä¸šé¢†åŸŸç¿»è¯‘
        self.trans_type = &#39;translate&#39;
        self.parameters = []
   # source_lang ç¿»è¯‘çš„æºè¯­è¨€   target_lang ç¿»è¯‘çš„ç›®æ ‡è¯­è¨€
        self.source_lang = &#39;auto&#39;
        self.target_lang = &#39;auto&#39;
   # domain å¦‚æœä½¿ç”¨ä¸“ä¸šé¢†åŸŸç¿»è¯‘ï¼Œéœ€æŒ‡å®šé¢†åŸŸï¼ˆå¦‚ finance è¡¨ç¤º é‡‘è é¢†åŸŸï¼‰
        self.domain = &#39;finance&#39;
# æ£€æŸ¥å‚æ•°åˆæ³•æ€§
    def check(self):
    # check_empty()ï¼šç¡®ä¿ appid å’Œ secret_key ä¸èƒ½ä¸ºç©ºã€‚
        self.check_empty(self.appid, &quot;BaiduFanyi APPID&quot;)
        self.check_empty(self.secret_key, &quot;BaiduFanyi Secret Key&quot;)
# check_valid_value()ï¼šç¡®ä¿ trans_typeã€source_langã€target_langã€domain çš„å€¼åœ¨åˆæ³•é€‰é¡¹ä¹‹å†…
        self.check_valid_value(self.trans_type, &quot;Translate type&quot;, [&#39;translate&#39;, &#39;fieldtranslate&#39;])
# ä»¥ä¸‹æ˜¯åˆ—ä¸¾å„ç§è¯­è¨€
        self.check_valid_value(self.source_lang, &quot;Source language&quot;,
                               [&#39;auto&#39;, &#39;zh&#39;, &#39;en&#39;, &#39;yue&#39;, &#39;wyw&#39;, &#39;jp&#39;, &#39;kor&#39;, &#39;fra&#39;, &#39;spa&#39;, &#39;th&#39;, &#39;ara&#39;, &#39;ru&#39;, &#39;pt&#39;,
                                &#39;de&#39;, &#39;it&#39;, &#39;el&#39;, &#39;nl&#39;, &#39;pl&#39;, &#39;bul&#39;, &#39;est&#39;, &#39;dan&#39;, &#39;fin&#39;, &#39;cs&#39;, &#39;rom&#39;, &#39;slo&#39;, &#39;swe&#39;,
                                &#39;hu&#39;, &#39;cht&#39;, &#39;vie&#39;])
        self.check_valid_value(self.target_lang, &quot;Target language&quot;,
                               [&#39;auto&#39;, &#39;zh&#39;, &#39;en&#39;, &#39;yue&#39;, &#39;wyw&#39;, &#39;jp&#39;, &#39;kor&#39;, &#39;fra&#39;, &#39;spa&#39;, &#39;th&#39;, &#39;ara&#39;, &#39;ru&#39;, &#39;pt&#39;,
                                &#39;de&#39;, &#39;it&#39;, &#39;el&#39;, &#39;nl&#39;, &#39;pl&#39;, &#39;bul&#39;, &#39;est&#39;, &#39;dan&#39;, &#39;fin&#39;, &#39;cs&#39;, &#39;rom&#39;, &#39;slo&#39;, &#39;swe&#39;,
                                &#39;hu&#39;, &#39;cht&#39;, &#39;vie&#39;])
# ä»¥ä¸‹æ˜¯åˆ—ä¸¾ä¸åŒä¸“ä¸šé¢†åŸŸ
        self.check_valid_value(self.domain, &quot;Translate field&quot;,
                               [&#39;it&#39;, &#39;finance&#39;, &#39;machinery&#39;, &#39;senimed&#39;, &#39;novel&#39;, &#39;academic&#39;, &#39;aerospace&#39;, &#39;wiki&#39;,
                                &#39;news&#39;, &#39;law&#39;, &#39;contract&#39;])

# ç»§æ‰¿ComponentBaseå’ŒABC
class BaiduFanyi(ComponentBase, ABC):
 # å®šä¹‰ç»„ä»¶åç§°åœ¨ç³»ç»Ÿå†…å”¯ä¸€æ ‡è¯†è¯¥ç»„ä»¶
    component_name = &quot;BaiduFanyi&quot;
    # _run()æ˜¯ç»„ä»¶çš„ æ ¸å¿ƒæ‰§è¡Œå‡½æ•°ï¼Œç”¨äºå¤„ç†ç¿»è¯‘è¯·æ±‚ã€‚
# **kwargsï¼šå¯ä»¥è®©å‡½æ•°æ›´åŠ çµæ´»ï¼Œå› ä¸ºå®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‘½åå‚æ•°
# åœ¨å‡½æ•°å†…éƒ¨ï¼Œkwargs æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†æ‰€æœ‰ä¼ é€’ç»™å‡½æ•°çš„é¢å¤–å‘½åå‚æ•°ã€‚
    def _run(self, history, **kwargs):
&#39;&#39;&#39;
self.get_input() è·å–è¾“å…¥å†…å®¹ã€‚
å¦‚æœ content å­˜åœ¨ï¼Œåˆ™ç”¨ - è¿æ¥å¤šä¸ªå†…å®¹ï¼ˆæ‹¼æ¥æˆå•ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚
å¦‚æœ ans ä¸ºç©ºï¼Œç›´æ¥è¿”å› &quot;&quot;
&#39;&#39;&#39;
        ans = self.get_input()
        ans = &quot; - &quot;.join(ans[&quot;content&quot;]) if &quot;content&quot; in ans else &quot;&quot;
        if not ans:
            return BaiduFanyi.be_output(&quot;&quot;)

        try:
&#39;&#39;&#39;
source_lang å’Œ target_langï¼šæ¥æºå’Œç›®æ ‡è¯­è¨€ã€‚
appidï¼šç™¾åº¦ç¿»è¯‘ API çš„ åº”ç”¨ IDã€‚
saltï¼šéšæœºæ•°ï¼ˆç™¾åº¦ API éœ€è¦æ­¤å‚æ•°ï¼‰ã€‚
secret_keyï¼šç™¾åº¦ API çš„ å¯†é’¥
&#39;&#39;&#39;
            source_lang = self._param.source_lang
            target_lang = self._param.target_lang
            appid = self._param.appid
            salt = random.randint(32768, 65536)
            secret_key = self._param.secret_key
-------------------------- â˜† æ™®é€šç¿»è¯‘APIè¯·æ±‚ â˜† --------------------------
            if self._param.trans_type == &#39;translate&#39;:
            # md5ç­¾åï¼Œé˜²æ­¢è¯·æ±‚è¢«ç¯¡æ”¹
                sign = md5((appid + ans + salt + secret_key).encode(&#39;utf-8&#39;)).hexdigest()
     # å‘é€ HTTP POST è¯·æ±‚ è®¿é—® ç™¾åº¦ç¿»è¯‘ API
                url = &#39;http://api.fanyi.baidu.com/api/trans/vip/translate?&#39; + &#39;q=&#39; + ans + &#39;&amp;from=&#39; + source_lang + &#39;&amp;to=&#39; + target_lang + &#39;&amp;appid=&#39; + appid + &#39;&amp;salt=&#39; + salt + &#39;&amp;sign=&#39; + sign
                headers = &#123;&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;&#125;
            # è§£æè¿”å›ç»“æœ
                response = requests.post(url=url, headers=headers).json()

                if response.get(&#39;error_code&#39;):
                    BaiduFanyi.be_output(&quot;**Error**:&quot; + response[&#39;error_msg&#39;])

                return BaiduFanyi.be_output(response[&#39;trans_result&#39;][0][&#39;dst&#39;])
-------------------------- â˜… ä¸“ä¸šç¿»è¯‘APIè¯·æ±‚ â˜… --------------------------
            elif self._param.trans_type == &#39;fieldtranslate&#39;:
                domain = self._param.domain
                sign = md5((appid + ans + salt + domain + secret_key).encode(&#39;utf-8&#39;)).hexdigest()
                url = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate?&#39; + &#39;q=&#39; + ans + &#39;&amp;from=&#39; + source_lang + &#39;&amp;to=&#39; + target_lang + &#39;&amp;appid=&#39; + appid + &#39;&amp;salt=&#39; + salt + &#39;&amp;domain=&#39; + domain + &#39;&amp;sign=&#39; + sign
                headers = &#123;&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;&#125;
                response = requests.post(url=url, headers=headers).json()

                if response.get(&#39;error_code&#39;):
                    BaiduFanyi.be_output(&quot;**Error**:&quot; + response[&#39;error_msg&#39;])

                return BaiduFanyi.be_output(response[&#39;trans_result&#39;][0][&#39;dst&#39;])
        # æ•è· æ‰€æœ‰å¼‚å¸¸ï¼Œé˜²æ­¢ç¨‹åºå´©æºƒ
        except Exception as e:
            BaiduFanyi.be_output(&quot;**Error**:&quot; + str(e))
</code></pre>
<h3 id="æ·±å±‚æ¬¡ç ”ç©¶"><a href="#æ·±å±‚æ¬¡ç ”ç©¶" class="headerlink" title="æ·±å±‚æ¬¡ç ”ç©¶"></a><strong>æ·±å±‚æ¬¡ç ”ç©¶</strong></h3><p><code>from agent.component.base import ComponentBase, ComponentParamBase</code></p>
<p>ä¸»è¦ç”¨äºå¤„ç†ã€æ›´æ–°ã€éªŒè¯å’Œè­¦å‘Šç»„ä»¶å‚æ•°ï¼Œé€‚ç”¨äºé‚£äº›éœ€è¦åŠ¨æ€é…ç½®ã€é€’å½’åµŒå¥—ç»“æ„ä¸”è¦æ±‚é«˜å¯æ‰©å±•æ€§çš„ç³»ç»Ÿ</p>
<pre><code class="python">class ComponentParamBase(ABC):
    def __init__(self):
        # åˆå§‹åŒ–è¾“å‡ºå˜é‡å
        self.output_var_name = &quot;output&quot;
        # åˆå§‹åŒ–æ¶ˆæ¯å†å²çª—å£å¤§å°
        self.message_history_window_size = 22
        # åˆå§‹åŒ–æŸ¥è¯¢å‚æ•°
        self.query = []
        # åˆå§‹åŒ–è¾“å…¥å‚æ•°
        self.inputs = []
        # åˆå§‹åŒ–è°ƒè¯•è¾“å…¥å‚æ•°
        self.debug_inputs = []
    # è®¾ç½®ç»„ä»¶çš„åç§°ï¼Œå¹¶è¿”å›å½“å‰å¯¹è±¡ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
    def set_name(self, name: str):
        self._name = name
        return self

    # æŠ½è±¡æ–¹æ³• å­ç±»å¿…é¡»å®ç° å®ƒçš„ç›®çš„æ˜¯æ£€æŸ¥å‚æ•°æ˜¯å¦æœ‰æ•ˆ
    def check(self):
        raise NotImplementedError(&quot;Parameter Object should be checked.&quot;)

    # ç±»æ–¹æ³• ç”¨äºæ£€æŸ¥ç±»æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§ _DEPRECATED_PARAMS å¦‚æœæ²¡æœ‰ åˆ™åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆ
    @classmethod
    def _get_or_init_deprecated_params_set(cls):
        if not hasattr(cls, _DEPRECATED_PARAMS):
            setattr(cls, _DEPRECATED_PARAMS, set())
        return getattr(cls, _DEPRECATED_PARAMS)
    # ç”¨äºæ£€æŸ¥å’Œåˆå§‹åŒ–å®ä¾‹çš„å·²åºŸå¼ƒå‚æ•°é›†åˆ
    def _get_or_init_feeded_deprecated_params_set(self, conf=None):
        if not hasattr(self, _FEEDED_DEPRECATED_PARAMS):
            if conf is None:
                setattr(self, _FEEDED_DEPRECATED_PARAMS, set())
            else:
                setattr(
                    self,
                    _FEEDED_DEPRECATED_PARAMS,
                    set(conf[_FEEDED_DEPRECATED_PARAMS]),
                )
        return getattr(self, _FEEDED_DEPRECATED_PARAMS)
    # ç”¨äºæ£€æŸ¥å’Œåˆå§‹åŒ–å®ä¾‹çš„å·²åºŸå¼ƒå‚æ•°é›†åˆ
    def _get_or_init_user_feeded_params_set(self, conf=None):
        if not hasattr(self, _USER_FEEDED_PARAMS):
            if conf is None:
                setattr(self, _USER_FEEDED_PARAMS, set())
            else:
                setattr(self, _USER_FEEDED_PARAMS, set(conf[_USER_FEEDED_PARAMS]))
        return getattr(self, _USER_FEEDED_PARAMS)
    # è¿”å›ç”¨æˆ·æä¾›çš„å‚æ•°
    def get_user_feeded(self):
        return self._get_or_init_user_feeded_params_set()
    # è¿”å›å·²åºŸå¼ƒçš„å‚æ•°é›†åˆ
    def get_feeded_deprecated_params(self):
        return self._get_or_init_feeded_deprecated_params_set()
    
    # @è£…é¥°å™¨ å®šä¹‰äº† _deprecated_params_set å±æ€§ å®ƒè¿”å›å·²åºŸå¼ƒçš„å‚æ•°é›†åˆ
    @property
    def _deprecated_params_set(self):
        return &#123;name: True for name in self.get_feeded_deprecated_params()&#125;
    
    # å°†å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
    def __str__(self):
        return json.dumps(self.as_dict(), ensure_ascii=False)

    # é€’å½’åœ°å°†å¯¹è±¡çš„å±æ€§è½¬æ¢æˆå­—å…¸ é€‚ç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æˆ–è¿›è¡Œå…¶ä»–æ“ä½œ
    def as_dict(self):
        def _recursive_convert_obj_to_dict(obj):
            ret_dict = &#123;&#125;
            for attr_name in list(obj.__dict__):
                if attr_name in [_FEEDED_DEPRECATED_PARAMS, _DEPRECATED_PARAMS, _USER_FEEDED_PARAMS, _IS_RAW_CONF]:
                    continue
                # get attr
                attr = getattr(obj, attr_name)
                if isinstance(attr, pd.DataFrame):
                    ret_dict[attr_name] = attr.to_dict()
                    continue
                if attr and type(attr).__name__ not in dir(builtins):
                    ret_dict[attr_name] = _recursive_convert_obj_to_dict(attr)
                else:
                    ret_dict[attr_name] = attr

            return ret_dict

        return _recursive_convert_obj_to_dict(self)

    # ç”¨äºæ›´æ–°å¯¹è±¡çš„å‚æ•°ï¼Œå¹¶æ ¹æ®ä¼ å…¥çš„é…ç½®è¿›è¡Œä¿®æ”¹ å®ƒå¤„ç†é€’å½’æ›´æ–°å‚æ•°ã€æ£€æŸ¥å†—ä½™å±æ€§ç­‰
    def update(self, conf, allow_redundant=False):
        update_from_raw_conf = conf.get(_IS_RAW_CONF, True)
        if update_from_raw_conf:
            deprecated_params_set = self._get_or_init_deprecated_params_set()
            feeded_deprecated_params_set = (
                self._get_or_init_feeded_deprecated_params_set()
            )
            user_feeded_params_set = self._get_or_init_user_feeded_params_set()
            setattr(self, _IS_RAW_CONF, False)
        else:
            feeded_deprecated_params_set = (
                self._get_or_init_feeded_deprecated_params_set(conf)
            )
            user_feeded_params_set = self._get_or_init_user_feeded_params_set(conf)

        def _recursive_update_param(param, config, depth, prefix):
            if depth &gt; settings.PARAM_MAXDEPTH:
                raise ValueError(&quot;Param define nesting too deep!!!, can not parse it&quot;)

            inst_variables = param.__dict__
            redundant_attrs = []
            for config_key, config_value in config.items():
                # redundant attr
                if config_key not in inst_variables:
                    if not update_from_raw_conf and config_key.startswith(&quot;_&quot;):
                        setattr(param, config_key, config_value)
                    else:
                        setattr(param, config_key, config_value)
                        # redundant_attrs.append(config_key)
                    continue

                full_config_key = f&quot;&#123;prefix&#125;&#123;config_key&#125;&quot;

                if update_from_raw_conf:
                    # add user feeded params
                    user_feeded_params_set.add(full_config_key)

                    # update user feeded deprecated param set
                    if full_config_key in deprecated_params_set:
                        feeded_deprecated_params_set.add(full_config_key)

                # supported attr
                attr = getattr(param, config_key)
                if type(attr).__name__ in dir(builtins) or attr is None:
                    setattr(param, config_key, config_value)

                else:
                    # recursive set obj attr
                    sub_params = _recursive_update_param(
                        attr, config_value, depth + 1, prefix=f&quot;&#123;prefix&#125;&#123;config_key&#125;.&quot;
                    )
                    setattr(param, config_key, sub_params)

            if not allow_redundant and redundant_attrs:
                raise ValueError(
                    f&quot;cpn `&#123;getattr(self, &#39;_name&#39;, type(self))&#125;` has redundant parameters: `&#123;[redundant_attrs]&#125;`&quot;
                )

            return param

        return _recursive_update_param(param=self, config=conf, depth=0, prefix=&quot;&quot;)

    # ç”¨äºæå–æ‰€æœ‰éå†…ç½®ç±»å‹çš„å±æ€§ é€’å½’åœ°éå†å¯¹è±¡çš„å±æ€§
    def extract_not_builtin(self):
        def _get_not_builtin_types(obj):
            ret_dict = &#123;&#125;
            for variable in obj.__dict__:
                attr = getattr(obj, variable)
                if attr and type(attr).__name__ not in dir(builtins):
                    ret_dict[variable] = _get_not_builtin_types(attr)

            return ret_dict

        return _get_not_builtin_types(self)
    
    # validate æ–¹æ³•ç”¨äºéªŒè¯å¯¹è±¡çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„å®šä¹‰çš„è§„åˆ™ è§„åˆ™å­˜å‚¨åœ¨ JSON æ–‡ä»¶ä¸­
    def validate(self):
        self.builtin_types = dir(builtins)
        self.func = &#123;
            &quot;ge&quot;: self._greater_equal_than,
            &quot;le&quot;: self._less_equal_than,
            &quot;in&quot;: self._in,
            &quot;not_in&quot;: self._not_in,
            &quot;range&quot;: self._range,
        &#125;
        home_dir = os.path.abspath(os.path.dirname(os.path.realpath(__file__)))
        param_validation_path_prefix = home_dir + &quot;/param_validation/&quot;

        param_name = type(self).__name__
        param_validation_path = &quot;/&quot;.join(
            [param_validation_path_prefix, param_name + &quot;.json&quot;]
        )

        validation_json = None

        try:
            with open(param_validation_path, &quot;r&quot;) as fin:
                validation_json = json.loads(fin.read())
        except BaseException:
            return

        self._validate_param(self, validation_json)

    def _validate_param(self, param_obj, validation_json):
        default_section = type(param_obj).__name__
        var_list = param_obj.__dict__

        for variable in var_list:
            attr = getattr(param_obj, variable)

            if type(attr).__name__ in self.builtin_types or attr is None:
                if variable not in validation_json:
                    continue

                validation_dict = validation_json[default_section][variable]
                value = getattr(param_obj, variable)
                value_legal = False

                for op_type in validation_dict:
                    if self.func[op_type](value, validation_dict[op_type]):
                        value_legal = True
                        break

                if not value_legal:
                    raise ValueError(
                        &quot;Plase check runtime conf, &#123;&#125; = &#123;&#125; does not match user-parameter restriction&quot;.format(
                            variable, value
                        )
                    )

            elif variable in validation_json:
                self._validate_param(attr, validation_json)

    # ç”¨äºéªŒè¯å‚æ•°çš„ç±»å‹å’ŒèŒƒå›´ ç¡®ä¿ç¬¦åˆé¢„æœŸ          
    @staticmethod
    def check_string(param, descr):
        if type(param).__name__ not in [&quot;str&quot;]:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be string type&quot;.format(param)
            )

    @staticmethod
    def check_empty(param, descr):
        if not param:
            raise ValueError(
                descr + &quot; does not support empty value.&quot;
            )

    @staticmethod
    def check_positive_integer(param, descr):
        if type(param).__name__ not in [&quot;int&quot;, &quot;long&quot;] or param &lt;= 0:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be positive integer&quot;.format(param)
            )

    @staticmethod
    def check_positive_number(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;, &quot;long&quot;] or param &lt;= 0:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be positive numeric&quot;.format(param)
            )

    @staticmethod
    def check_nonnegative_number(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;, &quot;long&quot;] or param &lt; 0:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be non-negative numeric&quot;.format(param)
            )

    @staticmethod
    def check_decimal_float(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;] or param &lt; 0 or param &gt; 1:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be a float number in range [0, 1]&quot;.format(
                    param
                )
            )

    @staticmethod
    def check_boolean(param, descr):
        if type(param).__name__ != &quot;bool&quot;:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be bool type&quot;.format(param)
            )

    @staticmethod
    def check_open_unit_interval(param, descr):
        if type(param).__name__ not in [&quot;float&quot;] or param &lt;= 0 or param &gt;= 1:
            raise ValueError(
                descr + &quot; should be a numeric number between 0 and 1 exclusively&quot;
            )

    @staticmethod
    def check_valid_value(param, descr, valid_values):
        if param not in valid_values:
            raise ValueError(
                descr
                + &quot; &#123;&#125; is not supported, it should be in &#123;&#125;&quot;.format(param, valid_values)
            )

    @staticmethod
    def check_defined_type(param, descr, types):
        if type(param).__name__ not in types:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be one of &#123;&#125;&quot;.format(param, types)
            )

    @staticmethod
    def check_and_change_lower(param, valid_list, descr=&quot;&quot;):
        if type(param).__name__ != &quot;str&quot;:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be one of &#123;&#125;&quot;.format(param, valid_list)
            )

        lower_param = param.lower()
        if lower_param in valid_list:
            return lower_param
        else:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be one of &#123;&#125;&quot;.format(param, valid_list)
            )

    @staticmethod
    def _greater_equal_than(value, limit):
        return value &gt;= limit - settings.FLOAT_ZERO

    @staticmethod
    def _less_equal_than(value, limit):
        return value &lt;= limit + settings.FLOAT_ZERO

    @staticmethod
    def _range(value, ranges):
        in_range = False
        for left_limit, right_limit in ranges:
            if (
                    left_limit - settings.FLOAT_ZERO
                    &lt;= value
                    &lt;= right_limit + settings.FLOAT_ZERO
            ):
                in_range = True
                break

        return in_range

    @staticmethod
    def _in(value, right_value_list):
        return value in right_value_list

    @staticmethod
    def _not_in(value, wrong_value_list):
        return value not in wrong_value_list

    def _warn_deprecated_param(self, param_name, descr):
        if self._deprecated_params_set.get(param_name):
            logging.warning(
                f&quot;&#123;descr&#125; &#123;param_name&#125; is deprecated and ignored in this version.&quot;
            )

    def _warn_to_deprecate_param(self, param_name, descr, new_param):
        if self._deprecated_params_set.get(param_name):
            logging.warning(
                f&quot;&#123;descr&#125; &#123;param_name&#125; will be deprecated in future release; &quot;
                f&quot;please use &#123;new_param&#125; instead.&quot;
            )
            return True
        return False
</code></pre>
<h5 id="è¿™é‡Œè¿ç”¨åˆ°json-ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ"><a href="#è¿™é‡Œè¿ç”¨åˆ°json-ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ" class="headerlink" title="è¿™é‡Œè¿ç”¨åˆ°json ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ"></a>è¿™é‡Œè¿ç”¨åˆ°json ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ</h5><ul>
<li><strong>æ–¹ä¾¿åºåˆ—åŒ–</strong>ï¼š<code>json.dumps()</code>å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¯ä»¥è½»æ¾åœ°ä¿å­˜æˆ–ä¼ è¾“å¯¹è±¡æ•°æ®ã€‚</li>
<li><strong>æ–¹ä¾¿è°ƒè¯•å’Œå±•ç¤º</strong>ï¼šåœ¨ <code>__str__</code> æ–¹æ³•ä¸­è¿”å› JSON å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹å¯¹è±¡çš„å†…å®¹ã€‚å°¤å…¶æ˜¯åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œç›´æ¥æ‰“å°å‡ºå¯¹è±¡çš„ JSON æ ¼å¼å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å¿«é€ŸæŸ¥çœ‹å¯¹è±¡çš„çŠ¶æ€åŠå…¶å†…éƒ¨æ•°æ®ç»“æ„</li>
<li><strong>ä¸å¤§æ¨¡å‹äº¤äº’</strong>ï¼šå½“æ¶‰åŠåˆ°ä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPTï¼‰æˆ–å…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹çš„äº¤äº’æ—¶ï¼ŒJSON æ ¼å¼çš„æ•°æ®é€šå¸¸æ˜¯æ ‡å‡†çš„è¾“å…¥å’Œè¾“å‡ºæ ¼å¼ã€‚å°†å¯¹è±¡è½¬ä¸º JSON å­—ç¬¦ä¸²ï¼Œèƒ½å¤Ÿæ›´å®¹æ˜“åœ°å°†æ•°æ®ä¼ é€’ç»™æ¨¡å‹è¿›è¡Œå¤„ç†æˆ–åˆ†æï¼Œæ¨¡å‹é€šå¸¸ä¼šæ¥å— JSON æ ¼å¼çš„æ•°æ®è¿›è¡Œè®­ç»ƒæˆ–æ¨ç†ã€‚</li>
</ul>
<h5 id="å¦‚ä½•å»è¿ç”¨ï¼Ÿ"><a href="#å¦‚ä½•å»è¿ç”¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•å»è¿ç”¨ï¼Ÿ"></a>å¦‚ä½•å»è¿ç”¨ï¼Ÿ</h5><ul>
<li><strong>æ•°æ®äº¤æ¢</strong>ï¼šå¯ä»¥å°†è¿™ä¸ª JSON å­—ç¬¦ä¸²ç”¨ä½œ API è¯·æ±‚æˆ–å“åº”çš„æ•°æ®æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†è¿™ä¸ªå¯¹è±¡ä½œä¸º HTTP è¯·æ±‚çš„ body å‘é€ï¼Œæˆ–è€…ä»ç½‘ç»œä¸­è·å– JSON æ ¼å¼çš„æ•°æ®ï¼Œç„¶åè§£æå›å¯¹è±¡ã€‚</li>
<li><strong>æŒä¹…åŒ–å­˜å‚¨</strong>ï¼šå¦‚æœä½ éœ€è¦å°†å¯¹è±¡æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼ŒJSON æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­˜å‚¨æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œå°†å¯¹è±¡æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ä¸­æˆ–æ•°æ®åº“è¡¨çš„ JSON ç±»å‹å­—æ®µä¸­ï¼Œä¾¿äºæœªæ¥è¯»å–å’Œæ“ä½œã€‚</li>
<li><strong>é…ç½®å’Œå‚æ•°æ›´æ–°</strong>ï¼š<code>update</code> æ–¹æ³•ä¸­æ¥æ”¶åˆ°çš„ <code>conf</code> å‚æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—å…¸å¯¹è±¡ï¼Œå®ƒé€šè¿‡é€’å½’çš„æ–¹å¼æ›´æ–°å¯¹è±¡çš„å±æ€§ã€‚å¦‚æœä½ å°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æ ¼å¼åï¼Œå¯ä»¥å°† JSON ä½œä¸ºé…ç½®æ–‡ä»¶ä¼ é€’ç»™åº”ç”¨ï¼Œåº”ç”¨æ ¹æ®è¯¥é…ç½®åŠ¨æ€è°ƒæ•´å…¶è¡Œä¸ºã€‚è¿™ä½¿å¾—ç³»ç»Ÿæ›´åŠ çµæ´»å’Œå¯é…ç½®ã€‚</li>
<li><strong>éªŒè¯ä¸æ ¡éªŒ</strong>ï¼š<code>validate</code> æ–¹æ³•åˆ©ç”¨å­˜å‚¨åœ¨ JSON æ–‡ä»¶ä¸­çš„è§„åˆ™å¯¹å¯¹è±¡è¿›è¡Œå‚æ•°éªŒè¯ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„æ–¹å¼æ¥ç¡®ä¿è¾“å…¥çš„æ•°æ®ç¬¦åˆç‰¹å®šçš„æ ¼å¼æˆ–é™åˆ¶ã€‚å¯ä»¥é€šè¿‡åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶æ¥éªŒè¯å¯¹è±¡çš„æ•°æ®ï¼Œä¿è¯æ•°æ®çš„åˆæ³•æ€§ã€‚</li>
</ul>
<p>æ€ä¹ˆå’Œå¤§æ¨¡å‹äº¤äº’ jsonæ˜¯ä»¥ä»€ä¹ˆè§„èŒƒ æ˜¯å¦è®©æœºå™¨æ›´å¥½çš„ç†è§£ï¼Ÿ</p>
<h2 id="å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ"><a href="#å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ"></a><span style="color:blue">å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ</span></h2><h4 id="index-tsx"><a href="#index-tsx" class="headerlink" title="index.tsx"></a><span style = "color:red"><strong>index.tsx</strong></span></h4><p>è·¯å¾„<code>web/src/pages/flow/form/baidu-fanyi-form/index.tsx</code> </p>
<p><code>BaiduFanyiForm</code> æ˜¯ä¸€ä¸ªç”¨äºé…ç½®ç™¾åº¦ç¿»è¯‘ï¼ˆBaidu Fanyiï¼‰æ¥å£å‚æ•°çš„è¡¨å•ç»„ä»¶ã€‚è¯¥ç»„ä»¶åŸºäº Ant Design (<code>antd</code>) çš„ <code>Form</code> ç»„ä»¶ï¼Œå…è®¸ç”¨æˆ·è¾“å…¥ç¿»è¯‘æ‰€éœ€çš„ <strong>AppIDã€å¯†é’¥ã€ç¿»è¯‘ç±»å‹ã€é¢†åŸŸã€æºè¯­è¨€å’Œç›®æ ‡è¯­è¨€</strong>ã€‚</p>
<pre><code class="tsx">// useTranslate(&#39;flow&#39;)ï¼šè‡ªå®šä¹‰ Hookï¼Œæä¾›å›½é™…åŒ–ç¿»è¯‘èƒ½åŠ›
import &#123; useTranslate &#125; from &#39;@/hooks/common-hooks&#39;;
// Form, Input, Selectï¼šAnt Design è¡¨å•ç»„ä»¶
import &#123; Form, Input, Select &#125; from &#39;antd&#39;;
// useMemoï¼šä¼˜åŒ–è®¡ç®—ã€æé«˜æ€§èƒ½ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—
import &#123; useMemo &#125; from &#39;react&#39;;
// ä» constant ä¸­å¼•å…¥ç¿»è¯‘é¢†åŸŸå’Œè¯­è¨€é€‰é¡¹
import &#123;
  BaiduFanyiDomainOptions,
  BaiduFanyiSourceLangOptions,
&#125; from &#39;../../constant&#39;;
// è¡¨å•ç»„ä»¶çš„ç±»å‹å®šä¹‰ï¼ŒåŒ…å« onValuesChange, form, node ç­‰å‚æ•°
import &#123; IOperatorForm &#125; from &#39;../../interface&#39;;
// åŠ¨æ€è¾“å…¥ç»„ä»¶ï¼Œå¯èƒ½ç”¨äºå˜é‡æ›¿æ¢
import DynamicInputVariable from &#39;../components/dynamic-input-variable&#39;;

/*
ç”Ÿæˆ trans_typeï¼ˆç¿»è¯‘ç±»å‹ï¼‰çš„ Select é€‰é¡¹ï¼š
translateï¼šæ™®é€šç¿»è¯‘
fieldtranslateï¼šä¸“ä¸šé¢†åŸŸç¿»è¯‘
é€‰é¡¹çš„ label é€šè¿‡ t() è¿›è¡Œå›½é™…åŒ–ç¿»è¯‘ã€‚
*/
const BaiduFanyiForm = (&#123; onValuesChange, form, node &#125;: IOperatorForm) =&gt; &#123;
  const &#123; t &#125; = useTranslate(&#39;flow&#39;);
  const options = useMemo(() =&gt; &#123;
    return [&#39;translate&#39;, &#39;fieldtranslate&#39;].map((x) =&gt; (&#123;
      value: x,
      label: t(`baiduSecretKeyOptions.$&#123;x&#125;`),
    &#125;));
  &#125;, [t]);
// ç”Ÿæˆ é¢†åŸŸç¿»è¯‘ é€‰é¡¹ï¼ˆå¦‚åŒ»å­¦ã€æ³•å¾‹ç­‰ï¼‰
  const baiduFanyiOptions = useMemo(() =&gt; &#123;
    return BaiduFanyiDomainOptions.map((x) =&gt; (&#123;
      value: x,
      label: t(`baiduDomainOptions.$&#123;x&#125;`),
    &#125;));
  &#125;, [t]);
// æºè¯­è¨€ï¼ˆsource_langï¼‰å’Œ ç›®æ ‡è¯­è¨€ï¼ˆtarget_langï¼‰
  const baiduFanyiSourceLangOptions = useMemo(() =&gt; &#123;
    return BaiduFanyiSourceLangOptions.map((x) =&gt; (&#123;
      value: x,
      label: t(`baiduSourceLangOptions.$&#123;x&#125;`),
    &#125;));
  &#125;, [t]);

  return (
    &lt;Form
      name=&quot;basic&quot; //è¡¨å•åç§°
      autoComplete=&quot;off&quot; //å…³é—­è‡ªåŠ¨å¡«å……
      form=&#123;form&#125; //ç»‘å®š Ant Design è¡¨å•å®ä¾‹ï¼Œå…è®¸åŠ¨æ€è®¾ç½®è¡¨å•å€¼
      onValuesChange=&#123;onValuesChange&#125; //è¡¨å•å€¼å˜æ›´æ—¶è§¦å‘å¤–éƒ¨å›è°ƒ
      layout=&#123;&#39;vertical&#39;&#125;
    &gt;
          &lt;!-- å…è®¸ç”¨æˆ·è¾“å…¥ AppID å’Œ å¯†é’¥ï¼Œç”¨äºèº«ä»½éªŒè¯ --&gt;
      &lt;DynamicInputVariable node=&#123;node&#125;&gt;&lt;/DynamicInputVariable&gt;
      &lt;Form.Item label=&#123;t(&#39;appid&#39;)&#125; name=&#123;&#39;appid&#39;&#125;&gt;
        &lt;Input&gt;&lt;/Input&gt;
      &lt;/Form.Item&gt;
      &lt;Form.Item label=&#123;t(&#39;secretKey&#39;)&#125; name=&#123;&#39;secret_key&#39;&#125;&gt;
        &lt;Input&gt;&lt;/Input&gt;
      &lt;/Form.Item&gt;
          &lt;!-- ç¿»è¯‘ç±»å‹ --&gt;
      &lt;Form.Item label=&#123;t(&#39;transType&#39;)&#125; name=&#123;&#39;trans_type&#39;&#125;&gt;
        &lt;Select options=&#123;options&#125;&gt;&lt;/Select&gt;
      &lt;/Form.Item&gt;
          &lt;!-- é¢†åŸŸç¿»è¯‘ ä»…åœ¨ fieldtranslate é€‰ä¸­æ—¶æ˜¾ç¤º --&gt;
  &lt;!-- dependencies=&#123;[&#39;model_type&#39;]&#125;ï¼šç›‘å¬ model_type å­—æ®µçš„å˜åŒ– --&gt;
      &lt;Form.Item noStyle dependencies=&#123;[&#39;model_type&#39;]&#125;&gt;
        &#123;(&#123; getFieldValue &#125;) =&gt;
          getFieldValue(&#39;trans_type&#39;) === &#39;fieldtranslate&#39; &amp;&amp; (
            &lt;Form.Item label=&#123;t(&#39;domain&#39;)&#125; name=&#123;&#39;domain&#39;&#125;&gt;
              &lt;Select options=&#123;baiduFanyiOptions&#125;&gt;&lt;/Select&gt;
            &lt;/Form.Item&gt;
          )
        &#125;
      &lt;/Form.Item&gt;
      &lt;Form.Item label=&#123;t(&#39;sourceLang&#39;)&#125; name=&#123;&#39;source_lang&#39;&#125;&gt;
        &lt;Select options=&#123;baiduFanyiSourceLangOptions&#125;&gt;&lt;/Select&gt;
      &lt;/Form.Item&gt;
      &lt;Form.Item label=&#123;t(&#39;targetLang&#39;)&#125; name=&#123;&#39;target_lang&#39;&#125;&gt;
        &lt;Select options=&#123;baiduFanyiSourceLangOptions&#125;&gt;&lt;/Select&gt;
      &lt;/Form.Item&gt;
    &lt;/Form&gt;
  );
&#125;;
export default BaiduFanyiForm;
</code></pre>
<p><code>BaiduFanyiForm</code> ç»„ä»¶æ˜¯ç™¾åº¦ç¿»è¯‘ API å‚æ•°çš„å‰ç«¯é…ç½®è¡¨å•ï¼Œæ”¯æŒåŠ¨æ€äº¤äº’ï¼ˆå¦‚ <code>trans_type</code> é€‰æ‹© <code>fieldtranslate</code> æ—¶åŠ¨æ€æ˜¾ç¤º <code>domain</code> é€‰é¡¹ï¼‰ã€‚è¯¥ç»„ä»¶ç”¨äºæŸä¸ªæµç¨‹ï¼ˆflowï¼‰ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·è¾“å…¥ç¿»è¯‘ API ç›¸å…³ä¿¡æ¯ï¼Œå¹¶æä¾› <strong>å›½é™…åŒ–æ”¯æŒ</strong>ï¼ˆ<code>useTranslate()</code>ï¼‰</p>
<hr>
<hr>
<h4 id="init-py"><a href="#init-py" class="headerlink" title="_ _ init _ _.py"></a><span style = "color:red">_ _ init _ _.py</span></h4><p>é¦–å…ˆåœ¨ <code>agent/component/__init__.py</code> åœ¨ç»„ä»¶åŒçº§ç›®å½•ä¸‹æœ‰ä¸€ä¸ª<code>__init__.py</code><br>å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯**<u>å¯¼å…¥å¹¶ç®¡ç†å„ç§ç»„ä»¶</u><strong>ï¼Œè¿™äº›ç»„ä»¶ç”¨äº</strong><u>æ•°æ®å¤„ç†ã€ä¿¡æ¯æ£€ç´¢ã€ç¿»è¯‘ã€SQLæ‰§è¡Œã€è´¢ç»æ•°æ®è·å–</u>ç­‰**ä¸åŒåŠŸèƒ½ã€‚å…¶ä¸­çš„é‡è¦ä»£ç :</p>
<pre><code class="python"># import importlibï¼šç”¨äºåŠ¨æ€å¯¼å…¥æ¨¡å—ï¼ˆåœ¨ component_class æ–¹æ³•ä¸­ä½¿ç”¨ï¼‰
# è¿™äº›ç»„ä»¶åˆ†å¸ƒåœ¨ agent.component æ¨¡å—ä¸‹ï¼Œæä¾›ä¸åŒçš„åŠŸèƒ½

&#39;&#39;&#39;
è¯¥å‡½æ•°ç”¨äºåŠ¨æ€åŠ è½½ç»„ä»¶ï¼Œé€šè¿‡ importlib.import_module(&quot;agent.component&quot;) å¯¼å…¥ agent.component æ¨¡å—ï¼Œç„¶åä½¿ç”¨ getattr(m, class_name) è·å–ç±»ï¼Œä»è€Œè¿”å›å¯¹åº”çš„ç»„ä»¶ç±»ã€‚
&#39;&#39;&#39;
def component_class(class_name):
    m = importlib.import_module(&quot;agent.component&quot;)
    c = getattr(m, class_name)
    return c

&#39;&#39;&#39;
__all__ åˆ—è¡¨ï¼šæŒ‡å®šæ¨¡å—å¯¹å¤–æš´éœ²çš„æ‰€æœ‰ç»„ä»¶
ä½¿å…¶æˆä¸º from module import * æ—¶å¯ä»¥è¢«è®¿é—®çš„å¯¹è±¡ã€‚
&#39;&#39;&#39;
__all__ = [
    &quot;GitHub&quot;,
    &quot;GitHubParam&quot;,
    &quot;BaiduFanyi&quot;,
    &quot;BaiduFanyiParam&quot;,
]
</code></pre>
<h4 id="web-x2F-src-x2F-pages-x2F-flow-x2F-flow-drawer-x2F-index-tsx"><a href="#web-x2F-src-x2F-pages-x2F-flow-x2F-flow-drawer-x2F-index-tsx" class="headerlink" title="web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsx"></a><span style = "color:red">web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsx</span></h4><p>åœ¨<code>web/src/pages/flow/flow-drawer/index.tsx</code>é‡Œæœ‰è¿™æ ·ä¸€è¡Œä»£ç <br><code>import BaiduFanyiForm from &#39;../form/baidu-fanyi-form&#39;;</code><br>è¯¥æ–‡ä»¶ <code>index.tsx</code> ä¸»è¦ç”¨äº**è¡¨å•æŠ½å±‰ç»„ä»¶ (<code>FormDrawer</code>)**ï¼Œç”¨äºåœ¨ UI ä¸­å±•ç¤ºä¸åŒæ“ä½œèŠ‚ç‚¹çš„è¡¨å•ï¼Œå¹¶æ”¯æŒç¼–è¾‘ã€è°ƒè¯•ç­‰åŠŸèƒ½ã€‚</p>
<h5 id="ä»£ç åŠŸèƒ½æ¦‚è§ˆ"><a href="#ä»£ç åŠŸèƒ½æ¦‚è§ˆ" class="headerlink" title="ä»£ç åŠŸèƒ½æ¦‚è§ˆ"></a><strong>ä»£ç åŠŸèƒ½æ¦‚è§ˆ</strong></h5><p> ğŸ”¹ <strong>åŠ¨æ€æ¸²æŸ“ä¸åŒçš„è¡¨å•ç»„ä»¶</strong>ï¼ˆ<code>BaiduFanyiForm</code> ç­‰ï¼‰<br> ğŸ”¹ <strong>æ”¯æŒä¸åŒç±»å‹çš„æ“ä½œèŠ‚ç‚¹ï¼ˆOperatorï¼‰</strong>ï¼ˆå¦‚ <code>BaiduFanyi</code>, <code>Google</code>, <code>Generate</code> ç­‰ï¼‰<br> ğŸ”¹ <strong>æä¾›è¡¨å•è¾“å…¥äº¤äº’ï¼Œå¹¶æ”¯æŒå•æ­¥è°ƒè¯•</strong><br> ğŸ”¹ <strong>ä½¿ç”¨ <code>Drawer</code> ç»„ä»¶ä½œä¸ºä¾§è¾¹æ å¼¹å‡ºçª—å£</strong></p>
<h4 id="â˜…-ç»„ä»¶å¯¼å…¥"><a href="#â˜…-ç»„ä»¶å¯¼å…¥" class="headerlink" title="â˜… ç»„ä»¶å¯¼å…¥"></a>â˜… ç»„ä»¶å¯¼å…¥</h4><pre><code class="python">import &#123; Drawer, Flex, Form, Input &#125; from &#39;antd&#39;;
import &#123; get, isPlainObject, lowerFirst &#125; from &#39;lodash&#39;;
import &#123; Play &#125; from &#39;lucide-react&#39;;
import &#123; CloseOutlined &#125; from &#39;@ant-design/icons&#39;;
...
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼šå¼•å…¥ <strong>Ant Design</strong> ç»„ä»¶ï¼ˆ<code>Drawer</code>ã€<code>Form</code>ã€<code>Input</code>ï¼‰ã€<code>lodash</code> å·¥å…·åº“ä»¥åŠ <code>Play</code>ï¼ˆè°ƒè¯•æŒ‰é’®ï¼‰ã€<code>CloseOutlined</code>ï¼ˆå…³é—­æŒ‰é’®ï¼‰ã€‚</p>
<h4 id="â˜…-å¼•å…¥è¡¨å•ç»„ä»¶"><a href="#â˜…-å¼•å…¥è¡¨å•ç»„ä»¶" class="headerlink" title="â˜… å¼•å…¥è¡¨å•ç»„ä»¶"></a>â˜… å¼•å…¥è¡¨å•ç»„ä»¶</h4><pre><code class="python"># å½“ç„¶ä¸èƒ½å¿˜äº†æˆ‘ä»¬çš„ç™¾åº¦ç¿»è¯‘
import BaiduFanyiForm from &#39;../form/baidu-fanyi-form&#39;;
import GoogleForm from &#39;../form/google-form&#39;;
import GenerateForm from &#39;../form/generate-form&#39;;
import RetrievalForm from &#39;../form/retrieval-form&#39;;
...
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼šå¼•å…¥ <code>BaiduFanyiForm</code> ç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºç™¾åº¦ç¿»è¯‘çš„è¡¨å•äº¤äº’ã€‚</p>
<p>âœ… è¿™äº›è¡¨å•ç»„ä»¶ç”¨äºä¸åŒçš„ <code>Operator</code> æ“ä½œï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>BaiduFanyiForm</code> â†’ <strong>ç™¾åº¦ç¿»è¯‘è¡¨å•</strong></li>
<li><code>GoogleForm</code> â†’ <strong>Google æœç´¢è¡¨å•</strong></li>
<li><code>GenerateForm</code> â†’ <strong>æ–‡æœ¬ç”Ÿæˆè¡¨å•</strong></li>
<li><code>RetrievalForm</code> â†’ <strong>ä¿¡æ¯æ£€ç´¢è¡¨å•</strong></li>
</ul>
<h4 id="â˜…-FormMap-æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„"><a href="#â˜…-FormMap-æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„" class="headerlink" title="â˜… FormMap(æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„)"></a>â˜… FormMap(æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„)</h4><pre><code class="python">const FormMap = &#123;
  [Operator.BaiduFanyi]: BaiduFanyiForm,
  [Operator.Google]: GoogleForm,
  [Operator.Generate]: GenerateForm,
  [Operator.Retrieval]: RetrievalForm,
&#125;;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š<br> âœ… <strong>åŠ¨æ€åŒ¹é…</strong> <code>Operator</code>ï¼ˆæ“ä½œç±»å‹ï¼‰ä¸ <strong>å¯¹åº”è¡¨å•ç»„ä»¶</strong><br> âœ… <strong>å½“ <code>Operator</code> ä¸º <code>BaiduFanyi</code> æ—¶ï¼Œæ¸²æŸ“ <code>BaiduFanyiForm</code></strong><br> âœ… <strong>å¯ä»¥æ‰©å±•ä¸åŒçš„è¡¨å•ç±»å‹</strong></p>
<h4 id="â˜†-FormDrawerç»„ä»¶"><a href="#â˜†-FormDrawerç»„ä»¶" class="headerlink" title="â˜† FormDrawerç»„ä»¶"></a>â˜† FormDrawerç»„ä»¶</h4><pre><code class="python">const FormDrawer = (&#123; visible, hideModal, node, singleDebugDrawerVisible, hideSingleDebugDrawer, showSingleDebugDrawer &#125;: IModalProps&lt;any&gt; &amp; IProps) =&gt; &#123;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š<code>FormDrawer</code> æ˜¯ä¸€ä¸ª <strong>è¡¨å•æŠ½å±‰ç»„ä»¶</strong>ï¼Œç”¨äºå±•ç¤ºä¸åŒç±»å‹çš„è¡¨å•ã€‚</p>
<h4 id="â˜†-åŠ¨æ€æ¸²æŸ“è¡¨å•"><a href="#â˜†-åŠ¨æ€æ¸²æŸ“è¡¨å•" class="headerlink" title="â˜† åŠ¨æ€æ¸²æŸ“è¡¨å•"></a>â˜† åŠ¨æ€æ¸²æŸ“è¡¨å•</h4><pre><code class="python">const OperatorForm = FormMap[operatorName] ?? EmptyContent;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š âœ… <strong>æ ¹æ® <code>Operator</code>ï¼ˆæ“ä½œç±»å‹ï¼‰é€‰æ‹©å¯¹åº”çš„è¡¨å•ç»„ä»¶</strong><br> âœ… å¦‚æœ <code>Operator</code> ä¸åœ¨ <code>FormMap</code> ä¸­ï¼Œåˆ™æ˜¾ç¤º <code>EmptyContent</code>ï¼ˆç©ºç»„ä»¶ï¼‰</p>
<h4 id="â˜†-å¤„ç†è¡¨å•æ•°æ®"><a href="#â˜†-å¤„ç†è¡¨å•æ•°æ®" class="headerlink" title="â˜† å¤„ç†è¡¨å•æ•°æ®"></a>â˜† å¤„ç†è¡¨å•æ•°æ®</h4><pre><code class="python">useEffect(() =&gt; &#123;
  if (visible) &#123;
    form.resetFields();
    form.setFieldsValue(node?.data?.form);
  &#125;
&#125;, [visible, form, node?.data?.form]);
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š âœ… <strong>å½“æŠ½å±‰å¯è§æ—¶ï¼Œé‡ç½®è¡¨å•å¹¶å¡«å……æ•°æ®</strong><br> âœ… <strong>å¦‚æœ <code>Operator</code> æ˜¯ <code>Categorize</code>ï¼Œåˆ™ç‰¹æ®Šå¤„ç†åˆ†ç±»æ•°æ®</strong></p>
<h4 id="â˜†-ä¾§è¾¹æ -Drawer"><a href="#â˜†-ä¾§è¾¹æ -Drawer" class="headerlink" title="â˜† ä¾§è¾¹æ  (Drawer)"></a>â˜† ä¾§è¾¹æ  (<code>Drawer</code>)</h4><pre><code class="python">&lt;Drawer
  title=&#123;
    &lt;Flex&gt;
      &lt;OperatorIcon name=&#123;operatorName&#125; /&gt;
      &lt;Input value=&#123;name&#125; onChange=&#123;handleNameChange&#125; /&gt;
      &lt;Play onClick=&#123;showSingleDebugDrawer&#125; /&gt;
      &lt;CloseOutlined onClick=&#123;hideModal&#125; /&gt;
    &lt;/Flex&gt;
  &#125;
  open=&#123;visible&#125;
&gt;
  &lt;OperatorForm onValuesChange=&#123;handleValuesChange&#125; form=&#123;form&#125; node=&#123;node&#125; /&gt;
&lt;/Drawer&gt;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š âœ… <strong>æ ‡é¢˜åŒºåŸŸåŒ…å«æ“ä½œå›¾æ ‡ã€è¾“å…¥æ¡†ã€è°ƒè¯•æŒ‰é’®ã€å…³é—­æŒ‰é’®</strong><br> âœ… <strong>ä½¿ç”¨ <code>OperatorForm</code> ç»„ä»¶æ¸²æŸ“è¡¨å•</strong><br> âœ… <strong>ç‚¹å‡» <code>Play</code> æŒ‰é’®æ‰“å¼€è°ƒè¯•æ¨¡å¼</strong></p>
<hr>
<p>â˜… â˜… <u>æ€»ç»“ä¸€ä¸‹<code>BaiduFanyiForm</code>ç›¸å…³é€»è¾‘</u> â˜… â˜…<br>åœ¨ <code>index.tsx</code> é‡Œï¼Œ<code>BaiduFanyiForm</code> è¢«æ³¨å†Œåˆ° <code>FormMap</code>ï¼Œç„¶åé€šè¿‡ <code>FormDrawer</code> ç»„ä»¶</p>
<p>ğŸš€ <strong>å¦‚ä½•æ¸²æŸ“ <code>BaiduFanyiForm</code>ï¼Ÿ</strong></p>
<ol>
<li><code>Operator.BaiduFanyi</code> è§¦å‘ <code>BaiduFanyiForm</code></li>
<li><code>FormDrawer</code> ç»„ä»¶åŠ¨æ€åŒ¹é… <code>FormMap[Operator.BaiduFanyi]</code></li>
<li><code>BaiduFanyiForm</code> æ¸²æŸ“åœ¨ <code>Drawer</code> ä¸­</li>
</ol>
<p>ğŸ“Œ <strong>ç»“è®º</strong>ï¼š âœ… <strong><code>BaiduFanyiForm</code> åªæ˜¯ä¼—å¤šè¡¨å•ç»„ä»¶ä¹‹ä¸€ï¼Œä¸“é—¨ç”¨äºç™¾åº¦ç¿»è¯‘çš„åŠŸèƒ½</strong><br> âœ… <strong><code>index.tsx</code> ä¸»è¦æ˜¯è¡¨å•çš„åŠ¨æ€åŠ è½½å™¨ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰ <code>Operator</code> ç±»å‹</strong><br> âœ… <strong><code>FormDrawer</code> è´Ÿè´£ UI æ¸²æŸ“ã€æ•°æ®å¡«å……ã€è°ƒè¯•äº¤äº’ç­‰</strong></p>
<hr>
<p>â‘  <span style = "color:red">agent&#x2F;component&#x2F;baidufanyi.py</span> ã€åç«¯ä»£ç ã€‘<br>â‘¡ <span style = "color:red">agent&#x2F;component&#x2F;_ _ init _ _.py</span>  ã€åˆå§‹åŒ–ã€‘<br>â‘¢ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsxã€è¡¨å•æŠ½å±‰ç»„ä»¶ UIå±•ç¤ºã€‘<br>â‘£ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;form&#x2F;baidu-fanyi-form&#x2F;index.tsx ã€æä¾›ç”¨æˆ·ç•Œé¢è®©ç”¨æˆ·èƒ½é…ç½®å¹¶æäº¤å‚æ•°ã€‘<br>â‘¤ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;constant.tsx ã€å®šä¹‰ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å„ç§å›¾æ ‡ã€å¸¸é‡ã€æšä¸¾ã€æ¥å£ã€çŠ¶æ€å’Œå‡½æ•°ã€‘<br>â‘¥ web&#x2F;src&#x2F;locales&#x2F;zh.ts ã€æŠŠæ‰€æœ‰è¦æ˜¾ç¤ºçš„æåˆ°zh.tsä¸­(å‰ç«¯ç»„ä»¶æè¿°)ã€‘<br>â‘¦ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;constant.tsxã€å¼•å…¥ç»„ä»¶æ‰€éœ€çš„å„ç§å›¾æ ‡ã€ä»¥åŠæ“ä½œé¡¹çš„æ ·å¼ã€åˆå§‹å€¼ã€è¯­è¨€ç­‰ã€‘<br>â‘§ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;form-sheet&#x2F;use-form-config-map.tsx ã€è¡¨å•é…ç½®æ˜ å°„ã€é…ç½®ä¸åŒæ“ä½œå¯¹åº”è¡¨å•ç»„ä»¶ã€‘<br>â‘¨ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;form&#x2F;baidu-fanyi-form&#x2F;index.tsx ã€æ„å»ºé…ç½®è¡¨å• ã€‘<br>â‘© web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;hooks.tsx ã€ç®¡ç†å›¾å½¢ç•Œé¢æµç¨‹å›¾ å„ç§é’©å­ â†’ å»ºæ•°æ®å¤„ç†æµç¨‹ã€‘</p>
<hr>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/ddce11cf6c74dc31448ce098d9509fc9e2cbc2e2/RAGFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%9B%E5%BB%BA%E4%BB%A3%E7%90%86%E7%BB%84%E4%BB%B6%E6%B5%81%E7%A8%8B.jpg"></p>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#ffa2c4>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/03/07/AI/RAGFlowå·¥å…·æŠ€æœ¯æ–‡æ¡£/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/03/05/AI/RAGFlow/">
        <h2>
            RAGFlow
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/3/5
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h3 id="ä»€ä¹ˆæ˜¯RAGFlow"><a href="#ä»€ä¹ˆæ˜¯RAGFlow" class="headerlink" title="ä»€ä¹ˆæ˜¯RAGFlow"></a>ä»€ä¹ˆæ˜¯RAGFlow</h3><p>RAGFlow æ˜¯ä¸€ç§åŸºäºç”Ÿæˆæ¨¡å‹çš„æŠ€æœ¯ï¼Œå¸¸ç”¨äºæ™ºèƒ½èŠå¤©ç³»ç»Ÿã€æ¨èç³»ç»Ÿå’Œè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ã€‚å¦‚æœä½ æ˜¯ä»é›¶åŸºç¡€å¼€å§‹å­¦ä¹  RAGFlowï¼ˆå¯èƒ½æŒ‡çš„æ˜¯ <strong>Retrieval-Augmented Generation Flow</strong> æˆ–ä¸å…¶ç›¸å…³çš„æ¨¡å‹&#x2F;æ¡†æ¶ï¼‰ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ¨èçš„å­¦ä¹ è·¯å¾„ï¼š</p>
<h5 id="1-ç†è§£åŸºç¡€æ¦‚å¿µ"><a href="#1-ç†è§£åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1. ç†è§£åŸºç¡€æ¦‚å¿µ"></a><strong>1. ç†è§£åŸºç¡€æ¦‚å¿µ</strong></h5><p>åœ¨å­¦ä¹  RAGFlow ä¹‹å‰ï¼Œä½ éœ€è¦äº†è§£ä¸€äº›ç›¸å…³çš„åŸºæœ¬æ¦‚å¿µï¼š</p>
<ul>
<li><strong>è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰</strong>ï¼šå­¦ä¹  NLP çš„åŸºæœ¬æ¦‚å¿µï¼Œæ¯”å¦‚åˆ†è¯ã€è¯å‘é‡ï¼ˆWord Embeddingï¼‰ã€åºåˆ—å»ºæ¨¡ç­‰ã€‚</li>
<li><strong>æœºå™¨å­¦ä¹ åŸºç¡€</strong>ï¼šäº†è§£æœºå™¨å­¦ä¹ çš„åŸºæœ¬åŸç†ï¼ŒåŒ…æ‹¬ç›‘ç£å­¦ä¹ ã€æ— ç›‘ç£å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ç­‰ã€‚</li>
<li><strong>æ·±åº¦å­¦ä¹ æ¡†æ¶</strong>ï¼šç†Ÿæ‚‰ä¸€äº›å¸¸ç”¨çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå¦‚ TensorFlow å’Œ PyTorchï¼Œå®ƒä»¬ä¼šåœ¨è®­ç»ƒå’Œå®ç° RAGFlow æ¨¡å‹æ—¶ç”¨åˆ°ã€‚</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://github.com/infiniflow/ragflow/blob/main/README_zh.md">ragflow&#x2F;README_zh.md at main Â· infiniflow&#x2F;ragflow</a></p>
<h6 id="å…ˆè£…ä¸ªwinç‰ˆçš„Docker-Desktop"><a href="#å…ˆè£…ä¸ªwinç‰ˆçš„Docker-Desktop" class="headerlink" title="å…ˆè£…ä¸ªwinç‰ˆçš„Docker Desktop"></a>å…ˆè£…ä¸ªwinç‰ˆçš„Docker Desktop</h6><h6 id="æ‰“å¼€-Anaconda-Prompt-å…ˆæ”¾ç€ä¸ç®¡"><a href="#æ‰“å¼€-Anaconda-Prompt-å…ˆæ”¾ç€ä¸ç®¡" class="headerlink" title="æ‰“å¼€ Anaconda Prompt å…ˆæ”¾ç€ä¸ç®¡"></a>æ‰“å¼€ Anaconda Prompt å…ˆæ”¾ç€ä¸ç®¡</h6><p>å…‹éš† <strong>RAGFlow</strong> çš„ä»“åº“ <code>$ git clone https://github.com/infiniflow/ragflow.git</code></p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” â˜… â˜… â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>åœ¨<strong>Anaconda Prompt</strong>çš„å‘½ä»¤çª—å£é‡Œ<br>è¾“å…¥ <code>cd E:\Python\ragflow\docker</code><br>æ¥ç€ <code>E:</code><br>ç„¶åå°±å¼€å§‹ <u><strong>è£…è½½</strong></u>      <u><strong>æŸ¥çœ‹çŠ¶æ€</strong></u></p>
<p><span style = "color:red"><strong>å…³é—­</strong></span>            <code>docker-compose down</code><br><span style = "color:red"><strong>è£…è½½</strong></span>            <code>docker compose up -d</code><br><span style = "color:red"><strong>æŸ¥çœ‹çŠ¶æ€</strong></span>    <code>docker logs -f ragflow-server</code><br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” â˜… â˜… â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<blockquote>
<p>åœ¨ä½ çš„ <code>docker-compose.yml</code> é…ç½®ä¸­ï¼ŒRedis çš„è¿æ¥é—®é¢˜å¯èƒ½æ˜¯å› ä¸º RAGFlow é…ç½®æ–‡ä»¶ä¸­çš„ Redis éƒ¨åˆ†ä½¿ç”¨äº†å¯†ç ï¼Œå¹¶ä¸” Redis è¿è¡Œåœ¨ <code>localhost</code> ä¸Šã€‚å¦‚æœ Redis æ²¡æœ‰è®¾ç½®å¯†ç ä¸”ç«¯å£å·æ˜¯ <code>localhost</code>ï¼Œä½ å¯ä»¥å°è¯•ä»¥ä¸‹æ­¥éª¤è¿›è¡Œè°ƒæ•´ï¼š</p>
<ol>
<li><p><strong>ä¿®æ”¹ RAGFlow çš„é…ç½®</strong>ï¼šåœ¨ <code>ragflow</code> æœåŠ¡çš„é…ç½®ä¸­ï¼Œç¡®ä¿ Redis çš„è¿æ¥ä¿¡æ¯æ­£ç¡®ã€‚éœ€è¦ç¡®ä¿ Redis è¿æ¥æ—¶ä¸ä½¿ç”¨å¯†ç å¹¶ä¸”è¿æ¥åˆ° <code>localhost</code>ã€‚</p>
</li>
<li><p><strong>æ›´æ–° <code>service_conf.yaml</code> é…ç½®</strong>ï¼šæ ¹æ®æ—¥å¿—ï¼ŒRAGFlow è¿æ¥ Redis æ—¶ä½¿ç”¨äº†å¯†ç ã€‚ä½ éœ€è¦æ£€æŸ¥ <code>service_conf.yaml</code> ä¸­çš„ Redis é…ç½®ä¿¡æ¯ï¼Œå°†å…¶ä¿®æ”¹ä¸ºä¸ä½¿ç”¨å¯†ç ï¼Œå¹¶æŒ‡å®š <code>localhost</code>ã€‚</p>
<p>ç¤ºä¾‹ä¿®æ”¹ï¼š</p>
<pre><code class="python">  host: localhost
  port: 6379
  db: 1
  password: &quot;&quot;
</code></pre>
</li>
<li><p><strong>æ£€æŸ¥ <code>docker-compose.yml</code> é…ç½®</strong>ï¼šç¡®ä¿ <code>ragflow</code> æœåŠ¡çš„ Redis éƒ¨åˆ†æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œä¸”è¿æ¥ç«¯å£æ˜¯ <code>localhost</code>ã€‚æ ¹æ®ä½ çš„é…ç½®ï¼Œé»˜è®¤æƒ…å†µä¸‹åº”è¯¥æ˜¯æ²¡æœ‰å¯†ç çš„ã€‚</p>
</li>
<li><p><strong>é‡æ–°å¯åŠ¨æœåŠ¡</strong>ï¼šåœ¨ä¿®æ”¹é…ç½®åï¼Œå¯ä»¥é‡æ–°å¯åŠ¨ Docker æœåŠ¡ä»¥ä½¿ä¿®æ”¹ç”Ÿæ•ˆã€‚</p>
<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="python">docker-compose down
docker-compose up -d
</code></pre>
</li>
</ol>
<p>è¿™æ ·ï¼Œä½ åº”è¯¥èƒ½å¤Ÿè§£å†³ Redis è¿æ¥çš„ç›¸å…³é—®é¢˜ã€‚å¦‚æœè¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·ç»§ç»­æä¾›æ—¥å¿—æˆ–è¯¦ç»†ä¿¡æ¯ã€‚</p>
</blockquote>
<h6 id="å¦‚æœæ”¹äº†é…ç½®è¿˜æ˜¯ä¸è¡Œ-â†“"><a href="#å¦‚æœæ”¹äº†é…ç½®è¿˜æ˜¯ä¸è¡Œ-â†“" class="headerlink" title="å¦‚æœæ”¹äº†é…ç½®è¿˜æ˜¯ä¸è¡Œ â†“"></a>å¦‚æœæ”¹äº†é…ç½®è¿˜æ˜¯ä¸è¡Œ â†“</h6><blockquote>
<h3 id="æ£€æŸ¥ä¸è§£å†³æ­¥éª¤"><a href="#æ£€æŸ¥ä¸è§£å†³æ­¥éª¤" class="headerlink" title="æ£€æŸ¥ä¸è§£å†³æ­¥éª¤"></a><strong>æ£€æŸ¥ä¸è§£å†³æ­¥éª¤</strong></h3><h4 id="1-ç¡®ä¿-service-conf-yaml-å·²æ­£ç¡®ä¿®æ”¹"><a href="#1-ç¡®ä¿-service-conf-yaml-å·²æ­£ç¡®ä¿®æ”¹" class="headerlink" title="1. ç¡®ä¿ service_conf.yaml å·²æ­£ç¡®ä¿®æ”¹"></a><strong>1. ç¡®ä¿ <code>service_conf.yaml</code> å·²æ­£ç¡®ä¿®æ”¹</strong></h4><p>ä½ å¯ä»¥è¿›å…¥ RAGFlow å®¹å™¨ï¼ŒæŸ¥çœ‹ RAGFlow è¯»å–çš„é…ç½®æ˜¯å¦æ­£ç¡®ï¼š</p>
<pre><code class="python">docker exec -it ragflow-server cat /ragflow/conf/service_conf.yaml
</code></pre>
<p>æ£€æŸ¥ <code>redis</code> é…ç½®é¡¹æ˜¯å¦æ˜¯ï¼š</p>
<pre><code class="python">  redis:
  host: ragflow-redis  
  port: 6379
  db: 1
  password: &quot;&quot;  
</code></pre>
<p>å¦‚æœä¸æ˜¯ï¼Œè¯´æ˜ <code>docker-compose</code> å¯èƒ½ä»ç„¶ä½¿ç”¨äº†æ—§çš„é…ç½®ï¼Œä½ éœ€è¦æ‰‹åŠ¨æ›´æ–°ã€‚</p>
</blockquote>
<blockquote>
<h4 id="1-ç¡®ä¿-service-conf-yaml-ç»‘å®šåˆ°äº†å®¹å™¨"><a href="#1-ç¡®ä¿-service-conf-yaml-ç»‘å®šåˆ°äº†å®¹å™¨" class="headerlink" title="1. ç¡®ä¿ service_conf.yaml ç»‘å®šåˆ°äº†å®¹å™¨"></a><strong>1. ç¡®ä¿ <code>service_conf.yaml</code> ç»‘å®šåˆ°äº†å®¹å™¨</strong></h4><p><strong>æ£€æŸ¥ <code>docker-compose.yml</code> æ˜¯å¦æ­£ç¡®æŒ‚è½½ <code>service_conf.yaml</code></strong><br>åœ¨ <code>docker-compose.yml</code> é‡Œåº”è¯¥æœ‰ï¼š</p>
<pre><code class="python">yamlå¤åˆ¶ç¼–è¾‘volumes:
  - ./service_conf.yaml:/ragflow/conf/service_conf.yaml
</code></pre>
<p>å¦‚æœæ²¡æœ‰è¿™è¡Œï¼Œè¯´æ˜ <code>service_conf.yaml</code> æ²¡æœ‰æ­£ç¡®æŒ‚è½½ï¼Œå¯¼è‡´ RAGFlow ä»ç„¶ä½¿ç”¨å®¹å™¨å†…éƒ¨çš„é»˜è®¤é…ç½®ã€‚</p>
<p>å¦‚æœä½ ä¿®æ”¹äº† <code>docker-compose.yml</code>ï¼Œè¯·æ‰§è¡Œï¼š</p>
<pre><code class="python">docker-compose down
docker-compose up -d
</code></pre>
<p>ç„¶å <strong>é‡æ–°æ£€æŸ¥</strong> å®¹å™¨å†…çš„ <code>service_conf.yaml</code> æ˜¯å¦æ­£ç¡®ï¼š</p>
<pre><code class="python">docker exec -it ragflow-server cat /ragflow/conf/service_conf.yaml
</code></pre>
</blockquote>
<hr>
<p>ä½ éœ€è¦åœ¨è¯·æ±‚ä¸­æä¾›æ­£ç¡®çš„å‡­è¯ã€‚æ ¹æ®ä¹‹å‰ä½ æä¾›çš„è´¦å·å¯†ç  <code>elastic:infini_rag_flow</code>ï¼Œä½ å¯ä»¥å°è¯•ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="python">docker exec -it 3a50f571ce26 curl -u elastic:infini_rag_flow http://localhost:9200
</code></pre>
<hr>
<h3 id="å…³äºRAGFlowçš„é¡¶çº§é€†å¤©Bugè§£å†³åŠæ³•-gt"><a href="#å…³äºRAGFlowçš„é¡¶çº§é€†å¤©Bugè§£å†³åŠæ³•-gt" class="headerlink" title="å…³äºRAGFlowçš„é¡¶çº§é€†å¤©Bugè§£å†³åŠæ³•&gt;"></a><span style="color:red">å…³äºRAGFlowçš„é¡¶çº§é€†å¤©Bugè§£å†³åŠæ³•</span>&gt;</h3><blockquote>
<p>è¿™ä¸ªä¸æ˜¯BUGï¼Œæ˜¯ä½¿ç”¨é—®é¢˜ï¼Œå¦‚æœä½ æ˜¯å¦‚ä¸‹å’Œæˆ‘ä¸€æ ·çš„æŠ¥é”™ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„è§£å†³æ­¥éª¤<br>æ˜¯ä½¿ç”¨é—®é¢˜ï¼Œæˆ‘è¿™è¾¹å®Œç¾è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œè§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š<br>é—®é¢˜: docker logs -f 917c48df8473(infiniflow&#x2F;ragflow:v0.16.0çš„å®¹å™¨æ—¥å¿—)<br>peewee.OperationalError: (1045, â€œAccess denied for user â€˜rootâ€˜@â€™172.24.0.6â€™ (using password: YES)â€)</p>
<h1 id="é—®é¢˜åŸå› ï¼Œè¿™ä¸ªé•œåƒçš„mysqlå¯†ç ä¸€è‡´æ˜¯é»˜è®¤å¯†ç ï¼Œåªè¦é…ç½®æ²¡æ”¹å…¨å°±ä¼šæŠ¥é”™"><a href="#é—®é¢˜åŸå› ï¼Œè¿™ä¸ªé•œåƒçš„mysqlå¯†ç ä¸€è‡´æ˜¯é»˜è®¤å¯†ç ï¼Œåªè¦é…ç½®æ²¡æ”¹å…¨å°±ä¼šæŠ¥é”™" class="headerlink" title="é—®é¢˜åŸå› ï¼Œè¿™ä¸ªé•œåƒçš„mysqlå¯†ç ä¸€è‡´æ˜¯é»˜è®¤å¯†ç ï¼Œåªè¦é…ç½®æ²¡æ”¹å…¨å°±ä¼šæŠ¥é”™"></a>é—®é¢˜åŸå› ï¼Œè¿™ä¸ªé•œåƒçš„mysqlå¯†ç ä¸€è‡´æ˜¯é»˜è®¤å¯†ç ï¼Œåªè¦é…ç½®æ²¡æ”¹å…¨å°±ä¼šæŠ¥é”™</h1><h5 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•:"></a>è§£å†³åŠæ³•:</h5><ol>
<li>åœæ­¢å¹¶ç§»é™¤ç°æœ‰å®¹å™¨<br>cd .&#x2F;docker<br>docker compose -f docker-compose.yml down</li>
<li>åˆ é™¤æˆ–å¤‡ä»½æ•°æ®å·<br>å¤‡ä»½å‘½ä»¤ï¼š<br>cp -r &#x2F;home&#x2F;data&#x2F;docker&#x2F;volumes&#x2F;docker_esdata01 &#x2F;backup&#x2F;docker_esdata01_backup<br>cp -r &#x2F;home&#x2F;data&#x2F;docker&#x2F;volumes&#x2F;docker_minio_data &#x2F;backup&#x2F;docker_minio_data_backup<br>cp -r &#x2F;home&#x2F;data&#x2F;docker&#x2F;volumes&#x2F;docker_mysql_data &#x2F;backup&#x2F;docker_mysql_data_backup<br>cp -r &#x2F;home&#x2F;data&#x2F;docker&#x2F;volumes&#x2F;docker_redis_data &#x2F;backup&#x2F;docker_redis_data_backup<br>åˆ é™¤å‘½ä»¤ï¼š<br>docker volume rm docker_esdata01<br>docker volume rm docker_minio_data<br>docker volume rm docker_mysql_data<br>docker volume rm docker_redis_data</li>
<li>åˆ é™¤æœªä½¿ç”¨çš„ç½‘ç»œé…ç½®<br>docker network prune</li>
<li>ä¿®æ”¹docker&#x2F;.env ã€ docker&#x2F;service_conf.yaml.templateå’Œconf&#x2F;service_conf.yaml è¿™ä¸‰ä¸ªæ–‡ä»¶<br>ä¸­æ‰€æœ‰çš„å¯†ç ï¼Œè®¾ç½®æˆè‡ªå·±çš„ï¼ŒåŠ¡å¿…è¿™ä¸‰å¤„éƒ½ä¿æŒä¸€è‡´ï¼ˆé‡è¦ï¼‰</li>
<li>é‡æ–°å¯åŠ¨æœåŠ¡<br>cd .&#x2F;docker<br>[root@localhost docker]# docker compose -f docker-compose.yml up -d<br>WARN[0000] The â€œHF_ENDPOINTâ€ variable is not set. Defaulting to a blank string.<br>WARN[0000] The â€œMACOSâ€ variable is not set. Defaulting to a blank string.<br>[+] Running 10&#x2F;10<br>âœ” Network docker_ragflow Created 0.0s<br>âœ” Volume â€œdocker_esdata01â€ Created 0.0s<br>âœ” Volume â€œdocker_mysql_dataâ€ Created 0.0s<br>âœ” Volume â€œdocker_minio_dataâ€ Created 0.0s<br>âœ” Volume â€œdocker_redis_dataâ€ Created 0.0s<br>âœ” Container ragflow-minio Started 0.4s<br>âœ” Container ragflow-es-01 Started 0.4s<br>âœ” Container ragflow-redis Started 0.4s<br>âœ” Container ragflow-mysql Healthy 10.9s<br>âœ” Container ragflow-server Started 11.1s</li>
</ol>
<h1 id="6-æŸ¥çœ‹æ—¥å¿—çœ‹çœ‹ï¼Œæ²¡æœ‰å¦‚ä¸‹æŠ¥é”™äº†ï¼š"><a href="#6-æŸ¥çœ‹æ—¥å¿—çœ‹çœ‹ï¼Œæ²¡æœ‰å¦‚ä¸‹æŠ¥é”™äº†ï¼š" class="headerlink" title="6.æŸ¥çœ‹æ—¥å¿—çœ‹çœ‹ï¼Œæ²¡æœ‰å¦‚ä¸‹æŠ¥é”™äº†ï¼š"></a>6.æŸ¥çœ‹æ—¥å¿—çœ‹çœ‹ï¼Œæ²¡æœ‰å¦‚ä¸‹æŠ¥é”™äº†ï¼š</h1><p>2025-02-26 10:51:53,554 INFO 20 TaskExecutor: RAGFlow version: v0.16.0 full<br>2025-02-26 10:51:53,554 INFO 20 Use Elasticsearch <a target="_blank" rel="noopener" href="http://es01:9200/">http://es01:9200</a> as the doc engine.<br>2025-02-26 10:51:53,563 INFO 20 GET <a target="_blank" rel="noopener" href="http://es01:9200/">http://es01:9200/</a> [status:200 duration:0.007s]<br>2025-02-26 10:51:53,566 INFO 20 HEAD <a target="_blank" rel="noopener" href="http://es01:9200/">http://es01:9200/</a> [status:200 duration:0.003s]<br>2025-02-26 10:51:53,566 INFO 20 Elasticsearch <a target="_blank" rel="noopener" href="http://es01:9200/">http://es01:9200</a> is healthy.<br>2025-02-26 10:51:53,572 WARNING 20 Load term.freq FAIL!<br>2025-02-26 10:51:53,577 WARNING 20 Realtime synonym is disabled, since no redis connection.<br>2025-02-26 10:51:53,583 WARNING 20 Load term.freq FAIL!<br>2025-02-26 10:51:53,588 WARNING 20 Realtime synonym is disabled, since no redis connection.<br>2025-02-26 10:51:53,588 INFO 20 MAX_CONTENT_LENGTH: 134217728<br>2025-02-26 10:51:53,588 INFO 20 SERVER_QUEUE_MAX_LEN: 1024<br>2025-02-26 10:51:53,588 INFO 20 SERVER_QUEUE_RETENTION: 3600<br>2025-02-26 10:51:53,588 INFO 20 MAX_FILE_COUNT_PER_USER: 0<br>2025-02-26 10:51:53,591 WARNING 20 RedisDB.queue_info rag_flow_svr_queue got exception: no such key<br>2025-02-26 10:51:53,592 INFO 20 task_consumer_0 reported heartbeat: {â€œnameâ€: â€œtask_consumer_0â€, â€œnowâ€: â€œ2025-02-26T10:51:53.591+08:00â€, â€œboot_atâ€: â€œ2025-02-26T10:51:53.554+08:00â€, â€œpendingâ€: 0, â€œlagâ€: 0, â€œdoneâ€: 0, â€œfailedâ€: 0, â€œcurrentâ€: null}</p>
<h1 id="7-æ³¨å†Œç™»å½•æ³¨å†Œæµ‹è¯•ï¼šOK"><a href="#7-æ³¨å†Œç™»å½•æ³¨å†Œæµ‹è¯•ï¼šOK" class="headerlink" title="7.æ³¨å†Œç™»å½•æ³¨å†Œæµ‹è¯•ï¼šOK"></a>7.æ³¨å†Œç™»å½•æ³¨å†Œæµ‹è¯•ï¼šOK</h1><p>ğŸ‘2</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://ollama.com/shaw/dmeta-embedding-zh">shaw&#x2F;dmeta-embedding-zh</a><br><strong>Anaconda Prompt</strong>å¯åŠ¨ï¼š <code>ollama pull shaw/dmeta-embedding-zh</code></p>
<p>æŠŠæ¯ä¸ªæ®µè½åšæˆ<strong>å‘é‡åŒ–çš„ç¼–ç </strong></p>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#1bccbc>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/03/05/AI/RAGFlow/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/02/27/AI/AutoGen/">
        <h2>
            AutoGen
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/2/27
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <p><span style = "color:red"><strong>å¾…å®Œæˆ</strong>ï¼šæ¶æ„ è®¾è®¡æ€æƒ³ æ•´ä¸ªä»£ç æ€ä¹ˆç»„ç»‡èµ·æ¥çš„ æ€ä¹ˆå»æ»¡è¶³å„ç§éœ€æ±‚ </span><br><u>Bç«™ç‰›äººUPä¸»ã€DataSenseã€‘</u><br><a target="_blank" rel="noopener" href="https://juejin.cn/post/7462775772009938970">AutoGen æŠ€æœ¯åšå®¢ç³»åˆ— (ä¸€)ï¼šåŸºç¡€ä»‹ç»ä¸å…¥é—¨æ•™ç¨‹è¿™ç¯‡åšå®¢æä¾›äº†å¯¹ AutoGen çš„åŸºç¡€ä»‹ç»å’Œå…¥é—¨æ•™ç¨‹ï¼ŒåŒ…æ‹¬æ ¸å¿ƒ - æ˜é‡‘</a><br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV16u4y1j7so/?vd_source=a4d980c3208d51858f08b3025a6ab2d9">AutoGen æ™ºèƒ½åº”ç”¨å¼€å‘ï¼ˆä¸€ï¼‰ï½œAutoGen åŸºç¡€_å“”å“©å“”å“©_bilibili</a></p>
<p>[microsoft&#x2F;autogen: A programming framework for agentic AI ğŸ¤– PyPi: autogen-agentchat Discord: <a target="_blank" rel="noopener" href="https://aka.ms/autogen-discord">https://aka.ms/autogen-discord</a> Office Hour: <a target="_blank" rel="noopener" href="https://aka.ms/autogen-officehour]">https://aka.ms/autogen-officehour]</a> (<a target="_blank" rel="noopener" href="https://github.com/microsoft/autogen">https://github.com/microsoft/autogen</a>)</p>
<h5 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h5><p><strong>AutoGen</strong> å’Œ <strong>AutoGen Studio</strong> éƒ½æ˜¯ç”±å¾®è½¯å¼€å‘çš„ç”¨äºåˆ›å»ºå’Œç®¡ç†äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰æ™ºèƒ½ä½“çš„å·¥å…·ï¼Œä½†å®ƒä»¬åœ¨åŠŸèƒ½å’Œç›®æ ‡æ–¹é¢å­˜åœ¨ä¸€äº›å·®å¼‚ã€‚</p>
<p>AutoGen æ˜¯ä¸€æ¬¾åŸºäº AI å’Œå¤§æ•°æ®æŠ€æœ¯çš„äº§å“è®¾è®¡å·¥å…·ï¼Œæ—¨åœ¨é€šè¿‡è‡ªåŠ¨æå–äº§å“éœ€æ±‚ã€æ™ºèƒ½ä¼˜åŒ–è®¾è®¡æ–¹æ¡ˆå¹¶ç”Ÿæˆæœ€ç»ˆçš„äº§å“æ¨¡å‹æˆ–è§£å†³æ–¹æ¡ˆã€‚å…¶æ ¸å¿ƒç›®æ ‡æ˜¯å°†äººå·¥å¹²é¢„é™è‡³æœ€ä½ï¼Œä»è€Œæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿå¼€å‘æ•ˆç‡ã€‚AutoGen æ˜¯ä¸€ä¸ªå¼€æºçš„ Python æ¡†æ¶ï¼Œç”¨äºå®šä¹‰ã€é…ç½®å’Œç»„åˆ AI ä»£ç†ä»¥æ„å»ºå¤šæ™ºèƒ½ä½“åº”ç”¨ã€‚å®ƒæä¾›äº†ä¸€ç§ç”¨äºæè¿°ä»£ç†è¡Œä¸ºå’Œå®ƒä»¬ä¹‹é—´äº¤äº’çš„å£°æ˜æ€§è¯­è¨€ã€‚AutoGen éå¸¸çµæ´»ï¼Œå¯ç”¨äºæ„å»ºå„ç§å¤šæ™ºèƒ½ä½“åº”ç”¨ï¼Œä½†å®ƒéœ€è¦ä¸€å®šçš„ç¼–ç¨‹æŠ€èƒ½æ‰èƒ½ä½¿ç”¨ã€‚</p>
<p>AutoGen Studio æ˜¯ä¸€ä¸ªåŸºäº AutoGen æ¡†æ¶çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰å·¥å…·ã€‚å®ƒä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿæ›´è½»æ¾åœ°åˆ›å»ºå’Œç®¡ç†å¤šæ™ºèƒ½ä½“åº”ç”¨ï¼Œè€Œæ— éœ€ç¼–å†™ä»£ç ã€‚AutoGen Studio æä¾›äº†æ‹–æ”¾å¼ç•Œé¢å’Œå„ç§é¢„æ„å»ºæ¨¡å—ï¼Œå¯ä»¥ç®€åŒ–å¤šæ™ºèƒ½ä½“åº”ç”¨çš„å¼€å‘è¿‡ç¨‹ã€‚ä½†æ˜¯ï¼ŒAutoGen Studio çš„çµæ´»æ€§ä¸å¦‚ AutoGenï¼Œå¹¶ä¸”å®ƒå¯èƒ½ä¸é€‚ç”¨äºéœ€è¦é«˜åº¦å®šåˆ¶çš„åº”ç”¨ã€‚</p>
<p>ä»¥ä¸‹è¡¨æ ¼æ€»ç»“äº† AutoGen å’Œ AutoGen Studio çš„ä¸€äº›å…³é”®åŒºåˆ«ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ç‰¹æ€§</th>
<th align="left">AutoGen</th>
<th align="left">AutoGen Studio</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç±»å‹</td>
<td align="left">æ¡†æ¶</td>
<td align="left">GUI å·¥å…·</td>
</tr>
<tr>
<td align="left">æŠ½è±¡çº§åˆ«</td>
<td align="left">æ›´åº•å±‚</td>
<td align="left">æ›´é«˜å±‚</td>
</tr>
<tr>
<td align="left">çµæ´»åº¦</td>
<td align="left">æ›´çµæ´»</td>
<td align="left">ä¸å¤ªçµæ´»</td>
</tr>
<tr>
<td align="left">æ˜“ç”¨æ€§</td>
<td align="left">æ›´éš¾ä½¿ç”¨</td>
<td align="left">æ›´æ˜“ä½¿ç”¨</td>
</tr>
<tr>
<td align="left">ç¼–ç¨‹è¦æ±‚</td>
<td align="left">éœ€è¦ç¼–ç¨‹æŠ€èƒ½</td>
<td align="left">æ— éœ€ç¼–ç¨‹æŠ€èƒ½</td>
</tr>
<tr>
<td align="left">å¸¸è§ç”¨ä¾‹</td>
<td align="left">é«˜åº¦å®šåˆ¶çš„å¤šæ™ºèƒ½ä½“åº”ç”¨</td>
<td align="left">é€šç”¨å¤šæ™ºèƒ½ä½“åº”ç”¨</td>
</tr>
</tbody></table>
<p><strong>æ€»è€Œè¨€ä¹‹ï¼ŒAutoGen</strong> é€‚åˆéœ€è¦é«˜åº¦å®šåˆ¶å’Œçµæ´»æ€§çš„å¤šæ™ºèƒ½ä½“åº”ç”¨å¼€å‘äººå‘˜ï¼Œè€Œ <strong>AutoGen Studio</strong> é€‚åˆéœ€è¦å¿«é€Ÿæ„å»ºé€šç”¨å¤šæ™ºèƒ½ä½“åº”ç”¨çš„å¼€å‘äººå‘˜ã€‚</p>
<p>AI + è¡Œä¸š &#x3D; Agent</p>
<p>åªéœ€è¦æŠŠæ¥å£å¤åˆ¶ç²˜è´´æ¥åˆ°AutoGen Studioçš„æŠ€èƒ½è¡¨<br>**<u>ä¸‡èƒ½API</u>**ï¼š[<strong>å¤©èšæ•°è¡ŒTianAPI - åº”ç”¨å¼€å‘è€…APIæ•°æ®è°ƒç”¨å¹³å°</strong>] (<a target="_blank" rel="noopener" href="https://www.tianapi.com/">https://www.tianapi.com/</a>)</p>
<p>æˆ‘ä»¬è¦å»ç»™æ™ºèƒ½ä½“é…ç½®ä¸Šä½ éœ€è¦çš„èƒ½åŠ›ï¼</p>
<p>æˆ‘ç»“åˆæ™ºèƒ½ä½“æˆ‘å¯ä»¥åšåˆ°æ¯ä¸ªè¡Œä¸š ä½†æ¯ä¸ªè¡Œä¸šéƒ½æœ‰è‡ªå·±è§’è‰²çš„ä¸€ä¸ªå®šä¹‰<br>æˆ‘è¦ç»™æ™ºèƒ½ä½“å®šä¹‰è§’è‰²</p>
<hr>
<blockquote>
<ol>
<li><strong>æŠ€æœ¯åŸºç¡€å’Œé¢†åŸŸï¼š</strong><ul>
<li>â€œAutoGenâ€ å¯èƒ½ä¾èµ–äºç‰¹å®šçš„æŠ€æœ¯ï¼Œå¦‚æœºå™¨å­¦ä¹ ç®—æ³•ã€è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ç­‰ï¼Œ<br>ä¸»è¦ç”¨äºè‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆã€æ–‡æ¡£è‡ªåŠ¨æå–æˆ–æ•°æ®åˆ†æä»»åŠ¡ã€‚</li>
<li>â€œAiAgentâ€ åˆ™æ˜¯äººå·¥æ™ºèƒ½é¢†åŸŸçš„æ ¸å¿ƒæ¦‚å¿µï¼Œæ¶µç›–ä»éœ€æ±‚ç†è§£åˆ°è§£å†³æ–¹æ¡ˆç”Ÿæˆçš„<br>å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚å®ƒèƒ½å¤Ÿå°†ä¸åŒé¢†åŸŸçš„éœ€æ±‚æ•´åˆèµ·æ¥ï¼Œæä¾›ç»¼åˆæ€§çš„è§£å†³æ–¹æ¡ˆã€‚</li>
</ul>
</li>
<li><strong>åº”ç”¨åœºæ™¯ï¼š</strong><ul>
<li>åœ¨â€œAutoGenâ€çš„åº”ç”¨ä¸­ï¼Œå¯èƒ½åŒ…æ‹¬è‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆã€æ–‡æ¡£è‡ªåŠ¨åŒ–å¤„ç†ã€æ•°æ®åˆ†æ<br>å·¥å…·çš„æ„å»ºç­‰ã€‚</li>
<li>åœ¨â€œAiAgentâ€çš„åº”ç”¨ä¸­ï¼Œå¯èƒ½æ¶‰åŠéœ€æ±‚åˆ†æå’Œç†è§£ï¼Œæ•°æ®é¢„å¤„ç†ä¸æ¸…æ´—ï¼Œä»¥åŠç”Ÿ<br>æˆç”Ÿæˆæ¨¡å‹ï¼ˆå¦‚â€œAutoGenâ€ï¼‰ä¸­çš„äº§å“è®¾è®¡ç”Ÿæˆã€‚</li>
</ul>
</li>
<li><strong>åŠŸèƒ½ç‰¹ç‚¹ï¼š</strong><ul>
<li>â€œAutoGenâ€ å¯èƒ½ä¸“æ³¨äºè‡ªåŠ¨åŒ–ã€å¿«é€Ÿè¿­ä»£å’Œæ ‡å‡†åŒ–èƒ½åŠ›ï¼Œé€‚åˆéœ€è¦å¤§é‡é‡å¤åŠ³<br>åŠ¨çš„ä»»åŠ¡ã€‚</li>
<li>â€œAiAgentâ€ é€šå¸¸ç»“åˆäººå·¥æ™ºèƒ½çš„é«˜çº§ç®—æ³•å’Œåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚ã€å¤šé¢†<br>åŸŸçš„é—®é¢˜ï¼Œå¹¶æä¾›çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</li>
</ul>
</li>
<li><strong>ç ”ç©¶æ–¹å‘ä¸åº”ç”¨æ·±åº¦ï¼š</strong><ul>
<li>åœ¨â€œAutoGenâ€çš„ç ”ç©¶ä¸­ï¼Œå¯èƒ½ä¾§é‡äºç‰¹å®šä»»åŠ¡çš„å…·ä½“å®ç°å’ŒæŠ€æœ¯ä¼˜åŒ–ã€‚</li>
<li>åœ¨â€œAiAgentâ€çš„ç ”ç©¶ä¸­ï¼Œå¯èƒ½æ¶‰åŠè·¨é¢†åŸŸçš„çŸ¥è¯†èåˆã€åˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒç­‰é«˜çº§æŠ€<br>æœ¯ï¼Œæ¨åŠ¨äº†AIé¢†åŸŸçš„å‘å±•ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
<p>å…¨è‡ªåŠ¨åŒ–çš„ <strong>AI Agents</strong></p>
<p>LangChainå¯ä»¥å®ç°åšAI Agent<br>XAgent || <strong>AutoGen</strong> æ˜¯æ›´ä¸€æ­¥è¿›åŒ–çš„</p>
<p>å¦‚æœæœ‰ä¸å›¾ç‰‡è¾“å‡ºç›¸å…³çš„ï¼Œå¸®å¿™åŠ ä¸€ä¸ªGenImg(â€œå›¾ç‰‡ç”Ÿæˆæç¤º <strong>Prompt</strong>â€œ)<br>åˆ©ç”¨Promptè®¾å®šå¯ä»¥åˆ†é…ä»»åŠ¡åˆ°ä¸åŒçš„Agentä¸Š</p>
<p><strong>AutoGen</strong> æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œæ”¯æŒä½¿ç”¨å¤šä¸ªä»£ç†æ¥å¼€å‘ LLM åº”ç”¨ç¨‹åºè¿™äº›ä»£ç†å¯ä»¥ç›¸äº’å¯¹è¯æ¥è§£å†³ä»»åŠ¡ã€‚AutoGen ä»£ç†æ˜¯å¯å®šåˆ¶çš„ã€å¯å¯¹è¯çš„ï¼Œå¹¶ä¸”æ— ç¼åœ°å…è®¸äººå‚ä¸å…¶ä¸­ã€‚ä»–ä»¬å¯ä»¥ç»“åˆ LLMã€äººå·¥è¾“å…¥å’Œä¸åŒå·¥å…·çš„å„ç§æ¨¡å¼è¿è¡Œã€‚</p>
<p><strong>AutoGen</strong>æ˜¯å¾®è½¯çš„å¼€æºæ¡†æ¶</p>
<p>GitHubï¼š<a target="_blank" rel="noopener" href="https://github.com/microsoft/autogen">microsoft&#x2F;autogen: A programming framework for agentic AI ğŸ¤– PyPi: autogen-agentchat Discord: https://aka.ms/autogen-discord Office Hour: https://aka.ms/autogen-officehour</a></p>
<p>æ–‡æ¡£åšå®¢ï¼š<a target="_blank" rel="noopener" href="https://microsoft.github.io/autogen/stable/">AutoGen â€” AutoGen</a></p>
<h5 id="AutoGen-ä¸»è¦ç‰¹ç‚¹"><a href="#AutoGen-ä¸»è¦ç‰¹ç‚¹" class="headerlink" title="AutoGen ä¸»è¦ç‰¹ç‚¹"></a>AutoGen ä¸»è¦ç‰¹ç‚¹</h5><p>AutoGen å¯ä»¥è½»æ¾æ„å»ºåŸºäºå¤šä»£ç†å¯¹è¯çš„ä¸‹ä¸€ä»£ LLM åº”ç”¨ç¨‹åºã€‚å®ƒç®€åŒ–äº†å¤æ‚çš„LLM å·¥ä½œæµç¨‹çš„ç¼–æ’ã€è‡ªåŠ¨åŒ–å’Œä¼˜åŒ–ã€‚å®ƒæœ€å¤§é™åº¦åœ°æé«˜äº† LLM æ¨¡å‹çš„æ€§èƒ½å¹¶å…‹æœäº†å®ƒä»¬çš„å¼±ç‚¹ã€‚<br>å®ƒæ”¯æŒå¤æ‚å·¥ä½œæµç¨‹çš„å¤šç§å¯¹è¯æ¨¡å¼ã€‚å€ŸåŠ©å¯å®šåˆ¶å’Œå¯å¯¹è¯çš„ä»£ç†ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ AutoGen æ„å»ºå„ç§æ¶‰åŠå¯¹è¯è‡ªä¸»æ€§ã€ä»£ç†æ•°é‡å’Œä»£ç†å¯¹è¯æ‹“æ‰‘çš„å¯¹è¯æ¨¡å¼ã€‚<br>å®ƒæä¾›äº†ä¸€ç³»åˆ—å…·æœ‰ä¸åŒå¤æ‚æ€§çš„å·¥ä½œç³»ç»Ÿã€‚ è¿™äº›ç³»ç»Ÿæ¶µç›–å„ç§é¢†åŸŸå’Œå¤æ‚æ€§çš„å¹¿æ³›åº”ç”¨ã€‚ è¿™æ¼”ç¤ºäº† AutoGen å¦‚ä½•è½»æ¾æ”¯æŒä¸åŒçš„å¯¹è¯æ¨¡å¼ã€‚<br>AutoGen æä¾›å¢å¼ºçš„ LLM æ¨ç†ã€‚ å®ƒæä¾› APIç»Ÿä¸€å’Œç¼“å­˜ç­‰å®ç”¨ç¨‹åºï¼Œä»¥åŠé”™è¯¯å¤„ç†ã€å¤šé…ç½®æ¨ç†ã€ä¸Šä¸‹æ–‡ç¼–ç¨‹ç­‰é«˜çº§ä½¿ç”¨æ¨¡å¼ã€‚</p>
<p>AutoGen æŠ½è±¡å¹¶å®ç°äº†å¯å¯¹è¯ä»£ç†ï¼Œæ—¨åœ¨é€šè¿‡ä»£ç†é—´å¯¹è¯æ¥è§£å†³ä»»åŠ¡ã€‚<br><strong>å¯å¯¹è¯</strong>ï¼šAutoGen ä¸­çš„ä»£ç†æ˜¯å¯å¯¹è¯çš„ï¼Œè¿™æ„å‘³ç€ä»»ä½•ä»£ç†éƒ½å¯ä»¥ä»å…¶ä»–ä»£ç†å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ä»¥å‘èµ·æˆ–ç»§ç»­å¯¹è¯<br><strong>å¯å®šåˆ¶</strong>ï¼šAutoGen ä¸­çš„ä»£ç†å¯ä»¥å®šåˆ¶ä»¥é›†æˆ LLMã€äººã€å·¥å…·æˆ–å®ƒä»¬çš„ç»„åˆã€‚</p>
<hr>
<h6 id="â˜…-PyCharmæ€ä¹ˆæ‰“å¼€-ipynbåç¼€æ–‡ä»¶-æˆ‘éœ€è¦è¯¦ç»†æ­¥éª¤-æˆ‘pycharmé‡Œé¢æ²¡æœ‰è¿™ä¸ªï¼Ÿ"><a href="#â˜…-PyCharmæ€ä¹ˆæ‰“å¼€-ipynbåç¼€æ–‡ä»¶-æˆ‘éœ€è¦è¯¦ç»†æ­¥éª¤-æˆ‘pycharmé‡Œé¢æ²¡æœ‰è¿™ä¸ªï¼Ÿ" class="headerlink" title="â˜… PyCharmæ€ä¹ˆæ‰“å¼€.ipynbåç¼€æ–‡ä»¶ æˆ‘éœ€è¦è¯¦ç»†æ­¥éª¤ æˆ‘pycharmé‡Œé¢æ²¡æœ‰è¿™ä¸ªï¼Ÿ"></a>â˜… PyCharmæ€ä¹ˆæ‰“å¼€.ipynbåç¼€æ–‡ä»¶ æˆ‘éœ€è¦è¯¦ç»†æ­¥éª¤ æˆ‘pycharmé‡Œé¢æ²¡æœ‰è¿™ä¸ªï¼Ÿ</h6><p>å¦‚æœ PyCharm ç‰ˆæœ¬è¾ƒè€æˆ–è€…æ’ä»¶ä¸å¯ç”¨ï¼Œå¯ä»¥ç”¨å¤–éƒ¨ Jupyter Notebook è¿è¡Œï¼š</p>
<ol>
<li><p>å®‰è£… Jupyter</p>
<p>æ‰“å¼€ PyCharm è‡ªå¸¦çš„ Terminalï¼ˆç»ˆç«¯ï¼‰è¾“å…¥ï¼š</p>
<pre><code class="python">pip install jupyter
</code></pre>
</li>
<li><p>åœ¨ Terminal é‡Œå¯åŠ¨ <strong>Jupyter</strong></p>
<pre><code class="python">jupyter notebook
</code></pre>
</li>
<li><p><strong>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ .ipynb</strong> Jupyter Notebook ä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­ç¼–è¾‘ <code>.ipynb</code> æ–‡ä»¶ã€‚</p>
</li>
</ol>
<h5 id="AutoGenåŸºç¡€ç¯å¢ƒé…ç½®"><a href="#AutoGenåŸºç¡€ç¯å¢ƒé…ç½®" class="headerlink" title="AutoGenåŸºç¡€ç¯å¢ƒé…ç½®"></a>AutoGenåŸºç¡€ç¯å¢ƒé…ç½®</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/epitomizelu/article/details/140287498?ops_request_misc=%7B%22request_id%22:%2202bd36b0219fe5e5f9a59b0a71085885%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=02bd36b0219fe5e5f9a59b0a71085885&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-140287498-null-null.142%5Ev101%5Epc_search_result_base7&utm_term=%E6%80%8E%E4%B9%88%E4%B8%8B%E8%BD%BDautogen&spm=1018.2226.3001.4187">AutoGenåŸºç¡€ç¯å¢ƒå®‰è£…_autogenå®‰è£…-CSDNåšå®¢</a></p>
<p>windowså¼€å§‹èœå•æœç´¢æ ï¼Œæœç´¢promptï¼Œæœç´¢ç»“æœä¸­å¯ä»¥çœ‹åº”ç”¨<code>Aanconda Powershell Prompt</code>ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªå·¥å…·åˆ›å»ºä¸€ä¸ªç‰¹å®šç‰ˆæœ¬çš„Pythonç¯å¢ƒã€‚<br>åœ¨æ‰“å¼€çš„å‘½ä»¤è¡Œå·¥å…·ä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œç„¶åå›è½¦ã€‚</p>
<p><code>conda create -n lcy python=3.10</code></p>
<blockquote>
<p>-n åé¢æ˜¯çš„lcyæ˜¯ç¯å¢ƒçš„åç§°ï¼Œç›¸å½“äºä¸€ä¸ªæ ‡è¯†ï¼Œåç»­è¦ç”¨è¿™ä¸ªç¯å¢ƒæ—¶é€šè¿‡è¿™ä¸ªåç§°è¿›è¡ŒæŸ¥æ‰¾<br>python&#x3D;3.10ï¼Œæ˜¯æŒ‡å®špythonçš„ç‰ˆæœ¬</p>
</blockquote>
<p>æ¥ä¸‹æ¥ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œåˆ‡æ¢åˆ°åˆ›å»ºå¥½çš„ç¯å¢ƒã€‚</p>
<p>â˜… <code>conda activate lcy</code></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®‰è£…Autogen Studioã€‚<br>é‚£æ€ä¹ˆå®‰è£…å‘¢ï¼Ÿè¶…çº§ç®€å•ï¼Œåœ¨åˆšåˆšæˆ‘ä»¬å‡†å¤‡å¥½çš„pythonç¯å¢ƒä¸­æ‰§è¡Œä¸€ä¸ªå‘½ä»¤å°±å¥½ã€‚</p>
<p><code>pip install autogen studio</code></p>
<p>ä½†å¦‚æœç›´æ¥è¿™æ ·æ‰§è¡Œçš„è¯ï¼Œå› ä¸ºå®ƒä¼šè®¿é—®å›½å¤–çš„ç½‘ç«™å®Œæˆä¸‹è½½ï¼Œæ‰€ä»¥é€Ÿåº¦éå¸¸æ…¢ï¼Œæ…¢åˆ°ä¸èƒ½å¿å—ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è®©å®ƒå»å›½å†…çš„é•œåƒä¸‹è½½ã€‚é€šè¿‡å‚æ•°-iæŒ‡å®šå›½å†…é•œåƒåœ°å€ï¼Œæˆ‘ä»¬ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒã€‚</p>
<p>ä¸Šè¿°å‘½ä»¤å°±å˜æˆå¦‚ä¸‹è¿™æ ·äº†ã€‚</p>
<p><code>pip install autogenstudio -i https://mirrors.aliyun.com/pypi/simple</code></p>
<p>ä¸‹è½½ä¹‹åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨autogen studioæœåŠ¡ã€‚</p>
<pre><code class="bash">â˜… (lcy) C:\Users\Pluminary&gt; autogenstudio ui --port 6001
</code></pre>
<p>ä¹‹åç›´æ¥è®¿é—®<code>AutoGen Studio [Beta]</code> â†’ [127.0.0.1:6001] (<a target="_blank" rel="noopener" href="http://127.0.0.1:6001/">http://127.0.0.1:6001/</a>)</p>
<blockquote>
<p>åœ¨AutoGen Studioä¸­ï¼ŒTeam Builderæ˜¯ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œå…è®¸ç”¨æˆ·é…ç½®å’Œç®¡ç†ä¸åŒçš„Agentsæ¥æ„å»ºå¤šæ™ºèƒ½ä½“ç³»ç»Ÿã€‚ä¸‹é¢æ˜¯å¯¹æ‚¨æåˆ°çš„å‡ ç§Agentsçš„è¯¦ç»†åˆ†æï¼š</p>
<h6 id="AssistantAgent"><a href="#AssistantAgent" class="headerlink" title="AssistantAgent"></a>AssistantAgent</h6><ul>
<li><strong>ç”¨é€”</strong>ï¼šAssistantAgent æ˜¯ä¸€ç§ç”¨äºå¤„ç†å’Œç”Ÿæˆå¯¹è¯çš„æ™ºèƒ½ä½“ã€‚å®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºèŠå¤©æœºå™¨äººã€è™šæ‹ŸåŠ©æ‰‹æˆ–ä»»ä½•éœ€è¦ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’çš„åº”ç”¨ç¨‹åºã€‚</li>
<li>åŠŸèƒ½<ul>
<li><strong>å¯¹è¯ç”Ÿæˆ</strong>ï¼šèƒ½å¤ŸåŸºäºç”¨æˆ·çš„è¾“å…¥ç”Ÿæˆè‡ªç„¶è¯­è¨€å“åº”ã€‚</li>
<li><strong>ä»»åŠ¡æ‰§è¡Œ</strong>ï¼šå¯ä»¥æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ï¼Œå¦‚ä¿¡æ¯æŸ¥è¯¢ã€ç®€å•è®¡ç®—æˆ–æ‰§è¡Œé¢„è®¾çš„å‘½ä»¤ã€‚</li>
<li><strong>ä¸Šä¸‹æ–‡ç®¡ç†</strong>ï¼šä¿æŒå¯¹è¯çš„ä¸Šä¸‹æ–‡ï¼Œä½¿å¾—å¯¹è¯æ›´åŠ è¿è´¯å’Œè‡ªç„¶ã€‚</li>
</ul>
</li>
</ul>
<h6 id="Web-Surfer-Agent"><a href="#Web-Surfer-Agent" class="headerlink" title="Web Surfer Agent"></a>Web Surfer Agent</h6><ul>
<li><strong>ç”¨é€”</strong>ï¼šWeb Surfer Agent ä¸“é—¨ç”¨äºä»äº’è”ç½‘ä¸Šæ£€ç´¢ä¿¡æ¯ã€‚å®ƒæ˜¯ä¸€ä¸ªç½‘ç»œçˆ¬è™«ï¼Œèƒ½å¤Ÿè®¿é—®ç½‘é¡µå¹¶æå–æœ‰ç”¨çš„ä¿¡æ¯ã€‚</li>
<li>åŠŸèƒ½<ul>
<li><strong>ç½‘é¡µè®¿é—®</strong>ï¼šèƒ½å¤Ÿè®¿é—®æŒ‡å®šçš„ç½‘é¡µï¼Œè·å–å†…å®¹ã€‚</li>
<li><strong>ä¿¡æ¯æå–</strong>ï¼šä»ç½‘é¡µä¸­æå–ç»“æ„åŒ–æˆ–éç»“æ„åŒ–æ•°æ®ã€‚</li>
<li><strong>æ•°æ®æ•´åˆ</strong>ï¼šå°†æå–çš„æ•°æ®æ•´åˆåˆ°å¯¹è¯æˆ–åº”ç”¨ç¨‹åºä¸­ã€‚</li>
</ul>
</li>
</ul>
<h6 id="Verification-Assistant"><a href="#Verification-Assistant" class="headerlink" title="Verification Assistant"></a>Verification Assistant</h6><ul>
<li><strong>ç”¨é€”</strong>ï¼šVerification Assistant ç”¨äºéªŒè¯ä¿¡æ¯çš„å‡†ç¡®æ€§æˆ–æ‰§è¡ŒæŸäº›æ£€æŸ¥ä»»åŠ¡ã€‚</li>
<li>åŠŸèƒ½<ul>
<li><strong>æ•°æ®éªŒè¯</strong>ï¼šæ£€æŸ¥æ•°æ®çš„å‡†ç¡®æ€§ï¼Œä¾‹å¦‚éªŒè¯ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æ˜¯å¦ç¬¦åˆç‰¹å®šçš„æ ¼å¼æˆ–æ ‡å‡†ã€‚</li>
<li><strong>é€»è¾‘éªŒè¯</strong>ï¼šæ‰§è¡Œé€»è¾‘æ£€æŸ¥ï¼Œæ¯”å¦‚éªŒè¯æŸä¸ªæµç¨‹æ˜¯å¦æŒ‰ç…§é¢„å®šçš„è§„åˆ™æ‰§è¡Œã€‚</li>
<li><strong>åˆè§„æ€§æ£€æŸ¥</strong>ï¼šç¡®ä¿æ“ä½œç¬¦åˆç‰¹å®šçš„è¡Œä¸šæˆ–æ³•å¾‹æ ‡å‡†ã€‚</li>
</ul>
</li>
</ul>
<h6 id="UserProxyAgent"><a href="#UserProxyAgent" class="headerlink" title="UserProxyAgent"></a>UserProxyAgent</h6><ul>
<li><strong>ç”¨é€”</strong>ï¼šUserProxyAgent ä»£è¡¨ç”¨æˆ·æ‰§è¡Œæ“ä½œï¼Œé€šå¸¸ç”¨äºæ¨¡æ‹Ÿç”¨æˆ·è¡Œä¸ºæˆ–è‡ªåŠ¨åŒ–ç”¨æˆ·ä»»åŠ¡ã€‚</li>
<li>åŠŸèƒ½<ul>
<li><strong>è¡Œä¸ºæ¨¡æ‹Ÿ</strong>ï¼šæ¨¡æ‹Ÿç”¨æˆ·çš„è¡Œä¸ºï¼Œä¾‹å¦‚åœ¨æµ‹è¯•ç¯å¢ƒä¸­æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œã€‚</li>
<li><strong>ä»»åŠ¡è‡ªåŠ¨åŒ–</strong>ï¼šè‡ªåŠ¨åŒ–é‡å¤æ€§çš„ç”¨æˆ·ä»»åŠ¡ï¼Œæé«˜æ•ˆç‡ã€‚</li>
<li><strong>éšç§ä¿æŠ¤</strong>ï¼šåœ¨éœ€è¦ä¿æŠ¤ç”¨æˆ·éšç§çš„åœºæ™¯ä¸­ï¼Œä»£æ›¿ç”¨æˆ·æ‰§è¡Œæ“ä½œï¼Œå‡å°‘ä¸ªäººä¿¡æ¯æ³„éœ²çš„é£é™©ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨Team Builderä¸­ï¼Œè¿™äº›Agentså¯ä»¥è¢«é…ç½®å’Œç»„åˆï¼Œä»¥æ„å»ºå¤æ‚çš„å·¥ä½œæµç¨‹ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå·¥ä½œæµç¨‹å¯èƒ½é¦–å…ˆä½¿ç”¨Web Surfer Agentä»ç½‘ç»œä¸Šè·å–ä¿¡æ¯ï¼Œç„¶åç”±AssistantAgentå¤„ç†è¿™äº›ä¿¡æ¯å¹¶ç”Ÿæˆå“åº”ï¼Œæœ€åç”±Verification AssistantéªŒè¯å“åº”çš„å‡†ç¡®æ€§ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒAutoGen Studio æä¾›äº†ä¸€ä¸ªçµæ´»ä¸”å¼ºå¤§çš„å¹³å°ï¼Œç”¨äºåˆ›å»ºé«˜æ•ˆä¸”å¯æ‰©å±•çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿã€‚</p>
</blockquote>
<hr>
<hr>
<p><strong>ConversableAgent</strong> æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„æ™ºèƒ½å¯¹è¯ç³»ç»Ÿï¼Œå®ƒèƒ½å¤Ÿæä¾›ä¸ªæ€§åŒ–å’Œé«˜æ•ˆçš„äº¤æµä½“éªŒ</p>
<p><strong>AssistantAgentï¼ˆåŠ©æ‰‹ä»£ç†ï¼‰</strong>ï¼š</p>
<p>æƒ³è±¡ä¸€ä¸‹ä½ æœ‰ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œæ¯”å¦‚Siriæˆ–Alexaï¼ŒAssistantAgentå°±åƒæ˜¯è¿™ä¸ªåŠ©æ‰‹çš„å¤§è„‘ã€‚å®ƒçš„ä»»åŠ¡æ˜¯ç†è§£å’Œå¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼Œç„¶ååšå‡ºç›¸åº”çš„å›åº”ã€‚åœ¨AutoGenç³»ç»Ÿä¸­ï¼ŒAssistantAgentè´Ÿè´£æ¥æ”¶ç”¨æˆ·çš„ä¿¡æ¯ï¼Œåˆ†æè¿™äº›ä¿¡æ¯ï¼Œå¹¶æ ¹æ®é¢„è®¾çš„è§„åˆ™æˆ–é€»è¾‘æ¥æ‰§è¡Œä»»åŠ¡ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ å‘Šè¯‰åŠ©æ‰‹â€œæˆ‘æ˜å¤©æœ‰ä¸ªä¼šè®®â€ï¼ŒAssistantAgentå°±ä¼šå¸®ä½ è®¾ç½®æé†’æˆ–è€…æ·»åŠ åˆ°æ—¥ç¨‹ä¸­ã€‚</p>
<p><strong>UserProxyAgentï¼ˆç”¨æˆ·ä»£ç†ä»£ç†ï¼‰</strong>ï¼š</p>
<p>æƒ³è±¡ä½ åœ¨ç©ä¸€ä¸ªè§’è‰²æ‰®æ¼”æ¸¸æˆï¼ŒUserProxyAgentå°±åƒæ˜¯ä½ çš„è§’è‰²ï¼Œå®ƒä»£è¡¨ä½ åœ¨æ¸¸æˆä¸–ç•Œä¸­è¡ŒåŠ¨ã€‚åœ¨AutoGenç³»ç»Ÿä¸­ï¼ŒUserProxyAgentä»£è¡¨ç”¨æˆ·ä¸ç³»ç»Ÿæˆ–å…¶ä»–ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚å®ƒå¯ä»¥æ˜¯ç”¨æˆ·çš„æ›¿èº«ï¼Œæ‰§è¡Œç”¨æˆ·çš„å‘½ä»¤ï¼Œæˆ–è€…ä»£è¡¨ç”¨æˆ·å‚ä¸æŸäº›æ´»åŠ¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ åœ¨ä¸€ä¸ªåœ¨çº¿è®ºå›ä¸Šï¼ŒUserProxyAgentå¯ä»¥å¸®ä½ å‘å¸–æˆ–è€…å›å¤åˆ«äººçš„è¯„è®ºã€‚</p>
<p><strong>GroupChatManagerï¼ˆç¾¤èŠç®¡ç†å™¨ï¼‰</strong>ï¼š</p>
<p>æƒ³è±¡ä½ åœ¨å‚åŠ ä¸€ä¸ªå¤šäººåœ¨çº¿ä¼šè®®æˆ–ç¾¤èŠï¼ŒGroupChatManagerå°±åƒæ˜¯ä¼šè®®çš„ä¸»æŒäººæˆ–è€…ç¾¤èŠçš„ç®¡ç†å‘˜ã€‚å®ƒçš„èŒè´£æ˜¯åè°ƒç¾¤èŠä¸­çš„æ‰€æœ‰å‚ä¸è€…ï¼Œç¡®ä¿ä¿¡æ¯æµç•…ä¸”æœ‰åºåœ°ä¼ é€’ã€‚åœ¨AutoGenç³»ç»Ÿä¸­ï¼ŒGroupChatManagerè´Ÿè´£ç®¡ç†ç¾¤èŠçš„å„ä¸ªæ–¹é¢ï¼Œæ¯”å¦‚é‚€è¯·æˆå‘˜åŠ å…¥ã€ç›‘æ§èŠå¤©å†…å®¹ã€ç»´æŒèŠå¤©ç§©åºç­‰ã€‚å¦‚æœæœ‰äººåœ¨ç¾¤èŠä¸­å‘äº†ä¸åˆé€‚çš„å†…å®¹ï¼ŒGroupChatManagerå¯èƒ½ä¼šä»‹å…¥å¤„ç†ã€‚</p>
<hr>
<p><span style = "color:red">åœ¨PyCharmä¸­æ–°å»ºä¸€ä¸ªåŸºäº<strong>conda</strong>çš„å·¥ç¨‹æ–‡ä»¶</span><br><u><strong>åœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥</strong></u>:<code> pip install pyautogen</code></p>
<p>æœ¬åœ°å¯åŠ¨ DeepSeek â†’ <code>C:\Users\Pluminary&gt;ollama run deepseek-r1:1.5b</code></p>
<h5 id="é…ç½®Open-WebUI"><a href="#é…ç½®Open-WebUI" class="headerlink" title="é…ç½®Open WebUI"></a>é…ç½®Open WebUI</h5><p><span style = "color:red"><strong>å¯ä»¥æµ‹è¯•æ¨¡å‹çš„é—®ç­”</strong></span></p>
<h6 id="å…ˆå®‰è£…conda"><a href="#å…ˆå®‰è£…conda" class="headerlink" title="å…ˆå®‰è£…conda"></a>å…ˆå®‰è£…conda</h6><pre><code class="python">conda create -n open-webui python=3.11.0
activate open-webui

# å¼€æºçš„è®¿é—®å¤§æ¨¡å‹ç®¡ç†é¡µé¢
pip install open-webui
</code></pre>
<h6 id="é…ç½®WebUIï¼šå¯åŠ¨"><a href="#é…ç½®WebUIï¼šå¯åŠ¨" class="headerlink" title="é…ç½®WebUIï¼šå¯åŠ¨"></a>é…ç½®WebUIï¼šå¯åŠ¨</h6><pre><code class="python">open-webui serve
------------------
http://localhost:8080
</code></pre>
<pre><code class="python">sentence_bert_config.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 53.0/53.0 [00:00&lt;?, ?B/s]
tokenizer_config.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 350/350 [00:00&lt;?, ?B/s]
vocab.txt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 232k/232k [00:00&lt;00:00, 1.17MB/s]
tokenizer.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 466k/466k [00:00&lt;00:00, 26.0MB/s]
special_tokens_map.json: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 112/112 [00:00&lt;?, ?B/s]
INFO:     Started server process [18264]
INFO:     Waiting for application startup.
2025-02-28 08:29:21.807 | INFO     | open_webui.utils.logger:start_logger:140 - GLOBAL_LOG_LEVEL: INFO - &#123;&#125;

# ç­‰çœ‹åˆ°ç«¯å£å·å†å»è®¿é—® 18264
</code></pre>
<hr>
<h4 id="åˆ©ç”¨Pythonéƒ¨ç½²æœ¬åœ°DeepSeekå¹¶è¿›è¡Œè¿é€š"><a href="#åˆ©ç”¨Pythonéƒ¨ç½²æœ¬åœ°DeepSeekå¹¶è¿›è¡Œè¿é€š" class="headerlink" title="åˆ©ç”¨Pythonéƒ¨ç½²æœ¬åœ°DeepSeekå¹¶è¿›è¡Œè¿é€š"></a>åˆ©ç”¨Pythonéƒ¨ç½²æœ¬åœ°DeepSeekå¹¶è¿›è¡Œè¿é€š</h4><pre><code class="python"># ç”¨äºå‘é€ HTTP è¯·æ±‚ã€‚åœ¨æ­¤ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒä¸æœ¬åœ°éƒ¨ç½²çš„ DeepSeek æœåŠ¡è¿›è¡Œé€šä¿¡
import requests
# ç”¨äºå¤„ç† JSON æ•°æ®ï¼Œå°¤å…¶æ˜¯åœ¨å‘é€å’Œæ¥æ”¶ HTTP è¯·æ±‚æ—¶
import json


# å®šä¹‰ä¸ DeepSeek æœåŠ¡äº¤äº’çš„ç±»
class DeepSeekChat:
    # è¿™ä¸ªç±»è´Ÿè´£ä¸ DeepSeek æœåŠ¡è¿›è¡Œäº¤äº’ å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š
    &#39;&#39;&#39;
     modelï¼šæ¨¡å‹åç§°ï¼Œåœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æ˜¯ &quot;deepseek-r1:1.5b&quot;ã€‚
     base_urlï¼šDeepSeek æœåŠ¡çš„ API åŸºç¡€ URLï¼Œå³æœ¬åœ°éƒ¨ç½²çš„ DeepSeek æœåŠ¡åœ°å€ã€‚
     
æˆ‘ä»¬é€šå¸¸ä½¿ç”¨selfä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„åç§°ã€‚è¿™æ˜¯ä¸ºäº†ä»£ç çš„å¯è¯»æ€§å’Œä¸€è‡´æ€§ã€‚è¿™ä¸ªçº¦å®šä½¿å¾—å…¶ä»–é˜…è¯»ä½ ä»£ç çš„Pythonç¨‹åºå‘˜èƒ½å¤Ÿç«‹å³è¯†åˆ«å‡ºselfä»£è¡¨çš„æ˜¯ç±»çš„å®ä¾‹ã€‚
    &#39;&#39;&#39;
    def __init__(self, model, base_url):
        self.model = model
        self.base_url = base_url

    # send_message æ–¹æ³•ï¼šè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ messages
    # å¹¶æ„å»ºä¸€ä¸ª POST è¯·æ±‚çš„æœ‰æ•ˆè´Ÿè½½ï¼ˆpayloadï¼‰ï¼ŒåŒ…æ‹¬æ¨¡å‹åç§°å’Œæ¶ˆæ¯å†…å®¹ã€‚messages æ˜¯ä¸€ä¸ªåŒ…å«å¤šæ¡æ¶ˆæ¯çš„åˆ—è¡¨ã€‚
    def send_message(self, messages):
        # æ„å»ºè¯·æ±‚æ•°æ®
        payload = &#123;
            &quot;model&quot;: self.model,
            &quot;messages&quot;: messages
        &#125;
        # è®¾ç½®è¯·æ±‚å¤´ï¼ŒæŒ‡å®šè¯·æ±‚ä½“çš„å†…å®¹ç±»å‹ä¸º application/json
        headers = &#123;
            &quot;Content-Type&quot;: &quot;application/json&quot;
        &#125;

        # å‘é€è¯·æ±‚åˆ°æœ¬åœ° DeepSeek æœåŠ¡
 &#39;&#39;&#39;
ä½¿ç”¨ requests.post() å‘é€ HTTP POST è¯·æ±‚åˆ° DeepSeek æœåŠ¡çš„ API åœ°å€ self.base_url
json.dumps(payload) å°†è¯·æ±‚ä½“çš„è´Ÿè½½ payload è½¬æ¢ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚
 &#39;&#39;&#39;
        response = requests.post(self.base_url, headers=headers, data=json.dumps(payload))

        if response.status_code == 200:
            return response.json()  # è¿”å› DeepSeek è¿”å›çš„å“åº”
        else:
            return &#123;&quot;error&quot;: f&quot;Request failed with status code &#123;response.status_code&#125;&quot;&#125;


# å®šä¹‰åˆå§‹åŒ–æ¶ˆæ¯ å®šä¹‰å¯åŠ¨å¯¹è¯å‡½æ•°
&#39;&#39;&#39;
æ­¤å‡½æ•°å¯åŠ¨å¹¶ç®¡ç†ä¸ç”¨æˆ·çš„å¯¹è¯ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªåˆå§‹åŒ–çš„ messages åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç³»ç»Ÿæ¶ˆæ¯ï¼Œç³»ç»Ÿæ¶ˆæ¯çš„è§’è‰²æ˜¯ &quot;system&quot;ï¼Œå†…å®¹æ˜¯ &quot;You are a helpful assistant.&quot;ï¼Œè¿™å°†å‘Šè¯‰æ¨¡å‹å…¶åº”æ‰®æ¼”çš„è§’è‰²
&#39;&#39;&#39;
def start_conversation():
    messages = [
        &#123;&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;You are a helpful assistant.&quot;&#125;  # ç³»ç»Ÿæ¶ˆæ¯å®šä¹‰è§’è‰²
    ]

    # åˆå§‹åŒ– DeepSeekChat å®ä¾‹
    deepseek_chat = DeepSeekChat(
        model=&quot;deepseek-r1:1.5b&quot;,  # ä½¿ç”¨çš„æœ¬åœ°æ¨¡å‹
        base_url=&quot;http://localhost:11434/v1/chat/completions&quot;  # æœ¬åœ°æœåŠ¡ URL
    )
# åˆ›å»ºä¸€ä¸ª DeepSeekChat ç±»çš„å®ä¾‹ deepseek_chatï¼Œå¹¶ä¼ å…¥æœ¬åœ°æ¨¡å‹å’ŒæœåŠ¡çš„ URL
    while True:
        try:
            # è·å–ç”¨æˆ·è¾“å…¥é—®é¢˜
            user_input = input(&quot;You: &quot;)

            # å¦‚æœç”¨æˆ·è¾“å…¥ &quot;exit&quot; é€€å‡ºå¾ªç¯
            # è¿›å…¥ä¸€ä¸ª while True å¾ªç¯ï¼Œä¸æ–­ç­‰å¾…ç”¨æˆ·è¾“å…¥
            #ç”¨æˆ·çš„æ¯æ¬¡è¾“å…¥éƒ½ä¼šè¢«æ•è·å¹¶å­˜å‚¨åœ¨ user_input å˜é‡ä¸­ã€‚

            if user_input.lower() == &quot;exit&quot;:
                print(&quot;Exiting the conversation.&quot;)
                break

            # æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
             essages.append(&#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: user_input&#125;)

            # å‘é€ç”¨æˆ·æ¶ˆæ¯å¹¶è·å–æ¨¡å‹å›ç­” å°†ç”¨æˆ·çš„è¾“å…¥æ·»åŠ åˆ° messages åˆ—è¡¨ä¸­ï¼Œæ¶ˆæ¯çš„è§’è‰²è®¾ç½®ä¸º &quot;user&quot;ã€‚
            response = deepseek_chat.send_message(messages)

            # æ£€æŸ¥å“åº”æ˜¯å¦åŒ…å«é”™è¯¯
            if &quot;error&quot; in response:
                print(response[&quot;error&quot;])
            else:
                # æ‰“å° DeepSeek æ¨¡å‹çš„å›ç­”
                answer = response.get(&quot;choices&quot;, [&#123;&#125;])[0].get(&quot;message&quot;, &#123;&#125;).get(&quot;content&quot;, &quot;No response&quot;)
                print(&quot;DeepSeek: &quot; + answer)

        except KeyboardInterrupt:
            print(&quot;\nExiting the conversation due to user interrupt.&quot;)
            break
&#39;&#39;&#39;
if __name__ == &quot;__main__&quot;: è¯­å¥ä¿è¯åªæœ‰å½“è„šæœ¬ä½œä¸ºä¸»ç¨‹åºæ‰§è¡Œæ—¶æ‰ä¼šè°ƒç”¨ start_conversation å‡½æ•°ã€‚å¦‚æœè¯¥è„šæœ¬è¢«ä½œä¸ºæ¨¡å—å¯¼å…¥åˆ°å…¶ä»–è„šæœ¬ä¸­ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œè¯¥å‡½æ•°ã€‚
&#39;&#39;&#39;

if __name__ == &quot;__main__&quot;:
    start_conversation()
</code></pre>
<h6 id="å‡è®¾ä½ å·²ç»ç†è§£äº†-DeepSeek-çš„åŸºç¡€ä»£ç ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨-AutoGen-é›†æˆ-DeepSeekï¼š"><a href="#å‡è®¾ä½ å·²ç»ç†è§£äº†-DeepSeek-çš„åŸºç¡€ä»£ç ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨-AutoGen-é›†æˆ-DeepSeekï¼š" class="headerlink" title="å‡è®¾ä½ å·²ç»ç†è§£äº† DeepSeek çš„åŸºç¡€ä»£ç ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ AutoGen é›†æˆ DeepSeekï¼š"></a><strong>å‡è®¾ä½ å·²ç»ç†è§£äº† DeepSeek çš„åŸºç¡€ä»£ç ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ AutoGen é›†æˆ DeepSeekï¼š</strong></h6><pre><code class="python">import requests
from autogen import Agent, GroupChat, GroupChatManager
from autogen.models.openai import OpenAIChatCompletionClient
import json

# å®šä¹‰ä¸ DeepSeek æœåŠ¡äº¤äº’çš„ç±»
class DeepSeekChat:
    def __init__(self, model, base_url):
        self.model = model
        self.base_url = base_url

    def send_message(self, messages):
        payload = &#123;
            &quot;model&quot;: self.model,
            &quot;messages&quot;: messages
        &#125;
        headers = &#123;&quot;Content-Type&quot;: &quot;application/json&quot;&#125;
        response = requests.post(self.base_url, headers=headers, data=json.dumps(payload))
        
        if response.status_code == 200:
            return response.json()
        else:
            return &#123;&quot;error&quot;: f&quot;Request failed with status code &#123;response.status_code&#125;&quot;&#125;

# åˆ›å»ºè‡ªå®šä¹‰ä»£ç†ï¼ˆDeepSeek ä»£ç†ï¼‰
class DeepSeekAgent(Agent):
    def __init__(self, model, base_url):
        super().__init__(name=&quot;DeepSeekAgent&quot;)
        self.chat = DeepSeekChat(model, base_url)

    def on_message(self, message):
        response = self.chat.send_message([&#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: message&#125;])
        return response.get(&quot;choices&quot;, [&#123;&#125;])[0].get(&quot;message&quot;, &#123;&#125;).get(&quot;content&quot;, &quot;No response&quot;)

# åˆ›å»ºç”¨æˆ·ä»£ç†
class UserAgent(Agent):
    def __init__(self):
        super().__init__(name=&quot;UserAgent&quot;)

    def on_message(self, message):
        return message

# è®¾ç½® DeepSeek ä»£ç†
deepseek_agent = DeepSeekAgent(model=&quot;deepseek-r1:1.5b&quot;, base_url=&quot;http://localhost:11434/v1/chat/completions&quot;)
user_agent = UserAgent()

# åˆ›å»ºç¾¤èŠ
group_chat = GroupChat(agents=[deepseek_agent, user_agent])
group_chat_manager = GroupChatManager(group_chat)

# å¯åŠ¨å¯¹è¯
def start_conversation():
    while True:
        try:
            user_input = input(&quot;You: &quot;)
            if user_input.lower() == &quot;exit&quot;:
                print(&quot;Exiting the conversation.&quot;)
                break
            
            response = group_chat_manager.handle_message(user_input)
            print(f&quot;DeepSeek: &#123;response&#125;&quot;)
        
        except KeyboardInterrupt:
            print(&quot;\nExiting the conversation due to user interrupt.&quot;)
            break

if __name__ == &quot;__main__&quot;:
    start_conversation()
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#ffa2c4>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/02/27/AI/AutoGen/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/02/26/AI/python/">
        <h2>
            python
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/2/26
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="Python-åŸºç¡€åˆçº§"><a href="#Python-åŸºç¡€åˆçº§" class="headerlink" title="Python åŸºç¡€åˆçº§"></a><span style = "color:red">Python åŸºç¡€åˆçº§</span></h1><h6 id="printå‡½æ•°è¾“å‡ºæ•°ç»„"><a href="#printå‡½æ•°è¾“å‡ºæ•°ç»„" class="headerlink" title="printå‡½æ•°è¾“å‡ºæ•°ç»„"></a>printå‡½æ•°è¾“å‡ºæ•°ç»„</h6><pre><code class="python">py3.xä½¿ç”¨è¾“å‡ºé›†åˆ
list = [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]
print (list)
-------------------
[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]
</code></pre>
<h6 id="å¸¦å¼•å·çš„æ˜¯åŒä¸€è¡Œæ˜¾ç¤ºå¤šæ¡è¯­å¥"><a href="#å¸¦å¼•å·çš„æ˜¯åŒä¸€è¡Œæ˜¾ç¤ºå¤šæ¡è¯­å¥" class="headerlink" title="å¸¦å¼•å·çš„æ˜¯åŒä¸€è¡Œæ˜¾ç¤ºå¤šæ¡è¯­å¥"></a>å¸¦å¼•å·çš„æ˜¯åŒä¸€è¡Œæ˜¾ç¤ºå¤šæ¡è¯­å¥</h6><pre><code class="python">print(&#39;hello&#39;); print(&#39;world&#39;)
</code></pre>
<h6 id="pyä»£ç å—ä¸èƒ½ä½¿ç”¨å¤§æ‹¬å·-åªèƒ½ç”¨ç¼©è¿›"><a href="#pyä»£ç å—ä¸èƒ½ä½¿ç”¨å¤§æ‹¬å·-åªèƒ½ç”¨ç¼©è¿›" class="headerlink" title="pyä»£ç å—ä¸èƒ½ä½¿ç”¨å¤§æ‹¬å· åªèƒ½ç”¨ç¼©è¿›"></a>pyä»£ç å—ä¸èƒ½ä½¿ç”¨å¤§æ‹¬å· åªèƒ½ç”¨ç¼©è¿›</h6><pre><code class="python">if True:
    print(&#39;true&#39;)
else:
    print(&#39;false&#39;)
</code></pre>
<h6 id="å¤šè¡Œè¯­å¥å¯ä»¥ç”¨æ–œæ "><a href="#å¤šè¡Œè¯­å¥å¯ä»¥ç”¨æ–œæ " class="headerlink" title="å¤šè¡Œè¯­å¥å¯ä»¥ç”¨æ–œæ ( \ )"></a>å¤šè¡Œè¯­å¥å¯ä»¥ç”¨æ–œæ ( \ )</h6><h6 id="å¤šè¡Œæ³¨é‡Šå¯ä»¥ç”¨-å•å¼•å·-ä¹Ÿå¯ä»¥ç”¨åŒå¼•å·"><a href="#å¤šè¡Œæ³¨é‡Šå¯ä»¥ç”¨-å•å¼•å·-ä¹Ÿå¯ä»¥ç”¨åŒå¼•å·" class="headerlink" title="å¤šè¡Œæ³¨é‡Šå¯ä»¥ç”¨ å•å¼•å· ä¹Ÿå¯ä»¥ç”¨åŒå¼•å·"></a>å¤šè¡Œæ³¨é‡Šå¯ä»¥ç”¨ å•å¼•å· ä¹Ÿå¯ä»¥ç”¨åŒå¼•å·</h6><pre><code class="python"># å¤šå¼•å·
&quot;&quot;&quot;
111

1
&quot;&quot;&quot;

# å•å¼•å·
&#39;&#39;&#39;
1
1
1
&#39;&#39;&#39;
</code></pre>
<h6 id="printè¾“å‡ºæ˜¯å¦æ¢è¡Œ-ä¸æ¢è¡Œå°±æœ«å°¾åŠ é€—å·-åœ¨py3ä¹‹åå°±è¦ç”¨end-x3D-â€-â€œ"><a href="#printè¾“å‡ºæ˜¯å¦æ¢è¡Œ-ä¸æ¢è¡Œå°±æœ«å°¾åŠ é€—å·-åœ¨py3ä¹‹åå°±è¦ç”¨end-x3D-â€-â€œ" class="headerlink" title="printè¾“å‡ºæ˜¯å¦æ¢è¡Œ ä¸æ¢è¡Œå°±æœ«å°¾åŠ é€—å· åœ¨py3ä¹‹åå°±è¦ç”¨end&#x3D;â€ â€œ"></a>printè¾“å‡ºæ˜¯å¦æ¢è¡Œ ä¸æ¢è¡Œå°±æœ«å°¾åŠ é€—å· åœ¨py3ä¹‹åå°±è¦ç”¨end&#x3D;â€ â€œ</h6><pre><code class="python">x = &quot;a&quot;
y = &quot;b&quot;
print(x, end=&quot; &quot;)
print(y)
</code></pre>
<h6 id="æ•´å‹-æµ®ç‚¹-å­—ç¬¦ä¸²"><a href="#æ•´å‹-æµ®ç‚¹-å­—ç¬¦ä¸²" class="headerlink" title="æ•´å‹ æµ®ç‚¹ å­—ç¬¦ä¸²"></a>æ•´å‹ æµ®ç‚¹ å­—ç¬¦ä¸²</h6><pre><code class="python">counter = 100
miles = 100.0
name = &quot;Runoob&quot;

print(counter)
print(miles)
print(name)
</code></pre>
<h6 id="åŠ å·æ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦-å‹å·æ˜¯é‡å¤æ“ä½œ"><a href="#åŠ å·æ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦-å‹å·æ˜¯é‡å¤æ“ä½œ" class="headerlink" title="åŠ å·æ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦ å‹å·æ˜¯é‡å¤æ“ä½œ"></a>åŠ å·æ˜¯å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦ å‹å·æ˜¯é‡å¤æ“ä½œ</h6><pre><code class="python">str = &quot;Hello World!&quot;
print(str * 2)
print(str + &quot;TEST&quot;)

list = [&#39;sac&#39;, 123, 2.32, &#39;john&#39;, 70.2]
print list[2:] # è¾“å‡ºä»ç¬¬ä¸‰ä¸ªå¼€å§‹è‡³åˆ—è¡¨æœ«å°¾çš„æ‰€æœ‰å…ƒç´ 
-------------------
Hello World!Hello World!
Hello World!TEST

[2.32, &#39;john&#39;, 70.2]
</code></pre>
<h6 id="åˆ—è¡¨æ˜¯æœ‰åºçš„å¯¹è±¡é›†åˆï¼Œå­—å…¸æ˜¯æ— åºçš„å¯¹è±¡é›†åˆ"><a href="#åˆ—è¡¨æ˜¯æœ‰åºçš„å¯¹è±¡é›†åˆï¼Œå­—å…¸æ˜¯æ— åºçš„å¯¹è±¡é›†åˆ" class="headerlink" title="åˆ—è¡¨æ˜¯æœ‰åºçš„å¯¹è±¡é›†åˆï¼Œå­—å…¸æ˜¯æ— åºçš„å¯¹è±¡é›†åˆ"></a>åˆ—è¡¨æ˜¯æœ‰åºçš„å¯¹è±¡é›†åˆï¼Œå­—å…¸æ˜¯æ— åºçš„å¯¹è±¡é›†åˆ</h6><p>ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«åœ¨äºï¼šå­—å…¸å½“ä¸­çš„å…ƒç´ æ˜¯é€šè¿‡é”®æ¥å­˜å–çš„ï¼Œè€Œä¸æ˜¯é€šè¿‡åç§»å­˜å‚¨<br>å­—å…¸ç”¨â€™{ }â€™æ ‡è¯†ï¼Œå­—å…¸ç”±ç´¢å¼•(key)å’Œå®ƒå¯¹åº”çš„å€¼valueç»„æˆ</p>
<blockquote>
<p>Pythonä¸­çš„é›†åˆï¼ˆSetï¼‰ã€å…ƒç»„ï¼ˆTupleï¼‰å’Œå­—å…¸ï¼ˆDictionaryï¼‰æ˜¯ä¸‰ç§ä¸åŒçš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œç”¨é€”ï¼š</p>
<ol>
<li><strong>é›†åˆï¼ˆSetï¼‰</strong>ï¼š<ul>
<li>æ— åºçš„é›†åˆæ•°æ®ç±»å‹ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å…ƒç´ ã€‚</li>
<li>æ”¯æŒé›†åˆçš„æ•°å­¦è¿ç®—ï¼Œå¦‚å¹¶é›†ã€äº¤é›†ã€å·®é›†ç­‰ã€‚</li>
<li>ç”¨å¤§æ‹¬å· <code>&#123;&#125;</code> æˆ–è€… <code>set()</code> å‡½æ•°æ¥åˆ›å»ºï¼Œä½†ç©ºé›†åˆåªèƒ½ç”¨ <code>set()</code> åˆ›å»ºï¼Œå› ä¸º <code>&#123;&#125;</code> åˆ›å»ºçš„æ˜¯ç©ºå­—å…¸ã€‚</li>
<li>ä¾‹å­ï¼š<code>&#123;1, 2, 3&#125;</code></li>
</ul>
</li>
<li><strong>å…ƒç»„ï¼ˆTupleï¼‰</strong>ï¼š<ul>
<li>æœ‰åºçš„é›†åˆæ•°æ®ç±»å‹ï¼Œå…ƒç´ ç”¨åœ†æ‹¬å· <code>()</code> æ‹¬èµ·æ¥ã€‚</li>
<li>å…ƒç»„ä¸­çš„å…ƒç´ ä¸å¯ä¿®æ”¹ï¼Œå³ä¸€æ—¦åˆ›å»ºï¼Œå°±ä¸èƒ½æ›´æ”¹å…¶å†…å®¹ã€‚</li>
<li>å…ƒç»„å¯ä»¥åŒ…å«ä¸åŒç±»å‹çš„å…ƒç´ ã€‚</li>
<li>ä¾‹å­ï¼š<code>(1, &quot;hello&quot;, 3.14)</code></li>
</ul>
</li>
<li><strong>å­—å…¸ï¼ˆDictionaryï¼‰</strong>ï¼š<ul>
<li>æ— åºçš„é”®å€¼å¯¹é›†åˆï¼Œæ¯ä¸ªé”®éƒ½æ˜¯å”¯ä¸€çš„ã€‚</li>
<li>é”®å’Œå€¼ä¹‹é—´ç”¨å†’å· <code>:</code> åˆ†éš”ï¼Œå¤šä¸ªé”®å€¼å¯¹ä¹‹é—´ç”¨é€—å· <code>,</code> åˆ†éš”ï¼Œæ•´ä¸ªå­—å…¸åŒ…æ‹¬åœ¨å¤§æ‹¬å· <code>&#123;&#125;</code> ä¸­ã€‚</li>
<li>é”®å¿…é¡»æ˜¯ä¸å¯å˜çš„æ•°æ®ç±»å‹ï¼Œå¦‚å­—ç¬¦ä¸²ã€æ•°å­—æˆ–å…ƒç»„ï¼Œè€Œå€¼å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ã€‚</li>
<li>å¯ä»¥é€šè¿‡é”®æ¥è®¿é—®ã€ä¿®æ”¹æˆ–åˆ é™¤å¯¹åº”çš„å€¼ã€‚</li>
<li>ä¾‹å­ï¼š<code>&#123;&quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: 25&#125;</code></li>
</ul>
</li>
</ol>
<p>æ€»ç»“åŒºåˆ«ï¼š</p>
<ul>
<li><strong>å”¯ä¸€æ€§</strong>ï¼šé›†åˆå’Œå­—å…¸ä¸­çš„å…ƒç´ ï¼ˆå¯¹äºé›†åˆæ˜¯å…ƒç´ ï¼Œå¯¹äºå­—å…¸æ˜¯é”®ï¼‰éƒ½æ˜¯å”¯ä¸€çš„ï¼Œè€Œå…ƒç»„ä¸­çš„å…ƒç´ å¯ä»¥é‡å¤ã€‚</li>
<li><strong>å¯å˜æ€§</strong>ï¼šé›†åˆå’Œå­—å…¸æ˜¯å¯å˜çš„ï¼Œå¯ä»¥æ·»åŠ ã€åˆ é™¤å…ƒç´ ï¼Œè€Œå…ƒç»„æ˜¯ä¸å¯å˜çš„ã€‚</li>
<li><strong>æœ‰åºæ€§</strong>ï¼šå…ƒç»„æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥ç´¢å¼•è®¿é—®ï¼›é›†åˆå’Œå­—å…¸æ˜¯æ— åºçš„ï¼Œä¸èƒ½é€šè¿‡ç´¢å¼•è®¿é—®ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼šé›†åˆç”¨äºå¤„ç†é›†åˆæ“ä½œï¼Œå­—å…¸ç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼Œå…ƒç»„ç”¨äºå­˜å‚¨ä¸å¯å˜çš„æœ‰åºå…ƒç´ </li>
</ul>
</blockquote>
<pre><code class="python">tinydict = &#123;&#39;name&#39;: &#39;runoob&#39;,&#39;code&#39;:6734, &#39;dept&#39;:&#39;sales&#39;&#125;
print(tinydict)
print(tinydict.keys())
print(tinydict.values())
------------------------------------
&#123;&#39;name&#39;: &#39;runoob&#39;, &#39;code&#39;: 6734, &#39;dept&#39;: &#39;sales&#39;&#125;
dict_keys([&#39;name&#39;, &#39;code&#39;, &#39;dept&#39;])
dict_values([&#39;runoob&#39;, 6734, &#39;sales&#39;])
</code></pre>
<h6 id="ç®—æœ¯è¿ç®—ç¬¦"><a href="#ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦"></a>ç®—æœ¯è¿ç®—ç¬¦</h6><blockquote>
<p>â€˜<em>â€˜ ä¸¤ä¸ªæ•°ç›¸ä¹˜<br>â€˜%â€™ è¿”å›é™¤æ³•çš„ä½™æ•° â€” å–æ¨¡<br>â€˜**â€™ å¹‚ è¿”å›xçš„yæ¬¡å¹‚        a * * bä¸º10çš„20æ¬¡æ–¹<br>â€˜</em> *&#x3D;â€™                                  c * * &#x3D; a ç­‰æ•ˆäº c &#x3D; c * * a</p>
</blockquote>
<h6 id="æ¯”è¾ƒè¿ç®—ç¬¦"><a href="#æ¯”è¾ƒè¿ç®—ç¬¦" class="headerlink" title="æ¯”è¾ƒè¿ç®—ç¬¦"></a>æ¯”è¾ƒè¿ç®—ç¬¦</h6><blockquote>
<p>â€˜&lt;&gt;â€™ ä¸ç­‰äº ç±»ä¼¼äº !&#x3D;</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">è¿ç®—ç¬¦</th>
<th align="left">æè¿°</th>
<th align="left">å®ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&amp;</td>
<td align="left">æŒ‰ä½ä¸è¿ç®—ç¬¦ï¼šå‚ä¸è¿ç®—çš„ä¸¤ä¸ªå€¼,å¦‚æœä¸¤ä¸ªç›¸åº”ä½éƒ½ä¸º1,åˆ™è¯¥ä½çš„ç»“æœä¸º1,å¦åˆ™ä¸º0</td>
<td align="left">(a &amp; b) è¾“å‡ºç»“æœ 12 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0000 1100</td>
</tr>
<tr>
<td align="left">|</td>
<td align="left">æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼šåªè¦å¯¹åº”çš„äºŒä¸ªäºŒè¿›ä½æœ‰ä¸€ä¸ªä¸º1æ—¶ï¼Œç»“æœä½å°±ä¸º1ã€‚</td>
<td align="left">(a | b) è¾“å‡ºç»“æœ 61 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0011 1101</td>
</tr>
<tr>
<td align="left">^</td>
<td align="left">æŒ‰ä½å¼‚æˆ–è¿ç®—ç¬¦ï¼šå½“ä¸¤å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æ—¶ï¼Œç»“æœä¸º1</td>
<td align="left">(a ^ b) è¾“å‡ºç»“æœ 49 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0011 0001</td>
</tr>
<tr>
<td align="left">~</td>
<td align="left">æŒ‰ä½å–åè¿ç®—ç¬¦ï¼šå°†äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„æ¯ä¸€ä½å–åï¼Œ0 å˜ä¸º 1ï¼Œ1 å˜ä¸º 0ã€‚**~x** ç±»ä¼¼äº <strong>-x-1</strong></td>
<td align="left">(~a ) è¾“å‡ºç»“æœ -61 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 1100 0011 (ä»¥è¡¥ç å½¢å¼è¡¨ç¤º)ï¼Œåœ¨ä¸€ä¸ªæœ‰ç¬¦å·äºŒè¿›åˆ¶æ•°çš„è¡¥ç å½¢å¼ã€‚</td>
</tr>
<tr>
<td align="left">&lt;&lt;</td>
<td align="left">å·¦ç§»åŠ¨è¿ç®—ç¬¦ï¼šè¿ç®—æ•°çš„å„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»è‹¥å¹²ä½ï¼Œç”± <strong>&lt;&lt;</strong> å³è¾¹çš„æ•°å­—æŒ‡å®šäº†ç§»åŠ¨çš„ä½æ•°ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0ã€‚</td>
<td align="left">a &lt;&lt; 2 è¾“å‡ºç»“æœ 240 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 1111 0000</td>
</tr>
<tr>
<td align="left">&gt;&gt;</td>
<td align="left">å³ç§»åŠ¨è¿ç®—ç¬¦ï¼šæŠŠâ€&gt;&gt;â€å·¦è¾¹çš„è¿ç®—æ•°çš„å„äºŒè¿›ä½å…¨éƒ¨å³ç§»è‹¥å¹²ä½ï¼Œ**&gt;&gt;** å³è¾¹çš„æ•°å­—æŒ‡å®šäº†ç§»åŠ¨çš„ä½æ•°</td>
<td align="left">a &gt;&gt; 2 è¾“å‡ºç»“æœ 15 ï¼ŒäºŒè¿›åˆ¶è§£é‡Šï¼š 0000 1111</td>
</tr>
</tbody></table>
<h6 id="æˆå‘˜è¿ç®—ç¬¦"><a href="#æˆå‘˜è¿ç®—ç¬¦" class="headerlink" title="æˆå‘˜è¿ç®—ç¬¦"></a>æˆå‘˜è¿ç®—ç¬¦</h6><p>é™¤äº†ä»¥ä¸Šçš„ä¸€äº›è¿ç®—ç¬¦ä¹‹å¤–ï¼ŒPythonè¿˜æ”¯æŒæˆå‘˜è¿ç®—ç¬¦ï¼Œæµ‹è¯•å®ä¾‹ä¸­åŒ…å«äº†ä¸€ç³»åˆ—çš„æˆå‘˜ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ï¼Œåˆ—è¡¨æˆ–å…ƒç»„ã€‚</p>
<table>
<thead>
<tr>
<th align="left">è¿ç®—ç¬¦</th>
<th align="left">æè¿°</th>
<th align="left">å®ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">in</td>
<td align="left">å¦‚æœåœ¨æŒ‡å®šçš„åºåˆ—ä¸­æ‰¾åˆ°å€¼è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td>
<td align="left">x åœ¨ y åºåˆ—ä¸­ , å¦‚æœ x åœ¨ y åºåˆ—ä¸­è¿”å› Trueã€‚</td>
</tr>
<tr>
<td align="left">not in</td>
<td align="left">å¦‚æœåœ¨æŒ‡å®šçš„åºåˆ—ä¸­æ²¡æœ‰æ‰¾åˆ°å€¼è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td>
<td align="left">x ä¸åœ¨ y åºåˆ—ä¸­ , å¦‚æœ x ä¸åœ¨ y åºåˆ—ä¸­è¿”å› Trueã€‚</td>
</tr>
</tbody></table>
<pre><code class="python">a = 10
b = 20
list = [1,2,3,4,5];
if(a in list):
    print(&quot;a åœ¨åˆ—è¡¨å†…&quot;)
else:
    print(&quot;a ä¸åœ¨åˆ—è¡¨å†…&quot;)
if(b not in list):
    print(&quot;b ä¸åœ¨åˆ—è¡¨å†…&quot;)
else:
    print(&quot;b åœ¨åˆ—è¡¨å†…&quot;)
--------------------------
a ä¸åœ¨åˆ—è¡¨å†…
b ä¸åœ¨åˆ—è¡¨å†…
</code></pre>
<h6 id="èº«ä»½è¿ç®—ç¬¦"><a href="#èº«ä»½è¿ç®—ç¬¦" class="headerlink" title="èº«ä»½è¿ç®—ç¬¦"></a>èº«ä»½è¿ç®—ç¬¦</h6><table>
<thead>
<tr>
<th align="left">ç®—ç¬¦</th>
<th align="left">æè¿°</th>
<th align="left">å®ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">is</td>
<td align="left">is æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸æ˜¯å¼•ç”¨è‡ªä¸€ä¸ªå¯¹è±¡</td>
<td align="left"><strong>x is y</strong>, ç±»ä¼¼ <strong>id(x) &#x3D;&#x3D; id(y)</strong> , å¦‚æœå¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left">is not</td>
<td align="left">is not æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯ä¸æ˜¯å¼•ç”¨è‡ªä¸åŒå¯¹è±¡</td>
<td align="left"><strong>x is not y</strong> ï¼Œ ç±»ä¼¼ **id(a) !&#x3D; id(b)**ã€‚å¦‚æœå¼•ç”¨çš„ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡åˆ™è¿”å›ç»“æœ Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td>
</tr>
</tbody></table>
<pre><code class="python">a1 = 20
b1 = 20
if(a1 is b1):
    print(&quot;a1 ä¸ b1 æ˜¯ç›¸åŒçš„å¯¹è±¡&quot;)
else:
    print(&quot;a1 ä¸ b1 ä¸æ˜¯ç›¸åŒçš„å¯¹è±¡&quot;)

if(a1 is not b1):
    print(&quot;a1 ä¸ b1 ä¸æ˜¯ç›¸åŒçš„å¯¹è±¡&quot;)
else:
    print(&quot;a1 ä¸ b1 æ˜¯ç›¸åŒçš„å¯¹è±¡&quot;)
----------------------------------
a1 ä¸ b1 æ˜¯ç›¸åŒçš„å¯¹è±¡
a1 ä¸ b1 æ˜¯ç›¸åŒçš„å¯¹è±¡
</code></pre>
<h6 id="whileå¾ªç¯è¯­å¥-continue-break"><a href="#whileå¾ªç¯è¯­å¥-continue-break" class="headerlink" title="whileå¾ªç¯è¯­å¥ + continue + break"></a>whileå¾ªç¯è¯­å¥ + continue + break</h6><pre><code class="python">count = 0
while(count &lt; 9):
    print(&#39;The count is:&#39;, count)
    count = count + 1
print(&quot;Good bye!&quot;)
--------------------------------
The count is: 0
The count is: 1
The count is: 2
The count is: 3
The count is: 4
The count is: 5
The count is: 6
The count is: 7
The count is: 8
Good bye!
</code></pre>
<pre><code class="python">count = 0
while(count &lt; 9):
    print(&#39;The count is:&#39;, count)
    count = count + 1
    print(&quot;Good bye!&quot;)
---------------------------------
The count is: 0
Good bye!
The count is: 1
Good bye!
The count is: 2
Good bye!
The count is: 3
Good bye!
The count is: 4
Good bye!
The count is: 5
Good bye!
The count is: 6
Good bye!
The count is: 7
Good bye!
The count is: 8
Good bye!
</code></pre>
<hr>
<pre><code class="python"># continue å’Œ break ç”¨æ³•
 
i = 1
while i &lt; 10:   
    i += 1
    if i%2 &gt; 0:     # éåŒæ•°æ—¶è·³è¿‡è¾“å‡º
        continue
    print i         # è¾“å‡ºåŒæ•°2ã€4ã€6ã€8ã€10
 
i = 1
while 1:            # å¾ªç¯æ¡ä»¶ä¸º1å¿…å®šæˆç«‹
    print i         # è¾“å‡º1~10
    i += 1
    if i &gt; 10:     # å½“iå¤§äº10æ—¶è·³å‡ºå¾ªç¯
        break
</code></pre>
<h6 id="forå¾ªç¯è¯­å¥"><a href="#forå¾ªç¯è¯­å¥" class="headerlink" title="forå¾ªç¯è¯­å¥"></a>forå¾ªç¯è¯­å¥</h6><pre><code class="python">for letter in &#39;Python&#39;:
    print(&#39;å½“å‰å­—æ¯ : %s&#39; %letter)

fruits = [&#39;banana&#39;, &#39;apple&#39;,  &#39;mango&#39;]
for fruit in fruits:
    print(&#39;å½“å‰æ°´æœ :&#39;, fruit)
print(&#39;Good bye!&#39;)
--------------------------------------
å½“å‰å­—æ¯ : P
å½“å‰å­—æ¯ : y
å½“å‰å­—æ¯ : t
å½“å‰å­—æ¯ : h
å½“å‰å­—æ¯ : o
å½“å‰å­—æ¯ : n
å½“å‰æ°´æœ : banana
å½“å‰æ°´æœ : apple
å½“å‰æ°´æœ : mango
Good bye!
</code></pre>
<h6 id="å¾ªç¯åµŒå¥—"><a href="#å¾ªç¯åµŒå¥—" class="headerlink" title="å¾ªç¯åµŒå¥—"></a>å¾ªç¯åµŒå¥—</h6><p>Python è¯­è¨€å…è®¸åœ¨ä¸€ä¸ªå¾ªç¯ä½“é‡Œé¢åµŒå…¥å¦ä¸€ä¸ªå¾ªç¯ã€‚</p>
<h6 id="Python-for-å¾ªç¯åµŒå¥—è¯­æ³•ï¼š"><a href="#Python-for-å¾ªç¯åµŒå¥—è¯­æ³•ï¼š" class="headerlink" title="Python for å¾ªç¯åµŒå¥—è¯­æ³•ï¼š"></a><strong>Python for å¾ªç¯åµŒå¥—è¯­æ³•ï¼š</strong></h6><pre><code class="python">for iterating_var in sequence:
   for iterating_var in sequence:
      statements(s)
   statements(s)
</code></pre>
<h6 id="Python-while-å¾ªç¯åµŒå¥—è¯­æ³•ï¼š"><a href="#Python-while-å¾ªç¯åµŒå¥—è¯­æ³•ï¼š" class="headerlink" title="Python while å¾ªç¯åµŒå¥—è¯­æ³•ï¼š"></a><strong>Python while å¾ªç¯åµŒå¥—è¯­æ³•ï¼š</strong></h6><pre><code class="python">while expression:
   while expression:
      statement(s)
   statement(s)
</code></pre>
<h6 id="Python-break-ç”¨æ³•"><a href="#Python-break-ç”¨æ³•" class="headerlink" title="Python break ç”¨æ³•"></a>Python break ç”¨æ³•</h6><pre><code class="python">for letter in &#39;python&#39;:
    if letter == &#39;h&#39;:
        break
    print(&#39;å½“å‰å­—æ¯ :&#39;, letter)
------------------------------
å½“å‰å­—æ¯ : p
å½“å‰å­—æ¯ : y
å½“å‰å­—æ¯ : t
</code></pre>
<h6 id="Python-pass-ç”¨æ³•"><a href="#Python-pass-ç”¨æ³•" class="headerlink" title="Python pass ç”¨æ³•"></a>Python pass ç”¨æ³•</h6><pre><code class="python">åœ¨ Python ä¸­æœ‰æ—¶å€™ä¼šçœ‹åˆ°ä¸€ä¸ª def å‡½æ•°:

def sample(n_samples):
    pass

è¯¥å¤„çš„ pass ä¾¿æ˜¯å æ®ä¸€ä¸ªä½ç½®ï¼Œå› ä¸ºå¦‚æœå®šä¹‰ä¸€ä¸ªç©ºå‡½æ•°ç¨‹åºä¼šæŠ¥é”™
å½“ä½ æ²¡æœ‰æƒ³å¥½å‡½æ•°çš„å†…å®¹æ˜¯å¯ä»¥ç”¨ pass å¡«å……ï¼Œä½¿ç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œ

-----------------------------------

åœ¨ Python3.x çš„æ—¶å€™ pass å¯ä»¥å†™æˆ–ä¸å†™ã€‚
python2.xï¼š

def function():
    # ç©ºå‡½æ•°åœ¨Python2.xç‰ˆæœ¬ä¸­passæ˜¯å¿…é¡»çš„
    pass
python3.x

def function():
    # åœ¨Python3.xçš„æ—¶å€™passå¯ä»¥å†™æˆ–ä¸å†™
    pass
</code></pre>
<h6 id="Python-Numberæ•°å­—"><a href="#Python-Numberæ•°å­—" class="headerlink" title="Python Numberæ•°å­—"></a>Python Numberæ•°å­—</h6><p>Python Number æ•°æ®ç±»å‹ç”¨äºå­˜å‚¨æ•°å€¼ã€‚<br>æ•°æ®ç±»å‹æ˜¯ä¸å…è®¸æ”¹å˜çš„,è¿™å°±æ„å‘³ç€å¦‚æœæ”¹å˜ Number æ•°æ®ç±»å‹çš„å€¼ï¼Œå°†é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ã€‚<br>ä»¥ä¸‹å®ä¾‹åœ¨å˜é‡èµ‹å€¼æ—¶ Number å¯¹è±¡å°†è¢«åˆ›å»ºï¼š</p>
<pre><code class="python">var1 = 1
var2 = 10
</code></pre>
<p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨delè¯­å¥åˆ é™¤ä¸€äº› Number å¯¹è±¡å¼•ç”¨ã€‚<br>delè¯­å¥çš„è¯­æ³•æ˜¯ï¼š</p>
<pre><code class="python">del var1[,var2[,var3[....,varN]]]]
</code></pre>
<p>æ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨delè¯­å¥åˆ é™¤å•ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="python">del var
del var_a, var_b
</code></pre>
<p>Python æ”¯æŒå››ç§ä¸åŒçš„æ•°å€¼ç±»å‹ï¼š</p>
<ul>
<li><p><strong>æ•´å‹(Int)</strong> - é€šå¸¸è¢«ç§°ä¸ºæ˜¯æ•´å‹æˆ–æ•´æ•°ï¼Œæ˜¯æ­£æˆ–è´Ÿæ•´æ•°ï¼Œä¸å¸¦å°æ•°ç‚¹ã€‚</p>
</li>
<li><p><strong>é•¿æ•´å‹(long integers)</strong> - æ— é™å¤§å°çš„æ•´æ•°ï¼Œæ•´æ•°æœ€åæ˜¯ä¸€ä¸ªå¤§å†™æˆ–å°å†™çš„Lã€‚</p>
</li>
<li><p><strong>æµ®ç‚¹å‹(floating point real values)</strong> - æµ®ç‚¹å‹ç”±æ•´æ•°éƒ¨åˆ†ä¸å°æ•°éƒ¨åˆ†ç»„æˆï¼Œæµ®ç‚¹å‹ä¹Ÿå¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºï¼ˆ2.5e2 &#x3D; 2.5 x 102 &#x3D; 250ï¼‰</p>
</li>
<li><p><strong>å¤æ•°(complex numbers)</strong> - å¤æ•°ç”±å®æ•°éƒ¨åˆ†å’Œè™šæ•°éƒ¨åˆ†æ„æˆï¼Œå¯ä»¥ç”¨a + bj,æˆ–è€…complex(a,b)è¡¨ç¤ºï¼Œ å¤æ•°çš„å®éƒ¨aå’Œè™šéƒ¨béƒ½æ˜¯æµ®ç‚¹å‹ã€‚</p>
</li>
</ul>
<h6 id="Python-Number-ç±»å‹è½¬æ¢"><a href="#Python-Number-ç±»å‹è½¬æ¢" class="headerlink" title="Python Number ç±»å‹è½¬æ¢"></a>Python Number ç±»å‹è½¬æ¢</h6><pre><code class="python">int(x [,base ])         å°†xè½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°  
long(x [,base ])        å°†xè½¬æ¢ä¸ºä¸€ä¸ªé•¿æ•´æ•°  
float(x )               å°†xè½¬æ¢åˆ°ä¸€ä¸ªæµ®ç‚¹æ•°  
complex(real [,imag ])  åˆ›å»ºä¸€ä¸ªå¤æ•°  
str(x )                 å°†å¯¹è±¡ x è½¬æ¢ä¸ºå­—ç¬¦ä¸²  
repr(x )                å°†å¯¹è±¡ x è½¬æ¢ä¸ºè¡¨è¾¾å¼å­—ç¬¦ä¸²  
eval(str )              ç”¨æ¥è®¡ç®—åœ¨å­—ç¬¦ä¸²ä¸­çš„æœ‰æ•ˆPythonè¡¨è¾¾å¼,å¹¶è¿”å›ä¸€ä¸ªå¯¹è±¡  
tuple(s )               å°†åºåˆ— s è½¬æ¢ä¸ºä¸€ä¸ªå…ƒç»„  
list(s )                å°†åºåˆ— s è½¬æ¢ä¸ºä¸€ä¸ªåˆ—è¡¨  
chr(x )                 å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦  
unichr(x )              å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢ä¸ºUnicodeå­—ç¬¦  
ord(x )                 å°†ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå®ƒçš„æ•´æ•°å€¼  
hex(x )                 å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢ä¸ºä¸€ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ä¸²  
oct(x )                 å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢ä¸ºä¸€ä¸ªå…«è¿›åˆ¶å­—ç¬¦ä¸²  
</code></pre>
<h6 id="Python-math-æ¨¡å—ã€cmath-æ¨¡å—"><a href="#Python-math-æ¨¡å—ã€cmath-æ¨¡å—" class="headerlink" title="Python math æ¨¡å—ã€cmath æ¨¡å—"></a>Python math æ¨¡å—ã€cmath æ¨¡å—</h6><p>Python ä¸­æ•°å­¦è¿ç®—å¸¸ç”¨çš„å‡½æ•°åŸºæœ¬éƒ½åœ¨ math æ¨¡å—ã€cmath æ¨¡å—ä¸­ã€‚<br>Python math æ¨¡å—æä¾›äº†è®¸å¤šå¯¹æµ®ç‚¹æ•°çš„æ•°å­¦è¿ç®—å‡½æ•°ã€‚<br>Python cmath æ¨¡å—åŒ…å«äº†ä¸€äº›ç”¨äºå¤æ•°è¿ç®—çš„å‡½æ•°ã€‚<br><code>cmath</code> æ¨¡å—çš„å‡½æ•°è·Ÿ math æ¨¡å—å‡½æ•°åŸºæœ¬ä¸€è‡´ï¼ŒåŒºåˆ«æ˜¯ cmath æ¨¡å—è¿ç®—çš„æ˜¯å¤æ•°<br><code>math</code> æ¨¡å—è¿ç®—çš„æ˜¯æ•°å­¦è¿ç®—ã€‚<br>è¦ä½¿ç”¨ math æˆ– cmath å‡½æ•°å¿…é¡»å…ˆå¯¼å…¥ï¼š</p>
<p>æŸ¥çœ‹ math æŸ¥çœ‹åŒ…ä¸­çš„å†…å®¹:</p>
<pre><code>&gt;&gt;&gt; import math
&gt;&gt;&gt; dir(math)
[&#39;__doc__&#39;, &#39;__file__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan&#39;, &#39;atan2&#39;, &#39;atanh&#39;, &#39;ceil&#39;, &#39;copysign&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;degrees&#39;, &#39;e&#39;, &#39;erf&#39;, &#39;erfc&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;fabs&#39;, &#39;factorial&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;frexp&#39;, &#39;fsum&#39;, &#39;gamma&#39;, &#39;gcd&#39;, &#39;hypot&#39;, &#39;inf&#39;, &#39;isclose&#39;, &#39;isfinite&#39;, &#39;isinf&#39;, &#39;isnan&#39;, &#39;ldexp&#39;, &#39;lgamma&#39;, &#39;log&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log2&#39;, &#39;modf&#39;, &#39;nan&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;radians&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;tan&#39;, &#39;tanh&#39;, &#39;tau&#39;, &#39;trunc&#39;]
&gt;&gt;&gt;
</code></pre>
<p>ä¸‹æ–‡ä¼šä»‹ç»å„ä¸ªå‡½æ•°çš„å…·ä½“åº”ç”¨ã€‚</p>
<p>æŸ¥çœ‹ cmath æŸ¥çœ‹åŒ…ä¸­çš„å†…å®¹</p>
<pre><code>&gt;&gt;&gt; import cmath
&gt;&gt;&gt; dir(cmath)
[&#39;__doc__&#39;, &#39;__file__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__spec__&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;e&#39;, &#39;exp&#39;, &#39;inf&#39;, &#39;infj&#39;, &#39;isclose&#39;, &#39;isfinite&#39;, &#39;isinf&#39;, &#39;isnan&#39;, &#39;log&#39;, &#39;log10&#39;, &#39;nan&#39;, &#39;nanj&#39;, &#39;phase&#39;, &#39;pi&#39;, &#39;polar&#39;, &#39;rect&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;tan&#39;, &#39;tanh&#39;, &#39;tau&#39;]
&gt;&gt;&gt;
</code></pre>
<h6 id="Pythonæ•°å­¦å‡½æ•°"><a href="#Pythonæ•°å­¦å‡½æ•°" class="headerlink" title="Pythonæ•°å­¦å‡½æ•°"></a>Pythonæ•°å­¦å‡½æ•°</h6><table>
<thead>
<tr>
<th align="left">å‡½æ•°</th>
<th align="left">è¿”å›å€¼ ( æè¿° )</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-abs.html">abs(x)</a></td>
<td align="left">è¿”å›æ•°å­—çš„ç»å¯¹å€¼ï¼Œå¦‚abs(-10) è¿”å› 10</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-ceil.html">ceil(x)</a></td>
<td align="left">è¿”å›æ•°å­—çš„ä¸Šå…¥æ•´æ•°ï¼Œå¦‚math.ceil(4.1) è¿”å› 5</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-cmp.html">cmp(x, y)</a></td>
<td align="left">å¦‚æœ x &lt; y è¿”å› -1, å¦‚æœ x &#x3D;&#x3D; y è¿”å› 0, å¦‚æœ x &gt; y è¿”å› 1</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-exp.html">exp(x)</a></td>
<td align="left">è¿”å›eçš„xæ¬¡å¹‚(ex),å¦‚math.exp(1) è¿”å›2.718281828459045</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-fabs.html">fabs(x)</a></td>
<td align="left">ä»¥æµ®ç‚¹æ•°å½¢å¼è¿”å›æ•°å­—çš„ç»å¯¹å€¼ï¼Œå¦‚math.fabs(-10) è¿”å›10.0</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-floor.html">floor(x)</a></td>
<td align="left">è¿”å›æ•°å­—çš„ä¸‹èˆæ•´æ•°ï¼Œå¦‚math.floor(4.9)è¿”å› 4</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-log.html">log(x)</a></td>
<td align="left">å¦‚math.log(math.e)è¿”å›1.0,math.log(100,10)è¿”å›2.0</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-log10.html">log10(x)</a></td>
<td align="left">è¿”å›ä»¥10ä¸ºåŸºæ•°çš„xçš„å¯¹æ•°ï¼Œå¦‚math.log10(100)è¿”å› 2.0</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-max.html">max(x1, x2,â€¦)</a></td>
<td align="left">è¿”å›ç»™å®šå‚æ•°çš„æœ€å¤§å€¼ï¼Œå‚æ•°å¯ä»¥ä¸ºåºåˆ—ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-min.html">min(x1, x2,â€¦)</a></td>
<td align="left">è¿”å›ç»™å®šå‚æ•°çš„æœ€å°å€¼ï¼Œå‚æ•°å¯ä»¥ä¸ºåºåˆ—ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-modf.html">modf(x)</a></td>
<td align="left">è¿”å›xçš„æ•´æ•°éƒ¨åˆ†ä¸å°æ•°éƒ¨åˆ†ï¼Œä¸¤éƒ¨åˆ†çš„æ•°å€¼ç¬¦å·ä¸xç›¸åŒï¼Œæ•´æ•°éƒ¨åˆ†ä»¥æµ®ç‚¹å‹è¡¨ç¤ºã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-pow.html">pow(x, y)</a></td>
<td align="left">x**y è¿ç®—åçš„å€¼ã€‚</td>
</tr>
<tr>
<td align="left">[round(x <a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-round.html">,n])</a></td>
<td align="left">è¿”å›æµ®ç‚¹æ•°xçš„å››èˆäº”å…¥å€¼ï¼Œå¦‚ç»™å‡ºnå€¼ï¼Œåˆ™ä»£è¡¨èˆå…¥åˆ°å°æ•°ç‚¹åçš„ä½æ•°ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-sqrt.html">sqrt(x)</a></td>
<td align="left">è¿”å›æ•°å­—xçš„å¹³æ–¹æ ¹</td>
</tr>
</tbody></table>
<h6 id="Pythonéšæœºæ•°å‡½æ•°"><a href="#Pythonéšæœºæ•°å‡½æ•°" class="headerlink" title="Pythonéšæœºæ•°å‡½æ•°"></a>Pythonéšæœºæ•°å‡½æ•°</h6><p>éšæœºæ•°å¯ä»¥ç”¨äºæ•°å­¦ï¼Œæ¸¸æˆï¼Œå®‰å…¨ç­‰é¢†åŸŸä¸­ï¼Œè¿˜ç»å¸¸è¢«åµŒå…¥åˆ°ç®—æ³•ä¸­ï¼Œç”¨ä»¥æé«˜ç®—æ³•æ•ˆç‡ï¼Œå¹¶æé«˜ç¨‹åºçš„å®‰å…¨æ€§ã€‚</p>
<p>PythonåŒ…å«ä»¥ä¸‹å¸¸ç”¨éšæœºæ•°å‡½æ•°ï¼š</p>
<table>
<thead>
<tr>
<th align="left">å‡½æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-choice.html">choice(seq)</a></td>
<td align="left">ä»åºåˆ—çš„å…ƒç´ ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚random.choice(range(10))ï¼Œä»0åˆ°9ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªæ•´æ•°ã€‚</td>
</tr>
<tr>
<td align="left">[randrange (<a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-randrange.html">start,] stop [,step])</a></td>
<td align="left">ä»æŒ‡å®šèŒƒå›´å†…ï¼ŒæŒ‰æŒ‡å®šåŸºæ•°é€’å¢çš„é›†åˆä¸­è·å–ä¸€ä¸ªéšæœºæ•°ï¼ŒåŸºæ•°é»˜è®¤å€¼ä¸º 1</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-random.html">random()</a></td>
<td align="left">éšæœºç”Ÿæˆä¸‹ä¸€ä¸ªå®æ•°ï¼Œå®ƒåœ¨[0,1)èŒƒå›´å†…ã€‚</td>
</tr>
<tr>
<td align="left"><u>seed([x])</u></td>
<td align="left">æ”¹å˜éšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­seedã€‚å¦‚æœä½ ä¸äº†è§£å…¶åŸç†ï¼Œä½ ä¸å¿…ç‰¹åˆ«å»è®¾å®šseedï¼ŒPythonä¼šå¸®ä½ é€‰æ‹©seedã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-shuffle.html">shuffle(lst)</a></td>
<td align="left">å°†åºåˆ—çš„æ‰€æœ‰å…ƒç´ éšæœºæ’åº</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-uniform.html">uniform(x, y)</a></td>
<td align="left">éšæœºç”Ÿæˆä¸‹ä¸€ä¸ªå®æ•°ï¼Œå®ƒåœ¨[x,y]èŒƒå›´å†…ã€‚</td>
</tr>
</tbody></table>
<h6 id="Pythonæ•°å­¦å¸¸é‡"><a href="#Pythonæ•°å­¦å¸¸é‡" class="headerlink" title="Pythonæ•°å­¦å¸¸é‡"></a>Pythonæ•°å­¦å¸¸é‡</h6><table>
<thead>
<tr>
<th align="left">å¸¸é‡</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">pi</td>
<td align="left">æ•°å­¦å¸¸é‡ piï¼ˆåœ†å‘¨ç‡ï¼Œä¸€èˆ¬ä»¥Ï€æ¥è¡¨ç¤ºï¼‰</td>
</tr>
<tr>
<td align="left">e</td>
<td align="left">æ•°å­¦å¸¸é‡ eï¼Œeå³è‡ªç„¶å¸¸æ•°ï¼ˆè‡ªç„¶å¸¸æ•°ï¼‰ã€‚</td>
</tr>
</tbody></table>
<h6 id="Python-å­—ç¬¦ä¸²"><a href="#Python-å­—ç¬¦ä¸²" class="headerlink" title="Python å­—ç¬¦ä¸²"></a>Python å­—ç¬¦ä¸²</h6><p>å­—ç¬¦ä¸²æ˜¯ Python ä¸­æœ€å¸¸ç”¨çš„æ•°æ®ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¼•å· ( <strong>â€˜</strong> æˆ– <strong>â€œ</strong> ) æ¥åˆ›å»ºå­—ç¬¦ä¸²ã€‚<br>åˆ›å»ºå­—ç¬¦ä¸²å¾ˆç®€å•ï¼Œåªè¦ä¸ºå˜é‡åˆ†é…ä¸€ä¸ªå€¼å³å¯ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="python">var1 = &#39;Hello World!&#39;
var2 = &quot;Python Runoob&quot;
</code></pre>
<h6 id="Python-å­—ç¬¦ä¸²æ ¼å¼åŒ–ç¬¦å·"><a href="#Python-å­—ç¬¦ä¸²æ ¼å¼åŒ–ç¬¦å·" class="headerlink" title="Python å­—ç¬¦ä¸²æ ¼å¼åŒ–ç¬¦å·"></a>Python å­—ç¬¦ä¸²æ ¼å¼åŒ–ç¬¦å·</h6><table>
<thead>
<tr>
<th align="left">ç¬¦  å·</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">%c</td>
<td align="left">æ ¼å¼åŒ–å­—ç¬¦åŠå…¶ASCIIç </td>
</tr>
<tr>
<td align="left">%s</td>
<td align="left">æ ¼å¼åŒ–å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left">%d</td>
<td align="left">æ ¼å¼åŒ–æ•´æ•°</td>
</tr>
<tr>
<td align="left">%u</td>
<td align="left">æ ¼å¼åŒ–æ— ç¬¦å·æ•´å‹</td>
</tr>
<tr>
<td align="left">%o</td>
<td align="left">æ ¼å¼åŒ–æ— ç¬¦å·å…«è¿›åˆ¶æ•°</td>
</tr>
<tr>
<td align="left">%x</td>
<td align="left">æ ¼å¼åŒ–æ— ç¬¦å·åå…­è¿›åˆ¶æ•°</td>
</tr>
<tr>
<td align="left">%X</td>
<td align="left">æ ¼å¼åŒ–æ— ç¬¦å·åå…­è¿›åˆ¶æ•°ï¼ˆå¤§å†™ï¼‰</td>
</tr>
<tr>
<td align="left">%f</td>
<td align="left">æ ¼å¼åŒ–æµ®ç‚¹æ•°å­—ï¼Œå¯æŒ‡å®šå°æ•°ç‚¹åçš„ç²¾åº¦</td>
</tr>
<tr>
<td align="left">%e</td>
<td align="left">ç”¨ç§‘å­¦è®¡æ•°æ³•æ ¼å¼åŒ–æµ®ç‚¹æ•°</td>
</tr>
<tr>
<td align="left">%E</td>
<td align="left">ä½œç”¨åŒ%eï¼Œç”¨ç§‘å­¦è®¡æ•°æ³•æ ¼å¼åŒ–æµ®ç‚¹æ•°</td>
</tr>
<tr>
<td align="left">%g</td>
<td align="left">%få’Œ%eçš„ç®€å†™</td>
</tr>
<tr>
<td align="left">%G</td>
<td align="left">%F å’Œ %E çš„ç®€å†™</td>
</tr>
<tr>
<td align="left">%p</td>
<td align="left">ç”¨åå…­è¿›åˆ¶æ•°æ ¼å¼åŒ–å˜é‡çš„åœ°å€</td>
</tr>
</tbody></table>
<h6 id="æ ¼å¼åŒ–æ“ä½œç¬¦è¾…åŠ©æŒ‡ä»¤"><a href="#æ ¼å¼åŒ–æ“ä½œç¬¦è¾…åŠ©æŒ‡ä»¤" class="headerlink" title="æ ¼å¼åŒ–æ“ä½œç¬¦è¾…åŠ©æŒ‡ä»¤:"></a>æ ¼å¼åŒ–æ“ä½œç¬¦è¾…åŠ©æŒ‡ä»¤:</h6><table>
<thead>
<tr>
<th align="left">ç¬¦å·</th>
<th align="left">åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td align="left">*</td>
<td align="left">å®šä¹‰å®½åº¦æˆ–è€…å°æ•°ç‚¹ç²¾åº¦</td>
</tr>
<tr>
<td align="left">-</td>
<td align="left">ç”¨åšå·¦å¯¹é½</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">åœ¨æ­£æ•°å‰é¢æ˜¾ç¤ºåŠ å·( + )</td>
</tr>
<tr>
<td align="left"><sp></td>
<td align="left">åœ¨æ­£æ•°å‰é¢æ˜¾ç¤ºç©ºæ ¼</td>
</tr>
<tr>
<td align="left">#</td>
<td align="left">åœ¨å…«è¿›åˆ¶æ•°å‰é¢æ˜¾ç¤ºé›¶(â€˜0â€™)ï¼Œåœ¨åå…­è¿›åˆ¶å‰é¢æ˜¾ç¤ºâ€™0xâ€™æˆ–è€…â€™0Xâ€™(å–å†³äºç”¨çš„æ˜¯â€™xâ€™è¿˜æ˜¯â€™Xâ€™)</td>
</tr>
<tr>
<td align="left">0</td>
<td align="left">æ˜¾ç¤ºçš„æ•°å­—å‰é¢å¡«å……â€™0â€™è€Œä¸æ˜¯é»˜è®¤çš„ç©ºæ ¼</td>
</tr>
<tr>
<td align="left">%</td>
<td align="left">â€˜%%â€™è¾“å‡ºä¸€ä¸ªå•ä¸€çš„â€™%â€™</td>
</tr>
<tr>
<td align="left">(var)</td>
<td align="left">æ˜ å°„å˜é‡(å­—å…¸å‚æ•°)</td>
</tr>
<tr>
<td align="left">m.n.</td>
<td align="left">m æ˜¯æ˜¾ç¤ºçš„æœ€å°æ€»å®½åº¦,n æ˜¯å°æ•°ç‚¹åçš„ä½æ•°(å¦‚æœå¯ç”¨çš„è¯)</td>
</tr>
</tbody></table>
<h6 id="Python-çš„å­—ç¬¦ä¸²å†…å»ºå‡½æ•°"><a href="#Python-çš„å­—ç¬¦ä¸²å†…å»ºå‡½æ•°" class="headerlink" title="Python çš„å­—ç¬¦ä¸²å†…å»ºå‡½æ•°"></a>Python çš„å­—ç¬¦ä¸²å†…å»ºå‡½æ•°</h6><p>å­—ç¬¦ä¸²æ–¹æ³•æ˜¯ä» Python1.6 åˆ° 2.0 æ…¢æ…¢åŠ è¿›æ¥çš„ â€”â€” å®ƒä»¬ä¹Ÿè¢«åŠ åˆ°äº†Jython ä¸­ã€‚</p>
<p>è¿™äº›æ–¹æ³•å®ç°äº† string æ¨¡å—çš„å¤§éƒ¨åˆ†æ–¹æ³•ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºåˆ—å‡ºäº†ç›®å‰å­—ç¬¦ä¸²å†…å»ºæ”¯æŒçš„æ–¹æ³•ï¼Œæ‰€æœ‰çš„æ–¹æ³•éƒ½åŒ…å«äº†å¯¹ Unicode çš„æ”¯æŒï¼Œæœ‰ä¸€äº›ç”šè‡³æ˜¯ä¸“é—¨ç”¨äº Unicode çš„ã€‚</p>
<table>
<thead>
<tr>
<th align="left"><strong>æ–¹æ³•</strong></th>
<th align="left"><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-capitalize.html">string.capitalize()</a></td>
<td align="left">æŠŠå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤§å†™</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-center.html">string.center(width)</a></td>
<td align="left">è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å±…ä¸­,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-count.html">string.count(str, beg&#x3D;0, end&#x3D;len(string))</a></strong></td>
<td align="left">è¿”å› str åœ¨ string é‡Œé¢å‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœ beg æˆ–è€… end æŒ‡å®šåˆ™è¿”å›æŒ‡å®šèŒƒå›´å†… str å‡ºç°çš„æ¬¡æ•°</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-decode.html">string.decode(encoding&#x3D;â€™UTF-8â€™, errors&#x3D;â€™strictâ€™)</a></td>
<td align="left">ä»¥ encoding æŒ‡å®šçš„ç¼–ç æ ¼å¼è§£ç  stringï¼Œå¦‚æœå‡ºé”™é»˜è®¤æŠ¥ä¸€ä¸ª ValueError çš„ å¼‚ å¸¸ ï¼Œ é™¤é errors æŒ‡ å®š çš„ æ˜¯ â€˜ignoreâ€™ æˆ– è€…â€™replaceâ€™</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-encode.html">string.encode(encoding&#x3D;â€™UTF-8â€™, errors&#x3D;â€™strictâ€™)</a></td>
<td align="left">ä»¥ encoding æŒ‡å®šçš„ç¼–ç æ ¼å¼ç¼–ç  stringï¼Œå¦‚æœå‡ºé”™é»˜è®¤æŠ¥ä¸€ä¸ªValueError çš„å¼‚å¸¸ï¼Œé™¤é errors æŒ‡å®šçš„æ˜¯â€™ignoreâ€™æˆ–è€…â€™replaceâ€™</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-endswith.html">string.endswith(obj, beg&#x3D;0, end&#x3D;len(string))</a></strong></td>
<td align="left">æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥ obj ç»“æŸï¼Œå¦‚æœbeg æˆ–è€… end æŒ‡å®šåˆ™æ£€æŸ¥æŒ‡å®šçš„èŒƒå›´å†…æ˜¯å¦ä»¥ obj ç»“æŸï¼Œå¦‚æœæ˜¯ï¼Œè¿”å› True,å¦åˆ™è¿”å› False.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-expandtabs.html">string.expandtabs(tabsize&#x3D;8)</a></td>
<td align="left">æŠŠå­—ç¬¦ä¸² string ä¸­çš„ tab ç¬¦å·è½¬ä¸ºç©ºæ ¼ï¼Œtab ç¬¦å·é»˜è®¤çš„ç©ºæ ¼æ•°æ˜¯ 8ã€‚</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-find.html">string.find(str, beg&#x3D;0, end&#x3D;len(string))</a></strong></td>
<td align="left">æ£€æµ‹ str æ˜¯å¦åŒ…å«åœ¨ string ä¸­ï¼Œå¦‚æœ beg å’Œ end æŒ‡å®šèŒƒå›´ï¼Œåˆ™æ£€æŸ¥æ˜¯å¦åŒ…å«åœ¨æŒ‡å®šèŒƒå›´å†…ï¼Œå¦‚æœæ˜¯è¿”å›å¼€å§‹çš„ç´¢å¼•å€¼ï¼Œå¦åˆ™è¿”å›-1</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-format.html">string.format()</a></strong></td>
<td align="left">æ ¼å¼åŒ–å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-index.html">string.index(str, beg&#x3D;0, end&#x3D;len(string))</a></strong></td>
<td align="left">è·Ÿfind()æ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡å¦‚æœsträ¸åœ¨ stringä¸­ä¼šæŠ¥ä¸€ä¸ªå¼‚å¸¸.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isalnum.html">string.isalnum()</a></td>
<td align="left">å¦‚æœ string è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦å¹¶ä¸”æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯æˆ–æ•°å­—åˆ™è¿”å› True,å¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isalpha.html">string.isalpha()</a></td>
<td align="left">å¦‚æœ string è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦å¹¶ä¸”æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯åˆ™è¿”å› True,å¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isdecimal.html">string.isdecimal()</a></td>
<td align="left">å¦‚æœ string åªåŒ…å«åè¿›åˆ¶æ•°å­—åˆ™è¿”å› True å¦åˆ™è¿”å› False.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isdigit.html">string.isdigit()</a></td>
<td align="left">å¦‚æœ string åªåŒ…å«æ•°å­—åˆ™è¿”å› True å¦åˆ™è¿”å› False.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-islower.html">string.islower()</a></td>
<td align="left">å¦‚æœ string ä¸­åŒ…å«è‡³å°‘ä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„å­—ç¬¦ï¼Œå¹¶ä¸”æ‰€æœ‰è¿™äº›(åŒºåˆ†å¤§å°å†™çš„)å­—ç¬¦éƒ½æ˜¯å°å†™ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isnumeric.html">string.isnumeric()</a></td>
<td align="left">å¦‚æœ string ä¸­åªåŒ…å«æ•°å­—å­—ç¬¦ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isspace.html">string.isspace()</a></td>
<td align="left">å¦‚æœ string ä¸­åªåŒ…å«ç©ºæ ¼ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-istitle.html">string.istitle()</a></td>
<td align="left">å¦‚æœ string æ˜¯æ ‡é¢˜åŒ–çš„(è§ title())åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-isupper.html">string.isupper()</a></td>
<td align="left">å¦‚æœ string ä¸­åŒ…å«è‡³å°‘ä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„å­—ç¬¦ï¼Œå¹¶ä¸”æ‰€æœ‰è¿™äº›(åŒºåˆ†å¤§å°å†™çš„)å­—ç¬¦éƒ½æ˜¯å¤§å†™ï¼Œåˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› False</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-join.html">string.join(seq)</a></strong></td>
<td align="left">ä»¥ string ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå°† seq ä¸­æ‰€æœ‰çš„å…ƒç´ (çš„å­—ç¬¦ä¸²è¡¨ç¤º)åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-ljust.html">string.ljust(width)</a></td>
<td align="left">è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å·¦å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-lower.html">string.lower()</a></td>
<td align="left">è½¬æ¢ string ä¸­æ‰€æœ‰å¤§å†™å­—ç¬¦ä¸ºå°å†™.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-lstrip.html">string.lstrip()</a></td>
<td align="left">æˆªæ‰ string å·¦è¾¹çš„ç©ºæ ¼</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-maketrans.html">string.maketrans(intab, outtab)</a></td>
<td align="left">maketrans() æ–¹æ³•ç”¨äºåˆ›å»ºå­—ç¬¦æ˜ å°„çš„è½¬æ¢è¡¨ï¼Œå¯¹äºæ¥å—ä¸¤ä¸ªå‚æ•°çš„æœ€ç®€å•çš„è°ƒç”¨æ–¹å¼ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºéœ€è¦è½¬æ¢çš„å­—ç¬¦ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¹Ÿæ˜¯å­—ç¬¦ä¸²è¡¨ç¤ºè½¬æ¢çš„ç›®æ ‡ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-max.html">max(str)</a></td>
<td align="left">è¿”å›å­—ç¬¦ä¸² <em>str</em> ä¸­æœ€å¤§çš„å­—æ¯ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-min.html">min(str)</a></td>
<td align="left">è¿”å›å­—ç¬¦ä¸² <em>str</em> ä¸­æœ€å°çš„å­—æ¯ã€‚</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-partition.html">string.partition(str)</a></strong></td>
<td align="left">æœ‰ç‚¹åƒ find()å’Œ split()çš„ç»“åˆä½“,ä» str å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½®èµ·,æŠŠ å­— ç¬¦ ä¸² string åˆ† æˆ ä¸€ ä¸ª 3 å…ƒ ç´  çš„ å…ƒ ç»„ (string_pre_str,str,string_post_str),å¦‚æœ string ä¸­ä¸åŒ…å«str åˆ™ string_pre_str &#x3D;&#x3D; string.</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-replace.html">string.replace(str1, str2, num&#x3D;string.count(str1))</a></strong></td>
<td align="left">æŠŠ string ä¸­çš„ str1 æ›¿æ¢æˆ str2,å¦‚æœ num æŒ‡å®šï¼Œåˆ™æ›¿æ¢ä¸è¶…è¿‡ num æ¬¡.</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-rfind.html">string.rfind(str, beg&#x3D;0,end&#x3D;len(string) )</a></td>
<td align="left">ç±»ä¼¼äº find() å‡½æ•°ï¼Œè¿”å›å­—ç¬¦ä¸²æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…é¡¹åˆ™è¿”å› -1ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-rindex.html">string.rindex( str, beg&#x3D;0,end&#x3D;len(string))</a></td>
<td align="left">ç±»ä¼¼äº index()ï¼Œä¸è¿‡æ˜¯è¿”å›æœ€åä¸€ä¸ªåŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²çš„ç´¢å¼•å·ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-rjust.html">string.rjust(width)</a></td>
<td align="left">è¿”å›ä¸€ä¸ªåŸå­—ç¬¦ä¸²å³å¯¹é½,å¹¶ä½¿ç”¨ç©ºæ ¼å¡«å……è‡³é•¿åº¦ width çš„æ–°å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-rpartition.html">string.rpartition(str)</a></td>
<td align="left">ç±»ä¼¼äº partition()å‡½æ•°,ä¸è¿‡æ˜¯ä»å³è¾¹å¼€å§‹æŸ¥æ‰¾</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-rstrip.html">string.rstrip()</a></td>
<td align="left">åˆ é™¤ string å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼.</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-split.html">string.split(str&#x3D;â€â€, num&#x3D;string.count(str))</a></strong></td>
<td align="left">ä»¥ str ä¸ºåˆ†éš”ç¬¦åˆ‡ç‰‡ stringï¼Œå¦‚æœ num æœ‰æŒ‡å®šå€¼ï¼Œåˆ™ä»…åˆ†éš” <strong>num+1</strong> ä¸ªå­å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left">[string.splitlines(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-splitlines.html">keepends])</a></td>
<td align="left">æŒ‰ç…§è¡Œ(â€˜\râ€™, â€˜\r\nâ€™, â€˜\nâ€™)åˆ†éš”ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«å„è¡Œä½œä¸ºå…ƒç´ çš„åˆ—è¡¨ï¼Œå¦‚æœå‚æ•° keepends ä¸º Falseï¼Œä¸åŒ…å«æ¢è¡Œç¬¦ï¼Œå¦‚æœä¸º Trueï¼Œåˆ™ä¿ç•™æ¢è¡Œç¬¦ã€‚</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-startswith.html">string.startswith(obj, beg&#x3D;0,end&#x3D;len(string))</a></td>
<td align="left">æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä»¥ obj å¼€å¤´ï¼Œæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚å¦‚æœbeg å’Œ end æŒ‡å®šå€¼ï¼Œåˆ™åœ¨æŒ‡å®šèŒƒå›´å†…æ£€æŸ¥.</td>
</tr>
<tr>
<td align="left"><strong>[string.strip(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-strip.html">obj])</a></strong></td>
<td align="left">åœ¨ string ä¸Šæ‰§è¡Œ lstrip()å’Œ rstrip()</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-swapcase.html">string.swapcase()</a></td>
<td align="left">ç¿»è½¬ string ä¸­çš„å¤§å°å†™</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-title.html">string.title()</a></td>
<td align="left">è¿”å›â€æ ‡é¢˜åŒ–â€çš„ string,å°±æ˜¯è¯´æ‰€æœ‰å•è¯éƒ½æ˜¯ä»¥å¤§å†™å¼€å§‹ï¼Œå…¶ä½™å­—æ¯å‡ä¸ºå°å†™(è§ istitle())</td>
</tr>
<tr>
<td align="left"><strong><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-translate.html">string.translate(str, del&#x3D;â€â€)</a></strong></td>
<td align="left">æ ¹æ® str ç»™å‡ºçš„è¡¨(åŒ…å« 256 ä¸ªå­—ç¬¦)è½¬æ¢ string çš„å­—ç¬¦,è¦è¿‡æ»¤æ‰çš„å­—ç¬¦æ”¾åˆ° del å‚æ•°ä¸­</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-upper.html">string.upper()</a></td>
<td align="left">è½¬æ¢ string ä¸­çš„å°å†™å­—æ¯ä¸ºå¤§å†™</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-zfill.html">string.zfill(width)</a></td>
<td align="left">è¿”å›é•¿åº¦ä¸º width çš„å­—ç¬¦ä¸²ï¼ŒåŸå­—ç¬¦ä¸² string å³å¯¹é½ï¼Œå‰é¢å¡«å……0</td>
</tr>
</tbody></table>
<h6 id="è®¿é—®åˆ—è¡¨ä¸­çš„å€¼-amp-amp-è¿½åŠ åˆ—è¡¨ã€appendã€‘-amp-amp-åˆ é™¤åˆ—è¡¨å…ƒç´ ã€delã€‘"><a href="#è®¿é—®åˆ—è¡¨ä¸­çš„å€¼-amp-amp-è¿½åŠ åˆ—è¡¨ã€appendã€‘-amp-amp-åˆ é™¤åˆ—è¡¨å…ƒç´ ã€delã€‘" class="headerlink" title="è®¿é—®åˆ—è¡¨ä¸­çš„å€¼ &amp;&amp; è¿½åŠ åˆ—è¡¨ã€appendã€‘&amp;&amp; åˆ é™¤åˆ—è¡¨å…ƒç´ ã€delã€‘"></a>è®¿é—®åˆ—è¡¨ä¸­çš„å€¼ &amp;&amp; è¿½åŠ åˆ—è¡¨ã€appendã€‘&amp;&amp; åˆ é™¤åˆ—è¡¨å…ƒç´ ã€delã€‘</h6><pre><code class="python">print(&quot;----------------&quot;)
list1 = [&#39;physics&#39;, &#39;chemistry&#39;, 1997, 2000]
print(list1)
print(list1[0])
list1.append(&#39;Google&#39;)
print(list1)

del list1[4] #åˆ é™¤äº†Google
print(list1)
-------------------------------
[&#39;physics&#39;, &#39;chemistry&#39;, 1997, 2000]
physics
[&#39;physics&#39;, &#39;chemistry&#39;, 1997, 2000, &#39;Google&#39;]
[&#39;physics&#39;, &#39;chemistry&#39;, 1997, 2000]  #åˆ é™¤äº†Google
</code></pre>
<h6 id="Pythonåˆ—è¡¨è„šæœ¬æ“ä½œç¬¦"><a href="#Pythonåˆ—è¡¨è„šæœ¬æ“ä½œç¬¦" class="headerlink" title="Pythonåˆ—è¡¨è„šæœ¬æ“ä½œç¬¦"></a>Pythonåˆ—è¡¨è„šæœ¬æ“ä½œç¬¦</h6><p>åˆ—è¡¨å¯¹ + å’Œ * çš„æ“ä½œç¬¦ä¸å­—ç¬¦ä¸²ç›¸ä¼¼ã€‚+ å·ç”¨äºç»„åˆåˆ—è¡¨ï¼Œ* å·ç”¨äºé‡å¤åˆ—è¡¨ã€‚</p>
<table>
<thead>
<tr>
<th align="left">Python è¡¨è¾¾å¼</th>
<th align="left">ç»“æœ</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">len([1, 2, 3])</td>
<td align="left">3</td>
<td align="left">é•¿åº¦</td>
</tr>
<tr>
<td align="left">[1, 2, 3] + [4, 5, 6]</td>
<td align="left">[1, 2, 3, 4, 5, 6]</td>
<td align="left">ç»„åˆ</td>
</tr>
<tr>
<td align="left">[â€˜Hi!â€™] * 4</td>
<td align="left">[â€˜Hi!â€™, â€˜Hi!â€™, â€˜Hi!â€™, â€˜Hi!â€™]</td>
<td align="left">é‡å¤</td>
</tr>
<tr>
<td align="left">3 in [1, 2, 3]</td>
<td align="left">True</td>
<td align="left">å…ƒç´ æ˜¯å¦å­˜åœ¨äºåˆ—è¡¨ä¸­</td>
</tr>
<tr>
<td align="left">for x in [1, 2, 3]: print x,</td>
<td align="left">1 2 3</td>
<td align="left">è¿­ä»£</td>
</tr>
</tbody></table>
<h6 id="è®°å¾—è´Ÿå·æ˜¯å€’æ•°çš„å™¢"><a href="#è®°å¾—è´Ÿå·æ˜¯å€’æ•°çš„å™¢" class="headerlink" title="è®°å¾—è´Ÿå·æ˜¯å€’æ•°çš„å™¢"></a>è®°å¾—è´Ÿå·æ˜¯å€’æ•°çš„å™¢</h6><pre><code class="python">&gt;&gt;&gt;L = [&#39;Google&#39;, &#39;Runoob&#39;, &#39;Taobao&#39;]
&gt;&gt;&gt; L[2]
&#39;Taobao&#39;
&gt;&gt;&gt; L[-2]
&#39;Runoob&#39;
&gt;&gt;&gt; L[1:]
[&#39;Runoob&#39;, &#39;Taobao&#39;]
&gt;&gt;&gt;
</code></pre>
<table>
<thead>
<tr>
<th align="left">Python è¡¨è¾¾å¼</th>
<th align="left">ç»“æœ</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">L[2]</td>
<td align="left">â€˜Taobaoâ€™</td>
<td align="left">è¯»å–åˆ—è¡¨ä¸­ç¬¬ä¸‰ä¸ªå…ƒç´ </td>
</tr>
<tr>
<td align="left">L[-2]</td>
<td align="left">â€˜Runoobâ€™</td>
<td align="left">è¯»å–åˆ—è¡¨ä¸­å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ </td>
</tr>
<tr>
<td align="left">L[1:]</td>
<td align="left">[â€˜Runoobâ€™, â€˜Taobaoâ€™]</td>
<td align="left">ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹æˆªå–åˆ—è¡¨</td>
</tr>
</tbody></table>
<h6 id="Pythonåˆ—è¡¨å‡½æ•°-amp-æ–¹æ³•"><a href="#Pythonåˆ—è¡¨å‡½æ•°-amp-æ–¹æ³•" class="headerlink" title="Pythonåˆ—è¡¨å‡½æ•°&amp;æ–¹æ³•"></a>Pythonåˆ—è¡¨å‡½æ•°&amp;æ–¹æ³•</h6><table>
<thead>
<tr>
<th align="left">åºå·</th>
<th align="left">å‡½æ•°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-cmp.html">cmp(list1, list2)</a> æ¯”è¾ƒä¸¤ä¸ªåˆ—è¡¨çš„å…ƒç´ </td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-len.html">len(list)</a> åˆ—è¡¨å…ƒç´ ä¸ªæ•°</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-max.html">max(list)</a> è¿”å›åˆ—è¡¨å…ƒç´ æœ€å¤§å€¼</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-min.html">min(list)</a> è¿”å›åˆ—è¡¨å…ƒç´ æœ€å°å€¼</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-list.html">list(seq)</a> å°†å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">åºå·</th>
<th align="left">æ–¹æ³•</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-append.html">list.append(obj)</a> åœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°çš„å¯¹è±¡</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-count.html">list.count(obj)</a> ç»Ÿè®¡æŸä¸ªå…ƒç´ åœ¨åˆ—è¡¨ä¸­å‡ºç°çš„æ¬¡æ•°</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-extend.html">list.extend(seq)</a> åœ¨åˆ—è¡¨æœ«å°¾ä¸€æ¬¡æ€§è¿½åŠ å¦ä¸€ä¸ªåºåˆ—ä¸­çš„å¤šä¸ªå€¼ï¼ˆç”¨æ–°åˆ—è¡¨æ‰©å±•åŸæ¥çš„åˆ—è¡¨ï¼‰</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-index.html">list.index(obj)</a> ä»åˆ—è¡¨ä¸­æ‰¾å‡ºæŸä¸ªå€¼ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ç´¢å¼•ä½ç½®</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-insert.html">list.insert(index, obj)</a> å°†å¯¹è±¡æ’å…¥åˆ—è¡¨</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">[list.pop(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-pop.html">index&#x3D;-1])</a> ç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-remove.html">list.remove(obj)</a> ç§»é™¤åˆ—è¡¨ä¸­æŸä¸ªå€¼çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-reverse.html">list.reverse()</a> åå‘åˆ—è¡¨ä¸­å…ƒç´ </td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-sort.html">list.sort(cmp&#x3D;None, key&#x3D;None, reverse&#x3D;False)</a> å¯¹åŸåˆ—è¡¨è¿›è¡Œæ’åº</td>
</tr>
</tbody></table>
<h6 id="Pythonæ—¥æœŸå’Œæ—¶é—´"><a href="#Pythonæ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="Pythonæ—¥æœŸå’Œæ—¶é—´"></a>Pythonæ—¥æœŸå’Œæ—¶é—´</h6><p>Python ç¨‹åºèƒ½ç”¨å¾ˆå¤šæ–¹å¼å¤„ç†æ—¥æœŸå’Œæ—¶é—´ï¼Œè½¬æ¢æ—¥æœŸæ ¼å¼æ˜¯ä¸€ä¸ªå¸¸è§çš„åŠŸèƒ½ã€‚<br>Python æä¾›äº†ä¸€ä¸ª time å’Œ calendar æ¨¡å—å¯ä»¥ç”¨äºæ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶é—´ã€‚<br>æ—¶é—´é—´éš”æ˜¯ä»¥ç§’ä¸ºå•ä½çš„æµ®ç‚¹å°æ•°ã€‚<br>æ¯ä¸ªæ—¶é—´æˆ³éƒ½ä»¥è‡ªä»1970å¹´1æœˆ1æ—¥åˆå¤œï¼ˆå†å…ƒï¼‰ç»è¿‡äº†å¤šé•¿æ—¶é—´æ¥è¡¨ç¤ºã€‚<br>Python çš„ time æ¨¡å—ä¸‹æœ‰å¾ˆå¤šå‡½æ•°å¯ä»¥è½¬æ¢å¸¸è§æ—¥æœŸæ ¼å¼ã€‚<br>å¦‚å‡½æ•°<code>time.time()</code>ç”¨äºè·å–å½“å‰æ—¶é—´æˆ³, å¦‚ä¸‹å®ä¾‹:</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
import time  # å¼•å…¥timeæ¨¡å—
 
ticks = time.time()
print &quot;å½“å‰æ—¶é—´æˆ³ä¸º:&quot;, ticks
--------------------------
å½“å‰æ—¶é—´æˆ³ä¸º: 1459994552.51
</code></pre>
<h6 id="è·å–æŸæœˆæ—¥å†"><a href="#è·å–æŸæœˆæ—¥å†" class="headerlink" title="è·å–æŸæœˆæ—¥å†"></a>è·å–æŸæœˆæ—¥å†</h6><p><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-time-time.html"> time.time( )</a> è¿”å›å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ï¼ˆ1970çºªå…ƒåç»è¿‡çš„æµ®ç‚¹ç§’æ•°ï¼‰<br><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-time-sleep.html"> time.sleep(secs)</a> æ¨è¿Ÿè°ƒç”¨çº¿ç¨‹çš„è¿è¡Œï¼ŒsecsæŒ‡ç§’æ•°ã€‚<br>time.localtime([<a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-time-localtime.html">secs])</a> æ¥æ”¶æ—¶é—´æˆ³ï¼ˆ1970çºªå…ƒåç»è¿‡çš„æµ®ç‚¹ç§’æ•°ï¼‰å¹¶è¿”å›å½“åœ°æ—¶é—´ä¸‹çš„æ—¶é—´å…ƒç»„tï¼ˆt.tm_isdstå¯å–0æˆ–1ï¼Œå–å†³äºå½“åœ°å½“æ—¶æ˜¯ä¸æ˜¯å¤ä»¤æ—¶ï¼‰ã€‚</p>
<pre><code class="python">import  calendar
cal = calendar.month(2025, 2)
print(&quot;ä»¥ä¸‹è¾“å‡ºæ˜¯ 2025 å¹´ 2 æœˆçš„æ—¥å†:&quot;)
print(cal)
------------------------------------
ä»¥ä¸‹è¾“å‡ºæ˜¯ 2025 å¹´ 2 æœˆçš„æ—¥å†:
   February 2025
Mo Tu We Th Fr Sa Su
                1  2
 3  4  5  6  7  8  9
10 11 12 13 14 15 16
17 18 19 20 21 22 23
24 25 26 27 28
</code></pre>
<h6 id="Pythonå‡½æ•°"><a href="#Pythonå‡½æ•°" class="headerlink" title="Pythonå‡½æ•°"></a>Pythonå‡½æ•°</h6><p>ä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªç”±è‡ªå·±æƒ³è¦åŠŸèƒ½çš„å‡½æ•°ï¼Œä»¥ä¸‹æ˜¯ç®€å•çš„è§„åˆ™ï¼š</p>
<ul>
<li>å‡½æ•°ä»£ç å—ä»¥ <strong>def</strong> å…³é”®è¯å¼€å¤´ï¼Œåæ¥å‡½æ•°æ ‡è¯†ç¬¦åç§°å’Œåœ†æ‹¬å·**()**ã€‚</li>
<li>ä»»ä½•ä¼ å…¥å‚æ•°å’Œè‡ªå˜é‡å¿…é¡»æ”¾åœ¨åœ†æ‹¬å·ä¸­é—´ã€‚åœ†æ‹¬å·ä¹‹é—´å¯ä»¥ç”¨äºå®šä¹‰å‚æ•°ã€‚</li>
<li>å‡½æ•°çš„ç¬¬ä¸€è¡Œè¯­å¥å¯ä»¥é€‰æ‹©æ€§åœ°ä½¿ç”¨æ–‡æ¡£å­—ç¬¦ä¸²â€”ç”¨äºå­˜æ”¾å‡½æ•°è¯´æ˜ã€‚</li>
<li>å‡½æ•°å†…å®¹ä»¥å†’å·èµ·å§‹ï¼Œå¹¶ä¸”ç¼©è¿›ã€‚</li>
<li><strong>return [è¡¨è¾¾å¼]</strong> ç»“æŸå‡½æ•°ï¼Œé€‰æ‹©æ€§åœ°è¿”å›ä¸€ä¸ªå€¼ç»™è°ƒç”¨æ–¹ã€‚ä¸å¸¦è¡¨è¾¾å¼çš„returnç›¸å½“äºè¿”å› Noneã€‚</li>
</ul>
<pre><code class="python">def functionname( parameters ):
   &quot;å‡½æ•°_æ–‡æ¡£å­—ç¬¦ä¸²&quot;
   function_suite
   return [expression]
</code></pre>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå‚æ•°å€¼å’Œå‚æ•°åç§°æ˜¯æŒ‰å‡½æ•°å£°æ˜ä¸­å®šä¹‰çš„é¡ºåºåŒ¹é…èµ·æ¥çš„ã€‚</p>
<pre><code class="python">def readme(str):
    print(str)
    return
readme(&quot;Hello World!&quot;)
readme(&quot;Runoob&quot;)
----------------
Hello World!
Runoob
</code></pre>
<h6 id="ä¸å®šé•¿å‚æ•°"><a href="#ä¸å®šé•¿å‚æ•°" class="headerlink" title="ä¸å®šé•¿å‚æ•°"></a>ä¸å®šé•¿å‚æ•°</h6><p>ä½ å¯èƒ½éœ€è¦ä¸€ä¸ªå‡½æ•°èƒ½å¤„ç†æ¯”å½“åˆå£°æ˜æ—¶æ›´å¤šçš„å‚æ•°ã€‚è¿™äº›å‚æ•°å«åšä¸å®šé•¿å‚æ•°ï¼Œå’Œä¸Šè¿°2ç§å‚æ•°ä¸åŒï¼Œå£°æ˜æ—¶ä¸ä¼šå‘½åã€‚åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="python">def functionname([formal_args,] *var_args_tuple ):
   &quot;å‡½æ•°_æ–‡æ¡£å­—ç¬¦ä¸²&quot;
   function_suite
   return [expression]
</code></pre>
<p>åŠ äº†æ˜Ÿå·ï¼ˆ*ï¼‰çš„å˜é‡åä¼šå­˜æ”¾æ‰€æœ‰æœªå‘½åçš„å˜é‡å‚æ•°ã€‚ä¸å®šé•¿å‚æ•°å®ä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
# å¯å†™å‡½æ•°è¯´æ˜
def printinfo( arg1, *vartuple ):
   &quot;æ‰“å°ä»»ä½•ä¼ å…¥çš„å‚æ•°&quot;
   print &quot;è¾“å‡º: &quot;
   print arg1
   for var in vartuple:
      print var
   return
 
# è°ƒç”¨printinfo å‡½æ•°
printinfo( 10 )
printinfo( 70, 60, 50 )
------------------------------
è¾“å‡º:
10
è¾“å‡º:
70
60
50
</code></pre>
<h6 id="åŒ¿åå‡½æ•°"><a href="#åŒ¿åå‡½æ•°" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h6><p>python ä½¿ç”¨ <strong><u>lambda</u></strong> æ¥åˆ›å»ºåŒ¿åå‡½æ•°ã€‚</p>
<ul>
<li>lambdaåªæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå‡½æ•°ä½“æ¯”defç®€å•å¾ˆå¤šã€‚</li>
<li>lambdaçš„ä¸»ä½“æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä»£ç å—ã€‚ä»…ä»…èƒ½åœ¨lambdaè¡¨è¾¾å¼ä¸­å°è£…æœ‰é™çš„é€»è¾‘è¿›å»ã€‚</li>
<li>lambdaå‡½æ•°æ‹¥æœ‰è‡ªå·±çš„å‘½åç©ºé—´ï¼Œä¸”ä¸èƒ½è®¿é—®è‡ªæœ‰å‚æ•°åˆ—è¡¨ä¹‹å¤–æˆ–å…¨å±€å‘½åç©ºé—´é‡Œçš„å‚æ•°ã€‚</li>
<li>è™½ç„¶lambdaå‡½æ•°çœ‹èµ·æ¥åªèƒ½å†™ä¸€è¡Œï¼Œå´ä¸ç­‰åŒäºCæˆ–C++çš„å†…è”å‡½æ•°ï¼Œåè€…çš„ç›®çš„æ˜¯è°ƒç”¨å°å‡½æ•°æ—¶ä¸å ç”¨æ ˆå†…å­˜ä»è€Œå¢åŠ è¿è¡Œæ•ˆç‡ã€‚</li>
</ul>
<p>lambdaå‡½æ•°çš„è¯­æ³•åªåŒ…å«ä¸€ä¸ªè¯­å¥ï¼Œå¦‚ä¸‹ï¼š</p>
<blockquote>
<pre><code class="python">lambda [arg1 [,arg2,.....argn]]:expressio
</code></pre>
</blockquote>
<p><strong>å®ä¾‹å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
# å¯å†™å‡½æ•°è¯´æ˜
sum = lambda arg1, arg2: arg1 + arg2
 
# è°ƒç”¨sumå‡½æ•°
print &quot;ç›¸åŠ åçš„å€¼ä¸º : &quot;, sum( 10, 20 )
print &quot;ç›¸åŠ åçš„å€¼ä¸º : &quot;, sum( 20, 20 )
---------------------------------------
ç›¸åŠ åçš„å€¼ä¸º :  30
ç›¸åŠ åçš„å€¼ä¸º :  40
</code></pre>
<blockquote>
<p>Python ä¸­çš„ <code>lambda</code> è¡¨è¾¾å¼æ˜¯ä¸€ç§åŒ¿åå‡½æ•°ï¼Œå³æ²¡æœ‰åå­—çš„å‡½æ•°ã€‚<code>lambda</code> è¡¨è¾¾å¼é€šå¸¸ç”¨äºéœ€è¦çŸ­å°ç²¾æ‚å‡½æ•°çš„åœºæ™¯ï¼Œæ¯”å¦‚æ’åºæ—¶çš„é”®å‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºé«˜é˜¶å‡½æ•°çš„å‚æ•°ã€‚</p>
<p><code>lambda</code> è¡¨è¾¾å¼çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code>lambda arguments: expression
</code></pre>
<p>è¿™é‡Œçš„å…³é”®ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>lambda</code> æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œç”¨äºå®šä¹‰åŒ¿åå‡½æ•°ã€‚</li>
<li><code>arguments</code> æ˜¯å‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨é€—å·åˆ†éš”ã€‚</li>
<li><code>expression</code> æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶ç»“æœå°†ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ã€‚</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä¸€äº› <code>lambda</code> è¡¨è¾¾å¼çš„ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<h3 id="ç¤ºä¾‹-1ï¼šå®šä¹‰ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°"><a href="#ç¤ºä¾‹-1ï¼šå®šä¹‰ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°" class="headerlink" title="ç¤ºä¾‹ 1ï¼šå®šä¹‰ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°"></a>ç¤ºä¾‹ 1ï¼šå®šä¹‰ä¸€ä¸ªç®€å•çš„åŠ æ³•å‡½æ•°</h3><pre><code>add = lambda x, y: x + y
print(add(5, 3))  # è¾“å‡º 8
</code></pre>
<h3 id="ç¤ºä¾‹-2ï¼šåˆ—è¡¨æ’åº"><a href="#ç¤ºä¾‹-2ï¼šåˆ—è¡¨æ’åº" class="headerlink" title="ç¤ºä¾‹ 2ï¼šåˆ—è¡¨æ’åº"></a>ç¤ºä¾‹ 2ï¼šåˆ—è¡¨æ’åº</h3><p>ä½¿ç”¨ <code>lambda</code> è¡¨è¾¾å¼æ¥æŒ‰ç…§åˆ—è¡¨ä¸­å…ƒç´ çš„æŸä¸ªå±æ€§è¿›è¡Œæ’åºï¼š</p>
<pre><code># å‡è®¾æœ‰ä¸€ä¸ªåŒ…å«å­—å…¸çš„åˆ—è¡¨
list_of_dicts = [&#123;&#39;name&#39;: &#39;Alice&#39;, &#39;age&#39;: 25&#125;, &#123;&#39;name&#39;: &#39;Bob&#39;, &#39;age&#39;: 20&#125;, &#123;&#39;name&#39;: &#39;Charlie&#39;, &#39;age&#39;: 30&#125;]

# æŒ‰ç…§å¹´é¾„æ’åº
sorted_list = sorted(list_of_dicts, key=lambda x: x[&#39;age&#39;])
print(sorted_list)  # è¾“å‡º [&#123;&#39;name&#39;: &#39;Bob&#39;, &#39;age&#39;: 20&#125;, &#123;&#39;name&#39;: &#39;Alice&#39;, &#39;age&#39;: 25&#125;, &#123;&#39;name&#39;: &#39;Charlie&#39;, &#39;age&#39;: 30&#125;]
</code></pre>
<h3 id="ç¤ºä¾‹-3ï¼šé«˜é˜¶å‡½æ•°ä¸­çš„ä½¿ç”¨"><a href="#ç¤ºä¾‹-3ï¼šé«˜é˜¶å‡½æ•°ä¸­çš„ä½¿ç”¨" class="headerlink" title="ç¤ºä¾‹ 3ï¼šé«˜é˜¶å‡½æ•°ä¸­çš„ä½¿ç”¨"></a>ç¤ºä¾‹ 3ï¼šé«˜é˜¶å‡½æ•°ä¸­çš„ä½¿ç”¨</h3><p><code>lambda</code> è¡¨è¾¾å¼å¸¸ç”¨äº <code>map</code>, <code>filter</code>, <code>reduce</code> ç­‰é«˜é˜¶å‡½æ•°ï¼š</p>
<pre><code># ä½¿ç”¨ map å‡½æ•°å°†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ä¹˜ä»¥2
numbers = [1, 2, 3, 4, 5]
doubled = map(lambda x: x * 2, numbers)
print(list(doubled))  # è¾“å‡º [2, 4, 6, 8, 10]

# ä½¿ç”¨ filter å‡½æ•°è¿‡æ»¤å‡ºåˆ—è¡¨ä¸­çš„å¶æ•°
even_numbers = filter(lambda x: x % 2 == 0, numbers)
print(list(even_numbers))  # è¾“å‡º [2, 4]
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ <code>lambda</code> è¡¨è¾¾å¼éå¸¸æ–¹ä¾¿ï¼Œä½†å®ƒä»¬é€šå¸¸åªç”¨äºç®€å•çš„å‡½æ•°ã€‚å¦‚æœå‡½æ•°é€»è¾‘è¾ƒä¸ºå¤æ‚ï¼Œæœ€å¥½è¿˜æ˜¯ä½¿ç”¨å¸¸è§„çš„ <code>def</code> è¯­å¥æ¥å®šä¹‰å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
</blockquote>
<h6 id="return-è¯­å¥"><a href="#return-è¯­å¥" class="headerlink" title="return è¯­å¥"></a>return è¯­å¥</h6><p>returnè¯­å¥[è¡¨è¾¾å¼]é€€å‡ºå‡½æ•°ï¼Œé€‰æ‹©æ€§åœ°å‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ä¸å¸¦å‚æ•°å€¼çš„returnè¯­å¥è¿”å›Noneã€‚ä¹‹å‰çš„ä¾‹å­éƒ½æ²¡æœ‰ç¤ºèŒƒå¦‚ä½•è¿”å›æ•°å€¼ï¼Œä¸‹ä¾‹ä¾¿å‘Šè¯‰ä½ æ€ä¹ˆåšï¼š</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
# å¯å†™å‡½æ•°è¯´æ˜
def sum( arg1, arg2 ):
   # è¿”å›2ä¸ªå‚æ•°çš„å’Œ.&quot;
   total = arg1 + arg2
   print &quot;å‡½æ•°å†… : &quot;, total
   return total
 
# è°ƒç”¨sumå‡½æ•°
total = sum( 10, 20 )
</code></pre>
<h6 id="å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡"><a href="#å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡" class="headerlink" title="å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡"></a>å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡</h6><p>å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å˜é‡æ‹¥æœ‰ä¸€ä¸ªå±€éƒ¨ä½œç”¨åŸŸï¼Œå®šä¹‰åœ¨å‡½æ•°å¤–çš„æ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸã€‚</p>
<p>å±€éƒ¨å˜é‡åªèƒ½åœ¨å…¶è¢«å£°æ˜çš„å‡½æ•°å†…éƒ¨è®¿é—®ï¼Œè€Œå…¨å±€å˜é‡å¯ä»¥åœ¨æ•´ä¸ªç¨‹åºèŒƒå›´å†…è®¿é—®ã€‚è°ƒç”¨å‡½æ•°æ—¶ï¼Œæ‰€æœ‰åœ¨å‡½æ•°å†…å£°æ˜çš„å˜é‡åç§°éƒ½å°†è¢«åŠ å…¥åˆ°ä½œç”¨åŸŸä¸­ã€‚å¦‚ä¸‹å®ä¾‹ï¼š</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
total = 0 # è¿™æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡
# å¯å†™å‡½æ•°è¯´æ˜
def sum( arg1, arg2 ):
   #è¿”å›2ä¸ªå‚æ•°çš„å’Œ.&quot;
   total = arg1 + arg2 # totalåœ¨è¿™é‡Œæ˜¯å±€éƒ¨å˜é‡.
   print &quot;å‡½æ•°å†…æ˜¯å±€éƒ¨å˜é‡ : &quot;, total
   return total
 
#è°ƒç”¨sumå‡½æ•°
sum( 10, 20 )
print &quot;å‡½æ•°å¤–æ˜¯å…¨å±€å˜é‡ : &quot;, total
------------------------------------------
å‡½æ•°å†…æ˜¯å±€éƒ¨å˜é‡ :  30
å‡½æ•°å¤–æ˜¯å…¨å±€å˜é‡ :  0
</code></pre>
<h6 id="fromâ€¦import-è¯­å¥"><a href="#fromâ€¦import-è¯­å¥" class="headerlink" title="fromâ€¦import è¯­å¥"></a>fromâ€¦import è¯­å¥</h6><p>Python çš„ from è¯­å¥è®©ä½ ä»æ¨¡å—ä¸­å¯¼å…¥ä¸€ä¸ªæŒ‡å®šçš„éƒ¨åˆ†åˆ°å½“å‰å‘½åç©ºé—´ä¸­ã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code>from modname import name1[, name2[, ... nameN]]
</code></pre>
<p>ä¾‹å¦‚ï¼Œè¦å¯¼å…¥æ¨¡å— fib çš„ fibonacci å‡½æ•°ï¼Œä½¿ç”¨å¦‚ä¸‹è¯­å¥ï¼š</p>
<pre><code>from fib import fibonacci
</code></pre>
<p>è¿™ä¸ªå£°æ˜ä¸ä¼šæŠŠæ•´ä¸ª fib æ¨¡å—å¯¼å…¥åˆ°å½“å‰çš„å‘½åç©ºé—´ä¸­ï¼Œå®ƒåªä¼šå°† fib é‡Œçš„ fibonacci å•ä¸ªå¼•å…¥åˆ°æ‰§è¡Œè¿™ä¸ªå£°æ˜çš„æ¨¡å—çš„å…¨å±€ç¬¦å·è¡¨ã€‚</p>
<h6 id="fromâ€¦import-è¯­å¥-1"><a href="#fromâ€¦import-è¯­å¥-1" class="headerlink" title="fromâ€¦import* è¯­å¥"></a>fromâ€¦import* è¯­å¥</h6><p>æŠŠä¸€ä¸ªæ¨¡å—çš„æ‰€æœ‰å†…å®¹å…¨éƒ½å¯¼å…¥åˆ°å½“å‰çš„å‘½åç©ºé—´ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œåªéœ€ä½¿ç”¨å¦‚ä¸‹å£°æ˜ï¼š</p>
<pre><code>from modname import *
</code></pre>
<p>è¿™æä¾›äº†ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ¥å¯¼å…¥ä¸€ä¸ªæ¨¡å—ä¸­çš„æ‰€æœ‰é¡¹ç›®ã€‚ç„¶è€Œè¿™ç§å£°æ˜ä¸è¯¥è¢«è¿‡å¤šåœ°ä½¿ç”¨ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬æƒ³ä¸€æ¬¡æ€§å¼•å…¥ math æ¨¡å—ä¸­æ‰€æœ‰çš„ä¸œè¥¿ï¼Œè¯­å¥å¦‚ä¸‹ï¼š</p>
<pre><code>from math import *
</code></pre>
<h6 id="globals-å’Œ-locals-å‡½æ•°"><a href="#globals-å’Œ-locals-å‡½æ•°" class="headerlink" title="globals() å’Œ locals() å‡½æ•°"></a>globals() å’Œ locals() å‡½æ•°</h6><p>æ ¹æ®è°ƒç”¨åœ°æ–¹çš„ä¸åŒï¼Œglobals() å’Œ locals() å‡½æ•°å¯è¢«ç”¨æ¥è¿”å›å…¨å±€å’Œå±€éƒ¨å‘½åç©ºé—´é‡Œçš„åå­—ã€‚</p>
<p>å¦‚æœåœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ locals()ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰èƒ½åœ¨è¯¥å‡½æ•°é‡Œè®¿é—®çš„å‘½åã€‚</p>
<p>å¦‚æœåœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ globals()ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰åœ¨è¯¥å‡½æ•°é‡Œèƒ½è®¿é—®çš„å…¨å±€åå­—ã€‚</p>
<p>ä¸¤ä¸ªå‡½æ•°çš„è¿”å›ç±»å‹éƒ½æ˜¯å­—å…¸ã€‚æ‰€ä»¥åå­—ä»¬èƒ½ç”¨ keys() å‡½æ•°æ‘˜å–ã€‚</p>
<hr>
<h6 id="è¯»å–é”®ç›˜è¾“å…¥"><a href="#è¯»å–é”®ç›˜è¾“å…¥" class="headerlink" title="è¯»å–é”®ç›˜è¾“å…¥"></a>è¯»å–é”®ç›˜è¾“å…¥</h6><p>Pythonæä¾›äº†ä¸¤ä¸ªå†…ç½®å‡½æ•°ä»æ ‡å‡†è¾“å…¥è¯»å…¥ä¸€è¡Œæ–‡æœ¬ï¼Œé»˜è®¤çš„æ ‡å‡†è¾“å…¥æ˜¯é”®ç›˜ã€‚å¦‚ä¸‹ï¼š</p>
<ul>
<li>raw_input</li>
<li>input</li>
</ul>
<p><strong>inputå‡½æ•°</strong></p>
<p><code>input([prompt])</code> å‡½æ•°ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€ä¸ªè¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆå»æ‰ç»“å°¾çš„æ¢è¡Œç¬¦ï¼‰</p>
<pre><code class="python">è¯·è¾“å…¥ï¼š23
ä½ è¾“å…¥çš„å†…å®¹æ˜¯:  23
</code></pre>
<h6 id="æ‰“å¼€å’Œå…³é—­æ–‡ä»¶"><a href="#æ‰“å¼€å’Œå…³é—­æ–‡ä»¶" class="headerlink" title="æ‰“å¼€å’Œå…³é—­æ–‡ä»¶"></a>æ‰“å¼€å’Œå…³é—­æ–‡ä»¶</h6><p>æ‚¨å·²ç»å¯ä»¥å‘æ ‡å‡†è¾“å…¥å’Œè¾“å‡ºè¿›è¡Œè¯»å†™ã€‚ç°åœ¨ï¼Œæ¥çœ‹çœ‹æ€ä¹ˆè¯»å†™å®é™…çš„æ•°æ®æ–‡ä»¶ã€‚<br>Python æä¾›äº†å¿…è¦çš„å‡½æ•°å’Œæ–¹æ³•è¿›è¡Œé»˜è®¤æƒ…å†µä¸‹çš„æ–‡ä»¶åŸºæœ¬æ“ä½œã€‚ä½ å¯ä»¥ç”¨ <strong>file</strong> å¯¹è±¡åšå¤§éƒ¨åˆ†çš„æ–‡ä»¶æ“ä½œ</p>
<h3 id="open-å‡½æ•°"><a href="#open-å‡½æ•°" class="headerlink" title="open å‡½æ•°"></a>open å‡½æ•°</h3><p>ä½ å¿…é¡»å…ˆç”¨Pythonå†…ç½®çš„open()å‡½æ•°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªfileå¯¹è±¡ï¼Œç›¸å…³çš„æ–¹æ³•æ‰å¯ä»¥è°ƒç”¨å®ƒè¿›è¡Œè¯»å†™ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>file object = open(file_name [, access_mode][, buffering])
</code></pre>
<p>å„ä¸ªå‚æ•°çš„ç»†èŠ‚å¦‚ä¸‹ï¼š</p>
<ul>
<li>file_nameï¼šfile_nameå˜é‡æ˜¯ä¸€ä¸ªåŒ…å«äº†ä½ è¦è®¿é—®çš„æ–‡ä»¶åç§°çš„å­—ç¬¦ä¸²å€¼ã€‚</li>
<li>access_modeï¼šaccess_modeå†³å®šäº†æ‰“å¼€æ–‡ä»¶çš„æ¨¡å¼ï¼šåªè¯»ï¼Œå†™å…¥ï¼Œè¿½åŠ ç­‰ã€‚æ‰€æœ‰å¯å–å€¼è§å¦‚ä¸‹çš„å®Œå…¨åˆ—è¡¨ã€‚è¿™ä¸ªå‚æ•°æ˜¯éå¼ºåˆ¶çš„ï¼Œé»˜è®¤æ–‡ä»¶è®¿é—®æ¨¡å¼ä¸ºåªè¯»(r)ã€‚</li>
<li>buffering:å¦‚æœbufferingçš„å€¼è¢«è®¾ä¸º0ï¼Œå°±ä¸ä¼šæœ‰å¯„å­˜ã€‚å¦‚æœbufferingçš„å€¼å–1ï¼Œè®¿é—®æ–‡ä»¶æ—¶ä¼šå¯„å­˜è¡Œã€‚å¦‚æœå°†bufferingçš„å€¼è®¾ä¸ºå¤§äº1çš„æ•´æ•°ï¼Œè¡¨æ˜äº†è¿™å°±æ˜¯çš„å¯„å­˜åŒºçš„ç¼“å†²å¤§å°ã€‚å¦‚æœå–è´Ÿå€¼ï¼Œå¯„å­˜åŒºçš„ç¼“å†²å¤§å°åˆ™ä¸ºç³»ç»Ÿé»˜è®¤ã€‚</li>
</ul>
<p>ä¸åŒæ¨¡å¼æ‰“å¼€æ–‡ä»¶çš„å®Œå…¨åˆ—è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th align="left">æ¨¡å¼</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">t</td>
<td align="left">æ–‡æœ¬æ¨¡å¼ (é»˜è®¤)ã€‚</td>
</tr>
<tr>
<td align="left">x</td>
<td align="left">å†™æ¨¡å¼ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™ä¼šæŠ¥é”™ã€‚</td>
</tr>
<tr>
<td align="left">b</td>
<td align="left">äºŒè¿›åˆ¶æ¨¡å¼ã€‚</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œæ›´æ–°(å¯è¯»å¯å†™)ã€‚</td>
</tr>
<tr>
<td align="left">U</td>
<td align="left">é€šç”¨æ¢è¡Œæ¨¡å¼ï¼ˆä¸æ¨èï¼‰ã€‚</td>
</tr>
<tr>
<td align="left">r</td>
<td align="left">ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶çš„æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚</td>
</tr>
<tr>
<td align="left">rb</td>
<td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºåªè¯»ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td>
</tr>
<tr>
<td align="left">r+</td>
<td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚</td>
</tr>
<tr>
<td align="left">rb+</td>
<td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td>
</tr>
<tr>
<td align="left">w</td>
<td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td align="left">wb</td>
<td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶åªç”¨äºå†™å…¥ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td>
</tr>
<tr>
<td align="left">w+</td>
<td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td align="left">wb+</td>
<td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨åˆ™æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶ä»å¼€å¤´å¼€å§‹ç¼–è¾‘ï¼Œå³åŸæœ‰å†…å®¹ä¼šè¢«åˆ é™¤ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ã€‚ä¸€èˆ¬ç”¨äºéæ–‡æœ¬æ–‡ä»¶å¦‚å›¾ç‰‡ç­‰ã€‚</td>
</tr>
<tr>
<td align="left">a</td>
<td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚</td>
</tr>
<tr>
<td align="left">ab</td>
<td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„å†…å®¹å°†ä¼šè¢«å†™å…¥åˆ°å·²æœ‰å†…å®¹ä¹‹åã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶è¿›è¡Œå†™å…¥ã€‚</td>
</tr>
<tr>
<td align="left">a+</td>
<td align="left">æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚æ–‡ä»¶æ‰“å¼€æ—¶ä¼šæ˜¯è¿½åŠ æ¨¡å¼ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ç”¨äºè¯»å†™ã€‚</td>
</tr>
<tr>
<td align="left">ab+</td>
<td align="left">ä»¥äºŒè¿›åˆ¶æ ¼å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ ã€‚å¦‚æœè¯¥æ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆå°†ä¼šæ”¾åœ¨æ–‡ä»¶çš„ç»“å°¾ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶ç”¨äºè¯»å†™</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">æ¨¡å¼</th>
<th align="center">r</th>
<th align="center">r+</th>
<th align="center">w</th>
<th align="center">w+</th>
<th align="center">a</th>
<th align="center">a+</th>
</tr>
</thead>
<tbody><tr>
<td align="center">è¯»</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center"></td>
<td align="center">+</td>
<td align="center"></td>
<td align="center">+</td>
</tr>
<tr>
<td align="center">å†™</td>
<td align="center"></td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
</tr>
<tr>
<td align="center">åˆ›å»º</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
</tr>
<tr>
<td align="center">è¦†ç›–</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">æŒ‡é’ˆåœ¨å¼€å§‹</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center">+</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">æŒ‡é’ˆåœ¨ç»“å°¾</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">+</td>
<td align="center">+</td>
</tr>
</tbody></table>
<h6 id="Fileå¯¹è±¡çš„å±æ€§"><a href="#Fileå¯¹è±¡çš„å±æ€§" class="headerlink" title="Fileå¯¹è±¡çš„å±æ€§"></a>Fileå¯¹è±¡çš„å±æ€§</h6><p>ä¸€ä¸ªæ–‡ä»¶è¢«æ‰“å¼€åï¼Œä½ æœ‰ä¸€ä¸ªfileå¯¹è±¡ï¼Œä½ å¯ä»¥å¾—åˆ°æœ‰å…³è¯¥æ–‡ä»¶çš„å„ç§ä¿¡æ¯ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å’Œfileå¯¹è±¡ç›¸å…³çš„æ‰€æœ‰å±æ€§çš„åˆ—è¡¨ï¼š</p>
<table>
<thead>
<tr>
<th align="left">å±æ€§</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">file.closed</td>
<td align="left">è¿”å›trueå¦‚æœæ–‡ä»¶å·²è¢«å…³é—­ï¼Œå¦åˆ™è¿”å›falseã€‚</td>
</tr>
<tr>
<td align="left">file.mode</td>
<td align="left">è¿”å›è¢«æ‰“å¼€æ–‡ä»¶çš„è®¿é—®æ¨¡å¼ã€‚</td>
</tr>
<tr>
<td align="left">file.name</td>
<td align="left">è¿”å›æ–‡ä»¶çš„åç§°ã€‚</td>
</tr>
<tr>
<td align="left">file.softspace</td>
<td align="left">å¦‚æœç”¨printè¾“å‡ºåï¼Œå¿…é¡»è·Ÿä¸€ä¸ªç©ºæ ¼ç¬¦ï¼Œåˆ™è¿”å›falseã€‚å¦åˆ™è¿”å›trueã€‚</td>
</tr>
</tbody></table>
<p>ä»¥ä¸Šå®ä¾‹è¾“å‡ºç»“æœï¼š</p>
<pre><code>æ–‡ä»¶å:  foo.txt
æ˜¯å¦å·²å…³é—­ :  False
è®¿é—®æ¨¡å¼ :  w
æœ«å°¾æ˜¯å¦å¼ºåˆ¶åŠ ç©ºæ ¼ :  0
</code></pre>
<h6 id="close-æ–¹æ³•"><a href="#close-æ–¹æ³•" class="headerlink" title="close()æ–¹æ³•"></a>close()æ–¹æ³•</h6><p>File å¯¹è±¡çš„ closeï¼ˆï¼‰æ–¹æ³•åˆ·æ–°ç¼“å†²åŒºé‡Œä»»ä½•è¿˜æ²¡å†™å…¥çš„ä¿¡æ¯ï¼Œå¹¶å…³é—­è¯¥æ–‡ä»¶ï¼Œè¿™ä¹‹åä¾¿ä¸èƒ½å†è¿›è¡Œå†™å…¥ã€‚</p>
<p>å½“ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡çš„å¼•ç”¨è¢«é‡æ–°æŒ‡å®šç»™å¦ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒPython ä¼šå…³é—­ä¹‹å‰çš„æ–‡ä»¶ã€‚ç”¨ closeï¼ˆï¼‰æ–¹æ³•å…³é—­æ–‡ä»¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¹ æƒ¯ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>fileObject.close()
</code></pre>
<p>ä¾‹å­ï¼š</p>
<pre><code>#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
# æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶
fo = open(&quot;foo.txt&quot;, &quot;w&quot;)
print &quot;æ–‡ä»¶å: &quot;, fo.name
 
# å…³é—­æ‰“å¼€çš„æ–‡ä»¶
fo.close()
</code></pre>
<p>ä»¥ä¸Šå®ä¾‹è¾“å‡ºç»“æœï¼š</p>
<pre><code>æ–‡ä»¶å:  foo.txt
</code></pre>
<h6 id="write-æ–¹æ³•"><a href="#write-æ–¹æ³•" class="headerlink" title="write()æ–¹æ³•"></a>write()æ–¹æ³•</h6><p>write()æ–¹æ³•å¯å°†ä»»ä½•å­—ç¬¦ä¸²å†™å…¥ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚éœ€è¦é‡ç‚¹æ³¨æ„çš„æ˜¯ï¼ŒPythonå­—ç¬¦ä¸²å¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œä¸æ˜¯ä»…ä»…æ˜¯æ–‡å­—ã€‚</p>
<p>write()æ–¹æ³•ä¸ä¼šåœ¨å­—ç¬¦ä¸²çš„ç»“å°¾æ·»åŠ æ¢è¡Œç¬¦(â€˜\nâ€™)ï¼š</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>fileObject.write(string)
</code></pre>
<p>åœ¨è¿™é‡Œï¼Œè¢«ä¼ é€’çš„å‚æ•°æ˜¯è¦å†™å…¥åˆ°å·²æ‰“å¼€æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
# æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶
fo = open(&quot;foo.txt&quot;, &quot;w&quot;)
fo.write( &quot;www.runoob.com!\nVery good site!\n&quot;)
 
# å…³é—­æ‰“å¼€çš„æ–‡ä»¶
fo.close()
</code></pre>
<h6 id="read-æ–¹æ³•"><a href="#read-æ–¹æ³•" class="headerlink" title="read()æ–¹æ³•"></a>read()æ–¹æ³•</h6><p>readï¼ˆï¼‰æ–¹æ³•ä»ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚éœ€è¦é‡ç‚¹æ³¨æ„çš„æ˜¯ï¼ŒPythonå­—ç¬¦ä¸²å¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œä¸æ˜¯ä»…ä»…æ˜¯æ–‡å­—ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>fileObject.read([count])
</code></pre>
<p>åœ¨è¿™é‡Œï¼Œè¢«ä¼ é€’çš„å‚æ•°æ˜¯è¦ä»å·²æ‰“å¼€æ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚è®¡æ•°ã€‚è¯¥æ–¹æ³•ä»æ–‡ä»¶çš„å¼€å¤´å¼€å§‹è¯»å…¥ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥countï¼Œå®ƒä¼šå°è¯•å°½å¯èƒ½å¤šåœ°è¯»å–æ›´å¤šçš„å†…å®¹ï¼Œå¾ˆå¯èƒ½æ˜¯ç›´åˆ°æ–‡ä»¶çš„æœ«å°¾ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°ä»¥ä¸Šåˆ›å»ºçš„ foo.txt æ–‡ä»¶ã€‚</p>
<p>å®ä¾‹ï¼š</p>
<pre><code class="python">\#!/usr/bin/python
\# -*- coding: UTF-8 -*-

\# æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶
fo = open(&quot;foo.txt&quot;, &quot;r+&quot;)
str = fo.read(10)
**print** &quot;è¯»å–çš„å­—ç¬¦ä¸²æ˜¯ : &quot;, str
\# å…³é—­æ‰“å¼€çš„æ–‡ä»¶
fo.close()
---------------------
è¯»å–çš„å­—ç¬¦ä¸²æ˜¯ :  www.runoob
</code></pre>
<h6 id="é‡å‘½åå’Œåˆ é™¤æ–‡ä»¶"><a href="#é‡å‘½åå’Œåˆ é™¤æ–‡ä»¶" class="headerlink" title="é‡å‘½åå’Œåˆ é™¤æ–‡ä»¶"></a>é‡å‘½åå’Œåˆ é™¤æ–‡ä»¶</h6><p>Pythonçš„osæ¨¡å—æä¾›äº†å¸®ä½ æ‰§è¡Œæ–‡ä»¶å¤„ç†æ“ä½œçš„æ–¹æ³•ï¼Œæ¯”å¦‚é‡å‘½åå’Œåˆ é™¤æ–‡ä»¶ã€‚<br>è¦ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œä½ å¿…é¡»å…ˆå¯¼å…¥å®ƒï¼Œç„¶åæ‰å¯ä»¥è°ƒç”¨ç›¸å…³çš„å„ç§åŠŸèƒ½ã€‚</p>
<h6 id="rename-æ–¹æ³•"><a href="#rename-æ–¹æ³•" class="headerlink" title="rename() æ–¹æ³•"></a>rename() æ–¹æ³•</h6><p>rename() æ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œå½“å‰çš„æ–‡ä»¶åå’Œæ–°æ–‡ä»¶åã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>os.rename(current_file_name, new_file_name)
</code></pre>
<p>ä¾‹å­ï¼š</p>
<p>ä¸‹ä¾‹å°†é‡å‘½åä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶test1.txtã€‚</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-

import os
 
# é‡å‘½åæ–‡ä»¶test1.txtåˆ°test2.txtã€‚
os.rename( &quot;test1.txt&quot;, &quot;test2.txt&quot; )
</code></pre>
<h6 id="remove-æ–¹æ³•"><a href="#remove-æ–¹æ³•" class="headerlink" title="remove()æ–¹æ³•"></a>remove()æ–¹æ³•</h6><p>ä½ å¯ä»¥ç”¨remove()æ–¹æ³•åˆ é™¤æ–‡ä»¶ï¼Œéœ€è¦æä¾›è¦åˆ é™¤çš„æ–‡ä»¶åä½œä¸ºå‚æ•°ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code class="python">os.remove(file_name)
</code></pre>
<p>ä¾‹å­ï¼š</p>
<p>ä¸‹ä¾‹å°†åˆ é™¤ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶test2.txtã€‚</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-

import os
 
# åˆ é™¤ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶test2.txt
os.remove(&quot;test2.txt&quot;)
</code></pre>
<h6 id="mkdir-æ–¹æ³•"><a href="#mkdir-æ–¹æ³•" class="headerlink" title="mkdir()æ–¹æ³•"></a>mkdir()æ–¹æ³•</h6><p>å¯ä»¥ä½¿ç”¨osæ¨¡å—çš„mkdir()æ–¹æ³•åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºæ–°çš„ç›®å½•ä»¬ã€‚ä½ éœ€è¦æä¾›ä¸€ä¸ªåŒ…å«äº†è¦åˆ›å»ºçš„ç›®å½•åç§°çš„å‚æ•°ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>os.mkdir(&quot;newdir&quot;)
</code></pre>
<p>ä¾‹å­ï¼š</p>
<p>ä¸‹ä¾‹å°†åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•testã€‚</p>
<pre><code>#!/usr/bin/python
# -*- coding: UTF-8 -*-

import os
 
# åˆ›å»ºç›®å½•test
os.mkdir(&quot;test&quot;)
</code></pre>
<h6 id="chdir-æ–¹æ³•"><a href="#chdir-æ–¹æ³•" class="headerlink" title="chdir()æ–¹æ³•"></a>chdir()æ–¹æ³•</h6><p>å¯ä»¥ç”¨chdir()æ–¹æ³•æ¥æ”¹å˜å½“å‰çš„ç›®å½•ã€‚chdir()æ–¹æ³•éœ€è¦çš„ä¸€ä¸ªå‚æ•°æ˜¯ä½ æƒ³è®¾æˆå½“å‰ç›®å½•çš„ç›®å½•åç§°ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>os.chdir(&quot;newdir&quot;)
</code></pre>
<p>ä¾‹å­ï¼š</p>
<p>ä¸‹ä¾‹å°†è¿›å…¥â€&#x2F;home&#x2F;newdirâ€ç›®å½•ã€‚</p>
<pre><code>#!/usr/bin/python
# -*- coding: UTF-8 -*-

import os
 
# å°†å½“å‰ç›®å½•æ”¹ä¸º&quot;/home/newdir&quot;
os.chdir(&quot;/home/newdir&quot;)
</code></pre>
<h6 id="getcwd-æ–¹æ³•"><a href="#getcwd-æ–¹æ³•" class="headerlink" title="getcwd() æ–¹æ³•"></a>getcwd() æ–¹æ³•</h6><p>getcwd()æ–¹æ³•æ˜¾ç¤ºå½“å‰çš„å·¥ä½œç›®å½•ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>os.getcwd()
</code></pre>
<p>ä¾‹å­ï¼š</p>
<p>ä¸‹ä¾‹ç»™å‡ºå½“å‰ç›®å½•ï¼š</p>
<pre><code>#!/usr/bin/python
# -*- coding: UTF-8 -*-

import os
 
# ç»™å‡ºå½“å‰çš„ç›®å½•
print os.getcwd()
</code></pre>
<h6 id="rmdir-æ–¹æ³•"><a href="#rmdir-æ–¹æ³•" class="headerlink" title="rmdir()æ–¹æ³•"></a>rmdir()æ–¹æ³•</h6><p>rmdir()æ–¹æ³•åˆ é™¤ç›®å½•ï¼Œç›®å½•åç§°ä»¥å‚æ•°ä¼ é€’ã€‚</p>
<p>åœ¨åˆ é™¤è¿™ä¸ªç›®å½•ä¹‹å‰ï¼Œå®ƒçš„æ‰€æœ‰å†…å®¹åº”è¯¥å…ˆè¢«æ¸…é™¤ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<pre><code>os.rmdir(&#39;dirname&#39;)
</code></pre>
<p>ä¾‹å­ï¼š</p>
<p>ä»¥ä¸‹æ˜¯åˆ é™¤â€ &#x2F;tmp&#x2F;testâ€ç›®å½•çš„ä¾‹å­ã€‚ç›®å½•çš„å®Œå…¨åˆè§„çš„åç§°å¿…é¡»è¢«ç»™å‡ºï¼Œå¦åˆ™ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æœç´¢è¯¥ç›®å½•ã€‚</p>
<pre><code>#!/usr/bin/python
# -*- coding: UTF-8 -*-

import os
 
# åˆ é™¤â€/tmp/testâ€ç›®å½•
os.rmdir( &quot;/tmp/test&quot;  )
</code></pre>
<h5 id="Python-File-æ–‡ä»¶-æ–¹æ³•"><a href="#Python-File-æ–‡ä»¶-æ–¹æ³•" class="headerlink" title="Python File(æ–‡ä»¶) æ–¹æ³•"></a>Python File(æ–‡ä»¶) æ–¹æ³•</h5><h6 id="open-æ–¹æ³•"><a href="#open-æ–¹æ³•" class="headerlink" title="open() æ–¹æ³•"></a>open() æ–¹æ³•</h6><p>Python open() æ–¹æ³•ç”¨äºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è¿”å›æ–‡ä»¶å¯¹è±¡ï¼Œåœ¨å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†è¿‡ç¨‹éƒ½éœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯¥æ–‡ä»¶æ— æ³•è¢«æ‰“å¼€ï¼Œä¼šæŠ›å‡º OSErrorã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>ä½¿ç”¨ open() æ–¹æ³•ä¸€å®šè¦ä¿è¯å…³é—­æ–‡ä»¶å¯¹è±¡ï¼Œå³è°ƒç”¨ close() æ–¹æ³•ã€‚</p>
<p>open() å‡½æ•°å¸¸ç”¨å½¢å¼æ˜¯æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šæ–‡ä»¶å(file)å’Œæ¨¡å¼(mode)ã€‚</p>
<pre><code>open(file, mode=&#39;r&#39;)
</code></pre>
<p>å®Œæ•´çš„è¯­æ³•æ ¼å¼ä¸ºï¼š</p>
<pre><code>open(file, mode=&#39;r&#39;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)
</code></pre>
<p>å‚æ•°è¯´æ˜:</p>
<ul>
<li>file: å¿…éœ€ï¼Œæ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹æˆ–è€…ç»å¯¹è·¯å¾„ï¼‰ã€‚</li>
<li>mode: å¯é€‰ï¼Œæ–‡ä»¶æ‰“å¼€æ¨¡å¼</li>
<li>buffering: è®¾ç½®ç¼“å†²</li>
<li>encoding: ä¸€èˆ¬ä½¿ç”¨utf8</li>
<li>errors: æŠ¥é”™çº§åˆ«</li>
<li>newline: åŒºåˆ†æ¢è¡Œç¬¦</li>
<li>closefd: ä¼ å…¥çš„fileå‚æ•°ç±»å‹</li>
<li>opener: è®¾ç½®è‡ªå®šä¹‰å¼€å¯å™¨ï¼Œå¼€å¯å™¨çš„è¿”å›å€¼å¿…é¡»æ˜¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</li>
</ul>
<h6 id="file-å¯¹è±¡"><a href="#file-å¯¹è±¡" class="headerlink" title="file å¯¹è±¡"></a>file å¯¹è±¡</h6><p>file å¯¹è±¡ä½¿ç”¨ open å‡½æ•°æ¥åˆ›å»ºï¼Œä¸‹è¡¨åˆ—å‡ºäº† file å¯¹è±¡å¸¸ç”¨çš„å‡½æ•°ï¼š</p>
<table>
<thead>
<tr>
<th align="left">åºå·</th>
<th align="left">æ–¹æ³•åŠæè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-close.html">file.close()</a>å…³é—­æ–‡ä»¶ã€‚å…³é—­åæ–‡ä»¶ä¸èƒ½å†è¿›è¡Œè¯»å†™æ“ä½œã€‚</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-flush.html">file.flush()</a>åˆ·æ–°æ–‡ä»¶å†…éƒ¨ç¼“å†²ï¼Œç›´æ¥æŠŠå†…éƒ¨ç¼“å†²åŒºçš„æ•°æ®ç«‹åˆ»å†™å…¥æ–‡ä»¶, è€Œä¸æ˜¯è¢«åŠ¨çš„ç­‰å¾…è¾“å‡ºç¼“å†²åŒºå†™å…¥ã€‚</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-fileno.html">file.fileno()</a>è¿”å›ä¸€ä¸ªæ•´å‹çš„æ–‡ä»¶æè¿°ç¬¦(file descriptor FD æ•´å‹), å¯ä»¥ç”¨åœ¨å¦‚osæ¨¡å—çš„readæ–¹æ³•ç­‰ä¸€äº›åº•å±‚æ“ä½œä¸Šã€‚</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-isatty.html">file.isatty()</a>å¦‚æœæ–‡ä»¶è¿æ¥åˆ°ä¸€ä¸ªç»ˆç«¯è®¾å¤‡è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-next.html">file.next()</a>è¿”å›æ–‡ä»¶ä¸‹ä¸€è¡Œã€‚</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left">[file.read(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-file-read.html">size])</a>ä»æ–‡ä»¶è¯»å–æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œå¦‚æœæœªç»™å®šæˆ–ä¸ºè´Ÿåˆ™è¯»å–æ‰€æœ‰ã€‚</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left">[file.readline(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-readline.html">size])</a>è¯»å–æ•´è¡Œï¼ŒåŒ…æ‹¬ â€œ\nâ€ å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left">[file.readlines(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-readlines.html">sizeint])</a>è¯»å–æ‰€æœ‰è¡Œå¹¶è¿”å›åˆ—è¡¨ï¼Œè‹¥ç»™å®šsizeint&gt;0ï¼Œåˆ™æ˜¯è®¾ç½®ä¸€æ¬¡è¯»å¤šå°‘å­—èŠ‚ï¼Œè¿™æ˜¯ä¸ºäº†å‡è½»è¯»å–å‹åŠ›ã€‚</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">[file.seek(offset<a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-seek.html">, whence])</a>è®¾ç½®æ–‡ä»¶å½“å‰ä½ç½®</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-tell.html">file.tell()</a>è¿”å›æ–‡ä»¶å½“å‰ä½ç½®ã€‚</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left">[file.truncate(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-truncate.html">size])</a>æˆªå–æ–‡ä»¶ï¼Œæˆªå–çš„å­—èŠ‚é€šè¿‡sizeæŒ‡å®šï¼Œé»˜è®¤ä¸ºå½“å‰æ–‡ä»¶ä½ç½®ã€‚</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-file-write.html">file.write(str)</a>å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ï¼Œè¿”å›çš„æ˜¯å†™å…¥çš„å­—ç¬¦é•¿åº¦ã€‚</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/file-writelines.html">file.writelines(sequence)</a>å‘æ–‡ä»¶å†™å…¥ä¸€ä¸ªåºåˆ—å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¦‚æœéœ€è¦æ¢è¡Œåˆ™è¦è‡ªå·±åŠ å…¥æ¯è¡Œçš„æ¢è¡Œç¬¦ã€‚</td>
</tr>
</tbody></table>
<h6 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h6><p>æ•æ‰å¼‚å¸¸å¯ä»¥ä½¿ç”¨try&#x2F;exceptè¯­å¥ã€‚</p>
<p>try&#x2F;exceptè¯­å¥ç”¨æ¥æ£€æµ‹tryè¯­å¥å—ä¸­çš„é”™è¯¯ï¼Œä»è€Œè®©exceptè¯­å¥æ•è·å¼‚å¸¸ä¿¡æ¯å¹¶å¤„ç†ã€‚</p>
<p>å¦‚æœä½ ä¸æƒ³åœ¨å¼‚å¸¸å‘ç”Ÿæ—¶ç»“æŸä½ çš„ç¨‹åºï¼Œåªéœ€åœ¨tryé‡Œæ•è·å®ƒã€‚</p>
<p>è¯­æ³•ï¼š</p>
<p>ä»¥ä¸‹ä¸ºç®€å•çš„<em>tryâ€¦.exceptâ€¦else</em>çš„è¯­æ³•ï¼š</p>
<pre><code class="python">try:
&lt;è¯­å¥&gt;        #è¿è¡Œåˆ«çš„ä»£ç 
except &lt;åå­—&gt;ï¼š
&lt;è¯­å¥&gt;        #å¦‚æœåœ¨tryéƒ¨ä»½å¼•å‘äº†&#39;name&#39;å¼‚å¸¸
except &lt;åå­—&gt;ï¼Œ&lt;æ•°æ®&gt;:
&lt;è¯­å¥&gt;        #å¦‚æœå¼•å‘äº†&#39;name&#39;å¼‚å¸¸ï¼Œè·å¾—é™„åŠ çš„æ•°æ®
else:
&lt;è¯­å¥&gt;        #å¦‚æœæ²¡æœ‰å¼‚å¸¸å‘ç”Ÿ
</code></pre>
<p>tryçš„å·¥ä½œåŸç†æ˜¯ï¼Œå½“å¼€å§‹ä¸€ä¸ªtryè¯­å¥åï¼Œpythonå°±åœ¨å½“å‰ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ä½œæ ‡è®°ï¼Œè¿™æ ·å½“å¼‚å¸¸å‡ºç°æ—¶å°±å¯ä»¥å›åˆ°è¿™é‡Œï¼Œtryå­å¥å…ˆæ‰§è¡Œï¼Œæ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆä¾èµ–äºæ‰§è¡Œæ—¶æ˜¯å¦å‡ºç°å¼‚å¸¸ã€‚</p>
<ul>
<li>å¦‚æœå½“tryåçš„è¯­å¥æ‰§è¡Œæ—¶å‘ç”Ÿå¼‚å¸¸ï¼Œpythonå°±è·³å›åˆ°tryå¹¶æ‰§è¡Œç¬¬ä¸€ä¸ªåŒ¹é…è¯¥å¼‚å¸¸çš„exceptå­å¥ï¼Œå¼‚å¸¸å¤„ç†å®Œæ¯•ï¼Œæ§åˆ¶æµå°±é€šè¿‡æ•´ä¸ªtryè¯­å¥ï¼ˆé™¤éåœ¨å¤„ç†å¼‚å¸¸æ—¶åˆå¼•å‘æ–°çš„å¼‚å¸¸ï¼‰ã€‚</li>
<li>å¦‚æœåœ¨tryåçš„è¯­å¥é‡Œå‘ç”Ÿäº†å¼‚å¸¸ï¼Œå´æ²¡æœ‰åŒ¹é…çš„exceptå­å¥ï¼Œå¼‚å¸¸å°†è¢«é€’äº¤åˆ°ä¸Šå±‚çš„tryï¼Œæˆ–è€…åˆ°ç¨‹åºçš„æœ€ä¸Šå±‚ï¼ˆè¿™æ ·å°†ç»“æŸç¨‹åºï¼Œå¹¶æ‰“å°é»˜è®¤çš„å‡ºé”™ä¿¡æ¯ï¼‰ã€‚</li>
<li>å¦‚æœåœ¨tryå­å¥æ‰§è¡Œæ—¶æ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼Œpythonå°†æ‰§è¡Œelseè¯­å¥åçš„è¯­å¥ï¼ˆå¦‚æœæœ‰elseçš„è¯ï¼‰ï¼Œç„¶åæ§åˆ¶æµé€šè¿‡æ•´ä¸ªtryè¯­å¥ã€‚</li>
</ul>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-

try:
    fh = open(&quot;testfile&quot;, &quot;w&quot;)
    fh.write(&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•å¼‚å¸¸!!&quot;)
except IOError:
    print &quot;Error: æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶æˆ–è¯»å–æ–‡ä»¶å¤±è´¥&quot;
else:
    print &quot;å†…å®¹å†™å…¥æ–‡ä»¶æˆåŠŸ&quot;
    fh.close()
</code></pre>
<h6 id="ä½¿ç”¨exceptè€Œä¸å¸¦ä»»ä½•å¼‚å¸¸ç±»å‹"><a href="#ä½¿ç”¨exceptè€Œä¸å¸¦ä»»ä½•å¼‚å¸¸ç±»å‹" class="headerlink" title="ä½¿ç”¨exceptè€Œä¸å¸¦ä»»ä½•å¼‚å¸¸ç±»å‹"></a>ä½¿ç”¨exceptè€Œä¸å¸¦ä»»ä½•å¼‚å¸¸ç±»å‹</h6><pre><code class="python">try:
   # æ­£å¸¸çš„æ“ä½œ
   ......................
except:
   # å‘ç”Ÿå¼‚å¸¸ï¼Œæ‰§è¡Œè¿™å—ä»£ç 
   ......................
else:
   # å¦‚æœæ²¡æœ‰å¼‚å¸¸æ‰§è¡Œè¿™å—ä»£ç 
</code></pre>
<p>ä»¥ä¸Šæ–¹å¼<code>try-except</code>è¯­å¥æ•è·æ‰€æœ‰å‘ç”Ÿçš„å¼‚å¸¸ã€‚ä½†è¿™ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼ï¼Œæˆ‘ä»¬ä¸èƒ½é€šè¿‡è¯¥ç¨‹åºè¯†åˆ«å‡ºå…·ä½“çš„å¼‚å¸¸ä¿¡æ¯ã€‚å› ä¸ºå®ƒæ•è·æ‰€æœ‰çš„å¼‚å¸¸ã€‚</p>
<h6 id="ä½¿ç”¨exceptè€Œå¸¦å¤šç§å¼‚å¸¸ç±»å‹"><a href="#ä½¿ç”¨exceptè€Œå¸¦å¤šç§å¼‚å¸¸ç±»å‹" class="headerlink" title="ä½¿ç”¨exceptè€Œå¸¦å¤šç§å¼‚å¸¸ç±»å‹"></a>ä½¿ç”¨exceptè€Œå¸¦å¤šç§å¼‚å¸¸ç±»å‹</h6><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„exceptè¯­å¥æ¥å¤„ç†å¤šä¸ªå¼‚å¸¸ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">try:
   # æ­£å¸¸çš„æ“ä½œ
   ......................
except(Exception1[, Exception2[,...ExceptionN]]):
   # å‘ç”Ÿä»¥ä¸Šå¤šä¸ªå¼‚å¸¸ä¸­çš„ä¸€ä¸ªï¼Œæ‰§è¡Œè¿™å—ä»£ç 
   ......................
else:
   # å¦‚æœæ²¡æœ‰å¼‚å¸¸æ‰§è¡Œè¿™å—ä»£ç 
</code></pre>
<h6 id="try-finally-è¯­å¥"><a href="#try-finally-è¯­å¥" class="headerlink" title="try-finally è¯­å¥"></a>try-finally è¯­å¥</h6><p>try-finally è¯­å¥æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½å°†æ‰§è¡Œæœ€åçš„ä»£ç ã€‚</p>
<pre><code class="python">try:
&lt;è¯­å¥&gt;
finally:
&lt;è¯­å¥&gt;    #é€€å‡ºtryæ—¶æ€»ä¼šæ‰§è¡Œ
raise

---------------------------
try:
    fh = open(&quot;testfile&quot;, &quot;w&quot;)
    fh.write(&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•å¼‚å¸¸!!&quot;)
finally:
    print &quot;Error: æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶æˆ–è¯»å–æ–‡ä»¶å¤±è´¥&quot;
</code></pre>
<p>åŒæ ·çš„ä¾‹å­ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹æ–¹å¼</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-

try:
    fh = open(&quot;testfile&quot;, &quot;w&quot;)
    try:
        fh.write(&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•å¼‚å¸¸!!&quot;)
    finally:
        print &quot;å…³é—­æ–‡ä»¶&quot;
        fh.close()
except IOError:
    print &quot;Error: æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶æˆ–è¯»å–æ–‡ä»¶å¤±è´¥&quot;
</code></pre>
<p>å½“åœ¨tryå—ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç«‹å³æ‰§è¡Œfinallyå—ä»£ç ã€‚finallyå—ä¸­çš„æ‰€æœ‰è¯­å¥æ‰§è¡Œåï¼Œå¼‚å¸¸è¢«å†æ¬¡è§¦å‘ï¼Œå¹¶æ‰§è¡Œexceptå—ä»£ç ã€‚å‚æ•°çš„å†…å®¹ä¸åŒäºå¼‚å¸¸ã€‚</p>
<h6 id="è§¦å‘å¼‚å¸¸"><a href="#è§¦å‘å¼‚å¸¸" class="headerlink" title="è§¦å‘å¼‚å¸¸"></a><strong>è§¦å‘å¼‚å¸¸</strong></h6><p>å®ä¾‹</p>
<p>ä¸€ä¸ªå¼‚å¸¸å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç±»æˆ–å¯¹è±¡ã€‚ Pythonçš„å†…æ ¸æä¾›çš„å¼‚å¸¸ï¼Œå¤§å¤šæ•°éƒ½æ˜¯å®ä¾‹åŒ–çš„ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹çš„å‚æ•°ã€‚</p>
<p>å®šä¹‰ä¸€ä¸ªå¼‚å¸¸éå¸¸ç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>å®ä¾‹</p>
<pre><code class="python">def functionName( level ):
  if level &lt; 1:
    raise Exception(&quot;Invalid level!&quot;, level)
    \# è§¦å‘å¼‚å¸¸åï¼Œåé¢çš„ä»£ç å°±ä¸ä¼šå†æ‰§è¡Œ
</code></pre>
<p>ä¸ºäº†èƒ½å¤Ÿæ•è·å¼‚å¸¸ï¼Œâ€exceptâ€è¯­å¥å¿…é¡»æœ‰ç”¨ç›¸åŒçš„å¼‚å¸¸æ¥æŠ›å‡ºç±»å¯¹è±¡æˆ–è€…å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚æˆ‘ä»¬æ•è·ä»¥ä¸Šå¼‚å¸¸ï¼Œâ€exceptâ€è¯­å¥å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python"># è§¦å‘å¼‚å¸¸åï¼Œåé¢çš„ä»£ç å°±ä¸ä¼šå†æ‰§è¡Œ  è§¦å‘å¼‚å¸¸åï¼Œåé¢çš„ä»£ç å°±ä¸ä¼šå†æ‰§è¡Œ
try:
    æ­£å¸¸é€»è¾‘
except Exception,err:
    è§¦å‘è‡ªå®šä¹‰å¼‚å¸¸    
else:
    å…¶ä½™ä»£ç 

----------------------
#!/usr/bin/python
# -*- coding: UTF-8 -*-

# å®šä¹‰å‡½æ•°
def mye( level ):
    if level &lt; 1:
        raise Exception,&quot;Invalid level!&quot;
        # è§¦å‘å¼‚å¸¸åï¼Œåé¢çš„ä»£ç å°±ä¸ä¼šå†æ‰§è¡Œ
try:
    mye(0)            # è§¦å‘å¼‚å¸¸
except Exception,err:
    print 1,err
else:
    print 2
----------------------
$ python test.py 
1 Invalid level!
</code></pre>
<h6 id="ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸"><a href="#ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸" class="headerlink" title="ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸"></a>ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸</h6><p>é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„å¼‚å¸¸ç±»ï¼Œç¨‹åºå¯ä»¥å‘½åå®ƒä»¬è‡ªå·±çš„å¼‚å¸¸ã€‚å¼‚å¸¸åº”è¯¥æ˜¯å…¸å‹çš„ç»§æ‰¿è‡ªExceptionç±»ï¼Œé€šè¿‡ç›´æ¥æˆ–é—´æ¥çš„æ–¹å¼ã€‚ä»¥ä¸‹ä¸ºä¸RuntimeErrorç›¸å…³çš„å®ä¾‹,å®ä¾‹ä¸­åˆ›å»ºäº†ä¸€ä¸ªç±»ï¼ŒåŸºç±»ä¸ºRuntimeErrorï¼Œç”¨äºåœ¨å¼‚å¸¸è§¦å‘æ—¶è¾“å‡ºæ›´å¤šçš„ä¿¡æ¯ã€‚åœ¨tryè¯­å¥å—ä¸­ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„å¼‚å¸¸åæ‰§è¡Œexceptå—è¯­å¥ï¼Œå˜é‡ e æ˜¯ç”¨äºåˆ›å»ºNetworkerrorç±»çš„å®ä¾‹ã€‚</p>
<pre><code class="python">class Networkerror(RuntimeError):
    def __init__(self, arg):
        self.args = arg
</code></pre>
<p>åœ¨ä½ å®šä¹‰ä»¥ä¸Šç±»åï¼Œä½ å¯ä»¥è§¦å‘è¯¥å¼‚å¸¸ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">try:
    raise Networkerror(&quot;Bad hostname&quot;)
except Networkerror,e:
    print e.args
</code></pre>
<h6 id="Python-OS-æ–‡ä»¶-x2F-ç›®å½•æ–¹æ³•"><a href="#Python-OS-æ–‡ä»¶-x2F-ç›®å½•æ–¹æ³•" class="headerlink" title="Python OS æ–‡ä»¶&#x2F;ç›®å½•æ–¹æ³•"></a>Python OS æ–‡ä»¶&#x2F;ç›®å½•æ–¹æ³•</h6><table>
<thead>
<tr>
<th align="left">åºå·</th>
<th align="left">æ–¹æ³•åŠæè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-access.html">os.access(path, mode)</a> æ£€éªŒæƒé™æ¨¡å¼</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-chdir.html">os.chdir(path)</a> æ”¹å˜å½“å‰å·¥ä½œç›®å½•</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-chflags.html">os.chflags(path, flags)</a> è®¾ç½®è·¯å¾„çš„æ ‡è®°ä¸ºæ•°å­—æ ‡è®°ã€‚</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-chmod.html">os.chmod(path, mode)</a> æ›´æ”¹æƒé™</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-chown.html">os.chown(path, uid, gid)</a> æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…</td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-chroot.html">os.chroot(path)</a> æ”¹å˜å½“å‰è¿›ç¨‹çš„æ ¹ç›®å½•</td>
</tr>
<tr>
<td align="left">7</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-close.html">os.close(fd)</a> å…³é—­æ–‡ä»¶æè¿°ç¬¦ fd</td>
</tr>
<tr>
<td align="left">8</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-closerange.html">os.closerange(fd_low, fd_high)</a> å…³é—­æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦ï¼Œä» fd_low (åŒ…å«) åˆ° fd_high (ä¸åŒ…å«), é”™è¯¯ä¼šå¿½ç•¥</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-dup.html">os.dup(fd)</a> å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ fd</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-dup2.html">os.dup2(fd, fd2)</a> å°†ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ fd å¤åˆ¶åˆ°å¦ä¸€ä¸ª fd2</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fchdir.html">os.fchdir(fd)</a> é€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ”¹å˜å½“å‰å·¥ä½œç›®å½•</td>
</tr>
<tr>
<td align="left">12</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fchmod.html">os.fchmod(fd, mode)</a> æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„è®¿é—®æƒé™ï¼Œè¯¥æ–‡ä»¶ç”±å‚æ•°fdæŒ‡å®šï¼Œå‚æ•°modeæ˜¯Unixä¸‹çš„æ–‡ä»¶è®¿é—®æƒé™ã€‚</td>
</tr>
<tr>
<td align="left">13</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fchown.html">os.fchown(fd, uid, gid)</a> ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰æƒï¼Œè¿™ä¸ªå‡½æ•°ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶çš„ç”¨æˆ·IDå’Œç”¨æˆ·ç»„IDï¼Œè¯¥æ–‡ä»¶ç”±æ–‡ä»¶æè¿°ç¬¦fdæŒ‡å®šã€‚</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fdatasync.html">os.fdatasync(fd)</a> å¼ºåˆ¶å°†æ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œè¯¥æ–‡ä»¶ç”±æ–‡ä»¶æè¿°ç¬¦fdæŒ‡å®šï¼Œä½†æ˜¯ä¸å¼ºåˆ¶æ›´æ–°æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left">[os.fdopen(fd<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fdopen.html">, mode[, bufsize]])</a> é€šè¿‡æ–‡ä»¶æè¿°ç¬¦ fd åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œå¹¶è¿”å›è¿™ä¸ªæ–‡ä»¶å¯¹è±¡</td>
</tr>
<tr>
<td align="left">16</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fpathconf.html">os.fpathconf(fd, name)</a> è¿”å›ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶çš„ç³»ç»Ÿé…ç½®ä¿¡æ¯ã€‚nameä¸ºæ£€ç´¢çš„ç³»ç»Ÿé…ç½®çš„å€¼ï¼Œå®ƒä¹Ÿè®¸æ˜¯ä¸€ä¸ªå®šä¹‰ç³»ç»Ÿå€¼çš„å­—ç¬¦ä¸²ï¼Œè¿™äº›åå­—åœ¨å¾ˆå¤šæ ‡å‡†ä¸­æŒ‡å®šï¼ˆPOSIX.1, Unix 95, Unix 98, å’Œå…¶å®ƒï¼‰ã€‚</td>
</tr>
<tr>
<td align="left">17</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fstat.html">os.fstat(fd)</a> è¿”å›æ–‡ä»¶æè¿°ç¬¦fdçš„çŠ¶æ€ï¼Œåƒstat()ã€‚</td>
</tr>
<tr>
<td align="left">18</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fstatvfs.html">os.fstatvfs(fd)</a> è¿”å›åŒ…å«æ–‡ä»¶æè¿°ç¬¦fdçš„æ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼Œåƒ statvfs()</td>
</tr>
<tr>
<td align="left">19</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-fsync.html">os.fsync(fd)</a> å¼ºåˆ¶å°†æ–‡ä»¶æè¿°ç¬¦ä¸ºfdçš„æ–‡ä»¶å†™å…¥ç¡¬ç›˜ã€‚</td>
</tr>
<tr>
<td align="left">20</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-ftruncate.html">os.ftruncate(fd, length)</a> è£å‰ªæ–‡ä»¶æè¿°ç¬¦fdå¯¹åº”çš„æ–‡ä»¶, æ‰€ä»¥å®ƒæœ€å¤§ä¸èƒ½è¶…è¿‡æ–‡ä»¶å¤§å°ã€‚</td>
</tr>
<tr>
<td align="left">21</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-getcwd.html">os.getcwd()</a> è¿”å›å½“å‰å·¥ä½œç›®å½•</td>
</tr>
<tr>
<td align="left">22</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-getcwdu.html">os.getcwdu()</a> è¿”å›ä¸€ä¸ªå½“å‰å·¥ä½œç›®å½•çš„Unicodeå¯¹è±¡</td>
</tr>
<tr>
<td align="left">23</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-isatty.html">os.isatty(fd)</a> å¦‚æœæ–‡ä»¶æè¿°ç¬¦fdæ˜¯æ‰“å¼€çš„ï¼ŒåŒæ—¶ä¸tty(-like)è®¾å¤‡ç›¸è¿ï¼Œåˆ™è¿”å›true, å¦åˆ™Falseã€‚</td>
</tr>
<tr>
<td align="left">24</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-lchflags.html">os.lchflags(path, flags)</a> è®¾ç½®è·¯å¾„çš„æ ‡è®°ä¸ºæ•°å­—æ ‡è®°ï¼Œç±»ä¼¼ chflags()ï¼Œä½†æ˜¯æ²¡æœ‰è½¯é“¾æ¥</td>
</tr>
<tr>
<td align="left">25</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-lchmod.html">os.lchmod(path, mode)</a> ä¿®æ”¹è¿æ¥æ–‡ä»¶æƒé™</td>
</tr>
<tr>
<td align="left">26</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-lchown.html">os.lchown(path, uid, gid)</a> æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…ï¼Œç±»ä¼¼ chownï¼Œä½†æ˜¯ä¸è¿½è¸ªé“¾æ¥ã€‚</td>
</tr>
<tr>
<td align="left">27</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-link.html">os.link(src, dst)</a> åˆ›å»ºç¡¬é“¾æ¥ï¼Œåä¸ºå‚æ•° dstï¼ŒæŒ‡å‘å‚æ•° src</td>
</tr>
<tr>
<td align="left">28</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-listdir.html">os.listdir(path)</a> è¿”å›pathæŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„åˆ—è¡¨ã€‚</td>
</tr>
<tr>
<td align="left">29</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-lseek.html">os.lseek(fd, pos, how)</a> è®¾ç½®æ–‡ä»¶æè¿°ç¬¦ fdå½“å‰ä½ç½®ä¸ºpos, howæ–¹å¼ä¿®æ”¹: SEEK_SET æˆ–è€… 0 è®¾ç½®ä»æ–‡ä»¶å¼€å§‹çš„è®¡ç®—çš„pos; SEEK_CURæˆ–è€… 1 åˆ™ä»å½“å‰ä½ç½®è®¡ç®—; os.SEEK_ENDæˆ–è€…2åˆ™ä»æ–‡ä»¶å°¾éƒ¨å¼€å§‹. åœ¨unixï¼ŒWindowsä¸­æœ‰æ•ˆ</td>
</tr>
<tr>
<td align="left">30</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-lstat.html">os.lstat(path)</a> åƒstat(),ä½†æ˜¯æ²¡æœ‰è½¯é“¾æ¥</td>
</tr>
<tr>
<td align="left">31</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-major.html">os.major(device)</a> ä»åŸå§‹çš„è®¾å¤‡å·ä¸­æå–è®¾å¤‡majorå·ç  (ä½¿ç”¨statä¸­çš„st_devæˆ–è€…st_rdev field)ã€‚</td>
</tr>
<tr>
<td align="left">32</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-makedev.html">os.makedev(major, minor)</a> ä»¥majorå’Œminorè®¾å¤‡å·ç»„æˆä¸€ä¸ªåŸå§‹è®¾å¤‡å·</td>
</tr>
<tr>
<td align="left">33</td>
<td align="left">[os.makedirs(path<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-makedirs.html">, mode])</a> é€’å½’æ–‡ä»¶å¤¹åˆ›å»ºå‡½æ•°ã€‚åƒmkdir(), ä½†åˆ›å»ºçš„æ‰€æœ‰intermediate-levelæ–‡ä»¶å¤¹éœ€è¦åŒ…å«å­æ–‡ä»¶å¤¹ã€‚</td>
</tr>
<tr>
<td align="left">34</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-minor.html">os.minor(device)</a> ä»åŸå§‹çš„è®¾å¤‡å·ä¸­æå–è®¾å¤‡minorå·ç  (ä½¿ç”¨statä¸­çš„st_devæˆ–è€…st_rdev field )ã€‚</td>
</tr>
<tr>
<td align="left">35</td>
<td align="left">[os.mkdir(path<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-mkdir.html">, mode])</a> ä»¥æ•°å­—modeçš„modeåˆ›å»ºä¸€ä¸ªåä¸ºpathçš„æ–‡ä»¶å¤¹.é»˜è®¤çš„ mode æ˜¯ 0777 (å…«è¿›åˆ¶)ã€‚</td>
</tr>
<tr>
<td align="left">36</td>
<td align="left">[os.mkfifo(path<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-mkfifo.html">, mode])</a> åˆ›å»ºå‘½åç®¡é“ï¼Œmode ä¸ºæ•°å­—ï¼Œé»˜è®¤ä¸º 0666 (å…«è¿›åˆ¶)</td>
</tr>
<tr>
<td align="left">37</td>
<td align="left">[os.mknod(filename<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-mknod.html">, mode&#x3D;0600, device])</a> åˆ›å»ºä¸€ä¸ªåä¸ºfilenameæ–‡ä»¶ç³»ç»ŸèŠ‚ç‚¹ï¼ˆæ–‡ä»¶ï¼Œè®¾å¤‡ç‰¹åˆ«æ–‡ä»¶æˆ–è€…å‘½åpipeï¼‰ã€‚</td>
</tr>
<tr>
<td align="left">38</td>
<td align="left">[os.open(file, flags<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-open.html">, mode])</a> æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”è®¾ç½®éœ€è¦çš„æ‰“å¼€é€‰é¡¹ï¼Œmodeå‚æ•°æ˜¯å¯é€‰çš„</td>
</tr>
<tr>
<td align="left">39</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-openpty.html">os.openpty()</a> æ‰“å¼€ä¸€ä¸ªæ–°çš„ä¼ªç»ˆç«¯å¯¹ã€‚è¿”å› pty å’Œ ttyçš„æ–‡ä»¶æè¿°ç¬¦ã€‚</td>
</tr>
<tr>
<td align="left">40</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-pathconf.html">os.pathconf(path, name)</a> è¿”å›ç›¸å…³æ–‡ä»¶çš„ç³»ç»Ÿé…ç½®ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td align="left">41</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-pipe.html">os.pipe()</a> åˆ›å»ºä¸€ä¸ªç®¡é“. è¿”å›ä¸€å¯¹æ–‡ä»¶æè¿°ç¬¦(r, w) åˆ†åˆ«ä¸ºè¯»å’Œå†™</td>
</tr>
<tr>
<td align="left">42</td>
<td align="left">[os.popen(command<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-popen.html">, mode[, bufsize]])</a> ä»ä¸€ä¸ª command æ‰“å¼€ä¸€ä¸ªç®¡é“</td>
</tr>
<tr>
<td align="left">43</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-read.html">os.read(fd, n)</a> ä»æ–‡ä»¶æè¿°ç¬¦ fd ä¸­è¯»å–æœ€å¤š n ä¸ªå­—èŠ‚ï¼Œè¿”å›åŒ…å«è¯»å–å­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œæ–‡ä»¶æè¿°ç¬¦ fdå¯¹åº”æ–‡ä»¶å·²è¾¾åˆ°ç»“å°¾, è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td align="left">44</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-readlink.html">os.readlink(path)</a> è¿”å›è½¯é“¾æ¥æ‰€æŒ‡å‘çš„æ–‡ä»¶</td>
</tr>
<tr>
<td align="left">45</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-remove.html">os.remove(path)</a> åˆ é™¤è·¯å¾„ä¸ºpathçš„æ–‡ä»¶ã€‚å¦‚æœpath æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå°†æŠ›å‡ºOSError; æŸ¥çœ‹ä¸‹é¢çš„rmdir()åˆ é™¤ä¸€ä¸ª directoryã€‚</td>
</tr>
<tr>
<td align="left">46</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-removedirs.html">os.removedirs(path)</a> é€’å½’åˆ é™¤ç›®å½•ã€‚</td>
</tr>
<tr>
<td align="left">47</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-rename.html">os.rename(src, dst)</a> é‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ï¼Œä» src åˆ° dst</td>
</tr>
<tr>
<td align="left">48</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-renames.html">os.renames(old, new)</a> é€’å½’åœ°å¯¹ç›®å½•è¿›è¡Œæ›´åï¼Œä¹Ÿå¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œæ›´åã€‚</td>
</tr>
<tr>
<td align="left">49</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-rmdir.html">os.rmdir(path)</a> åˆ é™¤pathæŒ‡å®šçš„ç©ºç›®å½•ï¼Œå¦‚æœç›®å½•éç©ºï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªOSErrorå¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td align="left">50</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-stat.html">os.stat(path)</a> è·å–pathæŒ‡å®šçš„è·¯å¾„çš„ä¿¡æ¯ï¼ŒåŠŸèƒ½ç­‰åŒäºC APIä¸­çš„stat()ç³»ç»Ÿè°ƒç”¨ã€‚</td>
</tr>
<tr>
<td align="left">51</td>
<td align="left">[os.stat_float_times(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-stat_float_times.html">newvalue])</a> å†³å®šstat_resultæ˜¯å¦ä»¥floatå¯¹è±¡æ˜¾ç¤ºæ—¶é—´æˆ³</td>
</tr>
<tr>
<td align="left">52</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-statvfs.html">os.statvfs(path)</a> è·å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯</td>
</tr>
<tr>
<td align="left">53</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-symlink.html">os.symlink(src, dst)</a> åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥</td>
</tr>
<tr>
<td align="left">54</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-tcgetpgrp.html">os.tcgetpgrp(fd)</a> è¿”å›ä¸ç»ˆç«¯fdï¼ˆä¸€ä¸ªç”±os.open()è¿”å›çš„æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼‰å…³è”çš„è¿›ç¨‹ç»„</td>
</tr>
<tr>
<td align="left">55</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-tcsetpgrp.html">os.tcsetpgrp(fd, pg)</a> è®¾ç½®ä¸ç»ˆç«¯fdï¼ˆä¸€ä¸ªç”±os.open()è¿”å›çš„æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼‰å…³è”çš„è¿›ç¨‹ç»„ä¸ºpgã€‚</td>
</tr>
<tr>
<td align="left">56</td>
<td align="left">[os.tempnam(<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-tempnam.html">dir[, prefix]])</a> è¿”å›å”¯ä¸€çš„è·¯å¾„åç”¨äºåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td align="left">57</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-tmpfile.html">os.tmpfile()</a> è¿”å›ä¸€ä¸ªæ‰“å¼€çš„æ¨¡å¼ä¸º(w+b)çš„æ–‡ä»¶å¯¹è±¡ .è¿™æ–‡ä»¶å¯¹è±¡æ²¡æœ‰æ–‡ä»¶å¤¹å…¥å£ï¼Œæ²¡æœ‰æ–‡ä»¶æè¿°ç¬¦ï¼Œå°†ä¼šè‡ªåŠ¨åˆ é™¤ã€‚</td>
</tr>
<tr>
<td align="left">58</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-tmpnam.html">os.tmpnam()</a> ä¸ºåˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶è¿”å›ä¸€ä¸ªå”¯ä¸€çš„è·¯å¾„</td>
</tr>
<tr>
<td align="left">59</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-ttyname.html">os.ttyname(fd)</a> è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒè¡¨ç¤ºä¸æ–‡ä»¶æè¿°ç¬¦fd å…³è”çš„ç»ˆç«¯è®¾å¤‡ã€‚å¦‚æœfd æ²¡æœ‰ä¸ç»ˆç«¯è®¾å¤‡å…³è”ï¼Œåˆ™å¼•å‘ä¸€ä¸ªå¼‚å¸¸ã€‚</td>
</tr>
<tr>
<td align="left">60</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-unlink.html">os.unlink(path)</a> åˆ é™¤æ–‡ä»¶</td>
</tr>
<tr>
<td align="left">61</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-utime.html">os.utime(path, times)</a> è¿”å›æŒ‡å®šçš„pathæ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹çš„æ—¶é—´ã€‚</td>
</tr>
<tr>
<td align="left">62</td>
<td align="left">[os.walk(top[, topdown&#x3D;True[, onerror&#x3D;None[, followlinks&#x3D;False]]])](<a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-walk.html">https://www.runoob.com/python/os-walk.html</a>) è¾“å‡ºåœ¨æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶åé€šè¿‡åœ¨æ ‘ä¸­æ¸¸èµ°ï¼Œå‘ä¸Šæˆ–è€…å‘ä¸‹ã€‚</td>
</tr>
<tr>
<td align="left">63</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/os-write.html">os.write(fd, str)</a> å†™å…¥å­—ç¬¦ä¸²åˆ°æ–‡ä»¶æè¿°ç¬¦ fdä¸­. è¿”å›å®é™…å†™å…¥çš„å­—ç¬¦ä¸²é•¿åº¦</td>
</tr>
<tr>
<td align="left">64</td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-os-path.html">os.path æ¨¡å—</a> è·å–æ–‡ä»¶çš„å±æ€§ä¿¡æ¯ã€‚</td>
</tr>
</tbody></table>
<h6 id="Python-å†…ç½®å‡½æ•°"><a href="#Python-å†…ç½®å‡½æ•°" class="headerlink" title="Python å†…ç½®å‡½æ•°"></a>Python å†…ç½®å‡½æ•°</h6><table>
<thead>
<tr>
<th align="left"></th>
<th align="left"></th>
<th align="left">å†…ç½®å‡½æ•°</th>
<th align="left"></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-abs.html">abs()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-divmod.html">divmod()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-input.html">input()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-open.html">open()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-staticmethod.html">staticmethod()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-all.html">all()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-enumerate.html">enumerate()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-int.html">int()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-ord.html">ord()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-str.html">str()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-any.html">any()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-eval.html">eval()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-isinstance.html">isinstance()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-pow.html">pow()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-sum.html">sum()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-basestring.html">basestring()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-execfile.html">execfile()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-issubclass.html">issubclass()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-print.html">print()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-super.html">super()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-bin.html">bin()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-file.html">file()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-iter.html">iter()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-property.html">property()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-tuple-tuple.html">tuple()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-bool.html">bool()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-filter.html">filter()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-len.html">len()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-range.html">range()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-type.html">type()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-bytearray.html">bytearray()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-float.html">float()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-list.html">list()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-raw_input.html">raw_input()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-unichr.html">unichr()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-callable.html">callable()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-string-format.html">format()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-locals.html">locals()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-reduce.html">reduce()</a></td>
<td align="left">unicode()</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-chr.html">chr()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-frozenset.html">frozenset()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-long.html">long()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-reload.html">reload()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-vars.html">vars()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-classmethod.html">classmethod()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-getattr.html">getattr()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-map.html">map()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-repr.html">repr()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-xrange.html">xrange()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-cmp.html">cmp()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-globals.html">globals()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-max.html">max()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/att-list-reverse.html">reverse()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-zip.html">zip()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-compile.html">compile()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-hasattr.html">hasattr()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-memoryview.html">memoryview()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-round.html">round()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-__import__.html"><strong>import</strong>()</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-complex.html">complex()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-hash.html">hash()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/func-number-min.html">min()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-set.html">set()</a></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-delattr.html">delattr()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-help.html">help()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-next.html">next()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-setattr.html">setattr()</a></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-dict.html">dict()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-hex.html">hex()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python3/python-func-object.html">object()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-slice.html">slice()</a></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-dir.html">dir()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-id.html">id()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-oct.html">oct()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-sorted.html">sorted()</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-exec.html">exec å†…ç½®è¡¨è¾¾å¼</a></td>
</tr>
</tbody></table>
<hr>
<hr>
<hr>
<h1 id="Pythoné«˜çº§"><a href="#Pythoné«˜çº§" class="headerlink" title="Pythoné«˜çº§"></a><span style = "color:red">Pythoné«˜çº§</span></h1><h6 id="åˆ›å»ºç±»-é¢å‘å¯¹è±¡"><a href="#åˆ›å»ºç±»-é¢å‘å¯¹è±¡" class="headerlink" title="åˆ›å»ºç±» [é¢å‘å¯¹è±¡]"></a>åˆ›å»ºç±» [é¢å‘å¯¹è±¡]</h6><pre><code class="python">class Employee:
    &#39;æ‰€æœ‰å‘˜å·¥çš„åŸºæœ¬ç±»å‹&#39;
    empCount = 0

    def __init__(self, name, salary):
        self.name = name
        self.salary = salary
        Employee.empCount += 1

    def displayCount(self):
        print (&quot;Total Employee %d&quot; % Employee.empCount)
    def displayEmployee(self):
        print (&quot;Name : &quot;, self.name,  &quot;, Salary: &quot;, self.salary)

------------------------------------------
class Employee:  
    # å®šä¹‰ä¸€ä¸ªåä¸º Employee çš„æ–°ç±»
    &#39;æ‰€æœ‰å‘˜å·¥çš„åŸºæœ¬ç±»å‹&#39;  
    # ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²ï¼Œæè¿°ç±»çš„ç”¨é€”

    empCount = 0  
    # ç±»å˜é‡ï¼Œç”¨äºè·Ÿè¸ªç±»å®ä¾‹çš„æ•°é‡

    def __init__(self, name, salary):  
        # ç±»çš„æ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºç±»çš„æ–°å®ä¾‹
        self.name = name  
        # å°†å‚æ•° name çš„å€¼èµ‹ç»™å®ä¾‹å˜é‡ name
        self.salary = salary 
        # å°†å‚æ•° salary çš„å€¼èµ‹ç»™å®ä¾‹å˜é‡ salary
        Employee.empCount += 1  
        # æ¯åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œç±»å˜é‡ empCount çš„å€¼å°±å¢åŠ  1

    def displayCount(self):  
        # ç±»çš„æ–¹æ³•ï¼Œç”¨äºæ˜¾ç¤ºå½“å‰å‘˜å·¥æ•°é‡
        print(&quot;Total Employee %d&quot; % Employee.empCount)              # æ‰“å°å‘˜å·¥æ€»æ•°

    def displayEmployee(self):  
        # ç±»çš„æ–¹æ³•ï¼Œç”¨äºæ˜¾ç¤ºå‘˜å·¥ä¿¡æ¯
        print(&quot;Name : &quot;, self.name, &quot;, Salary: &quot;, self.salary)  
        # æ‰“å°å‘˜å·¥çš„å§“åå’Œè–ªæ°´
</code></pre>
<ul>
<li>empCount å˜é‡æ˜¯ä¸€ä¸ªç±»å˜é‡ï¼Œå®ƒçš„å€¼å°†åœ¨è¿™ä¸ªç±»çš„æ‰€æœ‰å®ä¾‹ä¹‹é—´å…±äº«ã€‚ä½ å¯ä»¥åœ¨å†…éƒ¨ç±»æˆ–å¤–éƒ¨ç±»ä½¿ç”¨ Employee.empCount è®¿é—®ã€‚</li>
<li>ç¬¬ä¸€ç§æ–¹æ³•__init__()æ–¹æ³•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œè¢«ç§°ä¸ºç±»çš„æ„é€ å‡½æ•°æˆ–åˆå§‹åŒ–æ–¹æ³•ï¼Œå½“åˆ›å»ºäº†è¿™ä¸ªç±»çš„å®ä¾‹æ—¶å°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•</li>
<li>self ä»£è¡¨ç±»çš„å®ä¾‹ï¼Œself åœ¨å®šä¹‰ç±»çš„æ–¹æ³•æ—¶æ˜¯å¿…é¡»æœ‰çš„ï¼Œè™½ç„¶åœ¨è°ƒç”¨æ—¶ä¸å¿…ä¼ å…¥ç›¸åº”çš„å‚æ•°ã€‚</li>
</ul>
<h6 id="åˆ›å»ºå®ä¾‹å¯¹è±¡"><a href="#åˆ›å»ºå®ä¾‹å¯¹è±¡" class="headerlink" title="åˆ›å»ºå®ä¾‹å¯¹è±¡"></a>åˆ›å»ºå®ä¾‹å¯¹è±¡</h6><p>å®ä¾‹åŒ–ç±»å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ä¸€èˆ¬ç”¨å…³é”®å­— newï¼Œä½†æ˜¯åœ¨ Python ä¸­å¹¶æ²¡æœ‰è¿™ä¸ªå…³é”®å­—ï¼Œç±»çš„å®ä¾‹åŒ–ç±»ä¼¼å‡½æ•°è°ƒç”¨æ–¹å¼ã€‚ä»¥ä¸‹ä½¿ç”¨ç±»çš„åç§° Employee æ¥å®ä¾‹åŒ–ï¼Œå¹¶é€šè¿‡ <strong>init</strong> æ–¹æ³•æ¥æ”¶å‚æ•°</p>
<pre><code class="python"># å…¶ä½™çš„éƒ½åœ¨ä¸Šé¢çš„ä»£ç ä¸­
emp1 = Employee(&quot;Zara&quot;, 2000)
emp2 = Employee(&quot;Manni&quot;, 5000)
</code></pre>
<h6 id="è®¿é—®å±æ€§"><a href="#è®¿é—®å±æ€§" class="headerlink" title="è®¿é—®å±æ€§"></a>è®¿é—®å±æ€§</h6><p>æ‚¨å¯ä»¥ä½¿ç”¨ç‚¹å· <strong>.</strong> æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ã€‚ä½¿ç”¨å¦‚ä¸‹ç±»çš„åç§°è®¿é—®ç±»å˜é‡:</p>
<pre><code class="python">emp1.displayEmployee()
emp2.displayEmployee()
print &quot;Total Employee %d&quot; % Employee.empCount
----------------------------------
Name :  Zara , Salary:  2000
Name :  Manni , Salary:  5000
Total Employeeï¼š2
</code></pre>
<p>ä½ å¯ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹ç±»çš„å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">emp1.age = 7  # æ·»åŠ ä¸€ä¸ª &#39;age&#39; å±æ€§
emp1.age = 8  # ä¿®æ”¹ &#39;age&#39; å±æ€§
del emp1.age  # åˆ é™¤ &#39;age&#39; å±æ€§
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡½æ•°çš„æ–¹å¼æ¥è®¿é—®å±æ€§ï¼š</p>
<ul>
<li><strong>getattr</strong>(obj, name[, default]) : è®¿é—®å¯¹è±¡çš„å±æ€§ã€‚</li>
<li><strong>hasattr</strong>(obj,name) : æ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå±æ€§ã€‚</li>
<li><strong>setattr</strong>(obj,name,value) : è®¾ç½®ä¸€ä¸ªå±æ€§ã€‚å¦‚æœå±æ€§ä¸å­˜åœ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°å±æ€§ã€‚</li>
<li><strong>delattr</strong>(obj, name) : åˆ é™¤å±æ€§ã€‚</li>
</ul>
<blockquote>
<p>hasattr(emp1, â€˜ageâ€™)        # å¦‚æœå­˜åœ¨ â€˜ageâ€™ å±æ€§è¿”å› Trueã€‚<br>getattr(emp1, â€˜ageâ€™)         # è¿”å› â€˜ageâ€™ å±æ€§çš„å€¼<br>setattr(emp1, â€˜ageâ€™, 8)     # æ·»åŠ å±æ€§ â€˜ageâ€™ å€¼ä¸º 8<br>delattr(emp1, â€˜ageâ€™)         # åˆ é™¤å±æ€§ â€˜ageâ€™</p>
</blockquote>
<pre><code class="python">emp1.displayEmployee()
emp2.displayEmployee()
emp1.age = 7 # æ·»åŠ ä¸€ä¸ª &#39;age&#39; å±æ€§
print(&quot;å§“åï¼š%s&quot; %emp1.name, &quot;å¹´é¾„ï¼š%d&quot; %emp1.age)
print (&quot;æ€»è®¡ï¼š%d&quot; %Employee.empCount)
-----------------------------------
Name :  Zara , Salary:  2000
Name :  Manni , Salary:  5000
å§“åï¼šZara å¹´é¾„ï¼š7
æ€»è®¡ï¼š2
</code></pre>
<h6 id="pythonå¯¹è±¡é”€æ¯-åƒåœ¾å›æ”¶"><a href="#pythonå¯¹è±¡é”€æ¯-åƒåœ¾å›æ”¶" class="headerlink" title="pythonå¯¹è±¡é”€æ¯(åƒåœ¾å›æ”¶)"></a>pythonå¯¹è±¡é”€æ¯(åƒåœ¾å›æ”¶)</h6><p>Python ä½¿ç”¨äº†å¼•ç”¨è®¡æ•°è¿™ä¸€ç®€å•æŠ€æœ¯æ¥è·Ÿè¸ªå’Œå›æ”¶åƒåœ¾ã€‚åœ¨ Python å†…éƒ¨è®°å½•ç€æ‰€æœ‰ä½¿ç”¨ä¸­çš„å¯¹è±¡å„æœ‰å¤šå°‘å¼•ç”¨ã€‚ä¸€ä¸ªå†…éƒ¨è·Ÿè¸ªå˜é‡ï¼Œç§°ä¸ºä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ã€‚å½“å¯¹è±¡è¢«åˆ›å»ºæ—¶,å°±åˆ›å»ºäº†ä¸€ä¸ªå¼•ç”¨è®¡æ•°,å½“è¿™ä¸ªå¯¹è±¡ä¸å†éœ€è¦æ—¶ï¼Œ ä¹Ÿå°±æ˜¯è¯´ï¼Œ è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°å˜ä¸º0 æ—¶ï¼Œ å®ƒè¢«åƒåœ¾å›æ”¶ã€‚ä½†æ˜¯å›æ”¶ä¸æ˜¯â€ç«‹å³â€çš„ï¼Œ ç”±è§£é‡Šå™¨åœ¨é€‚å½“çš„æ—¶æœºï¼Œå°†åƒåœ¾å¯¹è±¡å ç”¨çš„å†…å­˜ç©ºé—´å›æ”¶ã€‚</p>
<pre><code class="python">a = 40      # åˆ›å»ºå¯¹è±¡  &lt;40&gt;
b = a       # å¢åŠ å¼•ç”¨ï¼Œ &lt;40&gt; çš„è®¡æ•°
c = [b]     # å¢åŠ å¼•ç”¨.  &lt;40&gt; çš„è®¡æ•°

del a       # å‡å°‘å¼•ç”¨ &lt;40&gt; çš„è®¡æ•°
b = 100     # å‡å°‘å¼•ç”¨ &lt;40&gt; çš„è®¡æ•°
c[0] = -1   # å‡å°‘å¼•ç”¨ &lt;40&gt; çš„è®¡æ•°
</code></pre>
<p>åƒåœ¾å›æ”¶æœºåˆ¶ä¸ä»…é’ˆå¯¹å¼•ç”¨è®¡æ•°ä¸º0çš„å¯¹è±¡ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å¤„ç†å¾ªç¯å¼•ç”¨çš„æƒ…å†µã€‚å¾ªç¯å¼•ç”¨æŒ‡çš„æ˜¯ï¼Œä¸¤ä¸ªå¯¹è±¡ç›¸äº’å¼•ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰å…¶ä»–å˜é‡å¼•ç”¨ä»–ä»¬ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä»…ä½¿ç”¨å¼•ç”¨è®¡æ•°æ˜¯ä¸å¤Ÿçš„ã€‚Python çš„åƒåœ¾æ”¶é›†å™¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨å’Œä¸€ä¸ªå¾ªç¯åƒåœ¾æ”¶é›†å™¨ã€‚ä½œä¸ºå¼•ç”¨è®¡æ•°çš„è¡¥å……ï¼Œ åƒåœ¾æ”¶é›†å™¨ä¹Ÿä¼šç•™å¿ƒè¢«åˆ†é…çš„æ€»é‡å¾ˆå¤§ï¼ˆå³æœªé€šè¿‡å¼•ç”¨è®¡æ•°é”€æ¯çš„é‚£äº›ï¼‰çš„å¯¹è±¡ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ è§£é‡Šå™¨ä¼šæš‚åœä¸‹æ¥ï¼Œ è¯•å›¾æ¸…ç†æ‰€æœ‰æœªå¼•ç”¨çš„å¾ªç¯ã€‚</p>
<h6 id="ç±»çš„ç»§æ‰¿"><a href="#ç±»çš„ç»§æ‰¿" class="headerlink" title="ç±»çš„ç»§æ‰¿"></a>ç±»çš„ç»§æ‰¿</h6><p>é¢å‘å¯¹è±¡çš„ç¼–ç¨‹å¸¦æ¥çš„ä¸»è¦å¥½å¤„ä¹‹ä¸€æ˜¯ä»£ç çš„é‡ç”¨ï¼Œå®ç°è¿™ç§é‡ç”¨çš„æ–¹æ³•ä¹‹ä¸€æ˜¯é€šè¿‡ç»§æ‰¿æœºåˆ¶ã€‚é€šè¿‡ç»§æ‰¿åˆ›å»ºçš„æ–°ç±»ç§°ä¸º<strong>å­ç±»</strong>æˆ–<strong>æ´¾ç”Ÿç±»</strong>ï¼Œè¢«ç»§æ‰¿çš„ç±»ç§°ä¸º<strong>åŸºç±»</strong>ã€<strong>çˆ¶ç±»</strong>æˆ–<strong>è¶…ç±»</strong>ã€‚</p>
<p><strong>ç»§æ‰¿è¯­æ³•</strong></p>
<pre><code class="python">class æ´¾ç”Ÿç±»å(åŸºç±»å)
    ...
</code></pre>
<p>åœ¨pythonä¸­ç»§æ‰¿ä¸­çš„ä¸€äº›ç‰¹ç‚¹ï¼š</p>
<ul>
<li>1ã€å¦‚æœåœ¨å­ç±»ä¸­éœ€è¦çˆ¶ç±»çš„æ„é€ æ–¹æ³•å°±éœ€è¦æ˜¾å¼çš„è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œæˆ–è€…ä¸é‡å†™çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚è¯¦ç»†è¯´æ˜å¯æŸ¥çœ‹ï¼š<a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/python-extends-init.html"> python å­ç±»ç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°è¯´æ˜</a>ã€‚</li>
<li>2ã€åœ¨è°ƒç”¨åŸºç±»çš„æ–¹æ³•æ—¶ï¼Œéœ€è¦åŠ ä¸ŠåŸºç±»çš„ç±»åå‰ç¼€ï¼Œä¸”éœ€è¦å¸¦ä¸Š self å‚æ•°å˜é‡ã€‚åŒºåˆ«åœ¨äºç±»ä¸­è°ƒç”¨æ™®é€šå‡½æ•°æ—¶å¹¶ä¸éœ€è¦å¸¦ä¸Š self å‚æ•°</li>
<li>3ã€Python æ€»æ˜¯é¦–å…ˆæŸ¥æ‰¾å¯¹åº”ç±»å‹çš„æ–¹æ³•ï¼Œå¦‚æœå®ƒä¸èƒ½åœ¨æ´¾ç”Ÿç±»ä¸­æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ï¼Œå®ƒæ‰å¼€å§‹åˆ°åŸºç±»ä¸­é€ä¸ªæŸ¥æ‰¾ã€‚ï¼ˆå…ˆåœ¨æœ¬ç±»ä¸­æŸ¥æ‰¾è°ƒç”¨çš„æ–¹æ³•ï¼Œæ‰¾ä¸åˆ°æ‰å»åŸºç±»ä¸­æ‰¾ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœåœ¨ç»§æ‰¿å…ƒç»„ä¸­åˆ—äº†ä¸€ä¸ªä»¥ä¸Šçš„ç±»ï¼Œé‚£ä¹ˆå®ƒå°±è¢«ç§°ä½œâ€å¤šé‡ç»§æ‰¿â€ ã€‚</p>
<p><strong>è¯­æ³•ï¼š</strong></p>
<p>æ´¾ç”Ÿç±»çš„å£°æ˜ï¼Œä¸ä»–ä»¬çš„çˆ¶ç±»ç±»ä¼¼ï¼Œç»§æ‰¿çš„åŸºç±»åˆ—è¡¨è·Ÿåœ¨ç±»åä¹‹å<br>å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">class SubClassName (ParentClass1[, ParentClass2, ...]):
    ...
</code></pre>
<h6 id="æ–¹æ³•é‡å†™"><a href="#æ–¹æ³•é‡å†™" class="headerlink" title="æ–¹æ³•é‡å†™"></a>æ–¹æ³•é‡å†™</h6><p>å¦‚æœä½ çš„çˆ¶ç±»æ–¹æ³•çš„åŠŸèƒ½ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥åœ¨å­ç±»é‡å†™ä½ çˆ¶ç±»çš„æ–¹æ³•ï¼š</p>
<pre><code class="python">class Parent:
    def myMethod(self):
        print (&#39;è°ƒç”¨çˆ¶ç±»æ–¹æ³•&#39;)
class Child(Parent):
    def myMethod(self):
        print (&#39;è°ƒç”¨å­ç±»æ–¹æ³•&#39;)
c = Child()
c.myMethod()
</code></pre>
<h6 id="ç±»å±æ€§ä¸æ–¹æ³•"><a href="#ç±»å±æ€§ä¸æ–¹æ³•" class="headerlink" title="ç±»å±æ€§ä¸æ–¹æ³•"></a>ç±»å±æ€§ä¸æ–¹æ³•</h6><p><strong>ç±»çš„ç§æœ‰å±æ€§</strong></p>
<p>â€œ_ _â€ â†’ <code>__private_attrs</code> ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œå£°æ˜å±æ€§ä¸ºç§æœ‰ï¼Œä¸èƒ½åœ¨å¤–éƒ¨è¢«ä½¿ç”¨æˆ–ç›´æ¥è®¿é—®ã€‚åœ¨ç±»å†…éƒ¨çš„æ–¹æ³•ä¸­ä½¿ç”¨æ—¶ <code>self.__private_attrs</code></p>
<p><strong>ç±»çš„æ–¹æ³•</strong></p>
<p>åœ¨ç±»çš„å†…éƒ¨ï¼Œä½¿ç”¨<code>def</code>å…³é”®å­—å¯ä»¥ä¸ºç±»å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œä¸ä¸€èˆ¬å‡½æ•°å®šä¹‰ä¸åŒï¼Œç±»æ–¹æ³•å¿…é¡»åŒ…å«å‚æ•°selfï¼Œä¸”ä¸ºç¬¬ä¸€ä¸ªå‚æ•°</p>
<p><strong>ç±»çš„ç§æœ‰æ–¹æ³•</strong></p>
<p><code>__private_method</code>ï¼šä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œå£°æ˜è¯¥æ–¹æ³•ä¸ºç§æœ‰æ–¹æ³•ï¼Œä¸èƒ½åœ¨ç±»çš„å¤–éƒ¨è°ƒç”¨ã€‚<br>åœ¨ç±»çš„å†…éƒ¨è°ƒç”¨<code>self.__private_methods</code></p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
class JustCounter:
    __secretCount = 0  # ç§æœ‰å˜é‡
    publicCount = 0    # å…¬å¼€å˜é‡
 
    def count(self):
        self.__secretCount += 1
        self.publicCount += 1
        print self.__secretCount
 
counter = JustCounter()
counter.count()
counter.count()
print counter.publicCount
print counter.__secretCount  # æŠ¥é”™ï¼Œå®ä¾‹ä¸èƒ½è®¿é—®ç§æœ‰å˜é‡
----------------------------------------------------
1
2
2
Traceback (most recent call last):
  File &quot;test.py&quot;, line 17, in &lt;module&gt;
    print counter.__secretCount  # æŠ¥é”™ï¼Œå®ä¾‹ä¸èƒ½è®¿é—®ç§æœ‰å˜é‡
AttributeError: JustCounter instance has no attribute &#39;__secretCount&#39;
</code></pre>
<p>Pythonä¸å…è®¸å®ä¾‹åŒ–çš„ç±»è®¿é—®ç§æœ‰æ•°æ®ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨ <strong>object._className__attrName</strong>ï¼ˆ <strong>å¯¹è±¡å._ç±»å__ç§æœ‰å±æ€§å</strong> ï¼‰è®¿é—®å±æ€§ï¼Œå‚è€ƒä»¥ä¸‹å®ä¾‹ï¼š</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-

class Runoob:
    __site = &quot;www.runoob.com&quot;

runoob = Runoob()
print runoob._Runoob__site
</code></pre>
<p>æ‰§è¡Œä»¥ä¸Šä»£ç ï¼Œæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="python">www.runoob.com
</code></pre>
<h6 id="ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜ï¼š"><a href="#ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜ï¼š" class="headerlink" title="ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜ï¼š"></a>ä¸‹åˆ’çº¿ã€åŒä¸‹åˆ’çº¿ã€å¤´å°¾åŒä¸‹åˆ’çº¿è¯´æ˜ï¼š</h6><ul>
<li><strong>_ _ foo _ _</strong>: å®šä¹‰çš„æ˜¯ç‰¹æ®Šæ–¹æ³•ï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿå®šä¹‰åå­— ï¼Œç±»ä¼¼ <strong><strong>init</strong>()</strong> ä¹‹ç±»çš„ã€‚</li>
<li><strong>_ foo</strong>: ä»¥å•ä¸‹åˆ’çº¿å¼€å¤´çš„è¡¨ç¤ºçš„æ˜¯ protected ç±»å‹çš„å˜é‡ï¼Œå³ä¿æŠ¤ç±»å‹åªèƒ½å…è®¸å…¶æœ¬èº«ä¸å­ç±»è¿›è¡Œè®¿é—®ï¼Œä¸èƒ½ç”¨äº <strong>from module import *</strong></li>
<li><strong>_ _ foo</strong>: åŒä¸‹åˆ’çº¿çš„è¡¨ç¤ºçš„æ˜¯ç§æœ‰ç±»å‹(private)çš„å˜é‡, åªèƒ½æ˜¯å…è®¸è¿™ä¸ªç±»æœ¬èº«è¿›è¡Œè®¿é—®äº†ã€‚</li>
</ul>
<h3 id="æ­£åˆ™è¡¨è¾¾"><a href="#æ­£åˆ™è¡¨è¾¾" class="headerlink" title="æ­£åˆ™è¡¨è¾¾"></a>æ­£åˆ™è¡¨è¾¾</h3><h6 id="re-match-ä¸-re-search-çš„åŒºåˆ«"><a href="#re-match-ä¸-re-search-çš„åŒºåˆ«" class="headerlink" title="re.match() ä¸ re.search()çš„åŒºåˆ«"></a>re.match() ä¸ re.search()çš„åŒºåˆ«</h6><p>åœ¨ Python çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å— <code>re</code> ä¸­ï¼Œ<code>re.match()</code> å’Œ <code>re.search()</code> éƒ½ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…é¡¹ï¼Œä½†å®ƒä»¬åœ¨æŸ¥æ‰¾åŒ¹é…é¡¹çš„æ–¹å¼ä¸Šæœ‰æ‰€ä¸åŒã€‚</p>
<p><strong>re.match()</strong> åªåœ¨å­—ç¬¦ä¸²çš„å¼€å§‹å¤„è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœå­—ç¬¦ä¸²çš„å¼€å¤´ä¸æ­£åˆ™è¡¨è¾¾å¼ä¸åŒ¹é…ï¼Œ<code>re.match()</code>å°†è¿”å›None</p>
<pre><code class="python">import re
# ä½¿ç”¨ re.search()
string = &quot;hello world&quot;
pattern = &quot;hello&quot;
match = re.match(pattern, string)
if match:
    print(f&quot;åŒ¹é…æˆåŠŸ: &#123;match.group()&#125;&quot;)
else:
    print(&quot;åŒ¹é…å¤±è´¥&quot;)
----------------------
åŒ¹é…æˆåŠŸ: hello
</code></pre>
<p><strong>re.search()</strong> ä¼šæ‰«ææ•´ä¸ªå­—ç¬¦ä¸²ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„å­ä¸²ã€‚å®ƒåœ¨æ•´ä¸ªå­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾åŒ¹é…é¡¹ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨å­—ç¬¦ä¸²çš„å¼€å§‹å¤„ã€‚</p>
<pre><code class="python">import re
# ä½¿ç”¨ re.search()
string = &quot;world hello&quot;
pattern = &quot;hello&quot;

search = re.search(pattern, string)

if search:
    print(f&quot;Match found: &#123;search.group()&#125;&quot;)
else:
    print(&quot;No match found.&quot;)
-------------------------------
Match found: hello
</code></pre>
<h6 id="æ£€ç´¢å’Œæ›¿æ¢"><a href="#æ£€ç´¢å’Œæ›¿æ¢" class="headerlink" title="æ£€ç´¢å’Œæ›¿æ¢"></a>æ£€ç´¢å’Œæ›¿æ¢</h6><p>Python çš„ re æ¨¡å—æä¾›äº†re.subç”¨äºæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„åŒ¹é…é¡¹ã€‚</p>
<pre><code class="python">re.sub(pattern, repl, string, count=0, flags=0)
</code></pre>
<p>å‚æ•°ï¼š</p>
<ul>
<li>pattern : æ­£åˆ™ä¸­çš„æ¨¡å¼å­—ç¬¦ä¸²ã€‚</li>
<li>repl : æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä¸ºä¸€ä¸ªå‡½æ•°ã€‚</li>
<li>string : è¦è¢«æŸ¥æ‰¾æ›¿æ¢çš„åŸå§‹å­—ç¬¦ä¸²ã€‚</li>
<li>count : æ¨¡å¼åŒ¹é…åæ›¿æ¢çš„æœ€å¤§æ¬¡æ•°ï¼Œé»˜è®¤ 0 è¡¨ç¤ºæ›¿æ¢æ‰€æœ‰çš„åŒ¹é…ã€‚</li>
</ul>
<blockquote>
<h4 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h4><pre><code class="python">import re

phone = &quot;2004-959-559 # è¿™æ˜¯ä¸€ä¸ªå›½å¤–ç”µè¯å·ç &quot;

# åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„ Pythonæ³¨é‡Š 
num = re.sub(r&#39;#.*$&#39;, &quot;&quot;, phone)
print(&quot;ç”µè¯å·ç æ˜¯: &quot;, num)

# åˆ é™¤éæ•°å­—(-)çš„å­—ç¬¦ä¸² 
num = re.sub(r&#39;\D&#39;, &quot;&quot;, phone)
print(&quot;ç”µè¯å·ç æ˜¯ : &quot;, num)
</code></pre>
<h4 id="ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ³¨é‡Š"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ³¨é‡Š" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ³¨é‡Š"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ³¨é‡Š</h4><pre><code class="python">num = re.sub(r&#39;#.*$&#39;, &quot;&quot;, phone)
</code></pre>
<ul>
<li><p><code>re.sub()</code> æ˜¯ re æ¨¡å—ä¸­çš„å‡½æ•°ï¼Œç”¨äºæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„åŒ¹é…é¡¹ã€‚</p>
</li>
<li><pre><code class="python">r&#39;#.*$&#39;
</code></pre>
<p>æ˜¯æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼š</p>
<ul>
<li><code>#</code> è¡¨ç¤ºåŒ¹é…å­—ç¬¦ <code>#</code>ã€‚</li>
<li><code>.*</code> è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆ<code>.</code>ï¼‰ä»»æ„æ¬¡æ•°ï¼ˆ<code>*</code>ï¼‰ã€‚</li>
<li><code>$</code> è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚</li>
</ul>
</li>
<li><p><code>&quot;&quot;</code> æ˜¯æ›¿æ¢å­—ç¬¦ä¸²ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåŒ¹é…åˆ°çš„éƒ¨åˆ†å°†è¢«åˆ é™¤ã€‚</p>
</li>
<li><p><code>phone</code> æ˜¯è¦è¢«å¤„ç†çš„åŸå§‹å­—ç¬¦ä¸²ã€‚</p>
</li>
</ul>
<p>è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ <code>r&#39;#.*$&#39;</code> çš„æ„æ€æ˜¯ï¼šä» <code>#</code> å­—ç¬¦å¼€å§‹ï¼ŒåŒ¹é…ç›´åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„æ‰€æœ‰å­—ç¬¦ã€‚å› æ­¤ï¼Œè¯¥è¡Œä»£ç å°†åˆ é™¤å­—ç¬¦ä¸² <code>phone</code> ä¸­ä» <code>#</code> å¼€å§‹åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„æ‰€æœ‰å†…å®¹ã€‚</p>
<p>æ‰§è¡Œç»“æœï¼š</p>
<p>å¤åˆ¶</p>
<pre><code class="python">ç”µè¯å·ç æ˜¯:  2004-959-559 
</code></pre>
<h4 id="ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ é™¤éæ•°å­—å­—ç¬¦"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ é™¤éæ•°å­—å­—ç¬¦" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ é™¤éæ•°å­—å­—ç¬¦"></a>ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ é™¤éæ•°å­—å­—ç¬¦</h4><pre><code class="python">num = re.sub(r&#39;\D&#39;, &quot;&quot;, phone)
</code></pre>
<ul>
<li><p><code>re.sub()</code> åŒä¸Šï¼Œç”¨äºæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„åŒ¹é…é¡¹ã€‚</p>
</li>
<li><pre><code class="python">r&#39;\D&#39;
</code></pre>
<p>æ˜¯æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼š</p>
<ul>
<li><code>\D</code> è¡¨ç¤ºåŒ¹é…ä»»æ„éæ•°å­—å­—ç¬¦ã€‚</li>
</ul>
</li>
<li><p><code>&quot;&quot;</code> åŒä¸Šï¼Œæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåŒ¹é…åˆ°çš„éæ•°å­—å­—ç¬¦å°†è¢«åˆ é™¤ã€‚</p>
</li>
<li><p><code>phone</code> åŒä¸Šï¼Œæ˜¯è¦è¢«å¤„ç†çš„åŸå§‹å­—ç¬¦ä¸²ã€‚</p>
</li>
</ul>
<p>è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ <code>r&#39;\D&#39;</code> çš„æ„æ€æ˜¯ï¼šåŒ¹é…å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„éæ•°å­—å­—ç¬¦ã€‚å› æ­¤ï¼Œè¯¥è¡Œä»£ç å°†åˆ é™¤å­—ç¬¦ä¸² <code>phone</code> ä¸­æ‰€æœ‰éæ•°å­—å­—ç¬¦ã€‚</p>
<pre><code class="python">ç”µè¯å·ç æ˜¯ :  2004959559 
</code></pre>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>re.sub()</code> å‡½æ•°ç»“åˆæ­£åˆ™è¡¨è¾¾å¼æ¥æ¸…ç†å’Œæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç§»é™¤äº†å­—ç¬¦ä¸²æœ«å°¾çš„æ³¨é‡Šã€‚ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç§»é™¤äº†ç”µè¯å·ç ä¸­çš„æ‰€æœ‰éæ•°å­—å­—ç¬¦ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªä»…åŒ…å«æ•°å­—çš„å­—ç¬¦ä¸²ã€‚è¿™äº›æ“ä½œåœ¨æ•°æ®æ¸…æ´—å’Œé¢„å¤„ç†ä¸­éå¸¸æœ‰ç”¨ã€‚</p>
</blockquote>
<pre><code class="python">import re
string = &quot;hello world&quot;
pattern = &quot;hello&quot;
match = re.match(pattern, string)
if match:
    print(f&quot;åŒ¹é…æˆåŠŸ: &#123;match.group()&#125;&quot;)
else:
    print(&quot;åŒ¹é…å¤±è´¥&quot;)
print(&#39;-----------------&#39;)
import re
phone = &quot;2004-959-559 # è¿™æ˜¯ä¸€ä¸ªå›½å¤–ç”µè¯å·ç &quot;
num = re.sub(&quot;#.*$&quot;,&quot;&quot;,phone)
print(&quot;ç”µè¯å·ç æ˜¯: &quot;, num)
num2 = re.sub(r&#39;\D&#39;,&quot;&quot;,phone)
print(&quot;ç”µè¯å·ç æ˜¯: &quot;, num2)
-----------------------------------------
ç”µè¯å·ç æ˜¯:  2004-959-559 
ç”µè¯å·ç æ˜¯:  2004959559
</code></pre>
<p>â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… â˜… </p>
<blockquote>
<p><code>print(f&quot;åŒ¹é…æˆåŠŸ: &#123;match.group()&#125;&quot;)</code></p>
<p>f-string æ˜¯ Python 3.6 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­å¼•å…¥çš„ä¸€ç§æ–°çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–æ–¹æ³•ï¼Œå®ƒå…è®¸ä½ åœ¨å­—ç¬¦ä¸²å­—é¢é‡ä¸­åµŒå…¥è¡¨è¾¾å¼ï¼Œå¹¶åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è¿›è¡Œæ±‚å€¼å’Œæ ¼å¼åŒ–ã€‚</p>
<ul>
<li><code>f</code> å‘Šè¯‰ Python è¿™æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</li>
<li><code>&#123;match.group()&#125;</code> æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒå°†è¢«æ±‚å€¼ï¼Œå¹¶ä¸”å…¶ç»“æœå°†æ’å…¥åˆ°å­—ç¬¦ä¸²ä¸­ç›¸åº”çš„ä½ç½®ã€‚</li>
</ul>
</blockquote>
<h6 id="findall"><a href="#findall" class="headerlink" title="findall"></a>findall</h6><p>åœ¨å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…çš„æ‰€æœ‰å­ä¸²ï¼Œå¹¶è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå¦‚æœæœ‰å¤šä¸ªåŒ¹é…æ¨¡å¼ï¼Œåˆ™è¿”å›å…ƒç»„åˆ—è¡¨ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> match å’Œ search æ˜¯åŒ¹é…ä¸€æ¬¡ï¼Œfindall æ˜¯åŒ¹é…æ‰€æœ‰ã€‚</p>
<p>è¯­æ³•æ ¼å¼ä¸ºï¼š</p>
<pre><code>findall(string[, pos[, endpos]])
</code></pre>
<p>å‚æ•°ï¼š</p>
<ul>
<li><strong>string</strong> : å¾…åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</li>
<li><strong>pos</strong> : å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šå­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º 0ã€‚</li>
<li><strong>endpos</strong> : å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šå­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼Œé»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</li>
</ul>
<p>æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰æ•°å­—ï¼š</p>
<pre><code class="python"># -*- coding:UTF8 -*-
 
import re
# è¿™é‡Œæ‚¨ç¼–è¯‘äº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ï¼Œè¯¥æ¨¡å¼ r&#39;\d+&#39; åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ã€‚
# \d è¡¨ç¤ºæ•°å­— [0-9]ï¼Œ+ è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªã€‚
pattern = re.compile(r&#39;\d+&#39;)   # æŸ¥æ‰¾æ•°å­—
# è¿™é‡Œæ‚¨åœ¨å­—ç¬¦ä¸² &#39;runoob 123 google 456&#39; ä¸­æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„æ•°å­—ã€‚
# ç”±äºå­—ç¬¦ä¸²ä¸­æœ‰ä¸¤ä¸ªæ•°å­—åºåˆ— &#39;123&#39; å’Œ &#39;456&#39;ï¼Œæ‰€ä»¥è¿”å›ä¸€ä¸ªåˆ—è¡¨ [&#39;123&#39;, &#39;456&#39;]
result1 = pattern.findall(&#39;runoob 123 google 456&#39;)
# åœ¨è¿™é‡Œï¼Œæ‚¨åŒæ ·æŸ¥æ‰¾æ•°å­—ï¼Œä½†æ˜¯æŒ‡å®šäº†æœç´¢çš„èµ·å§‹ä½ç½® 0 å’Œç»“æŸä½ç½® 10ã€‚
# è¿™æ„å‘³ç€æœç´¢åªä¼šåœ¨å­—ç¬¦ä¸²çš„å‰10ä¸ªå­—ç¬¦å†…è¿›è¡Œã€‚åœ¨è¿™ä¸ªèŒƒå›´å†…ï¼Œæœ‰ä¸¤ä¸ªæ•°å­—åºåˆ— &#39;88&#39; å’Œ &#39;12&#39;ï¼Œæ‰€ä»¥è¿”å›åˆ—è¡¨ [&#39;88&#39;, &#39;12&#39;]
result2 = pattern.findall(&#39;run88oob123google456&#39;, 0, 10)
 
print(result1)
print(result2)
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="python">[&#39;123&#39;, &#39;456&#39;]
[&#39;88&#39;, &#39;12&#39;]
</code></pre>
<h6 id="re-finditer"><a href="#re-finditer" class="headerlink" title="re.finditer"></a>re.finditer</h6><p>å’Œ findall ç±»ä¼¼ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…çš„æ‰€æœ‰å­ä¸²ï¼Œå¹¶æŠŠå®ƒä»¬ä½œä¸ºä¸€ä¸ªè¿­ä»£å™¨è¿”å›ã€‚</p>
<pre><code>re.finditer(pattern, string, flags=0)
</code></pre>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">pattern</td>
<td align="left">åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼</td>
</tr>
<tr>
<td align="left">string</td>
<td align="left">è¦åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td align="left">flags</td>
<td align="left">æ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ã€‚å‚è§ï¼š<a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-reg-expressions.html#flags">æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦ - å¯é€‰æ ‡å¿—</a></td>
</tr>
</tbody></table>
<pre><code class="python"># -*- coding: UTF-8 -*-
 
import re
 
it = re.finditer(r&quot;\d+&quot;,&quot;12a32bc43jf3&quot;) 
for match in it:
    print(match)          # æ‰“å°åŒ¹é…å¯¹è±¡çš„æè¿°
    print(&quot;==========&quot;)
    print(match.group())  # æ‰“å°åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²
</code></pre>
<p>ä¸‹é¢æ˜¯å…·ä½“çš„åŒºåˆ«ï¼š</p>
<ul>
<li><p>å½“æ‚¨æ‰§è¡Œ <code>print(match)</code> æ—¶ï¼Œæ‚¨å®é™…ä¸Šæ˜¯åœ¨æ‰“å°åŒ¹é…å¯¹è±¡çš„å†…å­˜åœ°å€æˆ–è€…ä¸€ä¸ªè¡¨ç¤ºåŒ¹é…å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚è¿™ä¸ªè¾“å‡ºé€šå¸¸ç”¨äºè°ƒè¯•ï¼Œä»¥ä¾¿å¿«é€ŸæŸ¥çœ‹å¯¹è±¡çš„ç±»å‹å’Œæ ‡è¯†ã€‚</p>
<p>è€Œ <code>print(match.group())</code> æ˜¯ç”¨æ¥è·å–åŒ¹é…å¯¹è±¡ä¸­çš„å®é™…åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ã€‚<code>group()</code> æ–¹æ³•è¿”å›æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„æ•´ä¸ªå­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p><code>print(match)</code>ï¼š</p>
<ul>
<li>æ‰“å°çš„æ˜¯åŒ¹é…å¯¹è±¡çš„æè¿°ï¼Œé€šå¸¸åŒ…æ‹¬å¯¹è±¡çš„ç±»å‹å’Œå†…å­˜åœ°å€ã€‚</li>
<li>å¯¹äºè°ƒè¯•ç›®çš„ï¼Œè¿™æœ‰åŠ©äºäº†è§£å¯¹è±¡çš„èº«ä»½ï¼Œä½†ä¸æ˜¾ç¤ºåŒ¹é…åˆ°çš„æ–‡æœ¬ã€‚</li>
</ul>
</li>
<li><p><code>print(match.group())</code>ï¼š</p>
<ul>
<li>æ‰“å°çš„æ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„å…·ä½“å­—ç¬¦ä¸²ã€‚</li>
<li>è¿™æ˜¯è·å–åŒ¹é…æ–‡æœ¬çš„å®é™…å†…å®¹çš„æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
<h6 id="re-split"><a href="#re-split" class="headerlink" title="re.split"></a>re.split</h6><p><code>split</code>æ–¹æ³•æŒ‰ç…§èƒ½å¤ŸåŒ¹é…çš„å­ä¸²å°†å­—ç¬¦ä¸²åˆ†å‰²åè¿”å›åˆ—è¡¨</p>
<pre><code class="python">import re
# å®šä¹‰ä¸€ä¸ªåŒ…å«å•è¯å’Œæ•°å­—çš„å­—ç¬¦ä¸²
text = &quot;å•è¯1å•è¯2å•è¯3å•è¯4&quot;
# ä½¿ç”¨ re.split() æŒ‰ç…§æ•°å­—è¿›è¡Œåˆ†å‰²ï¼Œä½†ä¸ä¿ç•™æ•°å­—
# (?:\d+) åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ï¼Œä½†ä¸ä¼šæ•è·åŒ¹é…çš„æ•°å­—
result = re.split(r&#39;(?:\d+)&#39;, text)
print(result)
</code></pre>
<h6 id="æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼"></a><span style = "color:red">æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼</span></h6><p>æ¨¡å¼å­—ç¬¦ä¸²ä½¿ç”¨ç‰¹æ®Šçš„è¯­æ³•æ¥è¡¨ç¤ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š<br>å­—æ¯å’Œæ•°å­—è¡¨ç¤ºä»–ä»¬è‡ªèº«ã€‚ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­çš„å­—æ¯å’Œæ•°å­—åŒ¹é…åŒæ ·çš„å­—ç¬¦ä¸²ã€‚<br>å¤šæ•°å­—æ¯å’Œæ•°å­—å‰åŠ ä¸€ä¸ªåæ–œæ æ—¶ä¼šæ‹¥æœ‰ä¸åŒçš„å«ä¹‰ã€‚<br>æ ‡ç‚¹ç¬¦å·åªæœ‰è¢«è½¬ä¹‰æ—¶æ‰åŒ¹é…è‡ªèº«ï¼Œå¦åˆ™å®ƒä»¬è¡¨ç¤ºç‰¹æ®Šçš„å«ä¹‰ã€‚<br>åæ–œæ æœ¬èº«éœ€è¦ä½¿ç”¨åæ–œæ è½¬ä¹‰ã€‚<br>ç”±äºæ­£åˆ™è¡¨è¾¾å¼é€šå¸¸éƒ½åŒ…å«åæ–œæ ï¼Œæ‰€ä»¥ä½ æœ€å¥½ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²æ¥è¡¨ç¤ºå®ƒä»¬ã€‚æ¨¡å¼å…ƒç´ (å¦‚ râ€™\tâ€™ï¼Œç­‰ä»·äº â€˜\tâ€™)åŒ¹é…ç›¸åº”çš„ç‰¹æ®Šå­—ç¬¦ã€‚<br>ä¸‹è¡¨åˆ—å‡ºäº†æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼è¯­æ³•ä¸­çš„ç‰¹æ®Šå…ƒç´ ã€‚å¦‚æœä½ ä½¿ç”¨æ¨¡å¼çš„åŒæ—¶æä¾›äº†å¯é€‰çš„æ ‡å¿—å‚æ•°ï¼ŒæŸäº›æ¨¡å¼å…ƒç´ çš„å«ä¹‰ä¼šæ”¹å˜ã€‚</p>
<table>
<thead>
<tr>
<th align="left">æ¨¡å¼</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">^</td>
<td align="left">åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">åŒ¹é…å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œé™¤äº†æ¢è¡Œç¬¦ï¼Œå½“re.DOTALLæ ‡è®°è¢«æŒ‡å®šæ—¶ï¼Œåˆ™å¯ä»¥åŒ¹é…åŒ…æ‹¬æ¢è¡Œç¬¦çš„ä»»æ„å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td align="left">[â€¦]</td>
<td align="left">ç”¨æ¥è¡¨ç¤ºä¸€ç»„å­—ç¬¦,å•ç‹¬åˆ—å‡ºï¼š[amk] åŒ¹é… â€˜aâ€™ï¼Œâ€™mâ€™æˆ–â€™kâ€™</td>
</tr>
<tr>
<td align="left">[^â€¦]</td>
<td align="left">ä¸åœ¨[]ä¸­çš„å­—ç¬¦ï¼š[^abc] åŒ¹é…é™¤äº†a,b,cä¹‹å¤–çš„å­—ç¬¦ã€‚</td>
</tr>
<tr>
<td align="left">re*</td>
<td align="left">åŒ¹é…0ä¸ªæˆ–å¤šä¸ªçš„è¡¨è¾¾å¼ã€‚</td>
</tr>
<tr>
<td align="left">re+</td>
<td align="left">åŒ¹é…1ä¸ªæˆ–å¤šä¸ªçš„è¡¨è¾¾å¼ã€‚</td>
</tr>
<tr>
<td align="left">re?</td>
<td align="left">åŒ¹é…0ä¸ªæˆ–1ä¸ªç”±å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„ç‰‡æ®µï¼Œéè´ªå©ªæ–¹å¼</td>
</tr>
<tr>
<td align="left">re{ n}</td>
<td align="left">ç²¾ç¡®åŒ¹é… n ä¸ªå‰é¢è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œ <strong>o{2}</strong> ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€œoâ€ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td>
</tr>
<tr>
<td align="left">re{ n,}</td>
<td align="left">åŒ¹é… n ä¸ªå‰é¢è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œ o{2,} ä¸èƒ½åŒ¹é…â€Bobâ€ä¸­çš„â€oâ€ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ä¸­çš„æ‰€æœ‰ oã€‚â€o{1,}â€ ç­‰ä»·äº â€œo+â€ã€‚â€o{0,}â€ åˆ™ç­‰ä»·äº â€œo*â€ã€‚</td>
</tr>
<tr>
<td align="left">re{ n, m}</td>
<td align="left">åŒ¹é… n åˆ° m æ¬¡ç”±å‰é¢çš„æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„ç‰‡æ®µï¼Œè´ªå©ªæ–¹å¼</td>
</tr>
<tr>
<td align="left">a| b</td>
<td align="left">åŒ¹é…aæˆ–b</td>
</tr>
<tr>
<td align="left">(re)</td>
<td align="left">å¯¹æ­£åˆ™è¡¨è¾¾å¼åˆ†ç»„å¹¶è®°ä½åŒ¹é…çš„æ–‡æœ¬</td>
</tr>
<tr>
<td align="left">(?imx)</td>
<td align="left">æ­£åˆ™è¡¨è¾¾å¼åŒ…å«ä¸‰ç§å¯é€‰æ ‡å¿—ï¼ši, m, æˆ– x ã€‚åªå½±å“æ‹¬å·ä¸­çš„åŒºåŸŸã€‚</td>
</tr>
<tr>
<td align="left">(?-imx)</td>
<td align="left">æ­£åˆ™è¡¨è¾¾å¼å…³é—­ i, m, æˆ– x å¯é€‰æ ‡å¿—ã€‚åªå½±å“æ‹¬å·ä¸­çš„åŒºåŸŸã€‚</td>
</tr>
<tr>
<td align="left">(?: re)</td>
<td align="left">ç±»ä¼¼ (â€¦), ä½†æ˜¯ä¸è¡¨ç¤ºä¸€ä¸ªç»„</td>
</tr>
<tr>
<td align="left">(?imx: re)</td>
<td align="left">åœ¨æ‹¬å·ä¸­ä½¿ç”¨i, m, æˆ– x å¯é€‰æ ‡å¿—</td>
</tr>
<tr>
<td align="left">(?-imx: re)</td>
<td align="left">åœ¨æ‹¬å·ä¸­ä¸ä½¿ç”¨i, m, æˆ– x å¯é€‰æ ‡å¿—</td>
</tr>
<tr>
<td align="left">(?#â€¦)</td>
<td align="left">æ³¨é‡Š.</td>
</tr>
<tr>
<td align="left">(?&#x3D; re)</td>
<td align="left">å‰å‘è‚¯å®šç•Œå®šç¬¦ã€‚å¦‚æœæ‰€å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»¥ â€¦ è¡¨ç¤ºï¼Œåœ¨å½“å‰ä½ç½®æˆåŠŸåŒ¹é…æ—¶æˆåŠŸï¼Œå¦åˆ™å¤±è´¥ã€‚ä½†ä¸€æ—¦æ‰€å«è¡¨è¾¾å¼å·²ç»å°è¯•ï¼ŒåŒ¹é…å¼•æ“æ ¹æœ¬æ²¡æœ‰æé«˜ï¼›æ¨¡å¼çš„å‰©ä½™éƒ¨åˆ†è¿˜è¦å°è¯•ç•Œå®šç¬¦çš„å³è¾¹ã€‚</td>
</tr>
<tr>
<td align="left">(?! re)</td>
<td align="left">å‰å‘å¦å®šç•Œå®šç¬¦ã€‚ä¸è‚¯å®šç•Œå®šç¬¦ç›¸åï¼›å½“æ‰€å«è¡¨è¾¾å¼ä¸èƒ½åœ¨å­—ç¬¦ä¸²å½“å‰ä½ç½®åŒ¹é…æ—¶æˆåŠŸ</td>
</tr>
<tr>
<td align="left">(?&gt; re)</td>
<td align="left">åŒ¹é…çš„ç‹¬ç«‹æ¨¡å¼ï¼Œçœå»å›æº¯ã€‚</td>
</tr>
<tr>
<td align="left">\w</td>
<td align="left">åŒ¹é…å­—æ¯æ•°å­—åŠä¸‹åˆ’çº¿</td>
</tr>
<tr>
<td align="left">\W</td>
<td align="left">åŒ¹é…éå­—æ¯æ•°å­—åŠä¸‹åˆ’çº¿</td>
</tr>
<tr>
<td align="left">\s</td>
<td align="left">åŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦ï¼Œç­‰ä»·äº **[ \t\n\r\f]**ã€‚</td>
</tr>
<tr>
<td align="left">\S</td>
<td align="left">åŒ¹é…ä»»æ„éç©ºå­—ç¬¦</td>
</tr>
<tr>
<td align="left">\d</td>
<td align="left">åŒ¹é…ä»»æ„æ•°å­—ï¼Œç­‰ä»·äº [0-9].</td>
</tr>
<tr>
<td align="left">\D</td>
<td align="left">åŒ¹é…ä»»æ„éæ•°å­—</td>
</tr>
<tr>
<td align="left">\A</td>
<td align="left">åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹</td>
</tr>
<tr>
<td align="left">\Z</td>
<td align="left">åŒ¹é…å­—ç¬¦ä¸²ç»“æŸï¼Œå¦‚æœæ˜¯å­˜åœ¨æ¢è¡Œï¼ŒåªåŒ¹é…åˆ°æ¢è¡Œå‰çš„ç»“æŸå­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td align="left">\z</td>
<td align="left">åŒ¹é…å­—ç¬¦ä¸²ç»“æŸ</td>
</tr>
<tr>
<td align="left">\G</td>
<td align="left">åŒ¹é…æœ€ååŒ¹é…å®Œæˆçš„ä½ç½®ã€‚</td>
</tr>
<tr>
<td align="left">\b</td>
<td align="left">åŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯æŒ‡å•è¯å’Œç©ºæ ¼é—´çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œ â€˜er\bâ€™ å¯ä»¥åŒ¹é…â€neverâ€ ä¸­çš„ â€˜erâ€™ï¼Œä½†ä¸èƒ½åŒ¹é… â€œverbâ€ ä¸­çš„ â€˜erâ€™ã€‚</td>
</tr>
<tr>
<td align="left">\B</td>
<td align="left">åŒ¹é…éå•è¯è¾¹ç•Œã€‚â€™er\Bâ€™ èƒ½åŒ¹é… â€œverbâ€ ä¸­çš„ â€˜erâ€™ï¼Œä½†ä¸èƒ½åŒ¹é… â€œneverâ€ ä¸­çš„ â€˜erâ€™ã€‚</td>
</tr>
<tr>
<td align="left">\n, \t, ç­‰.</td>
<td align="left">åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ç­‰</td>
</tr>
<tr>
<td align="left">\1â€¦\9</td>
<td align="left">åŒ¹é…ç¬¬nä¸ªåˆ†ç»„çš„å†…å®¹ã€‚</td>
</tr>
<tr>
<td align="left">\10</td>
<td align="left">åŒ¹é…ç¬¬nä¸ªåˆ†ç»„çš„å†…å®¹ï¼Œå¦‚æœå®ƒç»åŒ¹é…ã€‚å¦åˆ™æŒ‡çš„æ˜¯å…«è¿›åˆ¶å­—ç¬¦ç çš„è¡¨è¾¾å¼</td>
</tr>
</tbody></table>
<h6 id="æ­£åˆ™è¡¨è¾¾å¼å®ä¾‹"><a href="#æ­£åˆ™è¡¨è¾¾å¼å®ä¾‹" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼å®ä¾‹"></a>æ­£åˆ™è¡¨è¾¾å¼å®ä¾‹</h6><p><strong>å­—ç¬¦åŒ¹é…</strong></p>
<table>
<thead>
<tr>
<th align="left">å®ä¾‹</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">python</td>
<td align="left">åŒ¹é… â€œpythonâ€.</td>
</tr>
</tbody></table>
<p><strong>å­—ç¬¦ç±»</strong></p>
<table>
<thead>
<tr>
<th align="left">å®ä¾‹</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">[Pp]ython</td>
<td align="left">åŒ¹é… â€œPythonâ€ æˆ– â€œpythonâ€</td>
</tr>
<tr>
<td align="left">rub[ye]</td>
<td align="left">åŒ¹é… â€œrubyâ€ æˆ– â€œrubeâ€</td>
</tr>
<tr>
<td align="left">[aeiou]</td>
<td align="left">åŒ¹é…ä¸­æ‹¬å·å†…çš„ä»»æ„ä¸€ä¸ªå­—æ¯</td>
</tr>
<tr>
<td align="left">[0-9]</td>
<td align="left">åŒ¹é…ä»»ä½•æ•°å­—ã€‚ç±»ä¼¼äº [0123456789]</td>
</tr>
<tr>
<td align="left">[a-z]</td>
<td align="left">åŒ¹é…ä»»ä½•å°å†™å­—æ¯</td>
</tr>
<tr>
<td align="left">[A-Z]</td>
<td align="left">åŒ¹é…ä»»ä½•å¤§å†™å­—æ¯</td>
</tr>
<tr>
<td align="left">[a-zA-Z0-9]</td>
<td align="left">åŒ¹é…ä»»ä½•å­—æ¯åŠæ•°å­—</td>
</tr>
<tr>
<td align="left">[^aeiou]</td>
<td align="left">é™¤äº†aeiouå­—æ¯ä»¥å¤–çš„æ‰€æœ‰å­—ç¬¦</td>
</tr>
<tr>
<td align="left">[^0-9]</td>
<td align="left">åŒ¹é…é™¤äº†æ•°å­—å¤–çš„å­—ç¬¦</td>
</tr>
</tbody></table>
<h6 id="ç‰¹æ®Šå­—ç¬¦ç±»"><a href="#ç‰¹æ®Šå­—ç¬¦ç±»" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦ç±»"></a>ç‰¹æ®Šå­—ç¬¦ç±»</h6><table>
<thead>
<tr>
<th align="left">å®ä¾‹</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">.</td>
<td align="left">åŒ¹é…é™¤ â€œ\nâ€ ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚è¦åŒ¹é…åŒ…æ‹¬ â€˜\nâ€™ åœ¨å†…çš„ä»»ä½•å­—ç¬¦ï¼Œè¯·ä½¿ç”¨è±¡ â€˜[.\n]â€™ çš„æ¨¡å¼ã€‚</td>
</tr>
<tr>
<td align="left">\d</td>
<td align="left">åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [0-9]ã€‚</td>
</tr>
<tr>
<td align="left">\D</td>
<td align="left">åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [^0-9]ã€‚</td>
</tr>
<tr>
<td align="left">\s</td>
<td align="left">åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº [ \f\n\r\t\v]ã€‚</td>
</tr>
<tr>
<td align="left">\S</td>
<td align="left">åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [^ \f\n\r\t\v]ã€‚</td>
</tr>
<tr>
<td align="left">\w</td>
<td align="left">åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ç­‰ä»·äºâ€™[A-Za-z0-9_]â€™ã€‚</td>
</tr>
<tr>
<td align="left">\W</td>
<td align="left">åŒ¹é…ä»»ä½•éå•è¯å­—ç¬¦ã€‚ç­‰ä»·äº â€˜[^A-Za-z0-9_]â€™ã€‚</td>
</tr>
</tbody></table>
<h6 id="requestè¯·æ±‚çš„ç”¨æ³•"><a href="#requestè¯·æ±‚çš„ç”¨æ³•" class="headerlink" title="requestè¯·æ±‚çš„ç”¨æ³•"></a>requestè¯·æ±‚çš„ç”¨æ³•</h6><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ Python æ ‡å‡†åº“ä¸­çš„ <code>urllib</code> æ¨¡å—è¿›è¡Œ HTTP <code>GET </code>å’Œ <code>POST</code> è¯·æ±‚çš„ç®€åŒ–ç”¨æ³•ã€‚</p>
<p><strong>Getè¯·æ±‚</strong><del>request.get()</del></p>
<pre><code class="python">import requests

# ç®€åŒ–çš„ GET è¯·æ±‚
def simple_get(url):
    response = requests.get(url)
    return response.text

# ä½¿ç”¨ GET è¯·æ±‚
url = &#39;http://httpbin.org/get&#39;
response_text = simple_get(url)
print(response_text)
</code></pre>
<p><strong>Postè¯·æ±‚</strong><del>request.post()</del></p>
<pre><code class="python">import requests

# ç®€åŒ–çš„ POST è¯·æ±‚
def simple_post(url, data):
    response = requests.post(url, data=data)
    return response.text

# ä½¿ç”¨ POST è¯·æ±‚
url = &#39;http://httpbin.org/post&#39;
data = &#123;&#39;key1&#39;: &#39;value1&#39;, &#39;key2&#39;: &#39;value2&#39;&#125;
response_text = simple_post(url, data)
print(response_text)
</code></pre>
<h6 id="SMTPå‘é€é‚®ä»¶"><a href="#SMTPå‘é€é‚®ä»¶" class="headerlink" title="SMTPå‘é€é‚®ä»¶"></a>SMTPå‘é€é‚®ä»¶</h6><pre><code class="python">import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.header import Header


# è®¾ç½®QQé‚®ç®±çš„SMTPæœåŠ¡å™¨åœ°å€å’Œç«¯å£
smtp_server = &#39;smtp.qq.com&#39;
smtp_port = 465  # QQé‚®ç®±SMTPæœåŠ¡å™¨ç«¯å£ä¸º465æˆ–587

# è®¾ç½®å‘ä»¶äººå’Œæ”¶ä»¶äººé‚®ç®±
sender_email = &#39;390415032@qq.com&#39;  # å‘ä»¶äººé‚®ç®±
receiver_email = &#39;recipient@example.com&#39;  # æ”¶ä»¶äººé‚®ç®±
password = &#39;your_qq_email_auth_code&#39;  # QQé‚®ç®±æˆæƒç 

# è®¾ç½®é‚®ä»¶ä¸»é¢˜å’Œå†…å®¹
subject = &#39;Test Email from Python&#39;
body = &#39;This is a test email sent by Python.&#39;

# åˆ›å»ºMIMETextå¯¹è±¡ï¼Œè®¾ç½®é‚®ä»¶å†…å®¹å’Œç¼–ç 
msg = MIMEText(body, &#39;plain&#39;, &#39;utf-8&#39;)
msg[&#39;From&#39;] = Header(sender_email, &#39;utf-8&#39;)
msg[&#39;To&#39;] = Header(receiver_email, &#39;utf-8&#39;)
msg[&#39;Subject&#39;] = Header(subject, &#39;utf-8&#39;)

# å‘é€é‚®ä»¶
try:
    # åˆ›å»ºSMTPå¯¹è±¡
    server = smtplib.SMTP_SSL(smtp_server, smtp_port)
    # ç™»å½•SMTPæœåŠ¡å™¨
    server.login(sender_email, password)
    # å‘é€é‚®ä»¶
    server.sendmail(sender_email, [receiver_email], msg.as_string())
    print(&#39;Email sent successfully!&#39;)
except smtplib.SMTPException as e:
    print(&#39;Error: unable to send email. &#39;, e)
finally:
    # å…³é—­æœåŠ¡å™¨è¿æ¥
    server.quit()
</code></pre>
<h6 id="Python-å¤šçº¿ç¨‹"><a href="#Python-å¤šçº¿ç¨‹" class="headerlink" title="Python å¤šçº¿ç¨‹"></a>Python å¤šçº¿ç¨‹</h6><p>Pythonä¸­ä½¿ç”¨çº¿ç¨‹æœ‰ä¸¤ç§æ–¹å¼ï¼šå‡½æ•°æˆ–è€…ç”¨ç±»æ¥åŒ…è£…çº¿ç¨‹å¯¹è±¡ã€‚</p>
<p>å‡½æ•°å¼ï¼šè°ƒç”¨threadæ¨¡å—ä¸­çš„start_new_thread()å‡½æ•°æ¥äº§ç”Ÿæ–°çº¿ç¨‹ã€‚è¯­æ³•å¦‚ä¸‹:</p>
<pre><code class="python">thread.start_new_thread ( function, args[, kwargs] )
</code></pre>
<p>å‚æ•°è¯´æ˜:</p>
<ul>
<li><strong>function</strong> - çº¿ç¨‹å‡½æ•°ã€‚</li>
<li><strong>args</strong> - ä¼ é€’ç»™çº¿ç¨‹å‡½æ•°çš„å‚æ•°,ä»–å¿…é¡»æ˜¯ä¸ªtupleç±»å‹ã€‚</li>
<li><strong>kwargs</strong> - å¯é€‰å‚æ•°ã€‚</li>
</ul>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
import thread
import time
 
# ä¸ºçº¿ç¨‹å®šä¹‰ä¸€ä¸ªå‡½æ•°
def print_time( threadName, delay):
   count = 0
   while count &lt; 5:
      time.sleep(delay)
      count += 1
      print &quot;%s: %s&quot; % ( threadName, time.ctime(time.time()) )
 
# åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹
try:
   thread.start_new_thread( print_time, (&quot;Thread-1&quot;, 2, ) )
   thread.start_new_thread( print_time, (&quot;Thread-2&quot;, 4, ) )
except:
   print &quot;Error: unable to start thread&quot;
 
while 1:
   pass

-------------------------------------------------------
Thread-1: Thu Jan 22 15:42:17 2009
Thread-1: Thu Jan 22 15:42:19 2009
Thread-2: Thu Jan 22 15:42:19 2009
Thread-1: Thu Jan 22 15:42:21 2009
Thread-2: Thu Jan 22 15:42:23 2009
Thread-1: Thu Jan 22 15:42:23 2009
Thread-1: Thu Jan 22 15:42:25 2009
Thread-2: Thu Jan 22 15:42:27 2009
Thread-2: Thu Jan 22 15:42:31 2009
Thread-2: Thu Jan 22 15:42:35 2009
</code></pre>
<p>çº¿ç¨‹çš„ç»“æŸä¸€èˆ¬ä¾é çº¿ç¨‹å‡½æ•°çš„è‡ªç„¶ç»“æŸï¼›ä¹Ÿå¯ä»¥åœ¨çº¿ç¨‹å‡½æ•°ä¸­è°ƒç”¨thread.exit()ï¼Œä»–æŠ›å‡ºSystemExit exceptionï¼Œè¾¾åˆ°é€€å‡ºçº¿ç¨‹çš„ç›®çš„ã€‚</p>
<h4 id="çº¿ç¨‹æ¨¡å—"><a href="#çº¿ç¨‹æ¨¡å—" class="headerlink" title="çº¿ç¨‹æ¨¡å—"></a>çº¿ç¨‹æ¨¡å—</h4><p>Pythoné€šè¿‡ä¸¤ä¸ªæ ‡å‡†åº“threadå’Œthreadingæä¾›å¯¹çº¿ç¨‹çš„æ”¯æŒã€‚threadæä¾›äº†ä½çº§åˆ«çš„ã€åŸå§‹çš„çº¿ç¨‹ä»¥åŠä¸€ä¸ªç®€å•çš„é”ã€‚</p>
<p><strong>threading</strong> æ¨¡å—æä¾›çš„å…¶ä»–æ–¹æ³•ï¼š</p>
<ul>
<li><code>threading.currentThread():</code>  è¿”å›å½“å‰çš„çº¿ç¨‹å˜é‡ã€‚</li>
<li><code>threading.enumerate():</code>  è¿”å›ä¸€ä¸ªåŒ…å«æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹çš„listã€‚æ­£åœ¨è¿è¡ŒæŒ‡çº¿ç¨‹å¯åŠ¨åã€ç»“æŸå‰ï¼Œä¸åŒ…æ‹¬å¯åŠ¨å‰å’Œç»ˆæ­¢åçš„çº¿ç¨‹ã€‚</li>
<li><code>threading.activeCount(): </code> è¿”å›æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡ï¼Œä¸len(threading.enumerate())æœ‰ç›¸åŒçš„ç»“æœã€‚</li>
</ul>
<p>é™¤äº†ä½¿ç”¨æ–¹æ³•å¤–ï¼Œçº¿ç¨‹æ¨¡å—åŒæ ·æä¾›äº†Threadç±»æ¥å¤„ç†çº¿ç¨‹ï¼ŒThreadç±»æä¾›äº†ä»¥ä¸‹æ–¹æ³•:</p>
<ul>
<li><strong>run():</strong> ç”¨ä»¥è¡¨ç¤ºçº¿ç¨‹æ´»åŠ¨çš„æ–¹æ³•ã€‚</li>
<li><strong>start():</strong> å¯åŠ¨çº¿ç¨‹æ´»åŠ¨ã€‚</li>
<li><strong>join([time]):</strong> ç­‰å¾…è‡³çº¿ç¨‹ä¸­æ­¢ã€‚è¿™é˜»å¡è°ƒç”¨çº¿ç¨‹ç›´è‡³çº¿ç¨‹çš„join() æ–¹æ³•è¢«è°ƒç”¨ä¸­æ­¢-æ­£å¸¸é€€å‡ºæˆ–è€…æŠ›å‡ºæœªå¤„ç†çš„å¼‚å¸¸-æˆ–è€…æ˜¯å¯é€‰çš„è¶…æ—¶å‘ç”Ÿã€‚</li>
<li><strong>isAlive():</strong> è¿”å›çº¿ç¨‹æ˜¯å¦æ´»åŠ¨çš„ã€‚</li>
<li><strong>getName():</strong> è¿”å›çº¿ç¨‹åã€‚</li>
<li><strong>setName():</strong> è®¾ç½®çº¿ç¨‹åã€‚</li>
</ul>
<h6 id="ä½¿ç”¨Threadingæ¨¡å—åˆ›å»ºçº¿ç¨‹"><a href="#ä½¿ç”¨Threadingæ¨¡å—åˆ›å»ºçº¿ç¨‹" class="headerlink" title="ä½¿ç”¨Threadingæ¨¡å—åˆ›å»ºçº¿ç¨‹"></a>ä½¿ç”¨Threadingæ¨¡å—åˆ›å»ºçº¿ç¨‹</h6><p>ä½¿ç”¨Threadingæ¨¡å—åˆ›å»ºçº¿ç¨‹ï¼Œç›´æ¥ä»threading.Threadç»§æ‰¿<br>ç„¶åé‡å†™__init__æ–¹æ³•å’Œrunæ–¹æ³•ï¼š</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
import threading
import time
 
exitFlag = 0
 
class myThread (threading.Thread):   #ç»§æ‰¿çˆ¶ç±»threading.Thread
    def __init__(self, threadID, name, counter):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.name = name
        self.counter = counter
    def run(self):                   #æŠŠè¦æ‰§è¡Œçš„ä»£ç å†™åˆ°runå‡½æ•°é‡Œé¢ çº¿ç¨‹åœ¨åˆ›å»ºåä¼šç›´æ¥è¿è¡Œrunå‡½æ•° 
        print &quot;Starting &quot; + self.name
        print_time(self.name, self.counter, 5)
        print &quot;Exiting &quot; + self.name
 
def print_time(threadName, delay, counter):
    while counter:
        if exitFlag:
            (threading.Thread).exit()
        time.sleep(delay)
        print &quot;%s: %s&quot; % (threadName, time.ctime(time.time()))
        counter -= 1
 
# åˆ›å»ºæ–°çº¿ç¨‹
thread1 = myThread(1, &quot;Thread-1&quot;, 1)
thread2 = myThread(2, &quot;Thread-2&quot;, 2)
 
# å¼€å¯çº¿ç¨‹
thread1.start()
thread2.start()
 
print &quot;Exiting Main Thread&quot;

------------------------------------------
Starting Thread-1
Starting Thread-2
Exiting Main Thread
Thread-1: Thu Mar 21 09:10:03 2013
Thread-1: Thu Mar 21 09:10:04 2013
Thread-2: Thu Mar 21 09:10:04 2013
Thread-1: Thu Mar 21 09:10:05 2013
Thread-1: Thu Mar 21 09:10:06 2013
Thread-2: Thu Mar 21 09:10:06 2013
Thread-1: Thu Mar 21 09:10:07 2013
Exiting Thread-1
Thread-2: Thu Mar 21 09:10:08 2013
Thread-2: Thu Mar 21 09:10:10 2013
Thread-2: Thu Mar 21 09:10:12 2013
Exiting Thread-2
</code></pre>
<h6 id="çº¿ç¨‹åŒæ­¥"><a href="#çº¿ç¨‹åŒæ­¥" class="headerlink" title="çº¿ç¨‹åŒæ­¥"></a>çº¿ç¨‹åŒæ­¥</h6><p>å¦‚æœå¤šä¸ªçº¿ç¨‹å…±åŒå¯¹æŸä¸ªæ•°æ®ä¿®æ”¹ï¼Œåˆ™å¯èƒ½å‡ºç°ä¸å¯é¢„æ–™çš„ç»“æœï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼Œéœ€è¦å¯¹å¤šä¸ªçº¿ç¨‹è¿›è¡ŒåŒæ­¥ã€‚</p>
<p>ä½¿ç”¨Threadå¯¹è±¡çš„Lockå’ŒRlockå¯ä»¥å®ç°ç®€å•çš„çº¿ç¨‹åŒæ­¥ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æœ‰<code>acquireæ–¹æ³•</code>å’Œ<code>releaseæ–¹æ³•</code>ï¼Œå¯¹äºé‚£äº›éœ€è¦æ¯æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹æ“ä½œçš„æ•°æ®ï¼Œå¯ä»¥å°†å…¶æ“ä½œæ”¾åˆ°acquireå’Œreleaseæ–¹æ³•ä¹‹é—´ã€‚å¦‚ä¸‹ï¼š</p>
<p>å¤šçº¿ç¨‹çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼ˆè‡³å°‘æ„Ÿè§‰èµ·æ¥æ˜¯è¿™æ ·ï¼‰ã€‚ä½†æ˜¯å½“çº¿ç¨‹éœ€è¦å…±äº«æ•°æ®æ—¶ï¼Œå¯èƒ½å­˜åœ¨æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ã€‚</p>
<p>è€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼šä¸€ä¸ªåˆ—è¡¨é‡Œæ‰€æœ‰å…ƒç´ éƒ½æ˜¯0ï¼Œçº¿ç¨‹â€setâ€ä»åå‘å‰æŠŠæ‰€æœ‰å…ƒç´ æ”¹æˆ1ï¼Œè€Œçº¿ç¨‹â€printâ€è´Ÿè´£ä»å‰å¾€åè¯»å–åˆ—è¡¨å¹¶æ‰“å°ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¯èƒ½çº¿ç¨‹â€setâ€å¼€å§‹æ”¹çš„æ—¶å€™ï¼Œçº¿ç¨‹â€printâ€ä¾¿æ¥æ‰“å°åˆ—è¡¨äº†ï¼Œè¾“å‡ºå°±æˆäº†ä¸€åŠ0ä¸€åŠ1ï¼Œè¿™å°±æ˜¯æ•°æ®çš„ä¸åŒæ­¥ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¼•å…¥äº†é”çš„æ¦‚å¿µã€‚</p>
<p>é”æœ‰ä¸¤ç§çŠ¶æ€â€”â€”é”å®šå’Œæœªé”å®šã€‚æ¯å½“ä¸€ä¸ªçº¿ç¨‹æ¯”å¦‚â€setâ€è¦è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆè·å¾—é”å®šï¼›å¦‚æœå·²ç»æœ‰åˆ«çš„çº¿ç¨‹æ¯”å¦‚â€printâ€è·å¾—é”å®šäº†ï¼Œé‚£ä¹ˆå°±è®©çº¿ç¨‹â€setâ€æš‚åœï¼Œä¹Ÿå°±æ˜¯åŒæ­¥é˜»å¡ï¼›ç­‰åˆ°çº¿ç¨‹â€printâ€è®¿é—®å®Œæ¯•ï¼Œé‡Šæ”¾é”ä»¥åï¼Œå†è®©çº¿ç¨‹â€setâ€ç»§ç»­ã€‚</p>
<p>ç»è¿‡è¿™æ ·çš„å¤„ç†ï¼Œæ‰“å°åˆ—è¡¨æ—¶è¦ä¹ˆå…¨éƒ¨è¾“å‡º0ï¼Œè¦ä¹ˆå…¨éƒ¨è¾“å‡º1ï¼Œä¸ä¼šå†å‡ºç°ä¸€åŠ0ä¸€åŠ1çš„å°´å°¬åœºé¢ã€‚</p>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
import threading
import time
 
class myThread (threading.Thread):
    def __init__(self, threadID, name, counter):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.name = name
        self.counter = counter
    def run(self):
        print &quot;Starting &quot; + self.name
       # è·å¾—é”ï¼ŒæˆåŠŸè·å¾—é”å®šåè¿”å›True
       # å¯é€‰çš„timeoutå‚æ•°ä¸å¡«æ—¶å°†ä¸€ç›´é˜»å¡ç›´åˆ°è·å¾—é”å®š
       # å¦åˆ™è¶…æ—¶åå°†è¿”å›False
        threadLock.acquire()
        print_time(self.name, self.counter, 3)
        # é‡Šæ”¾é”
        threadLock.release()
 
def print_time(threadName, delay, counter):
    while counter:
        time.sleep(delay)
        print &quot;%s: %s&quot; % (threadName, time.ctime(time.time()))
        counter -= 1
 
threadLock = threading.Lock()
threads = []
 
# åˆ›å»ºæ–°çº¿ç¨‹
thread1 = myThread(1, &quot;Thread-1&quot;, 1)
thread2 = myThread(2, &quot;Thread-2&quot;, 2)
 
# å¼€å¯æ–°çº¿ç¨‹
thread1.start()
thread2.start()
 
# æ·»åŠ çº¿ç¨‹åˆ°çº¿ç¨‹åˆ—è¡¨
threads.append(thread1)
threads.append(thread2)
 
# ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for t in threads:
    t.join()
print &quot;Exiting Main Thread&quot;
</code></pre>
<h6 id="çº¿ç¨‹ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆ-Queueï¼‰"><a href="#çº¿ç¨‹ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆ-Queueï¼‰" class="headerlink" title="çº¿ç¨‹ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆ Queueï¼‰"></a>çº¿ç¨‹ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆ Queueï¼‰</h6><p>Pythonçš„Queueæ¨¡å—ä¸­æä¾›äº†åŒæ­¥çš„ã€çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—ç±»ï¼ŒåŒ…æ‹¬FIFOï¼ˆå…ˆå…¥å…ˆå‡º)é˜Ÿåˆ—Queueï¼ŒLIFOï¼ˆåå…¥å…ˆå‡ºï¼‰é˜Ÿåˆ—LifoQueueï¼Œå’Œä¼˜å…ˆçº§é˜Ÿåˆ—PriorityQueueã€‚è¿™äº›é˜Ÿåˆ—éƒ½å®ç°äº†é”åŸè¯­ï¼Œèƒ½å¤Ÿåœ¨å¤šçº¿ç¨‹ä¸­ç›´æ¥ä½¿ç”¨ã€‚å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—æ¥å®ç°çº¿ç¨‹é—´çš„åŒæ­¥ã€‚</p>
<p>Queueæ¨¡å—ä¸­çš„å¸¸ç”¨æ–¹æ³•:</p>
<ul>
<li>Queue.qsize() è¿”å›é˜Ÿåˆ—çš„å¤§å°</li>
<li>Queue.empty() å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›True,åä¹‹False</li>
<li>Queue.full() å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œè¿”å›True,åä¹‹False</li>
<li>Queue.full ä¸ maxsize å¤§å°å¯¹åº”</li>
<li>Queue.get([block[, timeout]])è·å–é˜Ÿåˆ—ï¼Œtimeoutç­‰å¾…æ—¶é—´</li>
<li>Queue.get_nowait() ç›¸å½“Queue.get(False)</li>
<li>Queue.put(item, block&#x3D;True, timeout&#x3D;None) å†™å…¥é˜Ÿåˆ—ï¼Œtimeoutç­‰å¾…æ—¶é—´</li>
<li>Queue.put_nowait(item) ç›¸å½“ Queue.put(item, False)</li>
<li>Queue.task_done() åœ¨å®Œæˆä¸€é¡¹å·¥ä½œä¹‹åï¼ŒQueue.task_done()å‡½æ•°å‘ä»»åŠ¡å·²ç»å®Œæˆçš„é˜Ÿåˆ—å‘é€ä¸€ä¸ªä¿¡å·</li>
<li>Queue.join() å®é™…ä¸Šæ„å‘³ç€ç­‰åˆ°é˜Ÿåˆ—ä¸ºç©ºï¼Œå†æ‰§è¡Œåˆ«çš„æ“ä½œ</li>
</ul>
<pre><code class="python">#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
import Queue
import threading
import time
 
exitFlag = 0
 
class myThread (threading.Thread):
    def __init__(self, threadID, name, q):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.name = name
        self.q = q
    def run(self):
        print &quot;Starting &quot; + self.name
        process_data(self.name, self.q)
        print &quot;Exiting &quot; + self.name
 
def process_data(threadName, q):
    while not exitFlag:
        queueLock.acquire()
        if not workQueue.empty():
            data = q.get()
            queueLock.release()
            print &quot;%s processing %s&quot; % (threadName, data)
        else:
            queueLock.release()
        time.sleep(1)
 
threadList = [&quot;Thread-1&quot;, &quot;Thread-2&quot;, &quot;Thread-3&quot;]
nameList = [&quot;One&quot;, &quot;Two&quot;, &quot;Three&quot;, &quot;Four&quot;, &quot;Five&quot;]
queueLock = threading.Lock()
workQueue = Queue.Queue(10)
threads = []
threadID = 1
 
# åˆ›å»ºæ–°çº¿ç¨‹
for tName in threadList:
    thread = myThread(threadID, tName, workQueue)
    thread.start()
    threads.append(thread)
    threadID += 1
 
# å¡«å……é˜Ÿåˆ—
queueLock.acquire()
for word in nameList:
    workQueue.put(word)
queueLock.release()
 
# ç­‰å¾…é˜Ÿåˆ—æ¸…ç©º
while not workQueue.empty():
    pass
 
# é€šçŸ¥çº¿ç¨‹æ˜¯æ—¶å€™é€€å‡º
exitFlag = 1
 
# ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ
for t in threads:
    t.join()
print &quot;Exiting Main Thread&quot;
---------------------------------------------------
Starting Thread-1
Starting Thread-2
Starting Thread-3
Thread-1 processing One
Thread-2 processing Two
Thread-3 processing Three
Thread-1 processing Four
Thread-2 processing Five
Exiting Thread-3
Exiting Thread-1
Exiting Thread-2
Exiting Main Thread
</code></pre>
<h4 id="Python-XMLè§£æ"><a href="#Python-XMLè§£æ" class="headerlink" title="Python XMLè§£æ"></a>Python XMLè§£æ</h4><p>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆe<strong>X</strong>tensible <strong>M</strong>arkup <strong>L</strong>anguageï¼‰ï¼›XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ã€‚XML æ˜¯ä¸€å¥—å®šä¹‰è¯­ä¹‰æ ‡è®°çš„è§„åˆ™ï¼Œè¿™äº›æ ‡è®°å°†æ–‡æ¡£åˆ†æˆè®¸å¤šéƒ¨ä»¶å¹¶å¯¹è¿™äº›éƒ¨ä»¶åŠ ä»¥æ ‡è¯†ã€‚å®ƒä¹Ÿæ˜¯å…ƒæ ‡è®°è¯­è¨€ï¼Œå³å®šä¹‰äº†ç”¨äºå®šä¹‰å…¶ä»–ä¸ç‰¹å®šé¢†åŸŸæœ‰å…³çš„ã€è¯­ä¹‰çš„ã€ç»“æ„åŒ–çš„æ ‡è®°è¯­è¨€çš„å¥æ³•è¯­è¨€ã€‚å¸¸è§çš„ XML ç¼–ç¨‹æ¥å£æœ‰ DOM å’Œ SAXï¼Œè¿™ä¸¤ç§æ¥å£å¤„ç† XML æ–‡ä»¶çš„æ–¹å¼ä¸åŒï¼Œå½“ç„¶ä½¿ç”¨åœºåˆä¹Ÿä¸åŒã€‚<br>Python æœ‰ä¸‰ç§æ–¹æ³•è§£æ XMLï¼ŒSAXï¼ŒDOMï¼Œä»¥åŠ ElementTree:</p>
<h6 id="1-SAX-simple-API-for-XML"><a href="#1-SAX-simple-API-for-XML" class="headerlink" title="1.SAX (simple API for XML )"></a>1.SAX (simple API for XML )</h6><p>Python æ ‡å‡†åº“åŒ…å« SAX è§£æå™¨ï¼ŒSAX ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œé€šè¿‡åœ¨è§£æXMLçš„è¿‡ç¨‹ä¸­è§¦å‘ä¸€ä¸ªä¸ªçš„äº‹ä»¶å¹¶è°ƒç”¨ç”¨æˆ·å®šä¹‰çš„å›è°ƒå‡½æ•°æ¥å¤„ç†XMLæ–‡ä»¶ã€‚</p>
<h6 id="2-DOM-Document-Object-Model"><a href="#2-DOM-Document-Object-Model" class="headerlink" title="2.DOM(Document Object Model)"></a>2.DOM(Document Object Model)</h6><p>å°† XML æ•°æ®åœ¨å†…å­˜ä¸­è§£ææˆä¸€ä¸ªæ ‘ï¼Œé€šè¿‡å¯¹æ ‘çš„æ“ä½œæ¥æ“ä½œXMLã€‚</p>
<h6 id="3-ElementTree-å…ƒç´ æ ‘"><a href="#3-ElementTree-å…ƒç´ æ ‘" class="headerlink" title="3.ElementTree(å…ƒç´ æ ‘)"></a>3.ElementTree(å…ƒç´ æ ‘)</h6><p>ElementTreeå°±åƒä¸€ä¸ªè½»é‡çº§çš„DOMï¼Œå…·æœ‰æ–¹ä¾¿å‹å¥½çš„APIã€‚ä»£ç å¯ç”¨æ€§å¥½ï¼Œé€Ÿåº¦å¿«ï¼Œæ¶ˆè€—å†…å­˜å°‘ã€‚</p>
<p><strong>æ³¨ï¼š</strong>å› DOMéœ€è¦å°†XMLæ•°æ®æ˜ å°„åˆ°å†…å­˜ä¸­çš„æ ‘ï¼Œä¸€æ˜¯æ¯”è¾ƒæ…¢ï¼ŒäºŒæ˜¯æ¯”è¾ƒè€—å†…å­˜ï¼Œè€ŒSAXæµå¼è¯»å–XMLæ–‡ä»¶ï¼Œæ¯”è¾ƒå¿«ï¼Œå ç”¨å†…å­˜å°‘ï¼Œä½†éœ€è¦ç”¨æˆ·å®ç°å›è°ƒå‡½æ•°ï¼ˆhandlerï¼‰ã€‚</p>
<p><strong>XMLè§£æä¸€ä¸‹</strong></p>
<pre><code class="python">import xml.sax
from lxml import etree

# ç¡®ä¿æ–‡ä»¶è·¯å¾„æ­£ç¡®
xml_file_path = &#39;movies.xml&#39;

# ä½¿ç”¨ lxml åˆ›å»ºä¸€ä¸ª XML è§£æå™¨
parser = etree.XMLParser()

# è§£æ XML æ–‡ä»¶
try:
    tree = etree.parse(xml_file_path, parser)
    # éå†æ‰€æœ‰å…ƒç´ å¹¶æ‰“å°
    for element in tree.iter():
        print(f&quot;Element tag: &#123;element.tag&#125;, text: &#123;element.text.strip() if element.text else &#39;&#39;&#125;&quot;)
except etree.XMLSyntaxError as e:
    print(f&quot;XML è§£æé”™è¯¯: &#123;e&#125;&quot;)
</code></pre>
<pre><code class="xml">movies.xml
&lt;collection shelf=&quot;New Arrivals&quot;&gt;
&lt;movie title=&quot;Enemy Behind&quot;&gt;
   &lt;type&gt;War, Thriller&lt;/type&gt;
   &lt;format&gt;DVD&lt;/format&gt;
   &lt;year&gt;2003&lt;/year&gt;
   &lt;rating&gt;PG&lt;/rating&gt;
   &lt;stars&gt;10&lt;/stars&gt;
   &lt;description&gt;Talk about a US-Japan war&lt;/description&gt;
&lt;/movie&gt;
&lt;movie title=&quot;Transformers&quot;&gt;
   &lt;type&gt;Anime, Science Fiction&lt;/type&gt;
   &lt;format&gt;DVD&lt;/format&gt;
   &lt;year&gt;1989&lt;/year&gt;
   &lt;rating&gt;R&lt;/rating&gt;
   &lt;stars&gt;8&lt;/stars&gt;
   &lt;description&gt;A schientific fiction&lt;/description&gt;
&lt;/movie&gt;
   &lt;movie title=&quot;Trigun&quot;&gt;
   &lt;type&gt;Anime, Action&lt;/type&gt;
   &lt;format&gt;DVD&lt;/format&gt;
   &lt;episodes&gt;4&lt;/episodes&gt;
   &lt;rating&gt;PG&lt;/rating&gt;
   &lt;stars&gt;10&lt;/stars&gt;
   &lt;description&gt;Vash the Stampede!&lt;/description&gt;
&lt;/movie&gt;
&lt;movie title=&quot;Ishtar&quot;&gt;
   &lt;type&gt;Comedy&lt;/type&gt;
   &lt;format&gt;VHS&lt;/format&gt;
   &lt;rating&gt;PG&lt;/rating&gt;
   &lt;stars&gt;2&lt;/stars&gt;
   &lt;description&gt;Viewable boredom&lt;/description&gt;
&lt;/movie&gt;
&lt;/collection&gt;
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#00bcd4>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/02/26/AI/python/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/02/25/AI/LlamaIndex/">
        <h2>
            LlamaIndex
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/2/25
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="LlamaIndexå–‚é£Ÿç»™AIå¹¶è¿›åŒ–å‡çº§"><a href="#LlamaIndexå–‚é£Ÿç»™AIå¹¶è¿›åŒ–å‡çº§" class="headerlink" title="LlamaIndexå–‚é£Ÿç»™AIå¹¶è¿›åŒ–å‡çº§"></a>LlamaIndex<del>å–‚é£Ÿç»™AIå¹¶è¿›åŒ–å‡çº§</del></h1><h4 id="å°†æ‚¨çš„ä¼ä¸šæ•°æ®è½¬åŒ–ä¸ºå¯ç”¨äºç”Ÿäº§çš„LLMåº”ç”¨ç¨‹åº"><a href="#å°†æ‚¨çš„ä¼ä¸šæ•°æ®è½¬åŒ–ä¸ºå¯ç”¨äºç”Ÿäº§çš„LLMåº”ç”¨ç¨‹åº" class="headerlink" title="å°†æ‚¨çš„ä¼ä¸šæ•°æ®è½¬åŒ–ä¸ºå¯ç”¨äºç”Ÿäº§çš„LLMåº”ç”¨ç¨‹åº"></a>å°†æ‚¨çš„ä¼ä¸šæ•°æ®è½¬åŒ–ä¸ºå¯ç”¨äºç”Ÿäº§çš„LLMåº”ç”¨ç¨‹åº</h4><p>LLM æä¾›äººä¸æ•°æ®ä¹‹é—´çš„è‡ªç„¶è¯­è¨€æ¥å£ã€‚LLM é¢„å…ˆè®­ç»ƒè¿‡å¤§é‡å…¬å¼€æ•°æ®ï¼Œä½†å®ƒä»¬å¹¶éåŸºäºæ‚¨çš„æ•°æ®è¿›è¡Œè®­ç»ƒã€‚æ‚¨çš„æ•°æ®å¯èƒ½æ˜¯ç§æœ‰çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ç‰¹å®šäºæ‚¨è¦è§£å†³çš„é—®é¢˜çš„æ•°æ®ã€‚å®ƒéšè—åœ¨ AP1åé¢ã€SQL æ•°æ®åº“ä¸­ï¼Œæˆ–éšè—åœ¨PDF å’Œå¹»ç¯ç‰‡ä¸­ã€‚ä¸Šä¸‹æ–‡å¢å¼ºä½¿ LLM å¯ä»¥ä½¿ç”¨æ‚¨çš„æ•°æ®æ¥è§£å†³æ‰‹å¤´çš„é—®é¢˜ã€‚Llamalndex æä¾›æ„å»ºä»»ä½•ä¸Šä¸‹æ–‡å¢å¼ºç”¨ä¾‹çš„å·¥å…·ï¼Œä»åŸå‹åˆ°ç”Ÿäº§æˆ‘ä»¬çš„å·¥å…·å…è®¸æ‚¨æå–ã€è§£æã€ç´¢å¼•å’Œå¤„ç†æ‚¨çš„æ•°æ®ï¼Œå¹¶å¿«é€Ÿå®æ–½å°†æ•°æ®è®¿é—®ä¸ LLM æç¤ºç›¸ç»“åˆçš„å¤æ‚æŸ¥è¯¢å·¥ä½œæµã€‚<br>ä¸Šä¸‹æ–‡å¢å¼ºæœ€æµè¡Œçš„ç¤ºä¾‹æ˜¯<strong>æ£€ç´¢å¢å¼ºç”Ÿæˆ</strong>æˆ– <strong>RAG</strong>ï¼Œå®ƒåœ¨æ¨ç†æ—¶å°†ä¸Šä¸‹æ–‡ä¸ILLM ç›¸ç»“åˆã€‚</p>
<p>LlamaIndex æ˜¯ä¸€ä¸ªå°†<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B&zhida_source=entity">å¤§è¯­è¨€æ¨¡å‹</a>ï¼ˆLarge Language Models, LLMsï¼Œåç®€ç§°å¤§æ¨¡å‹ï¼‰å’Œå¤–éƒ¨æ•°æ®è¿æ¥åœ¨ä¸€èµ·çš„å·¥å…·ã€‚å¤§æ¨¡å‹ä¾é ä¸Šä¸‹æ–‡å­¦ä¹ ï¼ˆContext Learningï¼‰æ¥æ¨ç†çŸ¥è¯†ï¼Œé’ˆå¯¹ä¸€ä¸ªè¾“å…¥ï¼ˆæˆ–è€…æ˜¯promptï¼‰ï¼Œæ ¹æ®å…¶è¾“å‡ºç»“æœã€‚å› æ­¤Promptçš„è´¨é‡å¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šäº†è¾“å‡ºç»“æœçš„è´¨é‡ï¼Œå› æ­¤æç¤ºå·¥ç¨‹ï¼ˆ<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=Prompt+engineering&zhida_source=entity">Prompt engineering</a>ï¼‰ç°åœ¨ä¹Ÿå¾ˆå—æ¬¢è¿ã€‚ç›®å‰å¤§æ¨¡å‹çš„è¾“å…¥è¾“å‡ºé•¿åº¦å› æ¨¡å‹ç»“æ„ã€æ˜¾å¡ç®—åŠ›ç­‰å› ç´ å½±å“ï¼Œéƒ½æœ‰ä¸€ä¸ªé•¿åº¦é™åˆ¶ï¼ˆä»¥Tokenä¸ºå•ä½ï¼ŒChatGPTé™åˆ¶é•¿åº¦ä¸º4kä¸ªï¼ŒGPT-4æ˜¯32kç­‰ï¼ŒClaudeæœ€æ–°ç‰ˆæœ‰ä¸ª100kçš„ï¼‰ã€‚å½“æˆ‘ä»¬å¤–éƒ¨çŸ¥è¯†çš„å†…å®¹è¶…è¿‡è¿™ä¸ªé•¿åº¦æ—¶ï¼Œå°±æ— æ³•åŒæ—¶å°†æœ‰æ•ˆçš„ä¿¡æ¯ä¼ é€’ç»™å¤§æ¨¡å‹ã€‚å› æ­¤å°±è¯ç”Ÿäº† LlamaIndex ç­‰é¡¹ç›®ã€‚</p>
<p>å‡è®¾æœ‰ä¸€ä¸ª10wçš„å¤–éƒ¨æ•°æ®ï¼Œæˆ‘ä»¬çš„åŸå§‹è¾“å…¥Prompté•¿åº¦ä¸º100ï¼Œé•¿åº¦é™åˆ¶ä¸º4kï¼Œé€šè¿‡æŸ¥è¯¢-æ£€ç´¢çš„æ–¹å¼ï¼Œæˆ‘ä»¬èƒ½å°†æœ€æœ‰æ•ˆçš„ä¿¡æ¯æå–é›†ä¸­åœ¨è¿™4kçš„é•¿åº¦ä¸­ï¼Œä¸Promptä¸€èµ·é€ç»™å¤§æ¨¡å‹ï¼Œä»è€Œè®©å¤§æ¨¡å‹å¾—åˆ°æ›´å¤šçš„ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œè¿˜èƒ½é€šè¿‡å¤šè½®å¯¹è¯çš„æ–¹å¼ä¸æ–­æçº¯å¤–éƒ¨æ•°æ®ï¼Œè¾¾åˆ°åœ¨æœ‰é™çš„è¾“å…¥é•¿åº¦é™åˆ¶ä¸‹ï¼Œä¼ è¾¾æ›´å¤šçš„ä¿¡æ¯ç»™å¤§æ¨¡å‹ã€‚è¿™éƒ¨åˆ†çŸ¥è¯†å¯å‚è€ƒ</p>
<p>LLamaIndexçš„ä»»åŠ¡æ˜¯é€šè¿‡æŸ¥è¯¢ã€æ£€ç´¢çš„æ–¹å¼æŒ–æ˜å¤–éƒ¨æ•°æ®çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™å¤§æ¨¡å‹ï¼Œå› æ­¤å…¶ä¸»è¦ç”±xéƒ¨åˆ†ç»„æˆï¼š</p>
<ol>
<li><p>æ•°æ®è¿æ¥ã€‚é¦–å…ˆå°†æ•°æ®èƒ½è¯»å–è¿›æ¥ï¼Œè¿™æ ·æ‰èƒ½æŒ–æ˜ã€‚</p>
</li>
<li><p>ç´¢å¼•æ„å»ºã€‚è¦æŸ¥è¯¢å¤–éƒ¨æ•°æ®ï¼Œå°±å¿…é¡»å…ˆæ„å»ºå¯ä»¥æŸ¥è¯¢çš„ç´¢å¼•ï¼ŒllamdaIndexå°†æ•°æ®å­˜å‚¨åœ¨Nodeä¸­ï¼Œå¹¶åŸºäºNodeæ„å»ºç´¢å¼•ã€‚ç´¢å¼•ç±»å‹åŒ…æ‹¬<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E5%90%91%E9%87%8F%E7%B4%A2%E5%BC%95&zhida_source=entity">å‘é‡ç´¢å¼•</a>ã€<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E5%88%97%E8%A1%A8%E7%B4%A2%E5%BC%95&zhida_source=entity">åˆ—è¡¨ç´¢å¼•</a>ã€<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E6%A0%91%E5%BD%A2%E7%B4%A2%E5%BC%95&zhida_source=entity">æ ‘å½¢ç´¢å¼•</a>ç­‰ï¼›</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3&zhida_source=entity">æŸ¥è¯¢æ¥å£</a>ã€‚æœ‰äº†ç´¢å¼•ï¼Œå°±å¿…é¡»æä¾›æŸ¥è¯¢ç´¢å¼•çš„æ¥å£ã€‚é€šè¿‡è¿™äº›æ¥å£ç”¨æˆ·å¯ä»¥ä¸ä¸åŒçš„ å¤§æ¨¡å‹è¿›è¡Œå¯¹è¯ï¼Œä¹Ÿèƒ½è‡ªå®šä¹‰éœ€è¦çš„Promptç»„åˆæ–¹å¼ã€‚æŸ¥è¯¢æ¥å£ä¼šå®Œæˆ æ£€ç´¢+å¯¹è¯çš„åŠŸèƒ½ï¼Œå³å…ˆåŸºäºç´¢å¼•è¿›è¡Œæ£€ç´¢ï¼Œå†å°†æ£€ç´¢ç»“æœå’Œä¹‹å‰çš„è¾“å…¥Promptè¿›è¡Œï¼ˆè‡ªå®šä¹‰ï¼‰ç»„åˆå½¢æˆæ–°çš„<strong>æ‰©å……Prompt</strong>ï¼Œå¯¹è¯å¤§æ¨¡å‹å¹¶æ‹¿åˆ°ç»“æœè¿›è¡Œè§£æã€‚</p>
</li>
</ol>
<h2 id="1-æ•°æ®è¿æ¥å™¨ï¼ˆData-Connectorsï¼‰"><a href="#1-æ•°æ®è¿æ¥å™¨ï¼ˆData-Connectorsï¼‰" class="headerlink" title="1 æ•°æ®è¿æ¥å™¨ï¼ˆData Connectorsï¼‰"></a><strong>1 <a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E6%95%B0%E6%8D%AE%E8%BF%9E%E6%8E%A5%E5%99%A8&zhida_source=entity">æ•°æ®è¿æ¥å™¨</a>ï¼ˆData Connectorsï¼‰</strong></h2><p>æ•°æ®è¿æ¥å™¨ï¼Œè¯»å–æ–‡æ¡£çš„å·¥å…·ï¼Œæœ€ç®€å•çš„å°±æ˜¯è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚ LLamaIndex çš„æ•°æ®è¿æ¥å™¨åŒ…æ‹¬</p>
<ul>
<li>æœ¬åœ°æ–‡ä»¶ã€Notionã€Google æ–‡æ¡£ã€Slackã€Discord</li>
</ul>
<p>å…·ä½“å¯å‚è€ƒ<a href="https://link.zhihu.com/?target=https://gpt-index.readthedocs.io/en/latest/how_to/data_connectors.html">Data Connectorsã€‚</a></p>
<h2 id="2-ç´¢å¼•ç»“æ„ï¼ˆIndex-Structuresï¼‰"><a href="#2-ç´¢å¼•ç»“æ„ï¼ˆIndex-Structuresï¼‰" class="headerlink" title="2 ç´¢å¼•ç»“æ„ï¼ˆIndex Structuresï¼‰"></a><strong>2 <a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84&zhida_source=entity">ç´¢å¼•ç»“æ„</a>ï¼ˆIndex Structuresï¼‰</strong></h2><p>LlamaIndex çš„æ ¸å¿ƒå…¶å®å°±æ˜¯ ç´¢å¼•ç»“æ„çš„é›†åˆï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ç´¢å¼•ç»“æ„æˆ–åŸºäºè¿™äº›ç´¢å¼•ç»“æ„è‡ªè¡Œå»ºå›¾ã€‚</p>
<h3 id="2-1-ç´¢å¼•å¦‚ä½•å·¥ä½œ"><a href="#2-1-ç´¢å¼•å¦‚ä½•å·¥ä½œ" class="headerlink" title="2.1 ç´¢å¼•å¦‚ä½•å·¥ä½œ"></a><strong>2.1 ç´¢å¼•å¦‚ä½•å·¥ä½œ</strong></h3><p>ä¸¤ä¸ªæ¦‚å¿µï¼š</p>
<ul>
<li><strong>Nodeï¼ˆèŠ‚ç‚¹ï¼‰</strong>ï¼šå³ä¸€æ®µæ–‡æœ¬ï¼ˆChunk of Textï¼‰ï¼ŒLlamaIndexè¯»å–æ–‡æ¡£ï¼ˆdocumentsï¼‰å¯¹è±¡ï¼Œå¹¶å°†å…¶è§£æ&#x2F;åˆ’åˆ†ï¼ˆparse&#x2F;chunkï¼‰æˆ Node èŠ‚ç‚¹å¯¹è±¡ï¼Œæ„å»ºèµ·ç´¢å¼•ã€‚</li>
<li><strong>Response Synthesisï¼ˆå›å¤åˆæˆï¼‰</strong>ï¼šLlamaIndex è¿›è¡Œæ£€ç´¢èŠ‚ç‚¹å¹¶å“åº”å›å¤åˆæˆï¼Œä¸åŒçš„æ¨¡å¼æœ‰ä¸åŒçš„å“åº”æ¨¡å¼ï¼ˆæ¯”å¦‚å‘é‡æŸ¥è¯¢ã€æ ‘å½¢æŸ¥è¯¢å°±ä¸åŒï¼‰ï¼Œåˆæˆä¸åŒçš„æ‰©å……Promptã€‚</li>
</ul>
<p>ç´¢å¼•æ–¹å¼åŒ…æ‹¬</p>
<ul>
<li><strong>List Index</strong>ï¼šNodeé¡ºåºå­˜å‚¨ï¼Œå¯ç”¨å…³é”®å­—è¿‡æ»¤Node</li>
<li><strong>Vector Store Index</strong>ï¼šæ¯ä¸ªNodeä¸€ä¸ªå‘é‡ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å–top-kç›¸ä¼¼</li>
<li><strong>Tree Index</strong>ï¼šæ ‘å½¢Nodeï¼Œä»æ ‘æ ¹å‘å¶å­æŸ¥è¯¢ï¼Œå¯å•è¾¹æŸ¥è¯¢ï¼Œæˆ–è€…åŒè¾¹æŸ¥è¯¢åˆå¹¶ã€‚</li>
<li>**<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=228316377&content_type=Article&match_order=1&q=Keyword+Table+Index&zhida_source=entity">Keyword Table Index</a>**ï¼šæ¯ä¸ªNodeæœ‰å¾ˆå¤šä¸ªKeywordsé“¾æ¥ï¼Œé€šè¿‡æŸ¥Keywordèƒ½æŸ¥è¯¢å¯¹åº”Nodeã€‚</li>
</ul>
<p>ä¸åŒçš„ç´¢å¼•æ–¹å¼å†³å®šäº†Queryé€‰æ‹©Nodeæ–¹å¼çš„ä¸åŒã€‚</p>
<p>å›å¤åˆæˆæ–¹å¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>åˆ›å»ºå¹¶æçº¯ï¼ˆCreate and Refine)ï¼Œå³çº¿æ€§ä¾æ¬¡è¿­ä»£ï¼›</p>
</li>
<li><p>æ ‘å½¢æ€»ç»“ï¼ˆTree Summarizeï¼‰ï¼šè‡ªåº•å‘ä¸Šï¼Œä¸¤ä¸¤åˆå¹¶ï¼Œæœ€ç»ˆåˆå¹¶æˆä¸€ä¸ªå›å¤ã€‚</p>
</li>
</ul>
<h2 id="3-æŸ¥è¯¢æ¥å£ï¼ˆQuery-Inferenceï¼‰"><a href="#3-æŸ¥è¯¢æ¥å£ï¼ˆQuery-Inferenceï¼‰" class="headerlink" title="3 æŸ¥è¯¢æ¥å£ï¼ˆQuery Inferenceï¼‰"></a><strong>3 æŸ¥è¯¢æ¥å£ï¼ˆQuery Inferenceï¼‰</strong></h2><h3 id="3-1-LlamaIndex-ä½¿ç”¨æ¨¡æ¿"><a href="#3-1-LlamaIndex-ä½¿ç”¨æ¨¡æ¿" class="headerlink" title="3.1 LlamaIndex ä½¿ç”¨æ¨¡æ¿"></a><strong>3.1 LlamaIndex ä½¿ç”¨æ¨¡æ¿</strong></h3><p>LlamaIndex å¸¸ç”¨ä½¿ç”¨æ¨¡ç‰ˆï¼š</p>
<ol>
<li>è¯»å–æ–‡æ¡£ (æ‰‹åŠ¨æ·»åŠ oré€šè¿‡Loaderè‡ªåŠ¨æ·»åŠ )ï¼›</li>
<li>å°†æ–‡æ¡£è§£æä¸ºNodesï¼›</li>
<li>æ„å»ºç´¢å¼•ï¼ˆä»æ–‡æ¡£orä»Nodesï¼Œå¦‚æœä»æ–‡æ¡£ï¼Œåˆ™å¯¹åº”å‡½æ•°å†…éƒ¨ä¼šå®Œæˆç¬¬2æ­¥çš„Nodeè§£æï¼‰</li>
<li>[å¯é€‰ï¼Œè¿›é˜¶] åœ¨å…¶ä»–ç´¢å¼•ä¸Šæ„å»ºç´¢å¼•ï¼Œå³å¤šçº§ç´¢å¼•ç»“æ„</li>
<li>æŸ¥è¯¢ç´¢å¼•å¹¶å¯¹è¯å¤§æ¨¡å‹</li>
</ol>
<hr>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/6f518a5400d2e36ad851f0799a45911cc1bb90ff/LLM%E7%BE%8A%E9%A9%BC.png"></p>
<h6 id="LangChain-vs-LlamaIndex"><a href="#LangChain-vs-LlamaIndex" class="headerlink" title="LangChain vs LlamaIndex"></a>LangChain vs LlamaIndex</h6><p>è¦<strong>ç»¼åˆæ„å»ºç”¨äºç”Ÿäº§çš„é«˜æ€§èƒ½RAGç¨‹åº</strong> å°±ç”¨<code>LlamaIndex</code><br>LlamaIndexå®˜ç½‘å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.llamaindex.ai/">https://www.llamaindex.ai/</a><br>pythonæ–‡æ¡£å‚è€ƒï¼š[LlamaIndex - LlamaIndex] (<a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/">https://docs.llamaindex.ai/en/stable/</a>)</p>
<h6 id="LLMå®˜ç½‘æœ€ä¸‹æ–¹çš„å…¥é—¨é¡¹ç›®ä¹Ÿéœ€è¦å­¦ä¹ "><a href="#LLMå®˜ç½‘æœ€ä¸‹æ–¹çš„å…¥é—¨é¡¹ç›®ä¹Ÿéœ€è¦å­¦ä¹ " class="headerlink" title="LLMå®˜ç½‘æœ€ä¸‹æ–¹çš„å…¥é—¨é¡¹ç›®ä¹Ÿéœ€è¦å­¦ä¹ "></a>LLMå®˜ç½‘æœ€ä¸‹æ–¹çš„å…¥é—¨é¡¹ç›®ä¹Ÿéœ€è¦å­¦ä¹ </h6><h5 id="å…¥é—¨é¡¹ç›®"><a href="#å…¥é—¨é¡¹ç›®" class="headerlink" title="å…¥é—¨é¡¹ç›®"></a>å…¥é—¨é¡¹ç›®</h5><blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/create-llama">åˆ›å»ºéª†é©¼</a></li>
<li><a target="_blank" rel="noopener" href="https://secinsights.ai/">SEC æ´å¯Ÿ</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/run-llama/llamabot">éª†é©¼æœºå™¨äºº</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/use_cases/q_and_a/rag_cli.html">RAG å‘½ä»¤è¡Œç•Œé¢</a></li>
</ul>
</blockquote>
<h4 id="RAG-Work-Flow"><a href="#RAG-Work-Flow" class="headerlink" title="RAG Work Flow"></a>RAG Work Flow</h4><p><img src="https://raw.githubusercontent.com/P-luminary/images/183f045f8c4d37aefbb62c12d2c52ebd82d26b74/RAG%20Work%20flow.png"></p>
<h4 id="æ„å»ºRAGç®¡é“â€”åŠ è½½æ•°æ®-é•Šå–"><a href="#æ„å»ºRAGç®¡é“â€”åŠ è½½æ•°æ®-é•Šå–" class="headerlink" title="æ„å»ºRAGç®¡é“â€”åŠ è½½æ•°æ®(é•Šå–)"></a>æ„å»ºRAGç®¡é“â€”åŠ è½½æ•°æ®(é•Šå–)</h4><p>åœ¨æ‚¨é€‰æ‹©çš„ LLM å¯ä»¥å¤„ç†æ‚¨çš„æ•°æ®ä¹‹å‰ï¼Œæ‚¨é¦–å…ˆéœ€è¦å¤„ç†æ•°æ®å¹¶åŠ è½½æ•°æ®ã€‚è¿™ä¸ ML é¢†åŸŸçš„æ•°æ®æ¸…ç†&#x2F;ç‰¹å¾å·¥ç¨‹ç®¡é“æˆ–ä¼ ç»Ÿæ•°æ®è®¾ç½®ä¸­çš„ ETL ç®¡é“æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚</p>
<p>æ­¤å¼•å…¥ç®¡é“é€šå¸¸åŒ…æ‹¬ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š</p>
<ol>
<li>åŠ è½½æ•°æ®</li>
<li>è½¬æ¢æ•°æ®</li>
<li>ç´¢å¼•å’Œå­˜å‚¨æ•°æ®</li>
</ol>
<p>æˆ‘ä»¬å°†åœ¨<a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/understanding/indexing/indexing/">åé¢</a><a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/understanding/storing/storing/">çš„ç« èŠ‚</a>ä¸­ä»‹ç»ç´¢å¼• &#x2F; å­˜å‚¨ã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä¸»è¦è®¨è®º loader å’Œ transformationsã€‚</p>
<h4 id="è£…è½½æœº"><a href="#è£…è½½æœº" class="headerlink" title="è£…è½½æœº"></a>è£…è½½æœº</h4><p>åœ¨æ‚¨é€‰æ‹©çš„ LLM å¯ä»¥å¤„ç†æ‚¨çš„æ•°æ®ä¹‹å‰ï¼Œæ‚¨éœ€è¦åŠ è½½å®ƒã€‚LlamaIndex æ‰§è¡Œæ­¤ä½œçš„æ–¹å¼æ˜¯é€šè¿‡æ•°æ®è¿æ¥å™¨ï¼ˆä¹Ÿç§°ä¸º .Data Connector ä»ä¸åŒçš„æ•°æ®æºæ‘„å–æ•°æ®å¹¶å°†æ•°æ®æ ¼å¼åŒ–ä¸ºå¯¹è±¡ã€‚A æ˜¯æœ‰å…³è¯¥æ•°æ®çš„æ•°æ®ï¼ˆ<u>å½“å‰ä¸º<strong>æ–‡æœ¬</strong>ï¼Œå°†æ¥ä¸º<strong>å›¾åƒ</strong>å’Œ<strong>éŸ³é¢‘</strong></u>ï¼‰å’Œå…ƒæ•°æ®çš„é›†åˆã€‚<code>Reader Document Document</code></p>
<h4 id="ä½¿ç”¨-SimpleDirectoryReader-åŠ è½½"><a href="#ä½¿ç”¨-SimpleDirectoryReader-åŠ è½½" class="headerlink" title="ä½¿ç”¨ SimpleDirectoryReader åŠ è½½"></a>ä½¿ç”¨ SimpleDirectoryReader åŠ è½½</h4><p>æœ€å®¹æ˜“ä½¿ç”¨çš„é˜…è¯»å™¨æ˜¯æˆ‘ä»¬çš„ SimpleDirectoryReaderï¼Œå®ƒä»ç»™å®šç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶åˆ›å»ºæ–‡æ¡£ã€‚å®ƒå†…ç½®äº LlamaIndex ä¸­ï¼Œå¯ä»¥è¯»å–å¤šç§æ ¼å¼ï¼ŒåŒ…æ‹¬ <strong>Markdownã€PDFã€Word æ–‡æ¡£ã€PowerPoint å¹»ç¯ç‰‡ã€å›¾åƒã€éŸ³é¢‘å’Œè§†é¢‘</strong>ã€‚</p>
<pre><code class="python">from llama_index.core import SimpleDirectoryReader
documents = SimpleDirectoryReader(&quot;./data&quot;).load_data()
</code></pre>
<p>â˜… â˜… â˜… â˜… <u>æ›´å¤šæ•™ç¨‹è¯·çœ‹<strong>å®˜æ–¹æ¥å£æ–‡æ¡£</strong></u> <a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/understanding/loading/loading/"><span style = "color:blue"><strong><u>Loading Data (Ingestion) - LlamaIndex</u></strong></span></a> â˜… â˜… â˜… â˜…</p>
<p><a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/getting_started/starter_example/">Starter Tutorial - LlamaIndex</a> + <a target="_blank" rel="noopener" href="https://colab.research.google.com/#scrollTo=S7b85AZVL5M5">æ¬¢è¿ä½¿ç”¨ Colaboratory - Colab</a> &#x3D; åœ¨çº¿ä½¿ç”¨ä»£ç </p>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/640d982cf931112877ec183a26a25a678da433be/LlamaIndex+Colab.png"></p>
<h4 id="RAG"><a href="#RAG" class="headerlink" title="RAG"></a>RAG</h4><p>RAGï¼Œä¹Ÿç§°ä¸ºæ£€ç´¢å¢å¼ºç”Ÿæˆï¼Œæ˜¯åˆ©ç”¨ä¸ªäººæˆ–ç§åŸŸæ•°æ®å¢å¼º <code>LLM</code> çš„ä¸€ç§èŒƒå¼ã€‚é€šå¸¸ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><p>ç´¢å¼•</p>
<p>æ„å»ºçŸ¥è¯†åº“ã€‚</p>
</li>
<li><p>æŸ¥è¯¢</p>
<p>ä»çŸ¥è¯†åº“æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»¥è¾…åŠ© <code>LLM</code> å›ç­”é—®é¢˜ã€‚</p>
</li>
</ol>
<p><code>LlamaIndex</code> æä¾›äº†å·¥å…·åŒ…å¸®åŠ©å¼€å‘è€…æå…¶ä¾¿æ·åœ°å®Œæˆè¿™ä¸¤ä¸ªé˜¶æ®µçš„å·¥ä½œã€‚</p>
<h4 id="ç´¢å¼•é˜¶æ®µ"><a href="#ç´¢å¼•é˜¶æ®µ" class="headerlink" title="ç´¢å¼•é˜¶æ®µ"></a>ç´¢å¼•é˜¶æ®µ</h4><p><code>LlamaIndex</code> é€šè¿‡æä¾› Data connectors(æ•°æ®è¿æ¥å™¨) å’Œ Indexes (ç´¢å¼•) å¸®åŠ©å¼€å‘è€…æ„å»ºçŸ¥è¯†åº“ã€‚</p>
<p>è¯¥é˜¶æ®µä¼šç”¨åˆ°å¦‚ä¸‹å·¥å…·æˆ–ç»„ä»¶ï¼š</p>
<ul>
<li><p>Data connectors</p>
<p>æ•°æ®è¿æ¥å™¨ã€‚å®ƒè´Ÿè´£å°†æ¥è‡ªä¸åŒæ•°æ®æºçš„ä¸åŒæ ¼å¼çš„æ•°æ®æ³¨å…¥ï¼Œå¹¶è½¬æ¢ä¸º <code>LlamaIndex</code> æ”¯æŒçš„æ–‡æ¡£ï¼ˆDocumentï¼‰è¡¨ç°å½¢å¼ï¼Œå…¶ä¸­åŒ…å«äº†æ–‡æœ¬å’Œå…ƒæ•°æ®ã€‚</p>
</li>
<li><p>Documents &#x2F; Nodes</p>
<p>Documentæ˜¯ <code>LlamaIndex</code> ä¸­å®¹å™¨çš„æ¦‚å¿µï¼Œå®ƒå¯ä»¥åŒ…å«ä»»ä½•æ•°æ®æºï¼ŒåŒ…æ‹¬ï¼ŒPDFæ–‡æ¡£ï¼ŒAPIå“åº”ï¼Œæˆ–æ¥è‡ªæ•°æ®åº“çš„æ•°æ®ã€‚</p>
<p>Nodeæ˜¯ <code>LlamaIndex</code> ä¸­æ•°æ®çš„æœ€å°å•å…ƒï¼Œä»£è¡¨äº†ä¸€ä¸ª Documentçš„åˆ†å—ã€‚å®ƒè¿˜åŒ…å«äº†å…ƒæ•°æ®ï¼Œä»¥åŠä¸å…¶ä»–Nodeçš„å…³ç³»ä¿¡æ¯ã€‚è¿™ä½¿å¾—æ›´ç²¾ç¡®çš„æ£€ç´¢æ“ä½œæˆä¸ºå¯èƒ½ã€‚</p>
</li>
<li><p>Data Indexes</p>
<p><code>LlamaIndex</code> æä¾›ä¾¿åˆ©çš„å·¥å…·ï¼Œå¸®åŠ©å¼€å‘è€…ä¸ºæ³¨å…¥çš„æ•°æ®å»ºç«‹ç´¢å¼•ï¼Œä½¿å¾—æœªæ¥çš„æ£€ç´¢ç®€å•è€Œé«˜æ•ˆã€‚</p>
<p>æœ€å¸¸ç”¨çš„ç´¢å¼•æ˜¯å‘é‡å­˜å‚¨ç´¢å¼• - <code>VectorStoreIndex</code>ã€‚</p>
</li>
</ul>
<h4 id="æŸ¥è¯¢é˜¶æ®µ"><a href="#æŸ¥è¯¢é˜¶æ®µ" class="headerlink" title="æŸ¥è¯¢é˜¶æ®µ"></a>æŸ¥è¯¢é˜¶æ®µ</h4><p>åœ¨æŸ¥è¯¢é˜¶æ®µï¼Œ<code>RAG</code> ç®¡é“æ ¹æ®çš„ç”¨æˆ·æŸ¥è¯¢ï¼Œæ£€ç´¢æœ€ç›¸å…³çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶å°†å…¶ä¸æŸ¥è¯¢ä¸€èµ·ï¼Œä¼ é€’ç»™ <code>LLM</code>ï¼Œä»¥åˆæˆå“åº”ã€‚è¿™ä½¿ <code>LLM</code> èƒ½å¤Ÿè·å¾—ä¸åœ¨å…¶åŸå§‹è®­ç»ƒæ•°æ®ä¸­çš„æœ€æ–°çŸ¥è¯†ï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†è™šæ„å†…å®¹ã€‚è¯¥é˜¶æ®µçš„å…³é”®æŒ‘æˆ˜åœ¨äºæ£€ç´¢ã€ç¼–æ’å’ŒåŸºäºçŸ¥è¯†åº“çš„æ¨ç†ã€‚</p>
<p><code>LlamaIndex</code> æä¾›å¯ç»„åˆçš„æ¨¡å—ï¼Œå¸®åŠ©å¼€å‘è€…æ„å»ºå’Œé›†æˆ <code>RAG</code> ç®¡é“ï¼Œç”¨äºé—®ç­”ã€èŠå¤©æœºå™¨äººæˆ–ä½œä¸ºä»£ç†çš„ä¸€éƒ¨åˆ†ã€‚è¿™äº›æ„å»ºå—å¯ä»¥æ ¹æ®æ’ååå¥½è¿›è¡Œå®šåˆ¶ï¼Œå¹¶ç»„åˆèµ·æ¥ï¼Œä»¥ç»“æ„åŒ–çš„æ–¹å¼åŸºäºå¤šä¸ªçŸ¥è¯†åº“è¿›è¡Œæ¨ç†ã€‚</p>
<p>è¯¥é˜¶æ®µçš„æ„å»ºå—åŒ…æ‹¬ï¼š</p>
<ul>
<li><p><strong>Retrievers</strong></p>
<p>æ£€ç´¢å™¨ã€‚å®ƒå®šä¹‰å¦‚ä½•é«˜æ•ˆåœ°ä»çŸ¥è¯†åº“ï¼ŒåŸºäºæŸ¥è¯¢ï¼Œæ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
</li>
<li><p><strong>Node Postprocessors</strong></p>
<p>Nodeåå¤„ç†å™¨ã€‚å®ƒå¯¹ä¸€ç³»åˆ—æ–‡æ¡£èŠ‚ç‚¹ï¼ˆNodeï¼‰å®æ–½è½¬æ¢ï¼Œè¿‡æ»¤ï¼Œæˆ–æ’åã€‚</p>
</li>
<li><p><strong>Response Synthesizers</strong></p>
<p>å“åº”åˆæˆå™¨ã€‚å®ƒåŸºäºç”¨æˆ·çš„æŸ¥è¯¢ï¼Œå’Œä¸€ç»„æ£€ç´¢åˆ°çš„æ–‡æœ¬å—ï¼ˆå½¢æˆä¸Šä¸‹æ–‡ï¼‰ï¼Œåˆ©ç”¨ <code>LLM</code> ç”Ÿæˆå“åº”ã€‚</p>
</li>
</ul>
<p>RAGç®¡é“åŒ…æ‹¬ï¼š</p>
<ul>
<li><p><strong>Query Engines</strong></p>
<p>æŸ¥è¯¢å¼•æ“ - ç«¯åˆ°ç«¯çš„ç®¡é“ï¼Œå…è®¸ç”¨æˆ·åŸºäºçŸ¥è¯†åº“ï¼Œä»¥è‡ªç„¶è¯­è¨€æé—®ï¼Œå¹¶è·å¾—å›ç­”ï¼Œä»¥åŠç›¸å…³çš„ä¸Šä¸‹æ–‡ã€‚</p>
</li>
<li><p><strong>Chat Engines</strong></p>
<p>èŠå¤©å¼•æ“ - ç«¯åˆ°ç«¯çš„ç®¡é“ï¼Œå…è®¸ç”¨æˆ·åŸºäºçŸ¥è¯†åº“è¿›è¡Œå¯¹è¯ï¼ˆå¤šæ¬¡äº¤äº’ï¼Œä¼šè¯å†å²ï¼‰ã€‚</p>
</li>
<li><p><strong>Agents</strong></p>
<p>ä»£ç†ã€‚å®ƒæ˜¯ä¸€ç§ç”± <code>LLM</code> é©±åŠ¨çš„è‡ªåŠ¨åŒ–å†³ç­–å™¨ã€‚ä»£ç†å¯ä»¥åƒæŸ¥è¯¢å¼•æ“æˆ–èŠå¤©å¼•æ“ä¸€æ ·ä½¿ç”¨ã€‚ä¸»è¦åŒºåˆ«åœ¨äºï¼Œä»£ç†åŠ¨æ€åœ°å†³å®šæœ€ä½³çš„åŠ¨ä½œåºåˆ—ï¼Œè€Œä¸æ˜¯éµå¾ªé¢„å®šçš„é€»è¾‘ã€‚è¿™ä¸ºå…¶æä¾›äº†å¤„ç†æ›´å¤æ‚ä»»åŠ¡çš„é¢å¤–çµæ´»æ€§ã€‚</p>
</li>
</ul>
<h4 id="LlamaIndexä¸ªæ€§åŒ–é…ç½®"><a href="#LlamaIndexä¸ªæ€§åŒ–é…ç½®" class="headerlink" title="LlamaIndexä¸ªæ€§åŒ–é…ç½®"></a>LlamaIndexä¸ªæ€§åŒ–é…ç½®</h4><p><code>LlamaIndex</code> å¯¹ <code>RAG</code> è¿‡ç¨‹æä¾›äº†å…¨é¢çš„é…ç½®æ”¯æŒï¼Œå…è®¸å¼€å‘è€…å¯¹æ•´ä¸ªè¿‡ç¨‹è¿›è¡Œä¸ªæ€§åŒ–è®¾ç½®ã€‚å¸¸è§çš„é…ç½®åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰æ–‡æ¡£åˆ†å—</li>
<li>è‡ªå®šä¹‰å‘é‡å­˜å‚¨</li>
<li>è‡ªå®šä¹‰æ£€ç´¢</li>
<li>æŒ‡å®š <code>LLM</code></li>
<li>æŒ‡å®šå“åº”æ¨¡å¼</li>
<li>æŒ‡å®šæµå¼å“åº”</li>
</ul>
<p>æ³¨ï¼Œä¸ªæ€§åŒ–é…ç½®ä¸»è¦é€šè¿‡ <code>LlamaIndex</code> æä¾›çš„ <code>ServiceContext</code> ç±»å®ç°ã€‚</p>
<h5 id="é…ç½®åœºæ™¯ç¤ºä¾‹"><a href="#é…ç½®åœºæ™¯ç¤ºä¾‹" class="headerlink" title="é…ç½®åœºæ™¯ç¤ºä¾‹"></a>é…ç½®åœºæ™¯ç¤ºä¾‹</h5><p>æ¥ä¸‹æ¥é€šè¿‡ç®€æ˜ç¤ºä¾‹ä»£ç æ®µå±•ç¤º <code>LlamaIndex</code> å¯¹å„ç§é…ç½®åœºæ™¯çš„æ”¯æŒã€‚</p>
<h5 id="è‡ªå®šä¹‰æ–‡æ¡£åˆ†å—"><a href="#è‡ªå®šä¹‰æ–‡æ¡£åˆ†å—" class="headerlink" title="è‡ªå®šä¹‰æ–‡æ¡£åˆ†å—"></a>è‡ªå®šä¹‰æ–‡æ¡£åˆ†å—</h5><pre><code class="python">from llama_index import ServiceContext
service_context = ServiceContext.from_defaults(chunk_size=500)
</code></pre>
<h5 id="è‡ªå®šä¹‰å‘é‡å­˜å‚¨"><a href="#è‡ªå®šä¹‰å‘é‡å­˜å‚¨" class="headerlink" title="è‡ªå®šä¹‰å‘é‡å­˜å‚¨"></a>è‡ªå®šä¹‰å‘é‡å­˜å‚¨</h5><pre><code class="python">import chromadb
from llama_index.vector_stores import ChromaVectorStore
from llama_index import StorageContext

chroma_client = chromadb.PersistentClient()
chroma_collection = chroma_client.create_collection(&quot;quickstart&quot;)
# å‘é‡å­˜å‚¨
vector_store = ChromaVectorStore(chroma_collection=chroma_collection)
storage_context = StorageContext.from_defaults(vector_store=vector_store)
</code></pre>
<h5 id="è‡ªå®šä¹‰æ£€ç´¢"><a href="#è‡ªå®šä¹‰æ£€ç´¢" class="headerlink" title="è‡ªå®šä¹‰æ£€ç´¢"></a>è‡ªå®šä¹‰æ£€ç´¢</h5><p>è‡ªå®šä¹‰æ£€ç´¢ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®š<strong>æŸ¥è¯¢å¼•æ“</strong>(Query Engine)åœ¨æ£€ç´¢æ—¶è¯·æ±‚çš„ç›¸ä¼¼æ–‡æ¡£æ•°ã€‚</p>
<pre><code class="python">index = VectorStoreIndex.from_documents(documents)
query_engine = index.as_query_engine(similarity_top_k=5)
</code></pre>
<h5 id="æŒ‡å®š-LLM"><a href="#æŒ‡å®š-LLM" class="headerlink" title="æŒ‡å®š LLM"></a>æŒ‡å®š <code>LLM</code></h5><pre><code class="python"># æŒ‡å®šå¤§è¯­è¨€æ¨¡å‹
service_context = ServiceContext.from_defaults(llm=OpenAI())
</code></pre>
<h5 id="æŒ‡å®šå“åº”æ¨¡å¼"><a href="#æŒ‡å®šå“åº”æ¨¡å¼" class="headerlink" title="æŒ‡å®šå“åº”æ¨¡å¼"></a>æŒ‡å®šå“åº”æ¨¡å¼</h5><pre><code class="python">query_engine = index.as_query_engine(response_mode=&#39;tree_summarize&#39;)
</code></pre>
<h5 id="æŒ‡å®šæµå¼å“åº”"><a href="#æŒ‡å®šæµå¼å“åº”" class="headerlink" title="æŒ‡å®šæµå¼å“åº”"></a>æŒ‡å®šæµå¼å“åº”</h5><pre><code class="python"># æµå¼å“åº”
query_engine = index.as_query_engine(streaming=True)
</code></pre>
<h5 id="å®Œæ•´å®ä¾‹"><a href="#å®Œæ•´å®ä¾‹" class="headerlink" title="å®Œæ•´å®ä¾‹"></a>å®Œæ•´å®ä¾‹</h5><p><strong>GitHub</strong>ï¼š<a target="_blank" rel="noopener" href="https://github.com/sugarforever/LlamaIndex-Tutorials/blob/main/03_Customization/03_Customization.ipynb">LlamaIndex-Tutorials&#x2F;03_Customization&#x2F;03_Customization.ipynb at main Â· sugarforever&#x2F;LlamaIndex-Tutorials</a><br><strong>Colab</strong>ï¼š<a target="_blank" rel="noopener" href="https://colab.research.google.com/github/sugarforever/LlamaIndex-Tutorials/blob/main/03_Customization/03_Customization.ipynb">03_Customization.ipynb - Colab</a></p>
<p>è¯·å‚è€ƒ<a target="_blank" rel="noopener" href="https://github.com/sugarforever/LlamaIndex-Tutorials/blob/main/03_Customization/03_Customization.ipynb">03_Customization.ipynb</a> ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºç¬¬1è¯¾çš„ç¤ºä¾‹å®ç°ä¸Šè¿°çš„æ‰€æœ‰ä¸ªæ€§åŒ–é…ç½®ï¼š</p>
<ol>
<li>æ–‡æ¡£åˆ†å—å¤§å°ï¼š500</li>
<li>Chromadbä½œä¸ºå‘é‡å­˜å‚¨</li>
<li>è‡ªå®šä¹‰æ£€ç´¢æ–‡æ¡£æ•°ä¸º5</li>
<li>æŒ‡å®šå¤§æ¨¡å‹ä¸ºOpenAIçš„æ¨¡å‹</li>
<li>å“åº”æ¨¡å¼ä¸º <code>tree_summarize</code></li>
<li>é—®ç­”å®ç°æµå¼å“åº”</li>
</ol>
<p>æ³¨ï¼Œå“åº”æ¨¡å¼ä¼šåœ¨åç»­è¯¾ç¨‹ä¸­è¯¦ç»†ä»‹ç»ã€‚</p>
<hr>
<h4 id="å¼ºå¤§çš„æ•°æ®è¿æ¥å™¨"><a href="#å¼ºå¤§çš„æ•°æ®è¿æ¥å™¨" class="headerlink" title="å¼ºå¤§çš„æ•°æ®è¿æ¥å™¨"></a>å¼ºå¤§çš„æ•°æ®è¿æ¥å™¨</h4><p><strong>å¼€æºæ•™ç¨‹</strong>ï¼š<a target="_blank" rel="noopener" href="https://github.com/sugarforever/LlamaIndex-Tutorials/tree/main/04_Data_Connectors">LlamaIndex-Tutorials&#x2F;04_Data_Connectors at main Â· sugarforever&#x2F;LlamaIndex-Tutorials</a><br><strong>æ¼”ç¤ºå®ä¾‹</strong>ï¼š<a target="_blank" rel="noopener" href="https://colab.research.google.com/github/sugarforever/LlamaIndex-Tutorials/blob/main/04_Data_Connectors/04_Data_Connectors.ipynb">04_Data_Connectors.ipynb - Colab</a></p>
<h4 id="æ–‡æ¡£ä¸èŠ‚ç‚¹"><a href="#æ–‡æ¡£ä¸èŠ‚ç‚¹" class="headerlink" title="æ–‡æ¡£ä¸èŠ‚ç‚¹"></a>æ–‡æ¡£ä¸èŠ‚ç‚¹</h4><p><strong>å¼€æºæ•™ç¨‹</strong>ï¼š<a target="_blank" rel="noopener" href="https://github.com/sugarforever/LlamaIndex-Tutorials/tree/main/05_Documents_Nodes">LlamaIndex-Tutorials&#x2F;05_Documents_Nodes at main Â· sugarforever&#x2F;LlamaIndex-Tutorials</a></p>
<h4 id="LlamaPack-æ–°æ‰‹å…¥é—¨"><a href="#LlamaPack-æ–°æ‰‹å…¥é—¨" class="headerlink" title="LlamaPack æ–°æ‰‹å…¥é—¨"></a>LlamaPack æ–°æ‰‹å…¥é—¨</h4><p><a target="_blank" rel="noopener" href="https://docs.llamaindex.ai/en/stable/community/llama_packs/">LlamaPacks - LlamaIndex</a></p>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/AI" style=color:#1bccbc>
                AI
            </a>
        </span>
        
    </div>

    <a href="/2025/02/25/AI/LlamaIndex/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/02/09/é¢è¯•/æ´ªå“¥é¢è¯•é¢˜/">
        <h2>
            æ´ªå“¥é¢è¯•é¢˜
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/2/9
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h4 id="çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹"><a href="#çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹" class="headerlink" title="çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹:"></a><strong>çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹</strong>:</h4><p>çº¿ç¨‹æ± ï¼šThreadPoolExecutor<br>ä¸€å¼€å§‹newçš„æ—¶å€™æ²¡æœ‰ æ˜¯ç©ºçš„ã€‚å…ˆå½“ä¸€ä¸ªä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± æ—¶ï¼Œçº¿ç¨‹æ± é¦–å…ˆæ£€æŸ¥å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚å¦‚æœæ²¡æœ‰è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœå·²ç»è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ± ä¼šå°†ä»»åŠ¡æ”¾å…¥å·¥ä½œé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œã€‚å¦‚æœå·¥ä½œé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœå·¥ä½œé˜Ÿåˆ—æ»¡äº†ï¼Œå¹¶ä¸”å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œçº¿ç¨‹æ± ä¼šæ ¹æ®<strong>æ‹’ç»ç­–ç•¥</strong></p>
<ul>
<li><u>ä¸¢å¼ƒä»»åŠ¡æŠ›å‡ºå¼‚å¸¸</u></li>
<li><u>ä¸¢å¼ƒä»»åŠ¡ä¸æŠ›å¼ƒå¼‚å¸¸</u></li>
<li><u>ä¸¢å¼ƒé˜Ÿåˆ—æœ€å‰é¢çš„ä»»åŠ¡,ç„¶åé‡æ–°æäº¤è¢«æ‹’ç»çš„ä»»åŠ¡ã€</u></li>
<li><u>ç”±ä¸»çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡æ¥å¤„ç†æ— æ³•æ‰§è¡Œçš„ä»»åŠ¡</u>ã€‚ã€çº¿ç¨‹æ± æ— æ³•èµ·åˆ°å¼‚æ­¥é—®é¢˜ã€‘<ul>
<li>é—®é¢˜ï¼šæƒ³ç»§ç»­å¼‚æ­¥ä¸”ä¸ä¸¢å¼ƒä»»åŠ¡æ€ä¹ˆåŠï¼Ÿ</li>
<li>æŠŠè¿™ä¸ªä¸šåŠ¡å…ˆå­˜åˆ°åˆ«çš„åœ°æ–¹ â†“â†“â†“</li>
</ul>
</li>
<li><u>è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥</u> è‡ªå·±å†™å®ç°ç±»å®ç°æ‹’ç»ç­–ç•¥ å¯ä»¥å…ˆå­˜åˆ°mysqlåˆ°æ—¶å€™å†æ…¢æ…¢æ</li>
</ul>
<p><strong>æ€ä¹ˆç¡®å®šæ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°</strong>ï¼Ÿ</p>
<h6 id="æ ¸å¿ƒçº¿ç¨‹æ•°"><a href="#æ ¸å¿ƒçº¿ç¨‹æ•°" class="headerlink" title="æ ¸å¿ƒçº¿ç¨‹æ•°"></a>æ ¸å¿ƒçº¿ç¨‹æ•°</h6><ul>
<li>CPUå¯†é›†å‹ä»»åŠ¡ï¼šå¦‚æœä»»åŠ¡æ˜¯CPUå¯†é›†å‹çš„ï¼Œå³ä»»åŠ¡ä¸»è¦æ˜¯è¿›è¡Œè®¡ç®—è€Œä¸æ˜¯ç­‰å¾…I&#x2F;Oæ“ä½œï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°é€šå¸¸è®¾ç½®ä¸ºCPUæ ¸å¿ƒæ•°åŠ 1ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿CPUåœ¨å¿™äºè®¡ç®—çš„åŒæ—¶ï¼Œè¿˜æœ‰é¢å¤–çš„çº¿ç¨‹æ¥å¤„ç†å¯èƒ½å‡ºç°çš„ä¸´æ—¶é«˜å³°ã€‚ã€çº¯å†…å­˜è®¡ç®— ä¸æ¶‰åŠåˆ°ç½‘ç»œè®¡ç®—å’Œioè®¡ç®—ã€‘ã€N+1ã€‘<ul>
<li>å…«ä¸ªæ ¸ åˆ›å»ºåä¸ªcpu æ²¡æ„ä¹‰ å› ä¸ºæœ€å¤šå¹¶å‘åªæ˜¯8ï¼Œå»ºè®®ä¿æŒä¸€è‡´æˆ–è€…+1ï¼Œ<u>å‡å°‘åŠ å…¥é˜Ÿåˆ—å’Œåˆ›å»ºé˜Ÿåˆ—çš„å¼€é”€</u></li>
<li>å…ˆæŠŠå…¶å½“æˆioå¯†é›† å› ä¸ºå±‚çº§ä¸ä¸€æ · ä¸æ–­å‹æµ‹å»é€¼è¿‘æœ€ç†æƒ³å€¼</li>
</ul>
</li>
<li>I&#x2F;Oå¯†é›†å‹ä»»åŠ¡ï¼šå¯¹äºI&#x2F;Oå¯†é›†å‹ä»»åŠ¡ï¼Œç”±äºçº¿ç¨‹åœ¨ç­‰å¾…I&#x2F;Oæ“ä½œæ—¶ä¼šé˜»å¡ï¼Œå› æ­¤å¯ä»¥è®¾ç½®æ›´å¤šçš„æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚ä¸€ä¸ªå¸¸ç”¨çš„ç»éªŒæ³•åˆ™æ˜¯æ ¸å¿ƒçº¿ç¨‹æ•°è®¾ç½®ä¸ºCPUæ ¸å¿ƒæ•°çš„ä¸¤å€ã€‚ã€çº¿ç¨‹æ•°è¶Šå¤šè¶Šå¥½ã€‘ã€å‹æµ‹æ— é™é€¼è¿‘å–æœ€åˆé€‚çš„çº¿ç¨‹æ•°ã€‘ã€2N+1ã€‘</li>
</ul>
<h6 id="æœ€å¤§çº¿ç¨‹æ•°"><a href="#æœ€å¤§çº¿ç¨‹æ•°" class="headerlink" title="æœ€å¤§çº¿ç¨‹æ•°"></a>æœ€å¤§çº¿ç¨‹æ•°</h6><p>éœ€è¦ä¸€å¼€å§‹åˆ›å»ºå¥½çº¿ç¨‹ç­‰ç€è®¿é—®æ¥ï¼Œå¦‚æœ <u>æ ¸å¿ƒ&#x3D;æœ€å¤§</u>ï¼Œæ­¤æ—¶æ²¡æœ‰ä¸´æ—¶çº¿ç¨‹</p>
<h4 id="åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§æ–¹å¼ï¼ˆå¿…ä¼šï¼‰"><a href="#åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§æ–¹å¼ï¼ˆå¿…ä¼šï¼‰" class="headerlink" title="åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§æ–¹å¼ï¼ˆå¿…ä¼šï¼‰"></a>åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§æ–¹å¼ï¼ˆå¿…ä¼šï¼‰</h4><p>1.<strong>ç»§æ‰¿</strong> Threadç±»å¹¶é‡å†™ run æ–¹æ³•åˆ›å»ºçº¿ç¨‹ï¼Œå®ç°ç®€å•ä½†ä¸å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»<br>2.<strong>å®ç°</strong> Runnableæ¥å£å¹¶é‡å†™ run æ–¹æ³•ã€‚é¿å…äº†å•ç»§æ‰¿å±€é™æ€§ï¼Œç¼–ç¨‹æ›´åŠ çµæ´»ï¼Œå®ç°è§£è€¦ã€‚ [æ— è¿”å›å€¼]<br>3.<strong>å®ç°</strong> Callableæ¥å£å¹¶é‡å†™ call æ–¹æ³•ï¼Œåˆ›å»ºçº¿ç¨‹ã€‚å¯ä»¥è·å–çº¿ç¨‹æ‰§è¡Œç»“æœçš„è¿”å›å€¼ï¼Œå¹¶ä¸”å¯ä»¥æŠ›å‡ºå¼‚å¸¸ã€‚[æœ‰è¿”å›å€¼]<br>4.ä½¿ç”¨<strong>çº¿ç¨‹æ± </strong>åˆ›å»ºï¼ˆä½¿ç”¨java.util.concurrent.Executoræ¥å£ï¼‰</p>
<ul>
<li>æƒ³è·å¾—çº¿ç¨‹æ± é‡Œçš„è¿”å›ç»“æœç”¨ä»€ä¹ˆï¼Ÿ<strong>execute + submit</strong></li>
<li>çº¿ç¨‹æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ javaçº¿ç¨‹æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</li>
<li>çº¿ç¨‹æ± æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</li>
</ul>
<pre><code class="java">// 1. ç»§æ‰¿Threadç±»å¹¶é‡å†™runæ–¹æ³•
class MyThread extends Thread &#123;
    @Override
    public void run() &#123;
        System.out.println(&quot;çº¿ç¨‹è¿è¡Œä¸­ - ç»§æ‰¿Threadç±»&quot;);
    &#125;
&#125;

// 2. å®ç°Runnableæ¥å£å¹¶é‡å†™runæ–¹æ³•
class MyRunnable implements Runnable &#123;
    @Override
    public void run() &#123;
        System.out.println(&quot;çº¿ç¨‹è¿è¡Œä¸­ - å®ç°Runnableæ¥å£&quot;);
    &#125;
&#125;

// 3. å®ç°Callableæ¥å£å¹¶é‡å†™callæ–¹æ³•
import java.util.concurrent.Callable;
import java.util.concurrent.FutureTask;

class MyCallable implements Callable&lt;String&gt; &#123;
    @Override
    public String call() throws Exception &#123;
        System.out.println(&quot;çº¿ç¨‹è¿è¡Œä¸­ - å®ç°Callableæ¥å£&quot;);
        return &quot;Callableçº¿ç¨‹è¿”å›ç»“æœ&quot;;
    &#125;
&#125;

// 4. ä½¿ç”¨çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ThreadCreationExamples &#123;
    public static void main(String[] args) &#123;
        // ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹
        Thread thread1 = new MyThread();
        thread1.start();

        // å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹
        Thread thread2 = new Thread(new MyRunnable());
        thread2.start();

        // å®ç°Callableæ¥å£åˆ›å»ºçº¿ç¨‹
        MyCallable callable = new MyCallable();
        FutureTask&lt;String&gt; futureTask = new FutureTask&lt;&gt;(callable);
        Thread thread3 = new Thread(futureTask);
        thread3.start();
        try &#123;
            // è·å–çº¿ç¨‹æ‰§è¡Œç»“æœçš„è¿”å›å€¼
            String result = futureTask.get();
            System.out.println(result);
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;

        // ä½¿ç”¨çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹
        ExecutorService executor = Executors.newFixedThreadPool(2);
        executor.execute(new MyRunnable()); // æäº¤Runnableä»»åŠ¡
        executor.submit(new MyCallable()); // æäº¤Callableä»»åŠ¡
        executor.shutdown(); // å…³é—­çº¿ç¨‹æ± 
    &#125;
&#125;
</code></pre>
<h4 id="çº¿ç¨‹æ± å“ªäº›ç±»å‹ï¼Ÿé€šè¿‡JUC-åŒ…-çš„executeså¯ä»¥åˆ›å»ºè¿™å››ä¸ªç±»å‹çš„çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± å“ªäº›ç±»å‹ï¼Ÿé€šè¿‡JUC-åŒ…-çš„executeså¯ä»¥åˆ›å»ºè¿™å››ä¸ªç±»å‹çš„çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± å“ªäº›ç±»å‹ï¼Ÿé€šè¿‡JUC[åŒ…]çš„executeså¯ä»¥åˆ›å»ºè¿™å››ä¸ªç±»å‹çš„çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± å“ªäº›ç±»å‹ï¼Ÿ<del>é€šè¿‡JUC[åŒ…]çš„executeså¯ä»¥åˆ›å»ºè¿™å››ä¸ªç±»å‹çš„çº¿ç¨‹æ± </del></h4><p>é—®é¢˜ï¼šä¸ºä»€ä¹ˆé˜¿é‡Œå·´å·´ä¸æ¨èJUCï¼Ÿæœ‰å¯èƒ½ä¼šå‡ºç°OOMã€èµ„æºæµªè´¹</p>
<ul>
<li>å•çº¿ç¨‹çº¿ç¨‹æ± </li>
<li>å¯ç¼“å­˜çº¿ç¨‹æ± &#x2F;å®šé•¿</li>
<li>å˜é•¿çš„çº¿ç¨‹æ± </li>
<li>å®šæ—¶ä»»åŠ¡çš„çº¿ç¨‹æ± </li>
</ul>
<h4 id="java-çº¿ç¨‹æ± åˆ›å»ºæ—¶æ ¸å¿ƒå‚æ•°-é«˜è–ªå¸¸é—®"><a href="#java-çº¿ç¨‹æ± åˆ›å»ºæ—¶æ ¸å¿ƒå‚æ•°-é«˜è–ªå¸¸é—®" class="headerlink" title="java çº¿ç¨‹æ± åˆ›å»ºæ—¶æ ¸å¿ƒå‚æ•°(é«˜è–ªå¸¸é—®)"></a>java çº¿ç¨‹æ± åˆ›å»ºæ—¶æ ¸å¿ƒå‚æ•°(é«˜è–ªå¸¸é—®)</h4><blockquote>
<h6 id="ä¸ƒå¤§æ ¸å¿ƒå‚æ•°è§£é‡Š"><a href="#ä¸ƒå¤§æ ¸å¿ƒå‚æ•°è§£é‡Š" class="headerlink" title="ä¸ƒå¤§æ ¸å¿ƒå‚æ•°è§£é‡Š"></a><strong>ä¸ƒå¤§æ ¸å¿ƒå‚æ•°è§£é‡Š</strong></h6><table>
<thead>
<tr>
<th>å‚æ•°å</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>corePoolSize</code></td>
<td><strong>æ ¸å¿ƒçº¿ç¨‹æ•°</strong>ï¼Œçº¿ç¨‹æ± å¸¸é©»çš„çº¿ç¨‹æ•°é‡ï¼Œå³ä½¿ç©ºé—²ä¹Ÿä¸ä¼šè¢«é”€æ¯ï¼ˆé™¤é <code>allowCoreThreadTimeOut = true</code>ï¼‰</td>
</tr>
<tr>
<td><code>maximumPoolSize</code></td>
<td><strong>æœ€å¤§çº¿ç¨‹æ•°</strong>ï¼Œçº¿ç¨‹æ± èƒ½å®¹çº³çš„æœ€å¤§çº¿ç¨‹æ•°é‡ï¼ˆåŒ…æ‹¬æ ¸å¿ƒçº¿ç¨‹ï¼‰</td>
</tr>
<tr>
<td><code>keepAliveTime</code></td>
<td><strong>éæ ¸å¿ƒ(ä¸´æ—¶)çº¿ç¨‹çš„å­˜æ´»æ—¶é—´</strong>ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œç©ºé—²çš„çº¿ç¨‹ä¼šè¢«å›æ”¶</td>
</tr>
<tr>
<td><code>unit</code></td>
<td><strong>æ—¶é—´å•ä½</strong>ï¼Œ<code>keepAliveTime</code> çš„æ—¶é—´å•ä½ï¼Œå¦‚ï¼šç§’ï¼ˆ<code>TimeUnit.SECONDS</code>ï¼‰</td>
</tr>
<tr>
<td><code>workQueue</code></td>
<td><strong>ä»»åŠ¡(é˜»å¡)é˜Ÿåˆ—</strong>ï¼Œç”¨äºç¼“å­˜æäº¤ä½†å°šæœªæ‰§è¡Œçš„ä»»åŠ¡ï¼ˆå¦‚ï¼š<code>ArrayBlockingQueue</code>ã€<code>LinkedBlockingQueue</code>ï¼‰</td>
</tr>
<tr>
<td><code>threadFactory</code></td>
<td><strong>çº¿ç¨‹å·¥å‚</strong>ï¼Œç”¨äºè‡ªå®šä¹‰çº¿ç¨‹åˆ›å»ºï¼ˆå¯ä»¥è®¾ç½®çº¿ç¨‹åç§°ã€æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ç­‰ï¼‰</td>
</tr>
<tr>
<td><code>handler</code></td>
<td><strong>æ‹’ç»ç­–ç•¥</strong>ï¼Œå½“ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ä¸”çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°æ—¶çš„å¤„ç†æ–¹å¼ï¼›(æŠ›ä¸æŠ›å¼‚å¸¸â€¦)</td>
</tr>
</tbody></table>
</blockquote>
<p>æ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ã€çº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹çš„æœ€å¤§ä¸ªæ•°(æ ¸å¿ƒ+éæ ¸å¿ƒ[ä¸´æ—¶çº¿ç¨‹])ã€ä¸´æ—¶çº¿ç¨‹å­˜æ´»æ—¶é—´ã€æ—¶é—´å•ä½ã€é˜»å¡é˜Ÿåˆ—ã€çº¿ç¨‹å·¥å‚(æŒ‡å®šçº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹çš„å‘½å)ã€æ‹’ç»ç­–ç•¥<br><u>çº¿ç¨‹å·¥å‚å¯ä»¥è®¾ç½®åˆ›å»ºçš„å±æ€§</u>ï¼š<br><strong>å®ˆæŠ¤çº¿ç¨‹</strong>ï¼šä¸»çº¿ç¨‹(main)ä¸€å¤©ä¸æ­» å®ˆæŠ¤çº¿ç¨‹ä¸æ­» [åŒç”Ÿå…±æ­»]<br><strong>éå®ˆæŠ¤çº¿ç¨‹</strong>ï¼šnewä¸€ä¸ªå°±æ˜¯ [ä¸æ˜¯åŒç”Ÿå…±æ­»]</p>
<p><u>é˜»å¡é˜Ÿåˆ—å¸¸ç”¨çš„é˜Ÿåˆ—</u>ï¼š</p>
<ol>
<li><strong>ArrayBlockingQueue</strong>ï¼š åŸºäºæ•°ç»„ç»“æ„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚åˆ›å»ºæ—¶éœ€è¦æŒ‡å®šå®¹é‡ã€‚ã€åº•å±‚æ˜¯æ•°ç»„ éšæœºè¯»å†™çš„ **æ—¶é—´å¤æ‚åº¦O(1)**ã€‘<ul>
<li>å¼€è¾Ÿæ–°ç©ºé—´åˆ›å»ºæ–°æ•°ç»„ æŠŠæ—§æ•°ç»„çš„æ•°æ®è¿ç§»è¿‡å»   <strong>new ArrayList</strong>ä¸ºç©º éœ€è¦addæ‰å¯ä»¥ <u>æ‰©å®¹æ˜¯+10 å–1.5å€</u></li>
<li>é«˜å¹¶å‘ä¸ä¼šè¶…è¿‡æŸä¸ªå€¼ æ•°ç»„ä¸ä¼šæ¶‰åŠåˆ°æ‰©å®¹ æ€§èƒ½ä¼šå¥½ä¸€äº›ã€æ¯”è¾ƒç¨³å®šèƒ½é¢„ä¼°ã€‘</li>
<li>newçš„æ—¶å€™ä¸ç”¨æŒ‡å®šé•¿åº¦</li>
</ul>
</li>
<li><strong>LinkedBlockingQueue</strong>ï¼š åŸºäºé“¾è¡¨ç»“æ„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼ˆå¦‚æœä¸æŒ‡å®šå®¹é‡ï¼Œåˆ™é»˜è®¤ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå³è§†ä¸ºæ— ç•Œï¼‰ã€‚æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„åŸåˆ™æ’åºå…ƒç´ ã€‚ã€éšæœºè¯»å†™çš„ <strong>æ—¶é—´å¤æ‚åº¦O(n)</strong> éšæœºè¯»å†™å¿«  æŸ¥è¯¢æ…¢ æ˜¯é€šè¿‡äºŒåˆ†æŸ¥æ‰¾å®šä½åˆ°ä¸‹æ ‡å…ƒç´ (é€šè¿‡ä¸‹æ ‡è®¿é—®æ•°ç»„å’Œé“¾è¡¨) åªä¼šèµ°ä¸€æ¬¡äºŒåˆ†æŸ¥æ‰¾ã€‘<ul>
<li>è¯»ä¸­é—´çš„æ…¢ è¯»å¤´å°¾å¿«</li>
<li>æ–°å¢å…ƒç´ ä¸æ¶‰åŠåˆ°æ•°ç»„çš„è¿ç§»</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹é«˜å¹¶å‘æ¨èä½¿ç”¨ï¼Œå› ä¸ºé˜Ÿåˆ—<del>é«˜çº§æ•°æ®ç»“æ„</del>(å¯ä»¥ç”¨æ•°ç»„å’Œé“¾è¡¨çš„å®ç° ç”±äºåº•å±‚æ•°æ®ç»“æ„ä¸åŒ)çš„ç‰¹æ€§æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œé“¾è¡¨ä¸æ¶‰åŠåˆ°æ•°ç»„çš„æ‰©å®¹ æœ«å°¾çš„æœ€å¿«æ˜¯O(1)ã€ä¸ç¨³å®šã€‘</li>
<li>newçš„æ—¶å€™å¯æŒ‡å®šé•¿åº¦æ˜¯æœ€å¤§é“¾è¡¨çš„é•¿åº¦               </li>
<li>ä¸å¯æŒ‡å®šé•¿åº¦ [æœ‰ç•Œé˜Ÿåˆ—&amp;æ— ç•Œé˜Ÿåˆ—] â†’ å¯èƒ½äº§ç”ŸJVMçš„OOM</li>
</ul>
</li>
</ol>
<h4 id="çº¿ç¨‹æ± çš„åº”ç”¨è¦æœ‰å®é™…çš„ä¸šåŠ¡åœºæ™¯"><a href="#çº¿ç¨‹æ± çš„åº”ç”¨è¦æœ‰å®é™…çš„ä¸šåŠ¡åœºæ™¯" class="headerlink" title="çº¿ç¨‹æ± çš„åº”ç”¨è¦æœ‰å®é™…çš„ä¸šåŠ¡åœºæ™¯"></a>çº¿ç¨‹æ± çš„åº”ç”¨<del>è¦æœ‰å®é™…çš„ä¸šåŠ¡åœºæ™¯</del></h4><ul>
<li><strong>å¼‚æ­¥ä»»åŠ¡å¤„ç†</strong>ï¼š<u>å°†ä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œ</u>ï¼Œè€Œä¸é˜»å¡ä¸»çº¿ç¨‹</li>
</ul>
<blockquote>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”µå•†å¹³å°ï¼Œå…¶ä¸­ä¸€ä¸ªæ ¸å¿ƒä¸šåŠ¡æ˜¯å¤„ç†ç”¨æˆ·è®¢å•ã€‚åœ¨è®¢å•å¤„ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼š</p>
<ol>
<li><h6 id="éªŒè¯è®¢å•ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šæ£€æŸ¥åº“å­˜ã€éªŒè¯ç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰ã€‚"><a href="#éªŒè¯è®¢å•ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šæ£€æŸ¥åº“å­˜ã€éªŒè¯ç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰ã€‚" class="headerlink" title="éªŒè¯è®¢å•ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šæ£€æŸ¥åº“å­˜ã€éªŒè¯ç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰ã€‚"></a>éªŒè¯è®¢å•ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šæ£€æŸ¥åº“å­˜ã€éªŒè¯ç”¨æˆ·ä¿¡æ¯ç­‰ï¼‰ã€‚</h6></li>
<li><h6 id="è®¡ç®—è®¢å•é‡‘é¢ï¼ˆåŒ…æ‹¬å•†å“ä»·æ ¼ã€æŠ˜æ‰£ã€è¿è´¹ç­‰ï¼‰ã€‚"><a href="#è®¡ç®—è®¢å•é‡‘é¢ï¼ˆåŒ…æ‹¬å•†å“ä»·æ ¼ã€æŠ˜æ‰£ã€è¿è´¹ç­‰ï¼‰ã€‚" class="headerlink" title="è®¡ç®—è®¢å•é‡‘é¢ï¼ˆåŒ…æ‹¬å•†å“ä»·æ ¼ã€æŠ˜æ‰£ã€è¿è´¹ç­‰ï¼‰ã€‚"></a>è®¡ç®—è®¢å•é‡‘é¢ï¼ˆåŒ…æ‹¬å•†å“ä»·æ ¼ã€æŠ˜æ‰£ã€è¿è´¹ç­‰ï¼‰ã€‚</h6></li>
<li><h6 id="ç”Ÿæˆè®¢å•å¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚"><a href="#ç”Ÿæˆè®¢å•å¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚" class="headerlink" title="ç”Ÿæˆè®¢å•å¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚"></a>ç”Ÿæˆè®¢å•å¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚</h6></li>
<li><h6 id="å‘é€è®¢å•ç¡®è®¤é‚®ä»¶ç»™ç”¨æˆ·ã€‚"><a href="#å‘é€è®¢å•ç¡®è®¤é‚®ä»¶ç»™ç”¨æˆ·ã€‚" class="headerlink" title="å‘é€è®¢å•ç¡®è®¤é‚®ä»¶ç»™ç”¨æˆ·ã€‚"></a>å‘é€è®¢å•ç¡®è®¤é‚®ä»¶ç»™ç”¨æˆ·ã€‚</h6></li>
</ol>
<p>ç”±äºè¿™äº›ä»»åŠ¡ç›¸å¯¹ç‹¬ç«‹ï¼Œå¹¶ä¸”å¤„ç†æ—¶é—´å¯èƒ½è¾ƒé•¿ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸å½±å“ç”¨æˆ·æ“ä½œçš„å‰æä¸‹å¼‚æ­¥æ‰§è¡Œå®ƒä»¬ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨çº¿ç¨‹æ± å¤„ç†è¿™äº›å¼‚æ­¥ä»»åŠ¡çš„æ¨¡æ‹Ÿä»£ç ï¼š</p>
<pre><code class="java">import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

class Order &#123;
    // è®¢å•ä¿¡æ¯
    private String orderId;
    private String userId;
    private double amount;

    // æ„é€ å‡½æ•°ã€getterå’Œsetterçœç•¥
&#125;

class OrderService &#123;
    private ExecutorService executorService = Executors.newFixedThreadPool(10); // å‡è®¾çº¿ç¨‹æ± å¤§å°ä¸º10

    // å¤„ç†è®¢å•
    public void processOrder(Order order) &#123;
        // 1. éªŒè¯è®¢å•ä¿¡æ¯
        executorService.submit(() -&gt; &#123;
            System.out.println(&quot;éªŒè¯è®¢å•ä¿¡æ¯: &quot; + order.getOrderId());
            // å‡è®¾éªŒè¯æˆåŠŸ
        &#125;);

        // 2. è®¡ç®—è®¢å•é‡‘é¢
        executorService.submit(() -&gt; &#123;
            System.out.println(&quot;è®¡ç®—è®¢å•é‡‘é¢: &quot; + order.getOrderId());
            // å‡è®¾è®¡ç®—æˆåŠŸï¼Œè®¾ç½®è®¢å•é‡‘é¢
            order.setAmount(100.0); // ç¤ºä¾‹é‡‘é¢
        &#125;);

        // 3. ç”Ÿæˆè®¢å•å¹¶ä¿å­˜åˆ°æ•°æ®åº“
        executorService.submit(() -&gt; &#123;
            System.out.println(&quot;ç”Ÿæˆè®¢å•å¹¶ä¿å­˜åˆ°æ•°æ®åº“: &quot; + order.getOrderId());
            // å‡è®¾ä¿å­˜æˆåŠŸ
        &#125;);

        // 4. å‘é€è®¢å•ç¡®è®¤é‚®ä»¶
        executorService.submit(() -&gt; &#123;
            System.out.println(&quot;å‘é€è®¢å•ç¡®è®¤é‚®ä»¶: &quot; + order.getOrderId());
            // å‡è®¾é‚®ä»¶å‘é€æˆåŠŸ
        &#125;);
    &#125;

    // å…³é—­çº¿ç¨‹æ± 
    public void shutdown() &#123;
        try &#123;
            executorService.shutdown();
            if (!executorService.awaitTermination(60, TimeUnit.SECONDS)) &#123;
                executorService.shutdownNow();
            &#125;
        &#125; catch (InterruptedException e) &#123;
            executorService.shutdownNow();
        &#125;
    &#125;
&#125;

public class ThreadPoolApplication &#123;
    public static void main(String[] args) &#123;
        OrderService orderService = new OrderService();
        Order order = new Order();
        order.setOrderId(&quot;ORDER12345&quot;);
        order.setUserId(&quot;USER12345&quot;);

        // å¤„ç†è®¢å•
        orderService.processOrder(order);

        // å‡è®¾ä¸»çº¿ç¨‹è¿˜æœ‰å…¶ä»–ä»»åŠ¡ï¼Œè¿™é‡Œæ¨¡æ‹Ÿç­‰å¾…å…¶ä»–ä»»åŠ¡å®Œæˆ
        try &#123;
            Thread.sleep(5000); // ç­‰å¾…5ç§’
        &#125; catch (InterruptedException e) &#123;
            e.printStackTrace();
        &#125;

        // å…³é—­çº¿ç¨‹æ± 
        orderService.shutdown();
    &#125;
&#125;
</code></pre>
<p>åœ¨è¿™ä¸ªæ¨¡æ‹Ÿåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª <code>OrderService</code> ç±»ï¼Œå®ƒåŒ…å«ä¸€ä¸ªçº¿ç¨‹æ± ç”¨äºå¼‚æ­¥å¤„ç†è®¢å•çš„å„ä¸ªæ­¥éª¤ã€‚å½“ç”¨æˆ·åˆ›å»ºè®¢å•æ—¶ï¼Œ<code>processOrder</code> æ–¹æ³•ä¼šå°†è®¢å•å¤„ç†çš„å„ä¸ªä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œã€‚è¿™æ ·ï¼Œä¸»çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ï¼Œå¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ç”¨æˆ·è¯·æ±‚æˆ–æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚åœ¨æ‰€æœ‰ä»»åŠ¡éƒ½æäº¤åˆ°çº¿ç¨‹æ± åï¼Œä¸»çº¿ç¨‹å¯èƒ½ä¼šæ‰§è¡Œå…¶ä»–é€»è¾‘ï¼Œæœ€åè°ƒç”¨ <code>shutdown</code> æ–¹æ³•æ¥ä¼˜é›…åœ°å…³é—­çº¿ç¨‹æ± ã€‚</p>
<hr>
<h5 id="çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹å›¾è§£"><a href="#çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹å›¾è§£" class="headerlink" title="çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹å›¾è§£"></a>çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹å›¾è§£</h5><p>å½“ä½ è°ƒç”¨ï¼š</p>
<pre><code class="java">executorService.submit(() -&gt; &#123;
    // ä»»åŠ¡é€»è¾‘
&#125;);
</code></pre>
<p>å®é™…ä¸ŠèƒŒåä¼šè§¦å‘ <code>ThreadPoolExecutor</code> çš„å¦‚ä¸‹å¤„ç†é€»è¾‘ï¼š<strong>çº¿ç¨‹æ± å†…éƒ¨æ‰§è¡Œæµç¨‹</strong></p>
<ol>
<li><strong>æ ¸å¿ƒçº¿ç¨‹æ•°æœªæ»¡</strong>ï¼š<ul>
<li>ç«‹å³åˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†è¯¥ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li><strong>æ ¸å¿ƒçº¿ç¨‹æ•°å·²æ»¡</strong>ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ï¼š<ul>
<li>å°†ä»»åŠ¡æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå¦‚ <code>LinkedBlockingQueue</code>ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡</strong>ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ï¼š<ul>
<li>åˆ¤æ–­å½“å‰çº¿ç¨‹æ•°æ˜¯å¦å°äºæœ€å¤§çº¿ç¨‹æ•°ï¼š<ul>
<li>å¦‚æœå°äºï¼Œåˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›</li>
<li>å¦‚æœç­‰äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œè§¦å‘ <strong>æ‹’ç»ç­–ç•¥</strong>ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>æ‰§è¡Œå®Œæ¯•</strong>çš„çº¿ç¨‹ä¼šå›åˆ°æ± ä¸­ç­‰å¾…ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œ<strong>éæ ¸å¿ƒçº¿ç¨‹åœ¨ç©ºé—²è¶…æ—¶åä¼šè¢«é”€æ¯</strong>ã€‚</li>
</ol>
<h4 id="ç»“åˆä½ çš„ä¸šåŠ¡åœºæ™¯åšè§£æ"><a href="#ç»“åˆä½ çš„ä¸šåŠ¡åœºæ™¯åšè§£æ" class="headerlink" title="ç»“åˆä½ çš„ä¸šåŠ¡åœºæ™¯åšè§£æ"></a>ç»“åˆä½ çš„ä¸šåŠ¡åœºæ™¯åšè§£æ</h4><p>ä½ è¿™ä¸ªè®¢å•åœºæ™¯ä¸­ï¼Œå…±æœ‰ <strong>å››ä¸ªå¼‚æ­¥ä»»åŠ¡</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ­¥éª¤</th>
<th>ä»»åŠ¡åç§°</th>
<th>æ˜¯å¦å¿…é¡»é¡ºåº</th>
<th>æ˜¯å¦è€—æ—¶</th>
</tr>
</thead>
<tbody><tr>
<td>â‘ </td>
<td>éªŒè¯è®¢å•</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>â‘¡</td>
<td>è®¡ç®—é‡‘é¢</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>â‘¢</td>
<td>å†™å…¥æ•°æ®åº“</td>
<td>å¦ï¼ˆæœ‰ä¾èµ–ï¼‰</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>â‘£</td>
<td>å‘é€ç¡®è®¤é‚®ä»¶</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
</tbody></table>
<blockquote>
<p>â€œä¸ä¸€å®šå¿…é¡»é¡ºåºâ€ï¼Œæ˜¯åŸºäº<strong>â€œçº¿ç¨‹æ± å¼‚æ­¥ä»»åŠ¡â€ çš„å¹¶å‘è§’åº¦</strong>è€Œè¨€çš„ â€”â€” å¦‚æœæŸäº›ä»»åŠ¡ä¹‹é—´æ²¡æœ‰ç›´æ¥ä¾èµ–å…³ç³»<strong>ï¼Œé‚£å°±å¯ä»¥å¹¶å‘å¼‚æ­¥æ‰§è¡Œï¼Œæé«˜æ•ˆç‡ã€‚</strong></p>
<p>ä½†æ˜¯ä½ æŒ‡å‡ºäº†ä¸€ä¸ªå…³é”®ç‚¹ï¼šè¿™ä¸ªåœºæ™¯ä¸­æ¯ä¸ªæ­¥éª¤å…¶å®<strong>æ˜¯æœ‰ä¾èµ–å…³ç³»</strong>çš„ï¼Œè¿™ç§é¡ºåºæ€§æ˜¯ä¸šåŠ¡é€»è¾‘æ‰€è¦æ±‚çš„ï¼Œ<strong>ä¸æ˜¯çº¿ç¨‹æ± å¯ä»¥éšæ„æ‰“ä¹±çš„</strong>ï¼</p>
</blockquote>
<p>âœ… è¿™æ­£æ˜¯çº¿ç¨‹æ± æœ€é€‚ç”¨çš„åœºæ™¯ï¼š<strong>ä»»åŠ¡ç‹¬ç«‹ &#x2F; å¯å¹¶è¡Œå¤„ç† &#x2F; éœ€è¦èŠ‚çœå“åº”æ—¶é—´</strong></p>
<h3 id="ğŸ§ -æ‰€ä»¥åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œçº¿ç¨‹æ± çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼åº”è¯¥æ˜¯ï¼š"><a href="#ğŸ§ -æ‰€ä»¥åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œçº¿ç¨‹æ± çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼åº”è¯¥æ˜¯ï¼š" class="headerlink" title="ğŸ§  æ‰€ä»¥åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œçº¿ç¨‹æ± çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼åº”è¯¥æ˜¯ï¼š"></a>ğŸ§  æ‰€ä»¥åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œçº¿ç¨‹æ± çš„<strong>æ­£ç¡®ä½¿ç”¨æ–¹å¼</strong>åº”è¯¥æ˜¯ï¼š</h3><p>æˆ‘ä»¬ä¸èƒ½æŠŠæ‰€æœ‰ä»»åŠ¡éƒ½ç›´æ¥ä¸¢è¿›çº¿ç¨‹æ±  <strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼Œè€Œåº”è¯¥æ˜¯ï¼š</p>
<pre><code class="yaml">ä¸»çº¿ç¨‹ï¼š
    1. éªŒè¯è®¢å•ï¼ˆåŒæ­¥æ‰§è¡Œï¼‰
    2. è®¡ç®—é‡‘é¢ï¼ˆåŒæ­¥æ‰§è¡Œæˆ–å¼‚æ­¥è®¡ç®—å get() ç­‰å¾…ç»“æœï¼‰
    3. å†™å…¥æ•°æ®åº“ï¼ˆä¾èµ–å‰é¢ä¸¤ä¸ªæˆåŠŸï¼‰
    4. å‘é€ç¡®è®¤é‚®ä»¶ï¼ˆå¯å¼‚æ­¥æ‰§è¡Œï¼‰
</code></pre>
<p>âœ… å…¶ä¸­ <strong>æ­¥éª¤ â‘£ å‘é€é‚®ä»¶</strong> æ˜¯å”¯ä¸€é€‚åˆå¼‚æ­¥æ‰§è¡Œçš„ â€”â€” å®ƒä¸å½±å“ä¸»æµç¨‹ï¼Œå¯ä»¥äº¤ç»™çº¿ç¨‹æ± å¼‚æ­¥å»å‘ã€‚</p>
<p><strong>è®¢å•å¤„ç†æ˜¯æœ‰ä¸¥æ ¼å…ˆåé¡ºåºä¾èµ–çš„</strong>ï¼š</p>
<ul>
<li><strong>éªŒè¯ â†’ é‡‘é¢ â†’ å…¥åº“ â†’ é‚®ä»¶</strong> æ˜¯ä¸€æ¡ä¸»æµç¨‹é“¾ï¼›</li>
<li>çº¿ç¨‹æ±  <strong>ä¸æ˜¯ç”¨æ¥æ‰“ä¹±è¿™ä¸ªé¡ºåºçš„</strong>ï¼Œè€Œæ˜¯ç”¨æ¥ <strong>å¹¶å‘æ‰§è¡Œä¸å½±å“ä¸»æµç¨‹çš„é™„å±ä»»åŠ¡</strong>ï¼ˆå¦‚é‚®ä»¶é€šçŸ¥ã€æ—¥å¿—ã€å¼‚æ­¥æ¨é€ç­‰ï¼‰ï¼›</li>
</ul>
<hr>
<h4 id="ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ï¼š"><a href="#ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ï¼š" class="headerlink" title="ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ï¼š"></a><strong>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ï¼š</strong></h4><ul>
<li>ğŸš€ <strong>æå‡å“åº”é€Ÿåº¦</strong>ï¼šä¸»çº¿ç¨‹å¿«é€Ÿè¿”å›ï¼ˆå¦‚ UI&#x2F;æ¥å£å“åº”ï¼‰ï¼Œè€—æ—¶ä»»åŠ¡äº¤ç»™çº¿ç¨‹æ± å¼‚æ­¥å®Œæˆã€‚</li>
<li>âœ… <strong>é˜²æ­¢çº¿ç¨‹èµ„æºæ»¥ç”¨</strong>ï¼šç›¸æ¯”æ¯ä¸ªä»»åŠ¡éƒ½<code>new Thread()</code>ï¼Œçº¿ç¨‹æ± èƒ½<strong>é‡ç”¨çº¿ç¨‹</strong>ï¼Œé¿å…é¢‘ç¹åˆ›å»º&#x2F;é”€æ¯é€ æˆèµ„æºæµªè´¹ã€‚</li>
<li>ğŸ”’ <strong>çº¿ç¨‹å¤ç”¨ + å¹¶å‘æ§åˆ¶</strong>ï¼šé€šè¿‡è®¾ç½® <code>corePoolSize</code> å’Œ <code>queueCapacity</code> æ§åˆ¶ç³»ç»Ÿè´Ÿè½½ã€‚</li>
</ul>
<pre><code class="java">ExecutorService executorService = new ThreadPoolExecutor(
    5,                // æ ¸å¿ƒçº¿ç¨‹æ•°
    10,               // æœ€å¤§çº¿ç¨‹æ•°
    60,               // éæ ¸å¿ƒçº¿ç¨‹çš„ç©ºé—²å­˜æ´»æ—¶é—´
    TimeUnit.SECONDS,
    new LinkedBlockingQueue&lt;&gt;(100), // é˜Ÿåˆ—é•¿åº¦
    Executors.defaultThreadFactory(),
    new ThreadPoolExecutor.AbortPolicy() // æ‹’ç»ç­–ç•¥
);
</code></pre>
<h4 id="ğŸ¯-å‚æ•°å¦‚ä½•é€‰æ‹©ï¼š"><a href="#ğŸ¯-å‚æ•°å¦‚ä½•é€‰æ‹©ï¼š" class="headerlink" title="ğŸ¯ å‚æ•°å¦‚ä½•é€‰æ‹©ï¼š"></a>ğŸ¯ å‚æ•°å¦‚ä½•é€‰æ‹©ï¼š</h4><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>é€‰å‹å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td>corePoolSize</td>
<td>å¯è®¾ä¸ºCPUæ ¸å¿ƒæ•°æˆ–ç¨é«˜ï¼Œå¦‚ <code>Runtime.getRuntime().availableProcessors()</code></td>
</tr>
<tr>
<td>maximumPoolSize</td>
<td>è§†ä»»åŠ¡å¤æ‚åº¦ã€å“åº”æ—¶é—´ç­‰å†³å®šï¼Œé€šå¸¸ä¸ºæ ¸å¿ƒæ•°çš„ 2~3 å€ <strong>2N+1</strong></td>
</tr>
<tr>
<td>queueCapacity</td>
<td>é€‚åˆä½¿ç”¨æœ‰é™é˜Ÿåˆ—ï¼ˆå¦‚100ï¼‰ï¼Œé¿å…OOM</td>
</tr>
<tr>
<td>keepAliveTime</td>
<td>ä¸€èˆ¬è®¾ç½® 30~60 ç§’</td>
</tr>
<tr>
<td>æ‹’ç»ç­–ç•¥</td>
<td>å»ºè®®ä½¿ç”¨ <code>CallerRunsPolicy</code> æˆ–è‡ªå®šä¹‰ç­–ç•¥</td>
</tr>
</tbody></table>
<h5 id="ä»€ä¹ˆæ—¶å€™ä¸è¯¥ç”¨çº¿ç¨‹æ± ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä¸è¯¥ç”¨çº¿ç¨‹æ± ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä¸è¯¥ç”¨çº¿ç¨‹æ± ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä¸è¯¥ç”¨çº¿ç¨‹æ± ï¼Ÿ</h5><p>è™½ç„¶çº¿ç¨‹æ± éå¸¸å¥½ï¼Œä½†åœ¨è¿™äº›æƒ…å†µä¸‹åº”è¯¥æ…ç”¨ï¼š</p>
<table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>å»ºè®®æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td>ä»»åŠ¡è½»é‡ã€ä½é¢‘</td>
<td>å¯ç›´æ¥ new Thread</td>
</tr>
<tr>
<td>ä»»åŠ¡è€—æ—¶ä¸¥é‡ã€ä¸ç¡®å®šæ€§é«˜</td>
<td>å¯ç”¨å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—æˆ–é™æµæœºåˆ¶æ›¿ä»£</td>
</tr>
<tr>
<td>å¹¶å‘æé«˜ï¼Œè¶…å‡ºç³»ç»Ÿæ‰¿è½½èƒ½åŠ›</td>
<td>åº”åŠ ç†”æ–­ã€é™çº§ã€é˜²æŠ–ç­‰ä¿æŠ¤æœºåˆ¶</td>
</tr>
</tbody></table>
<h5 id="æ€»ç»“çº¿ç¨‹æ± åº”ç”¨åœºæ™¯"><a href="#æ€»ç»“çº¿ç¨‹æ± åº”ç”¨åœºæ™¯" class="headerlink" title="æ€»ç»“çº¿ç¨‹æ± åº”ç”¨åœºæ™¯"></a>æ€»ç»“çº¿ç¨‹æ± åº”ç”¨åœºæ™¯</h5><table>
<thead>
<tr>
<th>åº”ç”¨åœºæ™¯</th>
<th>æ˜¯å¦æ¨è</th>
<th>ç†ç”±è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>âœ… å¼‚æ­¥ä»»åŠ¡</td>
<td>æ¨è</td>
<td>æå‡å“åº”é€Ÿåº¦ï¼Œé‡Šæ”¾ä¸»çº¿ç¨‹</td>
</tr>
<tr>
<td>âœ… æ•°æ®æ±‡æ€»</td>
<td>æ¨è</td>
<td>å¤šæ¥å£å¹¶è¡Œè°ƒç”¨ã€åŠ é€Ÿç»“æœæ”¶æ•›</td>
</tr>
<tr>
<td>âœ… å®šæ—¶æ‰¹å¤„ç†ä»»åŠ¡</td>
<td>æ¨è</td>
<td>æ¯”å¦‚å®šæ—¶æ‹‰å–ã€å¯¼å…¥æ•°æ®ã€åˆ†æ®µåˆ†é¡µå¹¶å‘å¤„ç†ç­‰</td>
</tr>
<tr>
<td>âŒ é«˜é¢‘IOé•¿è€—æ—¶ä»»åŠ¡</td>
<td>æ…ç”¨</td>
<td>åº”è€ƒè™‘æ¶ˆæ¯é˜Ÿåˆ—+å¼‚æ­¥æ¶ˆè´¹ï¼Œé¿å…çº¿ç¨‹è¢«é•¿æ—¶é—´å ç”¨</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="ä½ å•ç‹¬éƒ¨ç½²è¿‡é¡¹ç›®å—ï¼Ÿ"><a href="#ä½ å•ç‹¬éƒ¨ç½²è¿‡é¡¹ç›®å—ï¼Ÿ" class="headerlink" title="ä½ å•ç‹¬éƒ¨ç½²è¿‡é¡¹ç›®å—ï¼Ÿ"></a>ä½ å•ç‹¬éƒ¨ç½²è¿‡é¡¹ç›®å—ï¼Ÿ</h4><p>å‰ç«¯æ‰“åŒ…ngé…ç½®æ–‡ä»¶<br>gitæ‰€æœ‰äººéƒ½ç”¨ éœ€è¦æ‹‰åˆ†æ”¯ mavenæ‰“åŒ…åç«¯ åŒ…æ”¾åˆ°è¿œç¨‹æœåŠ¡å™¨ java -jar å¯åŠ¨ï¼ã€ä¸åº”è¯¥æœ‰äººå»åšã€‘<br>æœ‰ä¸“é—¨å·¥å…·å»æµæ°´çº¿åˆ¶ä½œ â†’ <strong>Jenkins</strong>æ˜¯ä¸€ä¸ªå¼€æºçš„è‡ªåŠ¨åŒ–æœåŠ¡å™¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ‚¨å®ç°è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²é¡¹ç›®   <strong><u>JenKins + docker åšè‡ªåŠ¨åŒ–éƒ¨ç½²</u></strong><br>éƒ¨ç½²æ˜¯å»ºç«‹æœ¬åœ°çš„é¡¹ç›®å†æ¨åˆ°æœåŠ¡å™¨</p>
<blockquote>
<p><strong>å®‰è£… Docker</strong>ï¼šç¡®ä¿ä½ çš„éƒ¨ç½²æœåŠ¡å™¨ä¸Šå®‰è£…äº† Dockerã€‚<br><strong>å®‰è£… Jenkins</strong>ï¼šå¯ä»¥é€šè¿‡ Docker å®‰è£… Jenkinsï¼Œæˆ–è€…ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…ã€‚</p>
<h4 id="æ­¥éª¤-1ï¼šå®‰è£…-Jenkins-å’Œ-Docker"><a href="#æ­¥éª¤-1ï¼šå®‰è£…-Jenkins-å’Œ-Docker" class="headerlink" title="æ­¥éª¤ 1ï¼šå®‰è£… Jenkins å’Œ Docker"></a>æ­¥éª¤ 1ï¼šå®‰è£… Jenkins å’Œ Docker</h4><p>ç¡®ä¿ Jenkins å’Œ Docker åœ¨æœåŠ¡å™¨ä¸Šéƒ½å·²ç»å®‰è£…å¹¶è¿è¡Œã€‚</p>
<h4 id="æ­¥éª¤-2ï¼šé…ç½®-Jenkins"><a href="#æ­¥éª¤-2ï¼šé…ç½®-Jenkins" class="headerlink" title="æ­¥éª¤ 2ï¼šé…ç½® Jenkins"></a>æ­¥éª¤ 2ï¼šé…ç½® Jenkins</h4><ol>
<li><p><strong>å¯åŠ¨ Jenkins</strong>ï¼š</p>
<p>ä½¿ç”¨ Docker å¯åŠ¨ Jenkinsï¼š</p>
<pre><code>docker run -d --name jenkins -p 8080:8080 -p 50000:50000 jenkins/jenkins:lts
</code></pre>
</li>
<li><p><strong>è®¿é—® Jenkins</strong>ï¼šåœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>http://&lt;æœåŠ¡å™¨åœ°å€&gt;:8080</code>ï¼Œå¹¶æŒ‰ç…§æŒ‡ç¤ºå®Œæˆ Jenkins çš„åˆå§‹è®¾ç½®ã€‚</p>
</li>
<li><p><strong>å®‰è£…å¿…è¦çš„æ’ä»¶</strong>ï¼šå®‰è£… Dockerã€Git ç­‰ç›¸å…³æ’ä»¶ã€‚</p>
</li>
</ol>
<h4 id="æ­¥éª¤-3ï¼šåˆ›å»º-Jenkins-ä»»åŠ¡"><a href="#æ­¥éª¤-3ï¼šåˆ›å»º-Jenkins-ä»»åŠ¡" class="headerlink" title="æ­¥éª¤ 3ï¼šåˆ›å»º Jenkins ä»»åŠ¡"></a>æ­¥éª¤ 3ï¼šåˆ›å»º Jenkins ä»»åŠ¡</h4><ol>
<li><p><strong>æ–°å»ºä»»åŠ¡</strong>ï¼šåœ¨ Jenkins ä¸»é¡µä¸Šï¼Œç‚¹å‡»â€œæ–°å»ºä»»åŠ¡â€ã€‚</p>
</li>
<li><p><strong>é…ç½®æºç ç®¡ç†</strong>ï¼šé…ç½® Git ä»“åº“åœ°å€ã€‚</p>
</li>
<li><p><strong>é…ç½®æ„å»ºè§¦å‘å™¨</strong>ï¼šé€‰æ‹©åˆé€‚çš„è§¦å‘å™¨ã€‚</p>
</li>
<li><p><strong>é…ç½®æ„å»ºç¯å¢ƒ</strong>ï¼šå‹¾é€‰â€œBuild inside a Docker containerâ€ã€‚</p>
</li>
<li><p><strong>æ·»åŠ æ„å»ºæ­¥éª¤</strong>ï¼š</p>
<ul>
<li><p><strong>æ‰§è¡Œ Shell</strong>ï¼š</p>
<pre><code>docker build -t myapp .
</code></pre>
</li>
</ul>
</li>
<li><p><strong>æ·»åŠ æ„å»ºåæ“ä½œ</strong>ï¼š</p>
<ul>
<li><p><strong>Push built image</strong>ï¼šå¦‚æœéœ€è¦å°†é•œåƒæ¨é€åˆ° Docker ä»“åº“ï¼Œå¡«å†™ä»“åº“ä¿¡æ¯ã€‚</p>
</li>
<li><p><strong>æ‰§è¡Œ Shell</strong>ï¼š</p>
<pre><code>docker stop myapp || true
docker rm myapp || true
docker run -d --name myapp -p 8080:8080 myapp
</code></pre>
</li>
</ul>
</li>
</ol>
<h4 id="æ­¥éª¤-4ï¼šæ‰§è¡Œæ„å»º"><a href="#æ­¥éª¤-4ï¼šæ‰§è¡Œæ„å»º" class="headerlink" title="æ­¥éª¤ 4ï¼šæ‰§è¡Œæ„å»º"></a>æ­¥éª¤ 4ï¼šæ‰§è¡Œæ„å»º</h4><p>ä¿å­˜é…ç½®åï¼Œå¯ä»¥æ‰‹åŠ¨è§¦å‘æ„å»ºæˆ–è€…ç­‰å¾…è§¦å‘å™¨è‡ªåŠ¨æ‰§è¡Œæ„å»ºã€‚</p>
<h4 id="æ­¥éª¤-5ï¼šéªŒè¯éƒ¨ç½²"><a href="#æ­¥éª¤-5ï¼šéªŒè¯éƒ¨ç½²" class="headerlink" title="æ­¥éª¤ 5ï¼šéªŒè¯éƒ¨ç½²"></a>æ­¥éª¤ 5ï¼šéªŒè¯éƒ¨ç½²</h4><p>æ„å»ºå®Œæˆåï¼Œè®¿é—®æœåŠ¡å™¨çš„æŒ‡å®šç«¯å£ï¼ˆä¾‹å¦‚ <code>http://&lt;æœåŠ¡å™¨åœ°å€&gt;:8080</code>ï¼‰ï¼ŒéªŒè¯åº”ç”¨æ˜¯å¦æˆåŠŸéƒ¨ç½²ã€‚</p>
</blockquote>
<h4 id="ä½ çš„æœŸæœ›è–ªèµ„ï¼Ÿ"><a href="#ä½ çš„æœŸæœ›è–ªèµ„ï¼Ÿ" class="headerlink" title="ä½ çš„æœŸæœ›è–ªèµ„ï¼Ÿ"></a>ä½ çš„æœŸæœ›è–ªèµ„ï¼Ÿ</h4><p>æˆ‘ç›®å‰çš„è–ªèµ„æ˜¯8000ï¼Œè€ƒè™‘åˆ°æˆ‘å³å°†æ‰¿æ‹…çš„èŒè´£å’Œæˆ‘çš„èŒä¸šå‘å±•ï¼Œæˆ‘æœŸæœ›çš„è–ªèµ„æ˜¯åœ¨ç°æœ‰åŸºç¡€ä¸Šæœ‰æ‰€æå‡ï¼Œå¤§çº¦åœ¨8000åˆ°10000ä¹‹é—´ã€‚å½“ç„¶ï¼Œæˆ‘å¯¹æ•´ä½“çš„è–ªé…¬åŒ…[åŒ…æ‹¬ç¦åˆ©ã€å¥–é‡‘å’ŒèŒä¸šå‘å±•æœºä¼š]ä¹Ÿå¾ˆæ„Ÿå…´è¶£ã€‚è–ªèµ„æ˜¯å¦‚ä½•æ„æˆçš„ï¼ŒåŒ…æ‹¬å›ºå®šå·¥èµ„ã€å¥–é‡‘ã€è‚¡æƒã€ç¦åˆ©ç­‰ã€‚</p>
<h4 id="çº¿ç¨‹æ± åœºæ™¯é¢˜"><a href="#çº¿ç¨‹æ± åœºæ™¯é¢˜" class="headerlink" title="çº¿ç¨‹æ± åœºæ™¯é¢˜"></a>çº¿ç¨‹æ± åœºæ™¯é¢˜</h4><h6 id="æ ¸å¿ƒçº¿ç¨‹æ•°5ä¸ªï¼Œæœ€å¤§çº¿ç¨‹æ•°è®¾ç½®äº†10ä¸ªï¼Œé˜Ÿåˆ—ä¹Ÿè®¾ç½®äº†10ä¸ªï¼Œç°åœ¨æœ‰å¹¶å‘6ä¸ªä»»åŠ¡æ¥ï¼Œçº¿ç¨‹æ± ä¸­æœ‰å¤šå°‘ä¸ªä»»åŠ¡ï¼Ÿ"><a href="#æ ¸å¿ƒçº¿ç¨‹æ•°5ä¸ªï¼Œæœ€å¤§çº¿ç¨‹æ•°è®¾ç½®äº†10ä¸ªï¼Œé˜Ÿåˆ—ä¹Ÿè®¾ç½®äº†10ä¸ªï¼Œç°åœ¨æœ‰å¹¶å‘6ä¸ªä»»åŠ¡æ¥ï¼Œçº¿ç¨‹æ± ä¸­æœ‰å¤šå°‘ä¸ªä»»åŠ¡ï¼Ÿ" class="headerlink" title="æ ¸å¿ƒçº¿ç¨‹æ•°5ä¸ªï¼Œæœ€å¤§çº¿ç¨‹æ•°è®¾ç½®äº†10ä¸ªï¼Œé˜Ÿåˆ—ä¹Ÿè®¾ç½®äº†10ä¸ªï¼Œç°åœ¨æœ‰å¹¶å‘6ä¸ªä»»åŠ¡æ¥ï¼Œçº¿ç¨‹æ± ä¸­æœ‰å¤šå°‘ä¸ªä»»åŠ¡ï¼Ÿ"></a>æ ¸å¿ƒçº¿ç¨‹æ•°5ä¸ªï¼Œæœ€å¤§çº¿ç¨‹æ•°è®¾ç½®äº†10ä¸ªï¼Œé˜Ÿåˆ—ä¹Ÿè®¾ç½®äº†10ä¸ªï¼Œç°åœ¨æœ‰å¹¶å‘6ä¸ªä»»åŠ¡æ¥ï¼Œçº¿ç¨‹æ± ä¸­æœ‰å¤šå°‘ä¸ªä»»åŠ¡ï¼Ÿ</h6><p>åœ¨æ‚¨æè¿°çš„çº¿ç¨‹æ± é…ç½®ä¸‹ï¼Œå½“æœ‰6ä¸ªå¹¶å‘ä»»åŠ¡åˆ°æ¥æ—¶ï¼Œè¿™äº›ä»»åŠ¡çš„å¤„ç†æƒ…å†µå¦‚ä¸‹ï¼š</p>
<ul>
<li>æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯5ï¼Œæ„å‘³ç€çº¿ç¨‹æ± ä¼šé¦–å…ˆåˆ›å»º5ä¸ªçº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚</li>
<li>å½“ç¬¬6ä¸ªä»»åŠ¡åˆ°æ¥æ—¶ï¼Œç”±äºæ ¸å¿ƒçº¿ç¨‹éƒ½åœ¨å¿™ï¼Œçº¿ç¨‹æ± ä¼šå°†è¿™ä¸ªä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œå› ä¸ºé˜Ÿåˆ—çš„å¤§å°ä¹Ÿæ˜¯10ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æ± ä¸­ä¼šæœ‰6ä¸ªä»»åŠ¡ï¼š<strong>5ä¸ªä»»åŠ¡æ­£åœ¨è¢«5ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„ç†ï¼Œå¦å¤–1ä¸ªä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…</strong>ã€‚çº¿ç¨‹æ± å¹¶æ²¡æœ‰è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°10ä¸ªï¼Œå› ä¸ºå½“å‰çš„ä»»åŠ¡æ•°é‡å’Œé˜Ÿåˆ—å®¹é‡è¿˜æœªè¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°å’Œé˜Ÿåˆ—çš„æ€»å’Œã€‚</p>
<blockquote>
<p>åœ¨æ‚¨æä¾›çš„çº¿ç¨‹æ± é…ç½®ä¸‹ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°5ä¸ªï¼Œæœ€å¤§çº¿ç¨‹æ•°10ä¸ªï¼Œé˜Ÿåˆ—å®¹é‡10ä¸ªï¼‰ï¼Œå½“6ä¸ªå¹¶å‘ä»»åŠ¡åˆ°æ¥æ—¶ï¼Œçº¿ç¨‹æ± ä¸ä¼šç«‹å³åˆ›å»º10ä¸ªçº¿ç¨‹ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>æ ¸å¿ƒçº¿ç¨‹æ•°ä¼˜å…ˆ</strong>ï¼šçº¿ç¨‹æ± é¦–å…ˆä¼šä½¿ç”¨æ ¸å¿ƒçº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯5ï¼Œæ‰€ä»¥å‰5ä¸ªä»»åŠ¡ä¼šåˆ†åˆ«ç”±5ä¸ªæ ¸å¿ƒçº¿ç¨‹æ¥å¤„ç†ã€‚</li>
<li><strong>é˜Ÿåˆ—ç¼“å†²</strong>ï¼šå½“æ ¸å¿ƒçº¿ç¨‹éƒ½åœ¨å¿™ç¢Œæ—¶ï¼Œé¢å¤–çš„ä»»åŠ¡ä¼šè¢«æ”¾å…¥é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œè€Œä¸æ˜¯ç«‹å³åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚æ‚¨çš„é˜Ÿåˆ—å®¹é‡æ˜¯10ï¼Œè¶³ä»¥å®¹çº³å½“å‰çš„ç¬¬6ä¸ªä»»åŠ¡ã€‚</li>
<li><strong>æŒ‰éœ€åˆ›å»ºçº¿ç¨‹</strong>ï¼šçº¿ç¨‹æ± ä¼šæ ¹æ®ä»»åŠ¡çš„å¤„ç†é€Ÿåº¦å’Œé˜Ÿåˆ—çš„é¥±å’Œåº¦æ¥å†³å®šæ˜¯å¦éœ€è¦åˆ›å»ºè¶…å‡ºæ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ã€‚åœ¨æ‚¨çš„ä¾‹å­ä¸­ï¼Œå°½ç®¡æœ‰6ä¸ªå¹¶å‘ä»»åŠ¡ï¼Œä½†é˜Ÿåˆ—è¿˜æœªæ»¡ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦åˆ›å»ºé¢å¤–çš„çº¿ç¨‹ã€‚</li>
<li><strong>æœ€å¤§çº¿ç¨‹æ•°é™åˆ¶</strong>ï¼šæœ€å¤§çº¿ç¨‹æ•°æ˜¯çº¿ç¨‹æ± å¯ä»¥åˆ›å»ºçš„çº¿ç¨‹æ•°é‡çš„ä¸Šé™ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€çº¿ç¨‹æ± ä¼šä¸€å¼€å§‹å°±åˆ›å»ºåˆ°è¿™ä¸ªä¸Šé™ã€‚åªæœ‰å½“é˜Ÿåˆ—æ»¡äº†ï¼Œä¸”è¿˜æœ‰æ–°çš„ä»»åŠ¡åˆ°æ¥æ—¶ï¼Œçº¿ç¨‹æ± æ‰ä¼šåˆ›å»ºé¢å¤–çš„çº¿ç¨‹ï¼ˆæœ€å¤šè¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°ï¼‰æ¥å¤„ç†è¿™äº›ä»»åŠ¡ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œåœ¨æ‚¨çš„åœºæ™¯ä¸­ï¼Œå½“6ä¸ªå¹¶å‘ä»»åŠ¡åˆ°æ¥æ—¶ï¼Œçº¿ç¨‹æ± çš„æ“ä½œæ˜¯ï¼š</p>
<ul>
<li>5ä¸ªæ ¸å¿ƒçº¿ç¨‹å„è‡ªå¤„ç†ä¸€ä¸ªä»»åŠ¡ã€‚</li>
<li>ç¬¬6ä¸ªä»»åŠ¡è¢«æ”¾å…¥é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</li>
</ul>
<p>æ­¤æ—¶ï¼Œçº¿ç¨‹æ± ä¸­åªæœ‰5ä¸ªçº¿ç¨‹åœ¨è¿è¡Œï¼Œé˜Ÿåˆ—ä¸­æœ‰1ä¸ªä»»åŠ¡ï¼Œæ€»å…±6ä¸ªä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¸ä¼šåˆ›å»ºé¢å¤–çš„çº¿ç¨‹ï¼Œå› ä¸ºå½“å‰çš„ä»»åŠ¡æ•°é‡è¿˜æœªè¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°å’Œé˜Ÿåˆ—çš„æ€»å®¹é‡ã€‚åªæœ‰å½“é˜Ÿåˆ—æ»¡äº†ï¼ˆå³æœ‰10ä¸ªä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­ï¼‰ï¼Œä¸”è¿˜æœ‰æ–°çš„ä»»åŠ¡åˆ°æ¥æ—¶ï¼Œçº¿ç¨‹æ± æ‰ä¼šè€ƒè™‘åˆ›å»ºé¢å¤–çš„çº¿ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°10ä¸ªã€‚</p>
</blockquote>
<h4 id="getè¯·æ±‚å’Œpostè¯·æ±‚çš„åŒºåˆ«"><a href="#getè¯·æ±‚å’Œpostè¯·æ±‚çš„åŒºåˆ«" class="headerlink" title="getè¯·æ±‚å’Œpostè¯·æ±‚çš„åŒºåˆ«"></a>getè¯·æ±‚å’Œpostè¯·æ±‚çš„åŒºåˆ«</h4><h6 id="getè¯·æ±‚"><a href="#getè¯·æ±‚" class="headerlink" title="getè¯·æ±‚"></a>getè¯·æ±‚</h6><ul>
<li>è¯·æ±‚æŒ‡å®šçš„èµ„æºã€‚ä½¿ç”¨GETçš„ç›®çš„æ˜¯è·å–æ•°æ®ï¼Œ</li>
<li>æ•°æ®åœ¨URLä¸­ä¼ è¾“ï¼Œé€šè¿‡å°†æ•°æ®é™„åœ¨<strong>URL</strong>ä¹‹åï¼Œä»¥æŸ¥è¯¢å­—ç¬¦ä¸²çš„å½¢å¼å‡ºç°</li>
<li>ç”±äºæ•°æ®åœ¨URLä¸­å¯è§ï¼Œå› æ­¤å®‰å…¨æ€§è¾ƒä½ï¼Œ<u>æ•æ„Ÿæ•°æ®ä¸åº”é€šè¿‡è¿‡GETè¯·æ±‚å‘é€</u></li>
<li>URLé•¿åº¦é™åˆ¶é€šå¸¸åœ¨<strong>2000ä¸ªå­—ç¬¦</strong>å·¦å³ï¼Œè¿™æ„å‘³ç€GETè¯·æ±‚èƒ½å¤Ÿä¼ è¾“çš„æ•°æ®æœ‰é™</li>
<li><strong>å¯ä»¥è¢«ç¼“å­˜</strong>ï¼Œä¹Ÿä¼šè¢«æµè§ˆå™¨ä¿å­˜åœ¨å†å²è®°å½•ä¸­</li>
<li>å¸¸ç”¨äº<strong>ä¿¡æ¯æŸ¥è¯¢ã€æ•°æ®æ£€ç´¢</strong>ç­‰æ“ä½œ.</li>
</ul>
<h6 id="postè¯·æ±‚"><a href="#postè¯·æ±‚" class="headerlink" title="postè¯·æ±‚"></a>postè¯·æ±‚</h6><ul>
<li>å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚(ä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶)ã€‚æ•°æ®è¢«åŒ…å«åœ¨<strong>è¯·æ±‚ä½“</strong>ä¸­ã€‚</li>
<li>æ•°æ®å­˜å‚¨åœ¨è¯·æ±‚ä½“(HTTPæ¶ˆæ¯ä¸»ä½“)ä¸­ï¼Œä¸ä¼šå¯†åœ¨URLä¸Š</li>
<li>æ•°æ®ä¸ä¼šå‡ºç°åœ¨URLä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ï¼Œé€‚åˆä¼ è¾“æ•æ„Ÿä¿¡æ¯ã€‚</li>
<li>ç†è®ºä¸Š<strong>æ²¡æœ‰å¤§å°é™åˆ¶</strong>ï¼Œé€‚ç”¨äºä¼ è¾“å¤§é‡æ•°æ®.</li>
<li><strong>ä¸ä¼šè¢«ç¼“å­˜</strong>ï¼Œä¸”ä¸ä¼šä¿å­˜åœ¨æµè§‰å™¨å†å²è®°å½•ä¸­</li>
<li>å¸¸ç”¨äº<strong>æ•°æ®æäº¤ã€è¡¨å•æäº¤</strong>ç­‰æ“ä½œ</li>
</ul>
<p>è¯·æ±‚è¡Œï¼šè¯·æ±‚ç±»å‹ è¯·æ±‚æ–¹æ³• url httpç‰ˆæœ¬1.1 è€å¼1.0ä¸æ”¯æŒé•¿è¿æ¥<br>è¯·æ±‚å¤´ï¼škey value<br>   <u>å¸¸è§è¯·æ±‚å¤´</u>ï¼š è¯·æ±‚æ•°æ®ç±»å‹ï¼ŒrestfulåŸºäºjson<br><strong>Content-Type</strong>ï¼šä¸Šä¼ æ–‡ä»¶ä¸ç”¨application è¦ç”¨ multipart&#x2F;form-dataâ€<br><strong>Host</strong>ï¼šæŒ‡å®šè¯·æ±‚çš„æœåŠ¡å™¨çš„åŸŸåå’Œç«¯å£å·ã€‚<br><strong>User-Agent</strong>ï¼šåŒ…å«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä»£ç†è½¯ä»¶ä¿¡æ¯ï¼Œé€šå¸¸åŒ…æ‹¬æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬<br>è¯·æ±‚ä½“ï¼šgetè¯·æ±‚å¯ä»¥æœ‰è¯·æ±‚ä½“<br>å“åº”ï¼šå“åº”è¡Œ å“åº”ä½“ çŠ¶æ€ç  æè¿°<br>  <u>å¸¸è§å“åº”å¤´</u>ï¼š<strong>Content-Type</strong>ï¼šè¿”å›æ•°æ®çš„æ ¼å¼   <strong>Content-Length</strong>ï¼šå“åº”ä½“çš„é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½</p>
<p>postè¯·æ±‚ä¹Ÿå¯ä»¥ç”¨é—®å·çš„å½¢å¼æ‹¼æ¥åˆ°æµè§ˆå™¨ ä¹Ÿå¯ä»¥ç”¨è·¯å¾„å‚æ•°</p>
<p>å¾ˆå¤§åŒºåˆ«ï¼šgetä¸€èˆ¬æ”¾åœ¨urlåé¢ ä¼šå±•ç¤ºurlå’Œåé¢å‚æ•° ä¼šæš´éœ²ä¼ å‚éšç§  ç™»å½•æ¥å£ç”¨postæ¥åš æœ‰å¯†ç æ•æ„Ÿä¿¡æ¯<br>è¡¨å•ã€å¯†ç ã€é•¿æ•°æ®ç”¨post ä¸è¿‡æ€•é»‘å®¢æŠ“åŒ… ç›¸å¯¹æ¥è¯´å®‰å…¨<br>getè¯·æ±‚åé¢ä¼ å‚çš„å¤§å°é™åˆ¶ ç†è®ºä¸Šæ²¡æœ‰é™åˆ¶ åªæ˜¯æµè§ˆå™¨å‚å•†ä¼šæœ‰é™åˆ¶<br>getç”¨æ¥æŸ¥è¯¢ postæ–°å¢æäº¤è¡¨å•</p>
<blockquote>
<p>â€œGET å’Œ POST éƒ½æ˜¯ HTTP åè®®ä¸­æœ€å¸¸ç”¨çš„è¯·æ±‚æ–¹å¼ï¼Œæœ€æœ¬è´¨çš„åŒºåˆ«åœ¨äºæ•°æ®ä¼ è¾“çš„ä½ç½®ä¸å¹‚ç­‰æ€§ï¼Œä¸ä»…å½±å“å®‰å…¨æ€§å’Œç¼“å­˜è¡Œä¸ºï¼Œä¹Ÿå…³ç³»åˆ°å®é™…åº”ç”¨åœºæ™¯é€‰æ‹©ã€‚â€</p>
<h3 id="âœ…-GET-ä¸-POST-è¯·æ±‚çš„å¯¹æ¯”æ€»ç»“è¡¨"><a href="#âœ…-GET-ä¸-POST-è¯·æ±‚çš„å¯¹æ¯”æ€»ç»“è¡¨" class="headerlink" title="âœ… GET ä¸ POST è¯·æ±‚çš„å¯¹æ¯”æ€»ç»“è¡¨"></a>âœ… GET ä¸ POST è¯·æ±‚çš„å¯¹æ¯”æ€»ç»“è¡¨</h3><table>
<thead>
<tr>
<th>é¡¹ç›®</th>
<th>GET è¯·æ±‚</th>
<th>POST è¯·æ±‚</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ä½œç”¨</strong></td>
<td>æŸ¥è¯¢èµ„æºï¼ˆè·å–æ•°æ®ï¼‰</td>
<td>æäº¤èµ„æºï¼ˆå‘é€æ•°æ®ï¼‰</td>
</tr>
<tr>
<td><strong>æ•°æ®ä½ç½®</strong></td>
<td>URL å‚æ•°ï¼šæ‹¼æ¥åœ¨ <code>?</code> åé¢ï¼Œå¦‚ <code>/user?id=1</code></td>
<td>è¯·æ±‚ä½“ï¼šæ”¾åœ¨ HTTP è¯·æ±‚ä½“ä¸­</td>
</tr>
<tr>
<td><strong>æ˜¯å¦æ˜¾ç¤ºå‚æ•°</strong></td>
<td>âœ… æ˜¾ç¤ºï¼ˆæš´éœ²åœ¨ URL ä¸­ï¼Œç”¨æˆ·å¯è§ï¼‰</td>
<td>âŒ ä¸æ˜¾ç¤ºï¼ˆéšè—åœ¨ Body ä¸­ï¼‰</td>
</tr>
<tr>
<td><strong>æ˜¯å¦å®‰å…¨</strong></td>
<td>âŒ ä¸å®‰å…¨ï¼ˆæ•æ„Ÿä¿¡æ¯å®¹æ˜“æ³„éœ²ï¼Œå¦‚æ˜æ–‡å¯†ç ï¼‰</td>
<td>âœ… ç›¸å¯¹å®‰å…¨ï¼ˆä½†ä¹Ÿè¦æ³¨æ„é˜²æ­¢æŠ“åŒ…ç­‰é—®é¢˜ï¼‰</td>
</tr>
<tr>
<td><strong>å‚æ•°é•¿åº¦é™åˆ¶</strong></td>
<td>æœ‰é™åˆ¶ï¼ˆç”±æµè§ˆå™¨å’ŒæœåŠ¡å™¨é™åˆ¶ï¼Œä¸€èˆ¬ä¸è¶…è¿‡ 2KBï¼‰</td>
<td>ç†è®ºä¸Šæ— é™åˆ¶ï¼ˆå—æœåŠ¡å™¨é…ç½®å½±å“ï¼‰</td>
</tr>
<tr>
<td><strong>æ˜¯å¦å¯ç¼“å­˜</strong></td>
<td>âœ… å¯ä»¥è¢«ç¼“å­˜</td>
<td>âŒ é»˜è®¤ä¸å¯ç¼“å­˜</td>
</tr>
<tr>
<td><strong>æ˜¯å¦ä¿ç•™å†å²è®°å½•</strong></td>
<td>âœ… ä¼šè¢«æµè§ˆå™¨è®°å½•</td>
<td>âŒ ä¸ä¼šè®°å½•</td>
</tr>
<tr>
<td><strong>æ˜¯å¦èƒ½è¢«æ”¶è—ä¸ºä¹¦ç­¾</strong></td>
<td>âœ… å¯ä»¥ï¼ˆURLå®Œæ•´ï¼‰</td>
<td>âŒ ä¸å»ºè®®ï¼ˆæ²¡æœ‰å®Œæ•´ URL å‚æ•°ï¼‰</td>
</tr>
<tr>
<td><strong>åº”ç”¨åœºæ™¯</strong></td>
<td>æŸ¥è¯¢ã€æ£€ç´¢ã€åˆ—è¡¨å±•ç¤º</td>
<td>æäº¤è¡¨å•ã€ä¸Šä¼ æ–‡ä»¶ã€ç™»å½•ã€æ³¨å†Œ</td>
</tr>
<tr>
<td><strong>è¯·æ±‚å¹‚ç­‰æ€§</strong></td>
<td>âœ… å¹‚ç­‰ï¼ˆå¤šæ¬¡è¯·æ±‚ç»“æœä¸€æ ·ï¼‰</td>
<td>âŒ ä¸ä¸€å®šå¹‚ç­‰ï¼ˆå¤šæ¬¡æäº¤å¯èƒ½åˆ›å»ºå¤šæ¡æ•°æ®ï¼‰</td>
</tr>
<tr>
<td><strong>å¸¸ç”¨è¯·æ±‚å¤´</strong></td>
<td><code>Accept</code>ã€<code>User-Agent</code>ã€<code>Host</code>ã€<code>Authorization</code> ç­‰</td>
<td>é¢å¤–ä½¿ç”¨ï¼š<code>Content-Type</code>ï¼ˆå¦‚ï¼š<code>application/json</code>ã€<code>multipart/form-data</code>ï¼‰</td>
</tr>
<tr>
<td><strong>æ˜¯å¦å¯é™„å¸¦è¯·æ±‚ä½“</strong></td>
<td>âœ… ç†è®ºæ”¯æŒï¼Œä½†ä¸æ¨èä½¿ç”¨ï¼Œå¾ˆå¤šæœåŠ¡ç«¯æ¡†æ¶é»˜è®¤å¿½ç•¥ï¼ˆå¦‚ Spring MVCï¼‰</td>
<td>âœ… æ­£å¸¸ä½¿ç”¨è¯·æ±‚ä½“ï¼ˆBodyï¼‰ä¼ å‚</td>
</tr>
<tr>
<td><strong>æ˜¯å¦æ”¯æŒè·¯å¾„å‚æ•°</strong></td>
<td>âœ… æ”¯æŒï¼Œå¦‚ <code>/user/1</code></td>
<td>âœ… åŒæ ·æ”¯æŒè·¯å¾„å‚æ•°å’Œ query å‚æ•°ï¼ˆä½†å‚æ•°å¤šç”¨ Body ä¼ ï¼‰</td>
</tr>
<tr>
<td><strong>æ˜¯å¦å¯ä»¥æ‹¼æ¥ ? å‚æ•°</strong></td>
<td>âœ… å¸¸ç”¨ï¼Œå¦‚ <code>/api?key=123</code></td>
<td>âœ… ä¹Ÿå¯ä»¥ <code>/api?token=abc</code>ï¼Œä½†æ•°æ®ä¸»ä½“ä¾ç„¶å»ºè®®æ”¾åœ¨è¯·æ±‚ä½“ä¸­</td>
</tr>
<tr>
<td><strong>å¯¹ç¼“å­˜å‹å¥½ç¨‹åº¦</strong></td>
<td>âœ… å‹å¥½ï¼Œå¯è¢«æµè§ˆå™¨ç¼“å­˜ï¼Œä¹Ÿå¯ç”¨äº CDN ç¼“å­˜</td>
<td>âŒ é»˜è®¤ä¸å¯ç¼“å­˜ï¼ˆé™¤éé€šè¿‡å“åº”å¤´æŒ‡å®šï¼‰</td>
</tr>
<tr>
<td><strong>åœ¨ RESTful ä¸­å¸¸ç”¨åœºæ™¯</strong></td>
<td>è·å–èµ„æºï¼Œå¦‚ GET <code>/api/users</code></td>
<td>åˆ›å»ºèµ„æºï¼Œå¦‚ POST <code>/api/users</code>ï¼Œæˆ–æäº¤ç™»å½•ç­‰æ•æ„Ÿæ“ä½œ</td>
</tr>
</tbody></table>
<h3 id="å†·é—¨ä½†å¸¸è€ƒ-amp-å®æˆ˜å¿…å¤‡è€ƒç‚¹"><a href="#å†·é—¨ä½†å¸¸è€ƒ-amp-å®æˆ˜å¿…å¤‡è€ƒç‚¹" class="headerlink" title="å†·é—¨ä½†å¸¸è€ƒ &amp; å®æˆ˜å¿…å¤‡è€ƒç‚¹"></a>å†·é—¨ä½†å¸¸è€ƒ &amp; å®æˆ˜å¿…å¤‡è€ƒç‚¹</h3><table>
<thead>
<tr>
<th>å†·é—¨çŸ¥è¯†ç‚¹ &#x2F; å®æˆ˜ç»éªŒ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>GET è¯·æ±‚ä¹Ÿå¯ä»¥æœ‰è¯·æ±‚ä½“</td>
<td>âœ… <strong>HTTP åè®®å…è®¸</strong>ï¼Œä½†å¾ˆå¤šæ¡†æ¶ï¼ˆå¦‚ Springï¼‰ä¸è§£æï¼Œé»˜è®¤å¿½ç•¥</td>
</tr>
<tr>
<td>POST è¯·æ±‚ä¹Ÿå¯ä»¥æ‹¼æ¥ URL å‚æ•°</td>
<td>âœ… URL å‚æ•°ä¸è¯·æ±‚ä½“å¯åŒæ—¶å­˜åœ¨ï¼Œå¦‚ï¼š<code>POST /api?type=1</code> + body ä¼ å‚</td>
</tr>
<tr>
<td>æµè§ˆå™¨æœ€å¤§ URL é•¿åº¦é™åˆ¶</td>
<td>â— é€šå¸¸ä¸º 2KBï½8KBï¼Œ<strong>IE æœ€å°</strong>ï¼Œ<strong>Chrome æ”¯æŒæ›´é•¿</strong></td>
</tr>
<tr>
<td>POST ä¹Ÿå¯ä»¥è¢«ç¼“å­˜</td>
<td>âŒ é»˜è®¤ä¸ä¼šç¼“å­˜ï¼Œä½†å¯é€šè¿‡ <code>Cache-Control</code> æˆ–è‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥å¼ºåˆ¶ç¼“å­˜</td>
</tr>
<tr>
<td>GET è¯·æ±‚ä¸€èˆ¬ä¸èƒ½ä¸Šä¼ æ–‡ä»¶ï¼ˆé™¤éç”¨ Base64 ç­‰ç‰¹æ®Šå½¢å¼ï¼‰</td>
<td>æ–‡ä»¶ä¸Šä¼ æ¨èç”¨ <code>POST + multipart/form-data</code></td>
</tr>
<tr>
<td>ç™»å½•æ“ä½œå¿…é¡»ç”¨ POST</td>
<td>å› ä¸º GET æš´éœ²ç”¨æˆ·å&#x2F;å¯†ç å®¹æ˜“è¢«è®°å½•ï¼Œ<strong>æ•æ„Ÿæ•°æ®å¿…é¡»èµ° POST + HTTPS åŠ å¯†ä¼ è¾“</strong></td>
</tr>
<tr>
<td>GET è¯·æ±‚å‚æ•°å¯¹é¡ºåºæ•æ„Ÿ</td>
<td>æŸäº›æ¡†æ¶ï¼ˆå¦‚éƒ¨åˆ†ç½‘å…³ã€ç­¾åè®¤è¯ï¼‰ä¼šå¯¹ URL å‚æ•°é¡ºåºæ•æ„Ÿï¼Œåº”æ³¨æ„å‚æ•°é¡ºåºä¸€è‡´</td>
</tr>
<tr>
<td>Content-Type åŒºåˆ«</td>
<td>- GET è¯·æ±‚å¸¸çœç•¥æˆ–é»˜è®¤ - POST å¸¸è®¾å®šä¸ºï¼š â‘  application&#x2F;json â‘¡ application&#x2F;x-www-form-urlencoded â‘¢ multipart&#x2F;form-data</td>
</tr>
<tr>
<td>GET è¯·æ±‚ä¼šè¢«é¢„æ£€ï¼ˆpreflightï¼‰å—ï¼Ÿ</td>
<td>âŒ ä¸ä¼šï¼Œåªæœ‰è·¨åŸŸçš„éç®€å•è¯·æ±‚ï¼ˆå¦‚ PUTã€å¸¦è‡ªå®šä¹‰å¤´çš„ POSTï¼‰æ‰ä¼šæœ‰ OPTIONS é¢„æ£€</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="æ˜¯å¦ä¸Šä¼ è¿‡å›¾ç‰‡"><a href="#æ˜¯å¦ä¸Šä¼ è¿‡å›¾ç‰‡" class="headerlink" title="æ˜¯å¦ä¸Šä¼ è¿‡å›¾ç‰‡"></a>æ˜¯å¦ä¸Šä¼ è¿‡å›¾ç‰‡</h4><p>é˜¿é‡Œäº‘æ˜¯æœ€åå­˜å‚¨çš„<br>å®Œæ•´çš„ä¸Šä¼ å›¾ç‰‡åº”è¯¥ï¼š<br><strong>å‰ç«¯</strong>è¦é…åˆ(è¡¨å• postæäº¤)  <strong>Content-Type</strong>ï¼šä¸Šä¼ æ–‡ä»¶ä¸ç”¨application è¦ç”¨ <strong>multipart&#x2F;form-data</strong>â€  åŒä¸€ä¸ªè¯·æ±‚èƒ½è¾¹ä¸Šä¼ å›¾ç‰‡å’Œæ–‡æœ¬æ•°æ®<br><strong>åç«¯</strong>çš„æ“ä½œï¼šä¼ åˆ°åç«¯controlleræ¥æ”¶ï¼Œæœ‰ä¸€ä¸ªç±»multipart ä¸“é—¨æ¥æ”¶äºŒè¿›åˆ¶æ•°æ® å›¾ç‰‡è§†é¢‘ç­‰ï¼Œæœ‰å¾ˆå¤šapi â†’ get input streamå°è£…util è°ƒç”¨uploadä¸Šä¼ ã€‚ä¸­å°å‹ä¼ä¸šéƒ½ç”¨é˜¿é‡Œäº‘oss å› ä¸ºè¦è€ƒè™‘å®¹ç¾ åœ°éœ‡ å®¹æ˜“æ•°æ®ä¸¢å¤±ï¼Œè¦è€ƒè™‘å¤‡ä»½â†’é›†ç¾¤ï¼ŒæœåŠ¡å™¨æœ‰ç‰©ç†ç¡¬ä»¶ä¸Šé™(è¦æœ‰è¿ç»´æˆæœ¬)ï¼Œæ–‡ä»¶ç»´æŠ¤å¾ˆä¸“ä¸šäº¤ç»™ä¸“ä¸šçš„äººã€‚é˜¿é‡Œäº‘çš„æœºæˆ¿åœ¨æ·±åœ³ï¼Œå¹¿å·çš„äººè®¿é—®ä¼šæ¯”å“ˆå°”æ»¨çš„æ›´å¿«ã€‚å…‰çº¤å—ç‰©ç†é™åˆ¶ è¶Šé•¿è¶Šæœ‰æŸè€—ã€‚å¤§å‹è¿è¥å•†åœ¨å…¨å›½å„åœ°éƒ½æœ‰æœºæˆ¿ï¼Œå¯ä»¥æ™ºèƒ½åˆ¤æ–­æ¯”å¦‚å“ˆå°”æ»¨çš„å°±å»è®¿é—®é»‘é¾™æ±ŸæœåŠ¡å™¨ã€‚CSDNå†…å®¹åˆ†å‘(æ”¶è´¹)</p>
<blockquote>
<h3 id="ğŸ”§-å®Œæ•´çš„ä¸Šä¼ æµç¨‹"><a href="#ğŸ”§-å®Œæ•´çš„ä¸Šä¼ æµç¨‹" class="headerlink" title="ğŸ”§ å®Œæ•´çš„ä¸Šä¼ æµç¨‹"></a>ğŸ”§ å®Œæ•´çš„ä¸Šä¼ æµç¨‹</h3><table>
<thead>
<tr>
<th>ç¯èŠ‚</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>å‰ç«¯</td>
<td>ä½¿ç”¨ <code>form</code> è¡¨å•æˆ– Ajax ä¸Šä¼ ï¼Œ<code>Content-Type</code> è®¾ç½®ä¸º <code>multipart/form-data</code>ï¼Œæ”¯æŒ<strong>åŒæ—¶ä¼ æ–‡æœ¬+æ–‡ä»¶</strong></td>
</tr>
<tr>
<td>æ§åˆ¶å™¨</td>
<td>Spring Boot ä½¿ç”¨ <code>MultipartFile</code> ç±»å‹æ¥æ”¶ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä½¿ç”¨ <code>.getInputStream()</code> è·å–å†…å®¹æµ</td>
</tr>
<tr>
<td>ä¸Šä¼ å·¥å…·ç±»</td>
<td>å°†æ–‡ä»¶æµå°è£…ä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹äº‘å­˜å‚¨ï¼Œå¦‚é˜¿é‡Œäº‘ OSSã€ä¸ƒç‰›äº‘ã€è…¾è®¯äº‘ç­‰</td>
</tr>
<tr>
<td>äº‘å­˜å‚¨</td>
<td>äº‘å‚å•†æ‹¥æœ‰<strong>å¤‡ä»½ã€å®¹ç¾ã€é›†ç¾¤ã€åˆ†å‘</strong>ç­‰èƒ½åŠ›ï¼Œç¡®ä¿æ•°æ®å®‰å…¨å’Œè®¿é—®é€Ÿåº¦</td>
</tr>
<tr>
<td>è¿”å›å‰ç«¯</td>
<td>è¿”å›ä¸Šä¼ åçš„å›¾ç‰‡ URL æˆ–æ–‡ä»¶ ID ç­‰ä¿¡æ¯</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="å‰ç«¯ä¼ è¿‡æ¥çš„å›¾ç‰‡æ€ä¹ˆè®¾ç½®å›¾ç‰‡å¤§å°-æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Ÿ"><a href="#å‰ç«¯ä¼ è¿‡æ¥çš„å›¾ç‰‡æ€ä¹ˆè®¾ç½®å›¾ç‰‡å¤§å°-æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Ÿ" class="headerlink" title="å‰ç«¯ä¼ è¿‡æ¥çš„å›¾ç‰‡æ€ä¹ˆè®¾ç½®å›¾ç‰‡å¤§å° æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Ÿ"></a>å‰ç«¯ä¼ è¿‡æ¥çš„å›¾ç‰‡æ€ä¹ˆè®¾ç½®å›¾ç‰‡å¤§å° æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Ÿ</h4><p>æ€è€ƒï¼šä¸ºä»€ä¹ˆåç«¯è¦é™åˆ¶å‰ç«¯å›¾ç‰‡ä¼ çš„å¤§å°ï¼Ÿ<br>å¤§å›¾ç‰‡ + å¤šäººä¸Šä¼ ï¼Œé¦–å…ˆåç«¯è¦è¯»åˆ°jvmå†…å­˜å†äºŒè¿›åˆ¶æµç»™åˆ°é˜¿é‡Œäº‘ï¼ŒåŒæ—¶å¹¶å‘æœ‰å¯èƒ½è¶…å‡ºOMçš„javaå†…å­˜å¤§å°<br>springboot ymlåŠ æ–‡ä»¶ä¸Šä¼ å¤§å°é…ç½®</p>
<pre><code class="yaml">spring:
  servlet:
    multipart:
      max-file-size: 10MB # å•ä¸ªæ–‡ä»¶çš„æœ€å¤§å¤§å°
      max-request-size: 20MB # æ•´ä¸ªè¯·æ±‚çš„æœ€å¤§å¤§å°ï¼ŒåŒ…æ‹¬å¤šä¸ªæ–‡ä»¶çš„æ€»å’Œ
</code></pre>
<blockquote>
<ol>
<li><strong>è¯»å–åˆ° JVM å†…å­˜</strong>ï¼š<ul>
<li>å½“å‰ç«¯å‘é€å›¾ç‰‡æ–‡ä»¶åˆ°åç«¯æ—¶ï¼Œåç«¯æœåŠ¡å™¨éœ€è¦æ¥æ”¶è¿™ä¸ªæ–‡ä»¶çš„æ•°æ®ã€‚</li>
<li>åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œæ¥æ”¶åˆ°çš„æ–‡ä»¶æ•°æ®é¦–å…ˆä¼šè¢«åŠ è½½åˆ° JVMï¼ˆJava è™šæ‹Ÿæœºï¼‰çš„å†…å­˜ä¸­ã€‚è¿™æ˜¯å› ä¸ºåœ¨ Java åº”ç”¨ç¨‹åºä¸­å¤„ç†ä»»ä½•æ•°æ®ä¹‹å‰ï¼Œæ•°æ®å¿…é¡»å…ˆè¢«åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li>
</ul>
</li>
<li><strong>äºŒè¿›åˆ¶æµç»™åˆ°é˜¿é‡Œäº‘</strong>ï¼š<ul>
<li>ä¸€æ—¦æ–‡ä»¶æ•°æ®è¢«åŠ è½½åˆ° JVM å†…å­˜ä¸­ï¼Œåç«¯æœåŠ¡é€šå¸¸ä¼šå°†è¿™äº›æ•°æ®ä»¥äºŒè¿›åˆ¶æµçš„å½¢å¼ä¸Šä¼ åˆ°äº‘å­˜å‚¨æœåŠ¡ï¼Œæ¯”å¦‚é˜¿é‡Œäº‘çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆOSSï¼‰ã€‚</li>
<li>è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°æ•°æ®çš„è¯»å–å’Œå†™å…¥æ“ä½œï¼Œå³ä» JVM å†…å­˜è¯»å–æ•°æ®ï¼Œç„¶åå†™å…¥åˆ°äº‘å­˜å‚¨æœåŠ¡ã€‚</li>
</ul>
</li>
<li><strong>å¹¶å‘å¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡º</strong>ï¼š<ul>
<li>å¦‚æœæœ‰å¤šä¸ªç”¨æˆ·åŒæ—¶ä¸Šä¼ å¤§å›¾ç‰‡ï¼Œåç«¯æœåŠ¡å™¨å¯èƒ½ä¼šåŒæ—¶å¤„ç†å¤šä¸ªä¸Šä¼ è¯·æ±‚ã€‚</li>
<li>æ¯ä¸ªä¸Šä¼ è¯·æ±‚éƒ½ä¼šå ç”¨ä¸€éƒ¨åˆ† JVM å†…å­˜ã€‚å¦‚æœä¸Šä¼ çš„å›¾ç‰‡éå¸¸å¤§ï¼Œä¸”å¹¶å‘è¯·æ±‚çš„æ•°é‡å¾ˆå¤šï¼Œé‚£ä¹ˆæ‰€æœ‰è¯·æ±‚åŠ èµ·æ¥çš„å†…å­˜ä½¿ç”¨é‡å¯èƒ½ä¼šè¿…é€Ÿå¢åŠ ã€‚</li>
<li>å¦‚æœå†…å­˜ä½¿ç”¨é‡è¶…è¿‡äº† JVM åˆ†é…ç»™åº”ç”¨ç¨‹åºçš„å†…å­˜å¤§å°ï¼ˆå³ OutOfMemoryï¼Œç®€ç§° OOMï¼‰ï¼Œå°±ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºé”™è¯¯ã€‚è¿™ç§é”™è¯¯ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒæˆ–è€…å˜å¾—ä¸ç¨³å®šã€‚</li>
</ul>
</li>
<li><strong>é™åˆ¶ä¸Šä¼ å¤§å°çš„é‡è¦æ€§</strong>ï¼š<ul>
<li>ä¸ºäº†é˜²æ­¢å†…å­˜æº¢å‡ºé”™è¯¯ï¼Œåç«¯é€šå¸¸ä¼šé™åˆ¶ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ã€‚</li>
<li>é€šè¿‡é™åˆ¶å•ä¸ªæ–‡ä»¶çš„æœ€å¤§å¤§å°ï¼ˆ<code>max-file-size</code>ï¼‰å’Œæ•´ä¸ªè¯·æ±‚çš„æœ€å¤§å¤§å°ï¼ˆ<code>max-request-size</code>ï¼‰ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶å†…å­˜çš„ä½¿ç”¨ï¼Œé¿å…å› å¤§é‡å¹¶å‘ä¸Šä¼ å¤§æ–‡ä»¶è€Œè€—å°½æœåŠ¡å™¨å†…å­˜ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<h3 id="å‰ç«¯å›¾ç‰‡å¤§å°å¦‚ä½•é™åˆ¶ï¼Ÿ"><a href="#å‰ç«¯å›¾ç‰‡å¤§å°å¦‚ä½•é™åˆ¶ï¼Ÿ" class="headerlink" title="å‰ç«¯å›¾ç‰‡å¤§å°å¦‚ä½•é™åˆ¶ï¼Ÿ"></a>å‰ç«¯å›¾ç‰‡å¤§å°å¦‚ä½•é™åˆ¶ï¼Ÿ</h3><h4 id="âœ…-åŸå› ï¼šé¿å…åç«¯-OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰"><a href="#âœ…-åŸå› ï¼šé¿å…åç«¯-OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰" class="headerlink" title="âœ… åŸå› ï¼šé¿å…åç«¯ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰"></a>âœ… åŸå› ï¼šé¿å…åç«¯ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰</h4><table>
<thead>
<tr>
<th>æ­¥éª¤</th>
<th>åŸå› </th>
</tr>
</thead>
<tbody><tr>
<td>ä¸Šä¼ å‰</td>
<td>æµè§ˆå™¨æœ¬åœ°å¯é™åˆ¶å›¾ç‰‡å¤§å°æˆ–å‹ç¼©ï¼ˆå‰ç«¯ UI é™åˆ¶ï¼‰</td>
</tr>
<tr>
<td>ä¸Šä¼ ä¸­</td>
<td>è®¾ç½® <code>multipart/form-data</code> åè®®</td>
</tr>
<tr>
<td>åç«¯æ¥æ”¶</td>
<td>æ–‡ä»¶å…ˆè¢«åŠ è½½åˆ° JVM å†…å­˜ï¼Œå†ä¼ ç»™äº‘æœåŠ¡ï¼Œ<strong>å¤§å›¾ + å¹¶å‘ä¸Šä¼  &#x3D; é«˜å†…å­˜å ç”¨</strong></td>
</tr>
<tr>
<td>é™åˆ¶å¤§å°</td>
<td>é¿å… OOMï¼Œä¿éšœæœåŠ¡ç¨³å®šæ€§</td>
</tr>
</tbody></table>
<h4 id="âœ…-Spring-Boot-é™åˆ¶é…ç½®"><a href="#âœ…-Spring-Boot-é™åˆ¶é…ç½®" class="headerlink" title="âœ… Spring Boot é™åˆ¶é…ç½®"></a>âœ… Spring Boot é™åˆ¶é…ç½®</h4><pre><code class="java">spring:
  servlet:
    multipart:
      max-file-size: 10MB         # å•ä¸ªæ–‡ä»¶æœ€å¤§10MB
      max-request-size: 20MB      # æ•´ä½“è¯·æ±‚æœ€å¤§20MBï¼ˆå¤šä¸ªæ–‡ä»¶+å­—æ®µï¼‰
</code></pre>
<h3 id="æ§åˆ¶å™¨ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"><a href="#æ§åˆ¶å™¨ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰" class="headerlink" title="æ§åˆ¶å™¨ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰"></a>æ§åˆ¶å™¨ä»£ç ç¤ºä¾‹ï¼ˆJavaï¼‰</h3><pre><code class="java">@PostMapping(&quot;/upload&quot;)
public String uploadFile(@RequestParam(&quot;file&quot;) MultipartFile file) &#123;
    if (file.isEmpty()) &#123;
        return &quot;ä¸Šä¼ å¤±è´¥ï¼Œæ–‡ä»¶ä¸ºç©º&quot;;
    &#125;

    try (InputStream inputStream = file.getInputStream()) &#123;
        // ä¸Šä¼ åˆ°é˜¿é‡Œäº‘OSSçš„é€»è¾‘
        String url = ossUtil.upload(inputStream, file.getOriginalFilename());
        return &quot;ä¸Šä¼ æˆåŠŸï¼Œè®¿é—®åœ°å€ï¼š&quot; + url;
    &#125; catch (IOException e) &#123;
        e.printStackTrace();
        return &quot;ä¸Šä¼ å¤±è´¥ï¼š&quot; + e.getMessage();
    &#125;
&#125;
</code></pre>
<h3 id="å†·é—¨ä½†å¸¸è€ƒçš„æ‰©å±•ç‚¹"><a href="#å†·é—¨ä½†å¸¸è€ƒçš„æ‰©å±•ç‚¹" class="headerlink" title="å†·é—¨ä½†å¸¸è€ƒçš„æ‰©å±•ç‚¹"></a>å†·é—¨ä½†å¸¸è€ƒçš„æ‰©å±•ç‚¹</h3><table>
<thead>
<tr>
<th>çŸ¥è¯†ç‚¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>MultipartFile</code> æ˜¯ä»€ä¹ˆï¼Ÿ</td>
<td>æ˜¯ Spring å°è£…çš„æ–‡ä»¶ä¸Šä¼ ç±»å‹ï¼Œå†…éƒ¨åŒ…å«æ–‡ä»¶åã€æ–‡ä»¶å¤§å°ã€æ–‡ä»¶æµç­‰</td>
</tr>
<tr>
<td>åŒä¸€è¯·æ±‚èƒ½ä¼ å›¾ç‰‡+æ–‡æœ¬ï¼Ÿ</td>
<td>âœ… æ”¯æŒï¼Œè¡¨å•ä¸­å¯åŒæ—¶ä¸Šä¼  <code>file</code> + æ–‡æœ¬å­—æ®µï¼Œå¦‚å•†å“åã€æè¿°</td>
</tr>
<tr>
<td>é˜¿é‡Œäº‘çš„ä¸Šä¼ è·¯å¾„å»ºè®®ï¼Ÿ</td>
<td>å¯ä½¿ç”¨æ—¶é—´æˆ³+UUIDç»„åˆè·¯å¾„ï¼Œå¦‚ï¼š<code>images/2025/07/abc.jpg</code>ï¼Œé˜²æ­¢é‡å¤æ–‡ä»¶è¦†ç›–</td>
</tr>
<tr>
<td>ä¸ºä»€ä¹ˆé€‰æ‹© OSSï¼Ÿ</td>
<td>ä¸“ä¸šã€å®‰å…¨ã€å¼¹æ€§æ‰©å±•ã€æ”¯æŒ CDN åˆ†å‘ã€æ”¯æŒè·¨åŒºåŸŸè®¿é—®</td>
</tr>
<tr>
<td>OSS ä¸Šä¼ æ˜¯å¦èµ° JVMï¼Ÿ</td>
<td>æ˜¯çš„ï¼Œæ–‡ä»¶å…ˆè¯»å…¥ JVMï¼Œå†é€šè¿‡ SDK ä¸Šä¼ ï¼Œä½†ä¹Ÿå¯ä»¥ä¼˜åŒ–ä¸º<strong>ç›´ä¼ ï¼ˆå‰ç«¯ç›´ä¼  OSSï¼‰</strong>å‡å°‘åç«¯å‹åŠ›</td>
</tr>
<tr>
<td>ä¼šä¸ä¼šå¹¶å‘å¯¼è‡´ OOMï¼Ÿ</td>
<td>æ˜¯çš„ï¼Œå°¤å…¶æ˜¯å¤§æ–‡ä»¶ + å¹¶å‘ä¸Šä¼ ï¼Œè‹¥ä¸é™åˆ¶ä¸Šä¼ å¤§å°ï¼Œææ˜“å¯¼è‡´å†…å­˜æº¢å‡º</td>
</tr>
</tbody></table>
</blockquote>
</blockquote>
<h4 id="ä½ åœ¨é‡Œé¢ä¸»è¦è´Ÿè´£å“ªæ–¹é¢çš„å·¥ä½œï¼Ÿ"><a href="#ä½ åœ¨é‡Œé¢ä¸»è¦è´Ÿè´£å“ªæ–¹é¢çš„å·¥ä½œï¼Ÿ" class="headerlink" title="ä½ åœ¨é‡Œé¢ä¸»è¦è´Ÿè´£å“ªæ–¹é¢çš„å·¥ä½œï¼Ÿ"></a>ä½ åœ¨é‡Œé¢ä¸»è¦è´Ÿè´£å“ªæ–¹é¢çš„å·¥ä½œï¼Ÿ</h4><p>æˆ‘ä¹‹å‰è´Ÿè´£åç«¯å¼€å‘ ä¹Ÿä¼šå‚ä¸ä¸€éƒ¨åˆ†<strong>è®¾è®¡å·¥ä½œ</strong><br>å¼€å‘å®Œä¼šååŠ©æµ‹è¯• å’Œå‰ç«¯è¿›è¡Œè”è°ƒ<br>å’Œç»„é•¿ä¸€èµ·è¿›è¡Œæµ‹è¯•<br>å’Œå‰åç«¯çš„é€»è¾‘åŸºæœ¬ä¸Šéƒ½æ˜¯å¯ä»¥çš„</p>
<h4 id="ä¸Šå®¶å…¬å¸çš„ç¦»èŒåŸå› ï¼Œè–ªèµ„å¤šå°‘ï¼Œè–ªèµ„ç»“æ„"><a href="#ä¸Šå®¶å…¬å¸çš„ç¦»èŒåŸå› ï¼Œè–ªèµ„å¤šå°‘ï¼Œè–ªèµ„ç»“æ„" class="headerlink" title="ä¸Šå®¶å…¬å¸çš„ç¦»èŒåŸå› ï¼Œè–ªèµ„å¤šå°‘ï¼Œè–ªèµ„ç»“æ„"></a>ä¸Šå®¶å…¬å¸çš„ç¦»èŒåŸå› ï¼Œè–ªèµ„å¤šå°‘ï¼Œè–ªèµ„ç»“æ„</h4><p>ä¸è¦è¯´ä¸€äº›é¢è¯•å®˜èƒ½æŒ‘åˆºçš„ç†ç”±<br><del>å‘å±•å‰æ™¯ï¼Ÿè¡¨æ˜ä¸Šå®¶å…¬å¸ä¸å¥½</del><br><del>å¤ªæƒ³è¿›æ­¥ï¼Ÿè¡¨åä¸Šå®¶å…¬å¸æä¾›çš„æŠ€æœ¯ä¸å¥½ è‡ªå·±æŠ€æœ¯ä¸å¥½</del><br>åœ¨ä¸Šå®¶å…¬å¸æˆ‘å­¦ä¹ äº†å¾ˆå¤š æˆé•¿äº†å¾ˆå¤šï¼Œä¸ªäººå‘å±•åŸå›  ï¼Œæƒ³è¦æ¶¨è–ª</p>
<pre><code class="java">// æ¥è‡ªAIçš„ç­”æ¡ˆ ä»…ä¾›å‚è€ƒ
æˆ‘åœ¨ä¸Šå®¶å…¬å¸å­¦åˆ°äº†å¾ˆå¤šï¼Œä½†æˆ‘è§‰å¾—ä¸ºäº†æˆ‘çš„èŒä¸šå‘å±•ï¼Œæˆ‘éœ€è¦å¯»æ‰¾ä¸€ä¸ªèƒ½å¤Ÿæä¾›æ›´å¤šæˆé•¿æœºä¼šå’ŒæŒ‘æˆ˜çš„èŒä½ã€‚æˆ‘æƒ³è¦åœ¨[æŠ€èƒ½/é¢†åŸŸ]ä¸Šè¿›ä¸€æ­¥æ·±è€•ï¼Œè€Œè´µå…¬å¸çš„èŒä½çœ‹èµ·æ¥éå¸¸ç¬¦åˆæˆ‘çš„èŒä¸šè§„åˆ’ï¼›æˆ‘åœ¨ä¸Šå®¶å…¬å¸çš„å¹´è–ªå¤§çº¦åœ¨6000åˆ°7000ä¹‹é—´ï¼›æˆ‘çš„è–ªèµ„ç»“æ„ä¸»è¦åŒ…æ‹¬åŸºæœ¬å·¥èµ„ã€æ¯å¹´ä¸¤æ¬¡çš„ç»©æ•ˆå¥–é‡‘ã€è‚¡ç¥¨æœŸæƒä»¥åŠä¸€äº›æ ‡å‡†ç¦åˆ©ï¼Œæ¯”å¦‚å¥åº·ä¿é™©ã€é€€ä¼‘é‡‘è®¡åˆ’ç­‰ã€‚æ­¤å¤–ï¼Œå…¬å¸è¿˜æä¾›äº†ä¸€äº›é¢å¤–çš„ç¦åˆ©ï¼Œæ¯”å¦‚çµæ´»çš„å·¥ä½œæ—¶é—´å’Œè¿œç¨‹å·¥ä½œçš„æœºä¼š
</code></pre>
<h6 id="ç®€å†å…¬å¸"><a href="#ç®€å†å…¬å¸" class="headerlink" title="ç®€å†å…¬å¸"></a>ç®€å†å…¬å¸</h6><p>ä¸Šå®¶å…¬å¸<strong>å¦‚æœé—®å·¥ä½œä¸å¥½æ‰¾ ä¸ºä»€ä¹ˆä¸å…ˆæ‰¾åˆ°å†ç¦»èŒ</strong>ï¼Ÿ<br>æˆ‘åœ¨è¿™ä¸€å—æƒ³å¥½å¥½å‡†å¤‡é¢è¯• ä½†æ˜¯ä¸Šç­çš„æ—¶é—´ä¸å¥½åˆ†é… æˆ‘æƒ³ä¸“å¿ƒå»æ‰¾å·¥ä½œ<br>ä¸Šå®¶å·¥ä½œç¹å¿™æŠ½ä¸å‡ºæ—¶é—´å»å‡†å¤‡ æ‰€ä»¥æˆ‘æƒ³å¤šå¤šå‡†å¤‡<br>è‹¥<strong>å¼‚åœ°</strong>å…¬å¸ â†’ ä¸‡èƒ½ç†ç”±ï¼šç°åœ¨é¢çš„å…¬å¸åœ¨å“ªå®¶é‡Œäººå°±åœ¨å“ª[åœ°ç†ä½ç½®è¦æ¥è¿‘ ç²¾ç¡®åˆ°å“ªä¸ªåŸå¸‚] å¼‚åœ°å¾ˆå¤šéƒ½çº¿ä¸‹ä¸æ–¹ä¾¿å…ˆç¦»èŒä¸“å¿ƒå‡†å¤‡</p>
<h6 id="è–ªèµ„å¤šå°‘"><a href="#è–ªèµ„å¤šå°‘" class="headerlink" title="è–ªèµ„å¤šå°‘"></a>è–ªèµ„å¤šå°‘</h6><p>ç°åœ¨æœŸæœ›12k ä¸Šå®¶æœ€å¥½ä¿è¯**20%-30%**åŒºé—´â†’8-9-10k(å‚è€ƒåŸå¸‚ä¸åŒ)</p>
<h6 id="è–ªèµ„ç»“æ„"><a href="#è–ªèµ„ç»“æ„" class="headerlink" title="è–ªèµ„ç»“æ„"></a>è–ªèµ„ç»“æ„</h6><p>åŸºæœ¬å·¥èµ„(ä¸ƒå…«æˆ)+ç»©æ•ˆå·¥èµ„(20%-30%) æœ‰å…¬å¸å…ˆæ‰£é™¤ æœ‰çš„å½“æœˆå‘<br>A 120%  S 150%-200%  C 80%</p>
<h6 id="ä½ å¯¹ä¸Šå®¶å…¬å¸çš„çœ‹æ³•"><a href="#ä½ å¯¹ä¸Šå®¶å…¬å¸çš„çœ‹æ³•" class="headerlink" title="ä½ å¯¹ä¸Šå®¶å…¬å¸çš„çœ‹æ³•"></a>ä½ å¯¹ä¸Šå®¶å…¬å¸çš„çœ‹æ³•</h6><p>ä¸èƒ½è´¬ä½ è¦è¯´ä¼˜ç‚¹ å­¦ä¹ æˆé•¿äº†å¾ˆå¤š åŒäº‹å’Œé¢†å¯¼éƒ½å¾ˆç…§é¡¾æˆ‘</p>
<h6 id="ä»€ä¹ˆæ—¶å€™èƒ½å…¥èŒï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™èƒ½å…¥èŒï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™èƒ½å…¥èŒï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™èƒ½å…¥èŒï¼Ÿ</h6><p>ä¸‰ä¸ªå·¥ä½œæ—¥ åˆ° ä¸€å‘¨ä¹‹é—´</p>
<h6 id="ä½ ç¦»èŒäº†-ç°åœ¨æœ‰å¤šå°‘ä¸ªofferäº†ï¼Ÿ"><a href="#ä½ ç¦»èŒäº†-ç°åœ¨æœ‰å¤šå°‘ä¸ªofferäº†ï¼Ÿ" class="headerlink" title="ä½ ç¦»èŒäº† ç°åœ¨æœ‰å¤šå°‘ä¸ªofferäº†ï¼Ÿ"></a>ä½ ç¦»èŒäº† ç°åœ¨æœ‰å¤šå°‘ä¸ªofferäº†ï¼Ÿ</h6><p>ä¸èƒ½è¯´ä¸€ä¸ªéƒ½æ²¡æœ‰</p>
<ul>
<li>æˆ‘å·²ç»æœ‰2ä¸ªoffer ä½†æ˜¯ä¸€å®šè¦è¡¨è¾¾å¯¹å½“å‰å…¬å¸çš„æœŸå¾… ç»è¿‡æˆ‘çš„äº†è§£ æˆ‘æ›´å–œæ¬¢è´µå…¬å¸çš„å‘å±•å’Œæ–‡åŒ–</li>
<li>æˆ‘ä¹Ÿæ˜¯åˆšåˆšå¼€å§‹æ‰¾å·¥ä½œâ€¦</li>
</ul>
<h4 id="ä½ å¯ä»¥æ¥å—åŠ ç­å—"><a href="#ä½ å¯ä»¥æ¥å—åŠ ç­å—" class="headerlink" title="ä½ å¯ä»¥æ¥å—åŠ ç­å—"></a>ä½ å¯ä»¥æ¥å—åŠ ç­å—</h4><p>(å¿…é¡»å®Œå…¨æ¥å—å…¨éƒ¨åŠ ç­ å…ˆæ‹¿åˆ°offerå†è¯´)</p>
<h4 id="Controllerå’ŒRestControllerçš„åŒºåˆ«"><a href="#Controllerå’ŒRestControllerçš„åŒºåˆ«" class="headerlink" title="Controllerå’ŒRestControllerçš„åŒºåˆ«"></a>Controllerå’ŒRestControllerçš„åŒºåˆ«</h4><p>@RestController &#x3D; @Controller + @ResponseBody</p>
<p>@Controllerå¦‚æœè¦è¿”å›JSON&#x2F;XMLç­‰æ ¼å¼çš„æ•°æ®ç»™å®¢æˆ·ç«¯ï¼Œå¿…é¡»æ˜¾å¼çš„ä½¿ç”¨@ResponseBodyæ³¨è§£å°†è¿”å›çš„å¯¹è±¡è½¬æ¢ä¸ºHTTPå“åº”ä½“å†…å®¹ã€‚<br>@RestController ä¸“é—¨ä¸ºæ„å»ºRESTful WebæœåŠ¡è®¾è®¡çš„æ§åˆ¶å™¨ã€‚å®ƒç®€åŒ–äº†åˆ›å»ºAPIçš„è¿‡ç¨‹ï¼Œå› ä¸ºæ‰€æœ‰æ–¹æ³•é»˜è®¤éƒ½ä¼šå°†è¿”å›å€¼ç›´æ¥å†™å…¥HTTPå“åº”ä½“ä¸­ä½œä¸ºJSONæˆ–XMLæ ¼å¼çš„æ•°æ®ã€‚</p>
<p>@Controllerå¯ä»¥å£°æ˜ä¸€ä¸ªç±»ä¸ºä¸€ä¸ªbean æ§åˆ¶å™¨ç”¨<br>@ResponseBody å…·ä½“æ–¹æ³•å’Œç±»éƒ½å¯ä»¥ ä¸æ˜¯åŒ…è£…ç±»å’Œå­—ç¬¦ éƒ½å¯ä»¥è‡ªåŠ¨è½¬æˆjsonæ•°æ®æ ¼å¼ æ›´ç¬¦åˆrestfulé£æ ¼</p>
<blockquote>
<p>â€œ<code>@RestController</code> æ˜¯ Spring ä¸ºäº†ç®€åŒ– RESTful æ¥å£å¼€å‘è€Œæ¨å‡ºçš„å¤åˆæ³¨è§£ï¼Œç­‰ä»·äº <code>@Controller + @ResponseBody</code>ã€‚å®ƒè®©æˆ‘ä»¬å¼€å‘ API æ¥å£æ—¶æ— éœ€å†ä¸ºæ¯ä¸ªæ–¹æ³•æ·»åŠ  <code>@ResponseBody</code>ï¼Œæ‰€æœ‰è¿”å›å€¼ä¼šè‡ªåŠ¨è½¬æ¢ä¸º JSON æˆ– XML æ ¼å¼å†™å…¥å“åº”ä½“ï¼Œéå¸¸é€‚åˆå‰åç«¯åˆ†ç¦»é¡¹ç›®ã€‚â€</p>
</blockquote>
<h4 id="åœ¨yamlæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€äº›å‚æ•°ï¼Œè¯¥æ€ä¹ˆè°ƒç”¨"><a href="#åœ¨yamlæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€äº›å‚æ•°ï¼Œè¯¥æ€ä¹ˆè°ƒç”¨" class="headerlink" title="åœ¨yamlæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€äº›å‚æ•°ï¼Œè¯¥æ€ä¹ˆè°ƒç”¨"></a><strong>åœ¨yamlæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€äº›å‚æ•°ï¼Œè¯¥æ€ä¹ˆè°ƒç”¨</strong></h4><ul>
<li>ä½¿ç”¨ @Value æ³¨è§£ï¼Œè¿™æ˜¯æœ€ç›´æ¥çš„æ–¹å¼ï¼Œé€‚ç”¨äºç®€å•çš„å±æ€§æ³¨å…¥ã€‚æ˜¯beançš„æ³¨è§£ <strong>ç”¨${key}è¿˜å¯ä»¥ç”¨#</strong><ul>
<li><code>$&#123;&#125;</code>ï¼šç”¨äºæ³¨å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶çš„å€¼ã€‚å®ƒå‘Šè¯‰Springéœ€è¦ä»ç¯å¢ƒå˜é‡ã€å±æ€§æ–‡ä»¶ã€ç³»ç»Ÿå±æ€§ç­‰åœ°æ–¹æŸ¥æ‰¾ç›¸åº”çš„å€¼ã€‚</li>
<li><code>#&#123;&#125;</code>ï¼šç”¨äºæ‰§è¡ŒSpELï¼ˆSpring Expression Languageï¼ŒSpringè¡¨è¾¾å¼è¯­è¨€ï¼‰è¡¨è¾¾å¼ã€‚å®ƒå…è®¸ä½ åœ¨æ³¨å…¥å€¼æ—¶æ‰§è¡Œä¸€äº›ç®€å•çš„è®¡ç®—æˆ–é€»è¾‘ã€‚</li>
<li>å¦‚æœåœ¨å¤šä¸ªç±»é‡Œå¼•ç”¨ é…ç½®å¤š æ‚ä¹±  å¯ä»¥å†™ä¸ªé…ç½®ç±»å†™ä¸€å †çš„å±æ€§ æä¾›get setæ–¹æ³• é…ç½®ç±».getè·å–åˆ°é…ç½®</li>
</ul>
</li>
</ul>
<blockquote>
<pre><code class="yaml"># application.yml
server:
port: 8080

custom:
property: myCustomValue
number: 42
enabled: true
</code></pre>
<pre><code class="java">import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class CustomComponent &#123;

 // æ³¨å…¥server.portå±æ€§
 @Value(&quot;$&#123;server.port&#125;&quot;)
 private String serverPort;

 // æ³¨å…¥custom.propertyå±æ€§
 @Value(&quot;$&#123;custom.property&#125;&quot;)
 private String customProperty;

 // æ³¨å…¥custom.numberå±æ€§ï¼Œå¹¶è½¬æ¢ä¸ºintç±»å‹
 @Value(&quot;$&#123;custom.number&#125;&quot;)
 private int customNumber;

 // æ³¨å…¥custom.enabledå±æ€§ï¼Œå¹¶è½¬æ¢ä¸ºbooleanç±»å‹
 @Value(&quot;$&#123;custom.enabled&#125;&quot;)
 private boolean customEnabled;

 // ä½¿ç”¨SpELè¡¨è¾¾å¼æ¥è®¡ç®—å€¼
 @Value(&quot;#&#123;$&#123;custom.number&#125; * 2&#125;&quot;)
 private int doubleCustomNumber;

 // ä½¿ç”¨SpELè¡¨è¾¾å¼æ¥è·å–ç¯å¢ƒå˜é‡
 @Value(&quot;#&#123;systemProperties[&#39;os.name&#39;]&#125;&quot;)
 private String osName;

 // ... ä½¿ç”¨æ³¨å…¥çš„å€¼è¿›è¡Œæ“ä½œ

 // Getterå’ŒSetteræ–¹æ³•
 // ...
&#125;
</code></pre>
</blockquote>
<ul>
<li>ä½¿ç”¨ @ConfigurationProperties æ³¨è§£ï¼Œé€šå¸¸ä¼šæŒ‡å®šä¸€ä¸ª<strong>å‰ç¼€</strong>ï¼ˆ<strong>prefix</strong>ï¼‰ï¼Œè¿™ä¸ªå‰ç¼€ç”¨äºæŒ‡å®šé…ç½®æ–‡ä»¶ä¸­å“ªäº›å±æ€§åº”è¯¥è¢«ç»‘å®šåˆ°è¿™ä¸ª Bean ä¸Šã€‚ç„¶åç¡®ä¿ä¸»åº”ç”¨ç¨‹åºç±»æˆ–æŸä¸ªé…ç½®ç±»ä¸Šæœ‰<code>@EnableConfigurationProperties(AppProperties.class)</code> æ³¨è§£<br><code>@ConfigurationProperties(prefix = &quot;prefix&quot;)</code></li>
</ul>
<h4 id="IOCå’ŒDIæœ‰äº†è§£è¿‡å—ï¼Œå®ƒä»¬çš„å¥½å¤„æ˜¯ä»€ä¹ˆ"><a href="#IOCå’ŒDIæœ‰äº†è§£è¿‡å—ï¼Œå®ƒä»¬çš„å¥½å¤„æ˜¯ä»€ä¹ˆ" class="headerlink" title="IOCå’ŒDIæœ‰äº†è§£è¿‡å—ï¼Œå®ƒä»¬çš„å¥½å¤„æ˜¯ä»€ä¹ˆ"></a>IOCå’ŒDIæœ‰äº†è§£è¿‡å—ï¼Œå®ƒä»¬çš„å¥½å¤„æ˜¯ä»€ä¹ˆ</h4><p><span style = "color:red">å®ƒä»¬çš„ç›®çš„æ˜¯ä¸ºäº†<strong>è§£è€¦</strong></span><br>IOC(æ§åˆ¶åè½¬)æ˜¯Springçš„ä¸¤å¤§æ ¸å¿ƒä¹‹ä¸€ï¼ŒDI(ä¾èµ–æ³¨å…¥)<br>IOCæŠŠæ§åˆ¶æƒäº¤ç»™springå®¹å™¨<br>å¯¹è±¡åˆ›å»ºå¥½ä¹‹å ä¹‹é—´ä¼šæœ‰ä¾èµ–å…³ç³» DIå› æ­¤è€Œç”Ÿ<br>å®ç°æ–¹å¼ï¼šDIé€šå¸¸æœ‰å››ç§å®ç°æ–¹å¼</p>
<blockquote>
<h3 id="IOC-ä¸-DI-æ€»ç»“å¯¹æ¯”è¡¨"><a href="#IOC-ä¸-DI-æ€»ç»“å¯¹æ¯”è¡¨" class="headerlink" title="IOC ä¸ DI æ€»ç»“å¯¹æ¯”è¡¨"></a>IOC ä¸ DI æ€»ç»“å¯¹æ¯”è¡¨</h3><table>
<thead>
<tr>
<th>æ¦‚å¿µ</th>
<th>IOCï¼ˆæ§åˆ¶åè½¬ï¼‰</th>
<th>DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>å«ä¹‰</td>
<td>æ§åˆ¶æƒä»ä»£ç â€œä¸»åŠ¨â€åˆ›å»ºå¯¹è±¡ï¼Œåè½¬ç»™ Spring å®¹å™¨</td>
<td>Spring å®¹å™¨å°†ä¾èµ–å¯¹è±¡â€œæ³¨å…¥â€åˆ°ç›®æ ‡å¯¹è±¡ä¸­</td>
</tr>
<tr>
<td>ç›®æ ‡</td>
<td><strong>è§£è€¦åˆ</strong>ï¼Œç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’Œä¾èµ–å…³ç³»</td>
<td>å®ç° IOC çš„æ ¸å¿ƒæ‰‹æ®µï¼Œé™ä½æ¨¡å—è€¦åˆåº¦</td>
</tr>
<tr>
<td>ä½“ç°</td>
<td>Bean ç”±å®¹å™¨ç»Ÿä¸€åˆ›å»ºå’Œç»´æŠ¤</td>
<td>å¯¹è±¡çš„ä¾èµ–ç”±å®¹å™¨è‡ªåŠ¨æä¾›</td>
</tr>
<tr>
<td>å¥½å¤„</td>
<td>é™ä½è€¦åˆã€ç»Ÿä¸€ç®¡ç†å¯¹è±¡</td>
<td>æé«˜å¯ç»´æŠ¤æ€§ã€æ‰©å±•æ€§ã€ä¾¿äºæµ‹è¯•</td>
</tr>
<tr>
<td>å…³ç³»</td>
<td>æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³</td>
<td>æ˜¯å®ç°æ–¹å¼ï¼ˆIOC çš„å…·ä½“å®ç°æ‰‹æ®µï¼‰</td>
</tr>
</tbody></table>
<h3 id="IOC-amp-DI-ç»å…¸è§£é‡Š"><a href="#IOC-amp-DI-ç»å…¸è§£é‡Š" class="headerlink" title="IOC &amp; DI ç»å…¸è§£é‡Š"></a>IOC &amp; DI ç»å…¸è§£é‡Š</h3><ul>
<li><strong>IOCï¼ˆæ§åˆ¶åè½¬ï¼‰</strong> æ˜¯ä¸€ç§æ€æƒ³ï¼ŒæŠŠåŸæ¥ç”±å¼€å‘è€…æ‰‹åŠ¨ new å¯¹è±¡çš„å·¥ä½œäº¤ç»™ Spring å®¹å™¨æ¥åšï¼Œå®ç°<strong>å¯¹è±¡åˆ›å»ºå’Œä¾èµ–ç®¡ç†çš„ç»Ÿä¸€æ§åˆ¶</strong>ã€‚</li>
<li><strong>DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰</strong> æ˜¯å®ç° IOC çš„ä¸€ç§æ–¹å¼ï¼Œå³é€šè¿‡æ³¨è§£ã€æ„é€ å‡½æ•°ç­‰æ–¹å¼ï¼Œç”±å®¹å™¨<strong>æ³¨å…¥ä¾èµ–å¯¹è±¡</strong>ã€‚</li>
</ul>
<p>ğŸ“Œ ä¸¾ä¸ªæ —å­ï¼š</p>
<p>ç±»ä¼¼ç§Ÿæˆ¿å¹³å°ï¼Œæˆ¿ä¸œæä¾›æˆ¿å­ï¼ˆBeanï¼‰ï¼Œä¸­ä»‹å¹³å°ï¼ˆSpring å®¹å™¨ï¼‰ç»Ÿä¸€ç®¡ç†ï¼Œç§Ÿå®¢ï¼ˆä¸šåŠ¡ç±»ï¼‰ä¸ç›´æ¥æ‰¾æˆ¿ä¸œï¼Œè€Œæ˜¯ç”±å¹³å°åˆ†é…ä¾èµ–ã€‚</p>
</blockquote>
<ul>
<li><p><strong>å±æ€§æ³¨å…¥</strong> <del>æ³¨è§£æ³¨å…¥</del></p>
<ul>
<li><code>@Autowired</code> æ˜¯ Spring æä¾›çš„æ³¨è§£ï¼Œç”¨äºè‡ªåŠ¨è£…é… Beanã€‚å®ƒå¯ä»¥ç”¨äºå­—æ®µã€æ„é€ å‡½æ•°ã€æ–¹æ³•æˆ–è®¾ç½®å™¨ä¸Šã€‚å½“ Spring å®¹å™¨å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æŸ¥æ‰¾å¹¶æ³¨å…¥åŒ¹é…çš„ Beanã€‚<ul>
<li>å¶å°”æœ‰ä¸å½±å“ç¨‹åºè¿è¡Œçš„æŠ¥é”™ï¼Ÿå†™springæŠ€æœ¯äººå‘˜æ˜¯æ ¹æ®jdkå†™ï¼Œæ€•åˆ«äººä¸ç”¨ã€‚</li>
</ul>
</li>
<li><code>@Resource</code> æ˜¯ Java çš„æ³¨è§£[JDKçš„]ï¼Œç”¨äºä¾èµ–æ³¨å…¥ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨äºå­—æ®µã€æ–¹æ³•æˆ–è®¾ç½®å™¨ä¸Šã€‚ä¸ <code>@Autowired</code> ä¸åŒçš„æ˜¯ï¼Œ<code>@Resource</code> é»˜è®¤é€šè¿‡åç§°è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœæœªæŒ‡å®šåç§°ï¼Œåˆ™å°è¯•é€šè¿‡ç±»å‹è¿›è¡ŒåŒ¹é…ã€‚</li>
<li>ä¸¤è€…åŒºåˆ«<ul>
<li>@Autowired å…ˆæ ¹æ®<strong>å±æ€§ç±»å‹</strong> å»å®¹å™¨é‡Œé¢æ‰¾ å¦‚æœæ‰¾ä¸åˆ° å†æ ¹æ®**å±æ€§åç§°[å­—æ®µ]**å»æ‰¾ å¦‚æœå®åœ¨æ‰¾ä¸åˆ°å°±ä¼šæŠ¥é”™ [@Autowiredæ°¸è¿œä¸ä¼šæ”¾å¼ƒä½ çš„ å°½å…¶æ‰€èƒ½å»å¸®ä½ æ‰¾]</li>
<li>@Resource å…ˆæ ¹æ®<strong>å±æ€§åç§°</strong>å»æ‰¾ è¦ä¹ˆæ‰¾ä¸åˆ° è¦ä¹ˆæ‰¾åˆ°ä¸€ä¸ª æ‰¾åˆ°å°±å»æ³¨å…¥ å¦‚æœæ‰¾ä¸åˆ° å¯ä»¥å†æ ¹æ®<strong>å±æ€§ç±»å‹</strong>å»æ‰¾ [ç±»å‹æ‰¾ä¸åˆ° æˆ–è€… æ‰¾åˆ°å¤šä¸ª ä¹Ÿä¼šæŠ¥é”™]</li>
</ul>
</li>
</ul>
<h6 id="å®ƒä¿©æœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#å®ƒä¿©æœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="å®ƒä¿©æœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>å®ƒä¿©æœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h6><blockquote>
<p> <code>@Autowired</code> æ›´å€¾å‘äºæŒ‰<strong>ç±»å‹æ³¨å…¥</strong>ï¼Œå¦‚æœç±»å‹ä¸å”¯ä¸€ï¼Œåˆ™éœ€è¦æŒ‡å®šæ³¨å…¥çš„åç§°ã€‚<br> <code>@Resource</code> æ›´å€¾å‘äºæŒ‰<strong>åç§°æ³¨å…¥</strong>ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåç§°ï¼Œåˆ™å°è¯•æŒ‰ç±»å‹æ³¨å…¥ã€‚<br> ä¸¤è€…çš„ä¸åŒåœ¨äºé»˜è®¤çš„æ³¨å…¥ç­–ç•¥å’Œå¦‚ä½•å¤„ç†ä¸å”¯ä¸€çš„ Bean å®šä¹‰ã€‚</p>
<p> <code>@Autowired</code> å’Œ <code>@Resource</code> æœ€å¤§çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„é»˜è®¤æ³¨å…¥ç­–ç•¥å’Œæ‰€ä¾èµ–çš„æ³¨å…¥æœºåˆ¶ï¼š</p>
<ol>
<li><strong>é»˜è®¤æ³¨å…¥ç­–ç•¥</strong>ï¼š</li>
</ol>
<ul>
<li><code>@Autowired</code>ï¼šé»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹ï¼ˆTypeï¼‰è¿›è¡Œæ³¨å…¥çš„ã€‚å¦‚æœå®¹å™¨ä¸­å­˜åœ¨å¤šä¸ªç›¸åŒç±»å‹çš„ Beanï¼Œåˆ™éœ€è¦é€šè¿‡ <code>@Qualifier</code> æ³¨è§£æŒ‡å®šå…·ä½“çš„ Bean åç§°ï¼Œæˆ–è€…é€šè¿‡è®¾ç½® <code>@Autowired</code> çš„ <code>required</code> å±æ€§ä¸º <code>false</code> æ¥å…è®¸æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ Bean æ—¶ä¸æŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li><code>@Resource</code>ï¼šé»˜è®¤æ˜¯æŒ‰ç…§åç§°ï¼ˆNameï¼‰è¿›è¡Œæ³¨å…¥çš„ã€‚å¦‚æœæœªæŒ‡å®šåç§°ï¼Œåˆ™å°è¯•æŒ‰ç±»å‹è¿›è¡Œæ³¨å…¥ã€‚å¦‚æœå®¹å™¨ä¸­å­˜åœ¨å¤šä¸ªç›¸åŒç±»å‹çš„ Beanï¼Œä¸”æ²¡æœ‰æŒ‡å®šåç§°ï¼Œå¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
<ol start="2">
<li><strong>ä¾èµ–çš„æ³¨å…¥æœºåˆ¶</strong>ï¼š</li>
</ol>
<ul>
<li><code>@Autowired</code>ï¼šæ˜¯ Spring æ¡†æ¶æä¾›çš„æ³¨è§£ï¼Œå› æ­¤å®ƒåªèƒ½ç”¨äº Spring ç®¡ç†çš„ä¸Šä¸‹æ–‡ä¸­ã€‚</li>
<li><code>@Resource</code>ï¼šæ˜¯ Java çš„æ‰©å±•åŒ…ï¼ˆjavax.annotationï¼‰æä¾›çš„æ³¨è§£ï¼Œå®ƒæ˜¯ JSR-250 è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¯ä»¥åœ¨ä»»ä½•å®ç°äº† JSR-250 è§„èŒƒçš„å®¹å™¨ä¸­ä½¿ç”¨ï¼Œä¸ä»…é™äº Springã€‚</li>
</ul>
<p> ç®€è€Œè¨€ä¹‹ï¼Œæœ€å¤§çš„åŒºåˆ«åœ¨äº <code>@Autowired</code> æ›´ä¾§é‡äº<strong>ç±»å‹åŒ¹é…</strong>ï¼Œè€Œ <code>@Resource</code> æ›´ä¾§é‡äº<strong>åç§°åŒ¹é…</strong>ï¼Œå¹¶ä¸” <code>@Resource</code> æ˜¯ Java æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œå…·æœ‰æ›´å¹¿æ³›çš„é€‚ç”¨æ€§ã€‚</p>
<h3 id="Autowired-vs-Resource-åŒºåˆ«æ€»ç»“è¡¨"><a href="#Autowired-vs-Resource-åŒºåˆ«æ€»ç»“è¡¨" class="headerlink" title="@Autowired vs @Resource åŒºåˆ«æ€»ç»“è¡¨"></a>@Autowired vs @Resource åŒºåˆ«æ€»ç»“è¡¨</h3><table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th><code>@Autowired</code></th>
<th><code>@Resource</code></th>
</tr>
</thead>
<tbody><tr>
<td>æä¾›æ–¹</td>
<td>Spring</td>
<td>JDKï¼ˆJSR-250ï¼‰</td>
</tr>
<tr>
<td>é»˜è®¤æ³¨å…¥æ–¹å¼</td>
<td>æŒ‰ç±»å‹ï¼ˆbyTypeï¼‰</td>
<td>æŒ‰åç§°ï¼ˆbyNameï¼‰</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒæŒ‰ç±»å‹æ³¨å…¥</td>
<td>âœ… æ”¯æŒ</td>
<td>âœ… æ”¯æŒï¼ˆæ¬¡é€‰ï¼‰</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒæŒ‰åç§°æ³¨å…¥</td>
<td>âœ… éœ€æ­é… <code>@Qualifier</code></td>
<td>âœ… é»˜è®¤</td>
</tr>
<tr>
<td>æ˜¯å¦æ¨è</td>
<td>âœ… æ¨è</td>
<td>âš ï¸ éƒ¨åˆ†åœºæ™¯é€‚ç”¨</td>
</tr>
<tr>
<td>å¯ç”¨ä½ç½®</td>
<td>æ„é€ æ–¹æ³•ã€å­—æ®µã€æ–¹æ³•</td>
<td>å­—æ®µã€æ–¹æ³•</td>
</tr>
<tr>
<td>æ˜¯å¦æ”¯æŒå¤šä¸ªæ„é€ æ–¹æ³•</td>
<td>âŒ ä¸èƒ½å¤šä¸ªéƒ½åŠ  @Autowired</td>
<td>âŒ åŒç†</td>
</tr>
</tbody></table>
<h3 id="âœ…-å¼€å‘å»ºè®®"><a href="#âœ…-å¼€å‘å»ºè®®" class="headerlink" title="âœ… å¼€å‘å»ºè®®"></a>âœ… å¼€å‘å»ºè®®</h3><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>å»ºè®®</th>
</tr>
</thead>
<tbody><tr>
<td>åªæœ‰ä¸€ä¸ªä¾èµ–å¯¹è±¡</td>
<td>ä¼˜å…ˆä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œè¯­ä¹‰æ¸…æ™°</td>
</tr>
<tr>
<td>éœ€è¦æ³¨å…¥å¤šä¸ªä¾èµ–</td>
<td>ä½¿ç”¨å­—æ®µæ³¨å…¥æˆ–æ„é€ å™¨æ³¨å…¥</td>
</tr>
<tr>
<td>å¯¹ä¾èµ–å¯é€‰æ€§è¾ƒå¼º</td>
<td>å¯è€ƒè™‘ setter æˆ–æ™®é€šæ–¹æ³•æ³¨å…¥</td>
</tr>
<tr>
<td>æƒ³ç¡®ä¿æ›´å¼ºçº¦æŸæ€§</td>
<td>ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼ˆ+finalå±æ€§ï¼‰</td>
</tr>
</tbody></table>
<p> â€œIOC æ˜¯ä¸€ç§åè½¬æ§åˆ¶æƒçš„æ€æƒ³ï¼Œç”± Spring å®¹å™¨æ¥ç»Ÿä¸€ç®¡ç†å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–ï¼›è€Œ DI æ˜¯å®ç° IOC çš„æ‰‹æ®µï¼Œé€šè¿‡æ„é€ å™¨ã€å±æ€§ç­‰æ–¹å¼å°†ä¾èµ–å¯¹è±¡æ³¨å…¥åˆ°ç±»ä¸­ã€‚å®ƒä»¬çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†è§£è€¦ï¼Œæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚å¼€å‘ä¸­å¸¸ç”¨ <code>@Autowired</code> å’Œ <code>@Resource</code> å®ç°å±æ€§æ³¨å…¥ï¼Œæ„é€ å™¨æ³¨å…¥åˆ™æ›´å…·å¯è¯»æ€§å’Œæµ‹è¯•å‹å¥½æ€§ã€‚â€</p>
</blockquote>
</li>
<li><p><strong>æ„é€ å‡½æ•°æ³¨å…¥</strong> [é»˜è®¤ç”Ÿæˆç©ºå‚æ„é€ æ–¹æ³• è‹¥å†™æœ‰å‚æ„é€ åŸæ¥æ— å‚ä¼šè¢«è¦†ç›– å‚æ•°æ ¹æ®ç±»å‹å»æ‰¾å’Œ<code>@Autowired</code>ç±»å‹ä¸€æ · å¯ä»¥å†™å¤šä¸ªæ„é€ æ–¹æ³• å¦‚æœå»å¤šä¸ªæ„é€ æ–¹æ³•é‡è½½ä¼šæŠ¥é”™ æ€ä¹ˆåŠï¼ŸåŠ ä¸ª<code>@Autowired[å±æ€§,æ„é€ æ–¹æ³•,å‚æ•°]éƒ½å¯åŠ </code> <strong>ä¸å¯å¤šä¸ªæ–¹æ³•éƒ½åŠ @Autowired</strong>  åå°„ä¼šè§¦å‘æ„é€ æ–¹æ³• @Bean &#x3D;&gt; new ] </p>
<pre><code class="java">public class MyService &#123;

    private DependencyA dependencyA;
    private DependencyB dependencyB;

    // æ„é€ å‡½æ•°æ³¨å…¥
    @Autowired
    public MyService(DependencyA dependencyA) &#123;
        this.dependencyA = dependencyA;
    &#125;

    // å¦ä¸€ä¸ªæ„é€ å‡½æ•°
    @Autowired
    public MyService(DependencyB dependencyB) &#123;
        this.dependencyB = dependencyB;
    &#125;

    // ... å…¶ä»–æ–¹æ³• ...
&#125;
/////////////////////////////////////////////////////
åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”±äºæœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°éƒ½ä½¿ç”¨äº† @Autowired æ³¨è§£ï¼ŒSpring å°†æ— æ³•ç¡®å®šä½¿ç”¨å“ªä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå› æ­¤ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ åº”è¯¥åªåœ¨ä¸€ä¸ªæ„é€ å‡½æ•°ä¸Šä½¿ç”¨ @Autowired æ³¨è§£ã€‚
</code></pre>
</li>
<li><p>Setæ–¹æ³•æ³¨å…¥[åŸç”Ÿspring ç”¨xmlå»å®šä¹‰æ‰æœ‰ SpringBootæ²¡æœ‰è¿™ä¸ªæ³¨å…¥ ]</p>
<pre><code class="java">public class MyService &#123;

    private DependencyA dependencyA;

    // Set æ–¹æ³•æ³¨å…¥
    @Autowired
    public void setDependencyA(DependencyA dependencyA) &#123;
        this.dependencyA = dependencyA;
    &#125;

    // ... å…¶ä»–æ–¹æ³• ...
&#125;
//////////////////////////////////////////////////////
åœ¨ Spring Boot ä¸­ï¼Œè™½ç„¶ä¸å¸¸ç”¨ XML é…ç½®ï¼Œä½†æ˜¯ä½ ä»ç„¶å¯ä»¥é€šè¿‡æ³¨è§£æ¥å®ç° Set æ–¹æ³•æ³¨å…¥ã€‚
</code></pre>
</li>
<li><p><strong>æ™®é€šæ–¹æ³•æ³¨å…¥</strong></p>
<pre><code class="java">public class MyService &#123;

    private DependencyA dependencyA;

    // æ™®é€šæ–¹æ³•æ³¨å…¥
    @Autowired
    public void init(DependencyA dependencyA) &#123;
        this.dependencyA = dependencyA;
    &#125;

    // ... å…¶ä»–æ–¹æ³• ...
&#125;
//////////////////////////////////////////////////////
æ™®é€šæ–¹æ³•æ³¨å…¥æŒ‡çš„æ˜¯åœ¨ç±»ä¸­çš„ä»»æ„éæ„é€ å‡½æ•°æ–¹æ³•ä¸Šä½¿ç”¨ @Autowired æ³¨è§£
</code></pre>
</li>
</ul>
<h4 id="æµ‹è¯•è¿‡ç¨‹æœ‰æ²¡æœ‰å‡ºç°åå¤çš„å›°æ‰°"><a href="#æµ‹è¯•è¿‡ç¨‹æœ‰æ²¡æœ‰å‡ºç°åå¤çš„å›°æ‰°" class="headerlink" title="æµ‹è¯•è¿‡ç¨‹æœ‰æ²¡æœ‰å‡ºç°åå¤çš„å›°æ‰°?"></a>æµ‹è¯•è¿‡ç¨‹æœ‰æ²¡æœ‰å‡ºç°åå¤çš„å›°æ‰°?</h4><p>å®¢æˆ·<strong>éœ€æ±‚é¢‘ç¹æ›´æ”¹</strong><br>æµ‹è¯•ç”¨ä¾‹æ²¡æœ‰è¦†ç›–åˆ°<br>å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒæœªåè°ƒ</p>
<p>å¤ªå¤æ‚çš„æ”¹åŠ¨è¦å…ˆæŠ¥å¤‡æŠ€æœ¯ç»ç†ã€é¡¹ç›®ç»ç†</p>
<p>æµ‹è¯•ï¼šè‡ªæµ‹ å•å…ƒæµ‹è¯• ä¸“ä¸šäººå‘˜</p>
<h4 id="å…¬å¸ä½¿ç”¨å“ªäº›æŠ€æœ¯ï¼Ÿ"><a href="#å…¬å¸ä½¿ç”¨å“ªäº›æŠ€æœ¯ï¼Ÿ" class="headerlink" title="å…¬å¸ä½¿ç”¨å“ªäº›æŠ€æœ¯ï¼Ÿ"></a>å…¬å¸ä½¿ç”¨å“ªäº›æŠ€æœ¯ï¼Ÿ</h4><p>åç«¯ï¼šRedis RabbitMQ æœç´¢å¼•æ“ å¾®æœåŠ¡å¸¸ç”¨ç»„ä»¶ è¿œç¨‹è°ƒç”¨ ç»Ÿä¸€ç½‘å…³ Springboot Springcloud MybatisPlus</p>
<h4 id="é¡¹ç›®æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Ÿ"><a href="#é¡¹ç›®æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Ÿ" class="headerlink" title="é¡¹ç›®æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Ÿ"></a>é¡¹ç›®æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Ÿ</h4><p>2å‰ 8å 1æµ‹ 1è¿ç»´ 1é¡¹ç›®ç»ç†(å°å…¬å¸çº¦13äººå·¦å³) è¦å…·ä½“äººæ•°<br>è‡ªç ”å…¬å¸ï¼Ÿå¤–åŒ…ï¼Ÿ</p>
<p><strong>è‡ªç ”å…¬å¸</strong>ï¼š</p>
<ul>
<li>åˆ›ä¸šå‹è‡ªç ”å…¬å¸ï¼šé€šå¸¸å‘˜å·¥äººæ•°åœ¨10-50äººä¹‹é—´ï¼ŒåˆæœŸå¯èƒ½æ›´å°‘ï¼Œåªæœ‰å‡ äººåˆ°åå‡ äººã€‚</li>
<li>æˆç†Ÿè‡ªç ”å…¬å¸ï¼šå‘˜å·¥äººæ•°å¯èƒ½ä»å‡ åäººåˆ°å‡ ç™¾äººç”šè‡³æ›´å¤šã€‚</li>
</ul>
<p><strong>å¤–åŒ…å…¬å¸</strong>ï¼š</p>
<ul>
<li>å°å‹å¤–åŒ…å…¬å¸ï¼šå‘˜å·¥äººæ•°å¯èƒ½åœ¨10-50äººä¹‹é—´ã€‚</li>
<li>ä¸­å‹å¤–åŒ…å…¬å¸ï¼šå‘˜å·¥äººæ•°å¯èƒ½åœ¨50-200äººä¹‹é—´ã€‚</li>
<li>å¤§å‹å¤–åŒ…å…¬å¸ï¼šå‘˜å·¥äººæ•°å¯èƒ½è¶…è¿‡200äººã€‚</li>
</ul>
<h4 id="HashMapåº•å±‚åŸç†"><a href="#HashMapåº•å±‚åŸç†" class="headerlink" title="HashMapåº•å±‚åŸç†"></a>HashMapåº•å±‚åŸç†</h4><h5 id="åº•å±‚æ•°æ®ç»“æ„"><a href="#åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="åº•å±‚æ•°æ®ç»“æ„"></a>åº•å±‚æ•°æ®ç»“æ„</h5><p>jdk1.8ä¹‹å‰åº•å±‚ç»“æ„æ˜¯<strong>æ•°ç»„+é“¾è¡¨</strong>(key+value)  æ•°æ®ç»“æ„é€šç”¨çš„[é”®å€¼å¯¹+å“ˆå¸Œè¡¨çš„æ•°æ®ç»“æ„]<br>jdk1.8ä»¥åã€æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ã€‘åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“<strong>é“¾è¡¨é•¿åº¦</strong>å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º<strong>8</strong>ï¼‰æ—¶ä¸”<strong>æ•°ç»„é•¿åº¦</strong>å¤§äº<strong>64</strong>æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚æ‰©å®¹æ—¶ï¼Œçº¢é»‘æ ‘æ‹†åˆ†æˆçš„æ ‘çš„ç»“ç‚¹æ•°å°äºç­‰äºä¸´ç•Œå€¼6ä¸ªï¼Œåˆ™é€€åŒ–æˆé“¾è¡¨ã€‚åæœŸä½¿ç”¨mapè·å–å€¼æ—¶ï¼Œç›´æ¥æ‰¾åˆ°hashå€¼å¯¹åº”çš„ä¸‹æ ‡ï¼Œåœ¨è¿›ä¸€æ­¥åˆ¤æ–­keyæ˜¯å¦ç›¸åŒï¼Œä»è€Œæ‰¾åˆ°å¯¹åº”å€¼ã€‚<br>åº•å±‚çš„åœ°å€è¿ç®—å‡ºæ¥ å¦‚æœåœ°å€ä¸ä¸€æ ·è®¡ç®—å‡ºæ¥çš„hashcodeä¸ä¸€æ ·ï¼Œhashcodeä¸€èˆ¬æ˜¯æ•°å­—[æ•´æ•°(Â±æˆ–0)] é€šè¿‡keyè¿›è¡Œhashcodeè¿ç®— å¯¹<strong>æ•°ç»„é•¿åº¦å–æ¨¡</strong> egï¼šä»»ä½•æ•´æ•°å»å–æ¨¡10   å¯ä»¥å®šä½åˆ°valueå¯ä»¥æ”¾åœ¨å“ªä¸ªæ¡¶ä¸‹é¢</p>
<p>hashcodeæœ¬èº«ä¸åŒçš„å¯¹è±¡ç®—å‡ºæ¥çš„hashcodeå€¼æ˜¯ç›¸åŒçš„æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>ä¸¤ä¸ªvalueä¸å¯èƒ½æ”¾åœ¨åŒä¸€ä¸ªæ¡¶ è¿™å°±æ˜¯<strong>hashå†²çª</strong>  å¦‚æœæ•°ç»„é•¿åº¦æ˜¯8 ç®—å‡ºæ¥ä¸€ä¸ªhashcodeå€¼æ˜¯8 å’Œ 16 æ­¤æ—¶å–æ¨¡ä½™æ•°ç›¸åŒè¿™æ ·çš„æƒ…å†µä¹Ÿæ˜¯ç›¸åŒã€‚æ‰€ä»¥æ­¤æ—¶åº”è¯¥ç”¨<strong>æ‹‰é“¾æ³•</strong>[å°è‘¡è„ä¸²]ï¼Œå³ä½¿æ¡¶ä¸€æ · å¯ä»¥ç”¨æŒ‡é’ˆä¸€ä¸ªä¸ªæŒ‡ï¼Œæ­¤æ—¶çš„é“¾è¡¨æ˜¯å•å‘é“¾è¡¨[linkedlistæ‰æ˜¯åŒå‘é“¾è¡¨]ã€‚<br>åœ¨1.8åæŒ‡å‡ºå¦‚æœåŒä¸€ä¸ªæ¡¶çš„è‘¡è„ä¸²å¤ªå¤šäº†ï¼Œæ­¤æ—¶è¦æ‹¿å‡ºæ•°æ®ï¼Œæ—¶é—´å¤æ‚åº¦å°±æ˜¯O(n)ï¼Œå¦‚æœæ²¡æœ‰å¾ˆå¤šå°±æ˜¯O(1)æ•°ç»„çš„é•¿åº¦ã€‚çº¢é»‘æ ‘çš„å¼•å…¥æ˜¯è§£å†³é“¾è¡¨è¿‡é•¿çš„é—®é¢˜ã€‚<br>çº¢é»‘æ ‘æ˜¯æ ‘å½¢çš„é«˜çº§æ•°æ®ç»“æ„ æ—¶é—´å¤æ‚åº¦O(logn)<br>äºŒå‰æ ‘åœ¨æŸäº›æƒ…å†µä¸‹ä¼šé€€åŒ–æˆé“¾è¡¨ å³å­æ ‘æ°¸è¿œæ¯”æ ¹èŠ‚ç‚¹å¤§<br>çº¢é»‘æ ‘ä¼šæ—‹è½¬è‡ªå¹³è¡¡[å±€éƒ¨æ—‹è½¬è¾¾åˆ°å¹³è¡¡] è¶…è¿‡å¤šå°‘å±‚ä¼šæ—‹è½¬ ä¸è‡³äºé€€åŒ–æˆé“¾è¡¨ã€‚</p>
<blockquote>
<p>æ‹‰é“¾æ³•ï¼ˆChainingï¼‰æ˜¯ Java çš„ <code>HashMap</code> åœ¨ JDK 1.8 ä¹‹å‰ä»¥åŠä¹‹åéƒ½ä½¿ç”¨çš„ä¸€ç§è§£å†³å“ˆå¸Œå†²çªçš„æ–¹æ³•ã€‚åœ¨ JDK 1.8 ä¹‹å‰ï¼Œ<code>HashMap</code> çš„å®ç°ä¸»è¦æ˜¯åŸºäºæ‹‰é“¾æ³•ï¼Œå³ä½¿ç”¨é“¾è¡¨æ¥è§£å†³å“ˆå¸Œå†²çªã€‚å½“ä¸åŒçš„é”®é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºç›¸åŒçš„å“ˆå¸Œç ï¼Œå¹¶ä¸”æ˜ å°„åˆ°åŒä¸€ä¸ªæ¡¶ï¼ˆbucketï¼‰æ—¶ï¼Œè¿™äº›é”®å€¼å¯¹å°†ä»¥é“¾è¡¨çš„å½¢å¼å­˜å‚¨åœ¨åŒä¸€ä¸ªæ¡¶ä¸­ã€‚</p>
<p>åœ¨ JDK 1.8 ä¸­ï¼Œ<code>HashMap</code> çš„å®ç°è¿›è¡Œäº†æ”¹è¿›ï¼Œå½“é“¾è¡¨çš„é•¿åº¦è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼ˆé»˜è®¤æ˜¯ 8ï¼‰æ—¶ï¼Œé“¾è¡¨ä¼šè¢«è½¬æ¢æˆçº¢é»‘æ ‘ã€‚è¿™æ˜¯ä¸ºäº†ä¼˜åŒ–å“ˆå¸Œè¡¨çš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å½“å“ˆå¸Œå†²çªä¸¥é‡æ—¶ï¼Œé“¾è¡¨çš„æŸ¥è¯¢æ•ˆç‡ä¼šé™ä½åˆ° O(n)ï¼Œè€Œçº¢é»‘æ ‘å¯ä»¥å°†æŸ¥è¯¢æ•ˆç‡æå‡åˆ° O(log n)ã€‚</p>
<h3 id="çº¢é»‘æ ‘å¦‚ä½•é¿å…å“ˆå¸Œå†²çª"><a href="#çº¢é»‘æ ‘å¦‚ä½•é¿å…å“ˆå¸Œå†²çª" class="headerlink" title="çº¢é»‘æ ‘å¦‚ä½•é¿å…å“ˆå¸Œå†²çª"></a>çº¢é»‘æ ‘å¦‚ä½•é¿å…å“ˆå¸Œå†²çª</h3><p>çº¢é»‘æ ‘æœ¬èº«å¹¶ä¸ç›´æ¥è§£å†³å“ˆå¸Œå†²çªï¼Œè€Œæ˜¯ä¼˜åŒ–äº†å“ˆå¸Œå†²çªå‘ç”Ÿåçš„æ•°æ®ç»“æ„ã€‚ä»¥ä¸‹æ˜¯çº¢é»‘æ ‘åœ¨ <code>HashMap</code> ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p>
<ol>
<li><strong>å“ˆå¸Œå†²çª</strong>ï¼šå½“ä¸åŒçš„é”®äº§ç”Ÿç›¸åŒçš„å“ˆå¸Œç æˆ–ç»è¿‡å–æ¨¡è¿ç®—åè½åœ¨åŒä¸€ä¸ªæ¡¶æ—¶ï¼Œå°±ä¼šå‘ç”Ÿå“ˆå¸Œå†²çªã€‚</li>
<li><strong>é“¾è¡¨</strong>ï¼šåœ¨ JDK 1.8 ä¸­ï¼Œå¦‚æœæ¡¶ä¸­çš„å…ƒç´ å°‘äºä¸€å®šæ•°é‡ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼Œå°±ä¼šä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨è¿™äº›å…ƒç´ ã€‚</li>
<li><strong>çº¢é»‘æ ‘è½¬æ¢</strong>ï¼šå½“é“¾è¡¨çš„é•¿åº¦è¶…è¿‡é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå¹¶ä¸”æ•°ç»„çš„é•¿åº¦è¶…è¿‡ 64ï¼Œé“¾è¡¨ä¼šè¢«è½¬æ¢æˆçº¢é»‘æ ‘ã€‚è¿™æ ·å¯ä»¥å‡å°‘æŸ¥æ‰¾æ—¶é—´ï¼Œå› ä¸ºçº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ã€‚</li>
<li><strong>è‡ªå¹³è¡¡</strong>ï¼šçº¢é»‘æ ‘é€šè¿‡æ—‹è½¬å’Œé‡æ–°ç€è‰²æ“ä½œæ¥ä¿æŒæ ‘çš„å¹³è¡¡ï¼Œä»è€Œé¿å…äº†äºŒå‰æœç´¢æ ‘é€€åŒ–æˆé“¾è¡¨çš„æƒ…å†µã€‚</li>
</ol>
<h3 id="çº¢é»‘æ ‘çš„æ—‹è½¬å’Œè‡ªå¹³è¡¡"><a href="#çº¢é»‘æ ‘çš„æ—‹è½¬å’Œè‡ªå¹³è¡¡" class="headerlink" title="çº¢é»‘æ ‘çš„æ—‹è½¬å’Œè‡ªå¹³è¡¡"></a>çº¢é»‘æ ‘çš„æ—‹è½¬å’Œè‡ªå¹³è¡¡</h3><p>çº¢é»‘æ ‘é€šè¿‡ä»¥ä¸‹è§„åˆ™ä¿æŒå¹³è¡¡ï¼š</p>
<ul>
<li><strong>èŠ‚ç‚¹é¢œè‰²</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯çº¢è‰²ï¼Œè¦ä¹ˆæ˜¯é»‘è‰²ã€‚</li>
<li><strong>æ ¹èŠ‚ç‚¹</strong>ï¼šæ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²çš„ã€‚</li>
<li><strong>çº¢è‰²è§„åˆ™</strong>ï¼šå¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œåˆ™å®ƒçš„å­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ï¼ˆä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ï¼‰ã€‚</li>
<li><strong>é»‘è‰²é«˜åº¦</strong>ï¼šä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚</li>
</ul>
<p>å½“æ’å…¥æˆ–åˆ é™¤èŠ‚ç‚¹æ—¶ï¼Œå¯èƒ½ä¼šç ´åè¿™äº›è§„åˆ™ï¼Œæ­¤æ—¶çº¢é»‘æ ‘ä¼šé€šè¿‡ä»¥ä¸‹æ“ä½œæ¥é‡æ–°å¹³è¡¡ï¼š</p>
<ul>
<li><strong>å·¦æ—‹è½¬</strong>ï¼šå½“å³å­èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼Œè€Œå·¦å­èŠ‚ç‚¹æ˜¯é»‘è‰²æˆ–ä¸å­˜åœ¨æ—¶ï¼Œè¿›è¡Œå·¦æ—‹è½¬ã€‚</li>
<li><strong>å³æ—‹è½¬</strong>ï¼šå½“å·¦å­èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼Œå¹¶ä¸”å®ƒçš„å·¦å­èŠ‚ç‚¹ä¹Ÿæ˜¯çº¢è‰²æ—¶ï¼Œè¿›è¡Œå³æ—‹è½¬ã€‚</li>
<li><strong>é‡æ–°ç€è‰²</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé€šè¿‡æ”¹å˜èŠ‚ç‚¹é¢œè‰²æ¥ç»´æŒçº¢é»‘æ ‘çš„æ€§è´¨ã€‚</li>
</ul>
<p>é€šè¿‡è¿™äº›æ“ä½œï¼Œçº¢é»‘æ ‘ç¡®ä¿äº†å³ä½¿åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ ‘çš„é«˜åº¦ä¹Ÿä¸ä¼šè¶…è¿‡ 2log(n+1)ï¼Œä»è€Œä¿è¯äº† O(log n) çš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼Œçº¢é»‘æ ‘å¹¶ä¸ç›´æ¥è§£å†³å“ˆå¸Œå†²çªï¼Œè€Œæ˜¯<strong>ä¼˜åŒ–äº†å“ˆå¸Œå†²çªåçš„æ•°æ®ç»“æ„</strong>ï¼Œä½¿å¾—å³ä½¿åœ¨å‘ç”Ÿå¤§é‡å“ˆå¸Œå†²çªçš„æƒ…å†µä¸‹ï¼Œ<code>HashMap</code> çš„æ€§èƒ½ä¹Ÿä¸ä¼šæ˜¾è‘—ä¸‹é™ã€‚</p>
</blockquote>
<h5 id="æ‰©å®¹æœºåˆ¶"><a href="#æ‰©å®¹æœºåˆ¶" class="headerlink" title="æ‰©å®¹æœºåˆ¶"></a>æ‰©å®¹æœºåˆ¶</h5><p>newçš„åˆå§‹åŒ– æ•°ç»„ä¸ºç©º<br>å½“ç¬¬ä¸€æ¬¡putçš„æ—¶å€™æ‰ä¸ä¼šä¸ºç©º ä¸º16<br>æ‰©å®¹å› å­ä¸ºä»€ä¹ˆæ˜¯0.75ï¼Ÿhashmapä¸ä»…ä»…java å…¶ä»–è¯­è¨€ä¹Ÿæœ‰è¿™ç§æ•°æ®ç»“æ„ ä½†æ‰©å®¹å› å­å¯èƒ½ä¸åŒï¼Œæ˜¯é€šè¿‡å¤§é‡çš„æ•°å­¦æ¦‚ç‡ç»Ÿè®¡å‡ºçš„æœ€å¥½æœ€å¹³è¡¡çš„å€¼ã€‚è¾¾åˆ°12çš„æ—¶å€™ä¼šæ‰©å®¹æˆ2å€<br>newä¸€ä¸ªhashmapå¯ä»¥æŒ‡å®šæ•°ç»„é•¿åº¦ä¸º7 æ­¤æ—¶æ•°ç»„é•¿åº¦æ˜¯8ã€hashmapçš„é•¿åº¦æ°¸è¿œæ˜¯2çš„å¹‚æ¬¡æ–¹ æ¯”ä½ ä¼ å…¥çš„é•¿åº¦æ°¸è¿œå¤§ ä¸” æ˜¯2çš„å¹‚æ¬¡æ–¹ã€‘ ä¸ºä»€ä¹ˆ2çš„å¹‚æ¬¡æ–¹ï¼Ÿå› ä¸º1.7è¦æ•°ç»„å–æ¨¡ æ€ä¹ˆæ‰“è¿™ä¸ªç¬¦å· shift+5 &#x3D;&gt; %ï¼Œ1.8ä¹‹åç”¨äº†ä½è¿ç®—ï¼Œ&gt;&gt;2 &lt;&lt;2 è®©ä½ çš„å–æ¨¡è¿ç®—æ›´å¿«ã€‚å¦‚æœå‡ºç°hashå†²çªä¼šæ‹‰é“¾ å½“å®ƒçš„<strong>æ•°ç»„é•¿åº¦</strong>å¤§äº64 å¹¶ä¸” <strong>é“¾è¡¨é•¿åº¦</strong>å¤§äº8æ—¶ï¼Œå½“é“¾è¡¨é•¿åº¦å°äºç­‰äº6ä¸´ç•Œå€¼ä¼šå˜å›æ¥ã€ä¸ºä»€ä¹ˆæ˜¯6ï¼Ÿé¿å…é¢‘ç¹åˆ‡æ¢(ç¦»8å¤ªè¿‘) é“¾è¡¨ â†â†’ çº¢é»‘æ ‘[æ¶ˆè€—æ€§èƒ½]ã€‘</p>
<p>é“¾è¡¨1.7ä¹‹å‰æ˜¯å¤´æ’æ³• ä¼šäº§ç”Ÿä¸€æ¡é¦–å°¾ç›¸æ¥çš„æ­»å¾ªç¯ã€å¹¶å‘æƒ…å†µ<del>[ä½†æ˜¯hashmapçº¿ç¨‹ä¸å®‰å…¨ä¸ä¼šç”¨åœ¨å¹¶å‘ï¼Œè¦ç”¨ConcurrentHashMap]</del>ä¸€èµ·put ä¸” åŒä¸€ä¸ªæ¡¶ã€‘<br>1.8ä¹‹åæ˜¯å°¾æ’æ³•ï¼Œå¹¶å‘æƒ…å†µä¸‹ä¸ä¼šå‡ºç°cpué£™é«˜</p>
<h5 id="HashSetåº•å±‚æ•°æ®ç»“æ„"><a href="#HashSetåº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="HashSetåº•å±‚æ•°æ®ç»“æ„"></a>HashSetåº•å±‚æ•°æ®ç»“æ„</h5><p><strong>åº•å±‚æ˜¯åŒ…è£…äº†ä¸€ä¸ªhashmap</strong>ï¼Œæ— åº keyä¸å…è®¸é‡å¤  valueå¯é‡å¤<br>HashSetå•åˆ—æ— åºä¸é‡å¤çš„ keyå°±æ˜¯é‚£ä¸ªå…ƒç´  valueå°±æ˜¯newäº†ä¸€ä¸ªæ— æ„ä¹‰çš„objectå¯¹è±¡</p>
<p>ArrayListå’ŒLinkedListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ ç”¨ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>Vector è¯»å†™éƒ½åŠ é”ã€‚</li>
<li>CopyOnWriteArrayList è¯»ä¸åŠ é” å†™åŠ é”</li>
</ul>
<p>ConcurrentHashMapèƒ½å­˜nullå—ï¼Ÿä¸å…è®¸ä½¿ç”¨ <code>null</code> ä½œä¸ºé”®ï¼Œä½†æ˜¯å…è®¸ä½¿ç”¨ <code>null</code> ä½œä¸ºå€¼ã€‚<br>HashMapï¼šnullé»˜è®¤æ”¾åœ¨ç¬¬ä¸€ä¸ªæ¡¶ä¸‹é¢ ä¸‹æ ‡å†™æ­»ä¸º0</p>
<h6 id="Hashcodeç›¸åŒequalsä¸€å®šç›¸åŒå—ï¼Ÿ"><a href="#Hashcodeç›¸åŒequalsä¸€å®šç›¸åŒå—ï¼Ÿ" class="headerlink" title="Hashcodeç›¸åŒequalsä¸€å®šç›¸åŒå—ï¼Ÿ"></a>Hashcodeç›¸åŒequalsä¸€å®šç›¸åŒå—ï¼Ÿ</h6><p><code>hashCode()</code> ç›¸åŒä¸ä¸€å®šæ„å‘³ç€ <code>equals()</code> ç›¸åŒï¼Œä½† <code>equals()</code> ç›¸åŒåˆ™ <code>hashCode()</code> å¿…é¡»ç›¸åŒã€‚</p>
<ul>
<li><code>equals()</code> æ–¹æ³•ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦é€»è¾‘ä¸Šç›¸ç­‰ã€‚</li>
<li><code>hashCode()</code> æ–¹æ³•ç”¨äºè¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼Œè¿™ä¸ªå“ˆå¸Œç é€šå¸¸ç”¨äºå“ˆå¸Œè¡¨çš„å¿«é€ŸæŸ¥æ‰¾ã€‚</li>
</ul>
<p>keyå¯ä»¥æ”¾å¤åˆå¯¹è±¡ï¼Œè¦æ³¨æ„è¦é‡å†™ hashcode()å’Œequals() å¦‚æœä¸é‡å†™ newäº†çš„ä¸¤ä¸ªå¯¹è±¡æœ‰å¯èƒ½ä¼šç›¸åŒ<br><code>&quot;é‡åœ°&quot;</code> å’Œ <code>&quot;é€šè¯&quot;</code> ã€‚<strong>è®¡ç®—hashcodeä¼šæ¯”equalsæ›´å¿«</strong>ï¼Œä¸€ä¸ªå¯¹è±¡newå‡ºæ¥åhashcodeå·²ç»è®¡ç®—å‡ºæ¥äº†ã€‚equalsè¦æ¯”è¾ƒæ¯ä¸ªå¯¹è±¡å€¼ï¼Œ<strong>æ‰€ä»¥å…ˆåˆ¤æ–­hashcode å†åˆ¤æ–­equals</strong>   é‡å†™ï¼š@Override ç”¨å±æ€§é‡Œé¢çš„hashcodeï¼Œuseré‡Œé¢åŒ…å«äº†å¤æ‚å¯¹è±¡order æ­¤æ—¶orderä¹Ÿè¦é‡å†™ã€‚åŒ…è£…ç±»å·²ç»é‡å†™äº†hashcodeï¼Œè¦æ•´ä¸ªå¯¹è±¡è¿”å›trueæ‰ä¸ºæ­£ç¡®çš„ï¼Œè¦å±‚å±‚é€’è¿›å»åˆ¤æ–­ã€‚hashmapé‡å†™å¤æ‚å¯¹è±¡å°±ä¸€å®šè¦é‡å†™é‚£ä¿©ä¸ª   âˆµ æ˜¯æ¯”è¾ƒå¯¹è±¡é‡Œçš„å±æ€§å€¼<br>list æœ‰åºå¯é‡å¤å•åˆ—<br>map åŒåˆ—keyä¸èƒ½é‡å¤valueå¯é‡å¤  treemapæ˜¯æœ‰åºçš„<br>set å•åˆ—ä¸é‡å¤æ— åº hashset æ— åº treeset æœ‰åº </p>
<p>&#x3D;&#x3D; å€¼ + åœ°å€å€¼<br>equals æ˜¯å¯¹è±¡å±æ€§å€¼æ˜¯å¦ä¸€ ä¸€ç›¸ç­‰</p>
<blockquote>
<h3 id="hashCode-ä¸-equals-æ€»ç»“å¯¹æ¯”è¡¨"><a href="#hashCode-ä¸-equals-æ€»ç»“å¯¹æ¯”è¡¨" class="headerlink" title="hashCode() ä¸ equals() æ€»ç»“å¯¹æ¯”è¡¨"></a><code>hashCode()</code> ä¸ <code>equals()</code> æ€»ç»“å¯¹æ¯”è¡¨</h3><table>
<thead>
<tr>
<th>æ¯”è¾ƒé¡¹</th>
<th><code>hashCode()</code></th>
<th><code>equals()</code></th>
</tr>
</thead>
<tbody><tr>
<td>ä½œç”¨</td>
<td>è¿”å›å¯¹è±¡çš„å“ˆå¸Œå€¼</td>
<td>åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦â€œé€»è¾‘ç›¸ç­‰â€</td>
</tr>
<tr>
<td>å®šä¹‰ä½ç½®</td>
<td><code>Object</code> ç±»ä¸­å®šä¹‰ï¼Œå¯è¢«é‡å†™</td>
<td>åŒä¸Š</td>
</tr>
<tr>
<td>é»˜è®¤è¡Œä¸º</td>
<td>è¿”å›å¯¹è±¡å†…å­˜åœ°å€çš„æ•´æ•°è¡¨ç¤º</td>
<td>æ¯”è¾ƒæ˜¯å¦ä¸ºåŒä¸€å¯¹è±¡ï¼ˆåœ°å€ï¼‰</td>
</tr>
<tr>
<td>éœ€è¦é‡å†™çš„åœºæ™¯</td>
<td>è‡ªå®šä¹‰å¯¹è±¡ä½œä¸ºé›†åˆçš„ keyï¼ˆå¦‚ <code>HashMap</code>ã€<code>HashSet</code>ï¼‰</td>
<td>è‡ªå®šä¹‰å¯¹è±¡éœ€è¦é€»è¾‘æ¯”è¾ƒ</td>
</tr>
<tr>
<td>æ˜¯å¦ä¸å¯¹è±¡å±æ€§æœ‰å…³</td>
<td>é»˜è®¤æ— å…³ï¼Œé‡å†™ååº”æœ‰å…³</td>
<td>é‡å†™æ—¶åº”åªå…³å¿ƒå…³é”®å±æ€§</td>
</tr>
<tr>
<td>æ€§èƒ½</td>
<td>é«˜æ•ˆï¼ˆæ•´å‹å€¼ï¼‰</td>
<td>æ…¢ï¼ˆé€ä¸ªå±æ€§æ¯”è¾ƒï¼‰</td>
</tr>
</tbody></table>
<h3 id="äºŒè€…å…³ç³»è¯´æ˜ï¼ˆæ ¸å¿ƒè§„åˆ™ï¼‰"><a href="#äºŒè€…å…³ç³»è¯´æ˜ï¼ˆæ ¸å¿ƒè§„åˆ™ï¼‰" class="headerlink" title="äºŒè€…å…³ç³»è¯´æ˜ï¼ˆæ ¸å¿ƒè§„åˆ™ï¼‰"></a>äºŒè€…å…³ç³»è¯´æ˜ï¼ˆæ ¸å¿ƒè§„åˆ™ï¼‰</h3><table>
<thead>
<tr>
<th>åˆ¤æ–­</th>
<th>æ˜¯å¦æˆç«‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>equals()</code> è¿”å› <code>true</code> â†’ <code>hashCode()</code> å¿…é¡»ç›¸ç­‰</td>
<td>âœ… å¿…é¡»æˆç«‹</td>
</tr>
<tr>
<td><code>hashCode()</code> ç›¸ç­‰ â†’ <code>equals()</code> ä¸ä¸€å®šç›¸ç­‰</td>
<td>âš ï¸ å¯èƒ½ä¸æˆç«‹ï¼ˆ<strong>å“ˆå¸Œå†²çª</strong>ï¼‰</td>
</tr>
</tbody></table>
<p>ğŸ‘‰ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <strong>HashMap åœ¨æ¯”è¾ƒ key æ—¶ï¼Œå…ˆæ¯” <code>hashCode()</code>ï¼Œå†æ¯” <code>equals()</code><strong>ï¼Œä¸ºäº†</strong>æå‡æ€§èƒ½</strong>ï¼Œä¹Ÿç¡®ä¿<strong>æ­£ç¡®æ€§</strong>ã€‚</p>
<pre><code class="java">String s1 = &quot;é‡åœ°&quot;;
String s2 = &quot;é€šè¯&quot;;

System.out.println(s1.hashCode()); // è¾“å‡º1179395
System.out.println(s2.hashCode()); // è¾“å‡º1179395
System.out.println(s1.equals(s2)); // false
</code></pre>
<p>âš ï¸ ä¸¤ä¸ªå­—ç¬¦ä¸²çš„ <code>hashCode()</code> ç›¸åŒï¼Œä½† <code>equals()</code> ä¸ç›¸åŒï¼Œè¯´æ˜å®ƒä»¬é€»è¾‘ä¸Šä¸ç›¸ç­‰ï¼ˆåªæ˜¯<strong>å“ˆå¸Œå†²çª</strong>ï¼‰ã€‚</p>
<h3 id="âœ…-ä¸ºä»€ä¹ˆè¦é‡å†™-hashCode-å’Œ-equals-ï¼Ÿ"><a href="#âœ…-ä¸ºä»€ä¹ˆè¦é‡å†™-hashCode-å’Œ-equals-ï¼Ÿ" class="headerlink" title="âœ… ä¸ºä»€ä¹ˆè¦é‡å†™ hashCode() å’Œ equals()ï¼Ÿ"></a>âœ… ä¸ºä»€ä¹ˆè¦é‡å†™ <code>hashCode()</code> å’Œ <code>equals()</code>ï¼Ÿ</h3><p>å¦‚æœä½ å°†è‡ªå®šä¹‰å¯¹è±¡ç”¨ä½œé›†åˆä¸­çš„ keyï¼ˆå¦‚æ”¾å…¥ <code>HashMap</code> æˆ– <code>HashSet</code>ï¼‰ï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>ä¸é‡å†™ï¼šé»˜è®¤ä½¿ç”¨åœ°å€åˆ¤æ–­ï¼Œç›¸åŒå†…å®¹çš„æ–°å¯¹è±¡è§†ä¸ºä¸åŒ</li>
<li>æ­£ç¡®é‡å†™ï¼šæŒ‰å±æ€§åˆ¤æ–­å†…å®¹ä¸€è‡´æ€§ï¼Œå¯è¯†åˆ«â€œé€»è¾‘ç›¸åŒâ€çš„å¯¹è±¡</li>
</ul>
<pre><code class="java">public class User &#123;
    private String name;
    private int age;

    @Override
    public boolean equals(Object o) &#123;
        if (this == o) return true;
        if (!(o instanceof User)) return false;
        User other = (User) o;
        return this.age == other.age &amp;&amp; Objects.equals(this.name, other.name);
    &#125;

    @Override
    public int hashCode() &#123;
        return Objects.hash(name, age);
    &#125;
&#125;
</code></pre>
<p><code>equals()</code> ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦é€»è¾‘ç›¸ç­‰ï¼Œ<code>hashCode()</code> ç”¨äºåŠ å¿«é›†åˆæŸ¥æ‰¾æ•ˆç‡ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œè‹¥ä½ è¦å°†å¯¹è±¡ä½œä¸º <code>HashMap</code> æˆ– <code>HashSet</code> çš„ keyï¼Œå¿…é¡»åŒæ—¶é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¿è¯é€»è¾‘ä¸€è‡´æ€§ï¼Œé¿å…å‡ºç°â€œç›¸ç­‰çš„å¯¹è±¡è¿›ä¸äº†é›†åˆâ€çš„é—®é¢˜ã€‚</p>
</blockquote>
<h4 id="HashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å—"><a href="#HashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å—" class="headerlink" title="HashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å—"></a>HashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å—</h4><p>ä¸å®‰å…¨çš„ï¼Œå¯ä»¥ä½¿ç”¨<strong>ConcurrentHashMap<del>çº¿ç¨‹å®‰å…¨</del><strong>ã€Collections.synchronizedMap()ã€</strong>HashTable</strong><br><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šå¤šçº¿ç¨‹å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡Œå¢åˆ æ”¹æ˜¯å¦å—åˆ°å½±å“<br>æ€ä¹ˆåŠï¼Ÿ</p>
<ul>
<li><p><strong>åŠ é”</strong></p>
<ul>
<li>synchronized</li>
<li>ReentrantLock</li>
</ul>
<p>åŠ é”ä¸ºä»€ä¹ˆèƒ½è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿçº¿ç¨‹è®¿é—®èµ„æºçš„å…ˆåé¡ºåº<br>å¤šçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ•°æ® &#x3D;&gt; å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ•°æ®<br><strong>ç§’æ€</strong> &#x3D;&gt;[æ€æƒ³] 1wä¸ªäººä¹° å¯¹ 100ä¸ªåº“å­˜è¿›è¡Œæ‰£å‡ï¼Œåªæ100ä¸ªçº¿ç¨‹ æŠŠ100ä¸ªåº“å­˜åˆ†æˆ10ä»½ å…¶ä¸­æ¯ä»½æœ‰10ä¸ª</p>
<pre><code class="java">åˆå§‹åŒ–åº“å­˜ï¼š åˆ›å»ºä¸€ä¸ªå…±äº«çš„åº“å­˜è®¡æ•°å™¨ï¼Œåˆå§‹å€¼ä¸º100ã€‚
åˆ›å»ºçº¿ç¨‹ï¼š åˆ›å»º100ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨å¯åŠ¨æ—¶åˆ†é…åˆ°ä¸€ä¸ªç‰¹å®šçš„åº“å­˜åˆ†ç‰‡ã€‚
æ‰£å‡åº“å­˜ï¼š æ¯ä¸ªçº¿ç¨‹å°è¯•æ‰£å‡å…¶åˆ†é…åˆ°çš„åº“å­˜åˆ†ç‰‡ä¸­çš„ä¸€ä¸ªå•†å“ã€‚æ‰£å‡æ“ä½œå¿…é¡»æ˜¯åŸå­çš„ï¼Œä»¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚
åŒæ­¥æœºåˆ¶ï¼š ä½¿ç”¨é€‚å½“çš„åŒæ­¥æœºåˆ¶ï¼ˆå¦‚synchronizedå…³é”®å­—ã€ReentrantLockç­‰ï¼‰æ¥ä¿æŠ¤åº“å­˜æ‰£å‡æ“ä½œï¼Œé˜²æ­¢å¹¶å‘é—®é¢˜ã€‚
åº“å­˜æ£€æŸ¥ï¼š åœ¨æ‰£å‡å‰ï¼Œçº¿ç¨‹éœ€è¦æ£€æŸ¥å½“å‰åˆ†ç‰‡æ˜¯å¦æœ‰å‰©ä½™åº“å­˜ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™çº¿ç¨‹å¯ä»¥ç»ˆæ­¢æˆ–è¿›è¡Œå…¶ä»–å¤„ç†ã€‚
</code></pre>
<p>HashTableä¸ç®¡è¯»å†™éƒ½ä¼šç”¨synchronizedåŠ é”ï¼Œå¹¶å‘ä¸€èµ·æ¥è¯»éƒ½åŠ é” æ²¡å¿…è¦ï¼Œæ‰€ä»¥ç”¨äº†<strong>ConcurrentHashMapè¯»ä¸åŠ é” å†™åŠ é”</strong>ã€‚<br>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œ<code>Hashtable</code> å·²ç»è¢«è®¤ä¸ºæ˜¯é—ç•™ä»£ç ï¼Œç°ä»£Javaä»£ç æ›´å€¾å‘äºä½¿ç”¨ <code>HashMap</code>ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰æˆ– <code>ConcurrentHashMap</code>ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ã€‚</p>
</li>
</ul>
<blockquote>
<p><strong>Synchronized</strong></p>
<pre><code class="java">public class SynchronizedExample &#123;
    public synchronized void synchronizedMethod() &#123;
        // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç å—
        System.out.println(&quot;è¿›å…¥åŒæ­¥æ–¹æ³•&quot;);
        // æ‰§è¡Œä¸€äº›æ“ä½œ
        System.out.println(&quot;é€€å‡ºåŒæ­¥æ–¹æ³•&quot;);
    &#125;
&#125;
-----------------------------------------------------
public class SynchronizedBlockExample &#123;
    private final Object lock = new Object();

    public void synchronizedBlock() &#123;
        synchronized (lock) &#123;
            // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç å—
            System.out.println(&quot;è¿›å…¥åŒæ­¥ä»£ç å—&quot;);
            // æ‰§è¡Œä¸€äº›æ“ä½œ
            System.out.println(&quot;é€€å‡ºåŒæ­¥ä»£ç å—&quot;);
        &#125;
    &#125;
&#125;
</code></pre>
<p><strong>ReentrantLock</strong></p>
<pre><code class="java">import java.util.concurrent.locks.ReentrantLock;

public class ReentrantLockExample &#123;
    private final ReentrantLock lock = new ReentrantLock();

    public void lockedMethod() &#123;
        lock.lock(); // åŠ é”
        try &#123;
            // è¿™é‡Œæ˜¯åŒæ­¥ä»£ç å—
            System.out.println(&quot;è¿›å…¥é”å®šçš„æ–¹æ³•&quot;);
            // æ‰§è¡Œä¸€äº›æ“ä½œ
            System.out.println(&quot;é€€å‡ºé”å®šçš„æ–¹æ³•&quot;);
        &#125; finally &#123;
            lock.unlock(); // è§£é”
        &#125;
    &#125;
&#125;
</code></pre>
</blockquote>
<h4 id="çº¢é»‘æ ‘æŸ¥è¯¢æ•ˆç‡é«˜çš„åŸå› "><a href="#çº¢é»‘æ ‘æŸ¥è¯¢æ•ˆç‡é«˜çš„åŸå› " class="headerlink" title="çº¢é»‘æ ‘æŸ¥è¯¢æ•ˆç‡é«˜çš„åŸå› "></a>çº¢é»‘æ ‘æŸ¥è¯¢æ•ˆç‡é«˜çš„åŸå› </h4><p>çº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ï¼Œå®ƒé€šè¿‡ç‰¹å®šçš„è§„åˆ™æ¥ä¿æŒæ ‘çš„å¹³è¡¡ï¼Œè¿™äº›è§„åˆ™ç¡®ä¿äº†æ ‘çš„é«˜åº¦å¤§çº¦æ˜¯<strong>log(n)</strong><br>è‡ªå¹³è¡¡ å±€éƒ¨æ—‹è½¬ </p>
<p>hashMapæ—¶é—´å¤æ‚åº¦</p>
<ul>
<li>O(1)ï¼šä¸æ¶‰åŠåˆ°æ‹‰é“¾</li>
<li>O(n)ï¼šæ‹‰é“¾ä¸æ˜¯æ ‘</li>
<li>O(logn)ï¼šæ¡¶ä¸ºçº¢é»‘æ ‘</li>
</ul>
<h4 id="è¿™ä¸ªæµ‹è¯•æ˜¯ä½ åšçš„å—ï¼Œè¿˜æ˜¯ä½ ä»¬å›¢é˜Ÿå»åšçš„ï¼Ÿ"><a href="#è¿™ä¸ªæµ‹è¯•æ˜¯ä½ åšçš„å—ï¼Œè¿˜æ˜¯ä½ ä»¬å›¢é˜Ÿå»åšçš„ï¼Ÿ" class="headerlink" title="è¿™ä¸ªæµ‹è¯•æ˜¯ä½ åšçš„å—ï¼Œè¿˜æ˜¯ä½ ä»¬å›¢é˜Ÿå»åšçš„ï¼Ÿ"></a>è¿™ä¸ªæµ‹è¯•æ˜¯ä½ åšçš„å—ï¼Œè¿˜æ˜¯ä½ ä»¬å›¢é˜Ÿå»åšçš„ï¼Ÿ</h4><p>åƒè‡ªæµ‹çš„è¯æ˜¯æˆ‘è‡ªå·±å»åšçš„(æµ‹è¯•ç”¨ä¾‹ã€apifox)ï¼Œç„¶åäº¤ç»™ä¸“ä¸šæµ‹è¯•äººå‘˜</p>
<h4 id="å›¢é˜Ÿæ˜¯æ€ä¹ˆåä½œçš„ï¼Ÿ"><a href="#å›¢é˜Ÿæ˜¯æ€ä¹ˆåä½œçš„ï¼Ÿ" class="headerlink" title="å›¢é˜Ÿæ˜¯æ€ä¹ˆåä½œçš„ï¼Ÿ"></a>å›¢é˜Ÿæ˜¯æ€ä¹ˆåä½œçš„ï¼Ÿ</h4><p>åƒæˆ‘ä»¬å›¢é˜Ÿçš„è¯ï¼Œæœ‰ä½¿ç”¨ç¦…é“æ¥åšæˆ‘ä»¬çš„æ–‡æ¡£ç®¡ç†ï¼Œéœ€æ±‚ç®¡ç†å’Œéœ€æ±‚çš„å˜æ›´æ§åˆ¶ï¼Œå’Œå·¥ä½œçš„ä¸€ä¸ªç»Ÿè®¡æŠ¥è¡¨ï¼Œå¤§éƒ¨åˆ†çš„åä½œä»»åŠ¡éƒ½å¯ä»¥åœ¨ç¦…é“ä¸Šå®Œæˆï¼Œä»£ç è¿™ä¸€å—æˆ‘ä»¬æ˜¯ä½¿ç”¨gitæ¥åšä¸€ä¸ªä»£ç ç®¡ç†å’Œåä½œçš„ã€‚</p>
<h4 id="linuxæŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å¤§å°çš„å‘½ä»¤"><a href="#linuxæŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å¤§å°çš„å‘½ä»¤" class="headerlink" title="linuxæŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å¤§å°çš„å‘½ä»¤"></a>linuxæŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å¤§å°çš„å‘½ä»¤</h4><p>ls -lh</p>
<h4 id="linuxæŸ¥çœ‹æ–‡ä»¶å¤¹å¤§å°çš„å‘½ä»¤"><a href="#linuxæŸ¥çœ‹æ–‡ä»¶å¤¹å¤§å°çš„å‘½ä»¤" class="headerlink" title="linuxæŸ¥çœ‹æ–‡ä»¶å¤¹å¤§å°çš„å‘½ä»¤"></a>linuxæŸ¥çœ‹æ–‡ä»¶å¤¹å¤§å°çš„å‘½ä»¤</h4><p>du -sh<br>du -sh â€“all éšè—<br>du -sh .&#x2F;* : å•ç‹¬åˆ—å‡ºå„å­é¡¹å ç”¨çš„å®¹é‡</p>
<h4 id="linuxæŸ¥çœ‹è¿›ç¨‹çš„å‘½ä»¤ï¼ŒåŠ¨æ€æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€å100è¡Œçš„å‘½ä»¤"><a href="#linuxæŸ¥çœ‹è¿›ç¨‹çš„å‘½ä»¤ï¼ŒåŠ¨æ€æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€å100è¡Œçš„å‘½ä»¤" class="headerlink" title="linuxæŸ¥çœ‹è¿›ç¨‹çš„å‘½ä»¤ï¼ŒåŠ¨æ€æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€å100è¡Œçš„å‘½ä»¤"></a>linuxæŸ¥çœ‹è¿›ç¨‹çš„å‘½ä»¤ï¼ŒåŠ¨æ€æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€å100è¡Œçš„å‘½ä»¤</h4><p>ps -ef<br>ps aux [æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹ï¼ˆåŒ…æ‹¬å…¶ä»–ç”¨æˆ·çš„è¿›ç¨‹ï¼‰ï¼š]<br>ps -ef | grep mysql</p>
<p><strong>åŠ¨æ€</strong>ï¼štail  -n 100 -f xxx ã€-f â†’ followã€‘<br><strong>é™æ€</strong>ï¼štail  -n 100 xxx</p>
<h4 id="å¸¸ç”¨çš„Linuxå‘½ä»¤"><a href="#å¸¸ç”¨çš„Linuxå‘½ä»¤" class="headerlink" title="å¸¸ç”¨çš„Linuxå‘½ä»¤"></a>å¸¸ç”¨çš„Linuxå‘½ä»¤</h4><h6 id="rm-x3D-romove"><a href="#rm-x3D-romove" class="headerlink" title="rm &#x3D; romove"></a>rm &#x3D; romove</h6><p>ç”¨äºåˆ é™¤æ–‡ä»¶å’Œç›®å½•<br> rm [-rf] name<br>-r(recursiveé€’å½’)ï¼šå°†ç›®å½•åŠç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶ï¼ˆç›®å½•ï¼‰é€ä¸€åˆ é™¤ï¼Œå³é€’å½’åˆ é™¤<br>-f(force)ï¼šæ— éœ€ç¡®è®¤ï¼Œç›´æ¥åˆ é™¤</p>
<h6 id="rmdir-x3D-remove-directory"><a href="#rmdir-x3D-remove-directory" class="headerlink" title="rmdir &#x3D; remove directory"></a>rmdir &#x3D; remove directory</h6><p>å®ƒç”¨äºåˆ é™¤ç©ºç›®å½•ã€‚å¦‚æœç›®å½•ä¸ä¸ºç©ºï¼Œå³ç›®å½•ä¸­åŒ…å«æ–‡ä»¶æˆ–å…¶ä»–å­ç›®å½•ï¼Œrmdir å‘½ä»¤å°†æ— æ³•åˆ é™¤è¯¥ç›®å½•</p>
<h6 id="pwd-x3D-print-working-directory"><a href="#pwd-x3D-print-working-directory" class="headerlink" title="pwd &#x3D; print working directory"></a>pwd &#x3D; print working directory</h6><p>æ‰“å°å‡ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚å½“ä½ éœ€è¦çŸ¥é“ä½ åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„å½“å‰ä½ç½®æ—¶ï¼Œè¿™ä¸ªå‘½ä»¤éå¸¸æœ‰ç”¨</p>
<h6 id="cp-x3D-copy"><a href="#cp-x3D-copy" class="headerlink" title="cp &#x3D; copy"></a>cp &#x3D; copy</h6><p>å¤åˆ¶æ–‡ä»¶å’Œç›®å½•ã€‚è¿™ä¸ªå‘½ä»¤å¯ä»¥ç”¨æ¥åˆ›å»ºæ–‡ä»¶çš„å‰¯æœ¬æˆ–å°†æ–‡ä»¶ä»ä¸€ä¸ªä½ç½®ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚<br>cp [-r] source dest<br>-r (recursiveé€’å½’)ï¼šå¦‚æœå¤åˆ¶çš„æ˜¯ç›®å½•éœ€è¦ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œæ­¤æ—¶å°†å¤åˆ¶è¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„å­ç›®å½•å’Œæ–‡ä»¶</p>
<h6 id="mv-x3D-move"><a href="#mv-x3D-move" class="headerlink" title="mv &#x3D; move"></a>mv &#x3D; move</h6><p>ä¸ºæ–‡ä»¶æˆ–ç›®å½•æ”¹åã€æˆ–å°†æ–‡ä»¶æˆ–ç›®å½•ç§»åŠ¨åˆ°å…¶ä»–ä½ç½®ã€ç§»åŠ¨ é‡å‘½å ä¿®æ”¹ã€‘</p>
<h6 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h6><p>ç”¨äºæœç´¢æ–‡æœ¬æ•°æ®ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æŒ‡å®šçš„æ¨¡å¼<br>æŸ¥çœ‹ç‰¹å®šè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚è¿›ç¨‹åä¸º <u>mysql</u><br>ps -ef | grep mysql</p>
<h6 id="tar-tape-archive"><a href="#tar-tape-archive" class="headerlink" title="tar [tape archive]"></a>tar [tape archive]</h6><p>ç”¨äºæ‰“åŒ…å¤šä¸ªæ–‡ä»¶å’Œç›®å½•åˆ°ä¸€ä¸ªå½’æ¡£æ–‡ä»¶ä¸­ï¼Œæˆ–è€…ä»å½’æ¡£æ–‡ä»¶ä¸­æå–æ–‡ä»¶</p>
<h6 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h6><p>åˆ‡æ¢è·¯å¾„</p>
<h6 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h6><p>ç¼–è¾‘æ–‡ä»¶</p>
<h6 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h6><p>æŸ¥çœ‹æ–‡ä»¶[head]</p>
<h6 id="å¦‚ä½•æŸ¥æ—¥å¿—"><a href="#å¦‚ä½•æŸ¥æ—¥å¿—" class="headerlink" title="å¦‚ä½•æŸ¥æ—¥å¿—"></a>å¦‚ä½•æŸ¥æ—¥å¿—</h6><p>æŸ¥çœ‹<code>/var/log/user.log</code>æ–‡ä»¶ï¼Œå¹¶ä¸”æƒ³è¦è·Ÿè¸ªç”¨æˆ· <u>nameï¼š<code>pcy</code></u> çš„æ´»åŠ¨</p>
<p>tail -f &#x2F;var&#x2F;log&#x2F;user.log | grep â€œpcyâ€<br><span style = "color:red"><strong>é«˜çº§ä¸“ç”¨ä½¿ç”¨</strong></span>ï¼š<code>awk</code> å¯ä»¥ç”¨æ­£åˆ™ç­‰ä¸€äº›é€»è¾‘æ“ä½œå»è·å–æ—¥å¿—</p>
<blockquote>
<h4 id="å†…å»ºå‡½æ•°"><a href="#å†…å»ºå‡½æ•°" class="headerlink" title="å†…å»ºå‡½æ•°"></a>å†…å»ºå‡½æ•°</h4><p><code>awk</code> éå¸¸å¼ºå¤§ï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œå¤æ‚çš„æ–‡æœ¬åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆï¼Œ<code>awk</code> æœ‰è®¸å¤šå†…å»ºå‡½æ•°ï¼Œå¦‚ <code>length()</code>ã€<code>toupper()</code>ã€<code>tolower()</code> ç­‰ã€‚</p>
<pre><code>awk &#39;&#123;print toupper($0)&#125;&#39; filename  # å°†æ‰€æœ‰å†…å®¹è½¬æ¢ä¸ºå¤§å†™
</code></pre>
<h4 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h4><pre><code>awk &#39;&#123;if ($1 &gt; 100) print$1&#125;&#39; filename
</code></pre>
<h4 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h4><pre><code>awk &#39;&#123;for (i=1; i&lt;=NF; i++) print $i&#125;&#39; filename
</code></pre>
<h4 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h4><pre><code>awk &#39;&#123;count[$1]++&#125; END &#123;for (word in count) print word, count[word]&#125;&#39; filename
</code></pre>
</blockquote>
<h4 id="ä½ ä»¬æ¥å£æ˜¯å¦‚ä½•è®©å‰ç«¯è°ƒç”¨çš„"><a href="#ä½ ä»¬æ¥å£æ˜¯å¦‚ä½•è®©å‰ç«¯è°ƒç”¨çš„" class="headerlink" title="ä½ ä»¬æ¥å£æ˜¯å¦‚ä½•è®©å‰ç«¯è°ƒç”¨çš„"></a>ä½ ä»¬æ¥å£æ˜¯å¦‚ä½•è®©å‰ç«¯è°ƒç”¨çš„</h4><p>æˆ‘ä»¬ä¼šåœ¨è®¾è®¡é˜¶æ®µæå‰è®¾è®¡å¥½ç»™å‰ç«¯ å¹¶è¡Œå¼€å‘ å‰åç«¯è”è°ƒ[æœ¬åœ°ipç«¯å£å‘Šè¯‰å‰ç«¯]</p>
<h4 id="æ¥å£æ–‡æ¡£æ€ä¹ˆå®šä¸‹æ¥çš„"><a href="#æ¥å£æ–‡æ¡£æ€ä¹ˆå®šä¸‹æ¥çš„" class="headerlink" title="æ¥å£æ–‡æ¡£æ€ä¹ˆå®šä¸‹æ¥çš„"></a>æ¥å£æ–‡æ¡£æ€ä¹ˆå®šä¸‹æ¥çš„</h4><p>æ ¹æ®é¡µé¢åŸå‹ã€éœ€æ±‚è®¾è®¡æ¥å£æ–‡æ¡£[åç«¯è‡ªå·±å†™]ï¼Œç»å¤§éƒ¨åˆ†åç«¯çœ‹åŸå‹çš„å‡ºå‚å…¥å‚ æ— å¤ªå¤§éœ€æ±‚å’Œå‰ç«¯å•†é‡ã€‚ã€å‰ç«¯ç»„ä»¶åº“ã€‘[è‹¥ä¿®æ”¹è¿”å›ç»“æ„çš„æ—¶å€™] [æŒ‰ç…§æ•°æ®ç»“æ„ä¿®æ”¹] éœ€è¦å¬å‰ç«¯æ„è§</p>
<h4 id="å‰ç«¯è°ƒç”¨åç«¯ç”¨çš„æ˜¯ä»€ä¹ˆè¯·æ±‚æ–¹å¼"><a href="#å‰ç«¯è°ƒç”¨åç«¯ç”¨çš„æ˜¯ä»€ä¹ˆè¯·æ±‚æ–¹å¼" class="headerlink" title="å‰ç«¯è°ƒç”¨åç«¯ç”¨çš„æ˜¯ä»€ä¹ˆè¯·æ±‚æ–¹å¼"></a>å‰ç«¯è°ƒç”¨åç«¯ç”¨çš„æ˜¯ä»€ä¹ˆè¯·æ±‚æ–¹å¼</h4><p><strong>WebSocket</strong>ã€åŸºäºé•¿è¿æ¥é€šè®¯ã€‘<br>HTTP</p>
<blockquote>
<p>å‰ç«¯å¼€å‘ä¸­ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>è·å–æ•°æ®ï¼šä½¿ç”¨GETè¯·æ±‚ã€‚</li>
<li>æäº¤è¡¨å•æˆ–æ•°æ®ï¼šä½¿ç”¨POSTè¯·æ±‚ã€‚</li>
<li>æ›´æ–°èµ„æºï¼šä½¿ç”¨PUTæˆ–PATCHè¯·æ±‚ã€‚</li>
<li>åˆ é™¤èµ„æºï¼šä½¿ç”¨DELETEè¯·æ±‚ã€‚</li>
</ul>
<p>å‰ç«¯å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å‘èµ·è¿™äº›è¯·æ±‚ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½¿ç”¨HTMLè¡¨å•ï¼ˆé€šå¸¸ç”¨äºGETå’ŒPOSTè¯·æ±‚ï¼‰ã€‚</li>
<li>ä½¿ç”¨JavaScriptçš„<code>XMLHttpRequest</code>å¯¹è±¡æˆ–è€…æ›´ç°ä»£çš„<code>fetch</code> APIæ¥å‘èµ·å„ç§ç±»å‹çš„HTTPè¯·æ±‚ã€‚</li>
<li>ä½¿ç”¨å„ç§å‰ç«¯æ¡†æ¶å’Œåº“ï¼ˆå¦‚React, Angular, Vue.jsï¼‰ä¸­æä¾›çš„å°è£…å¥½çš„HTTPæœåŠ¡ã€‚</li>
</ul>
</blockquote>
<h4 id="SpringBootä¸»è¦çš„ä¸€äº›æ³¨è§£ï¼Ÿéƒ½æœ‰å“ªäº›ï¼Œä»¥åŠä¸»è¦ä½œç”¨"><a href="#SpringBootä¸»è¦çš„ä¸€äº›æ³¨è§£ï¼Ÿéƒ½æœ‰å“ªäº›ï¼Œä»¥åŠä¸»è¦ä½œç”¨" class="headerlink" title="SpringBootä¸»è¦çš„ä¸€äº›æ³¨è§£ï¼Ÿéƒ½æœ‰å“ªäº›ï¼Œä»¥åŠä¸»è¦ä½œç”¨"></a><strong>SpringBootä¸»è¦çš„ä¸€äº›æ³¨è§£ï¼Ÿéƒ½æœ‰å“ªäº›ï¼Œä»¥åŠä¸»è¦ä½œç”¨</strong></h4><pre><code class="java">SpringBootï¼š
@SpringBootApplication [è§â†“â†“]
@ConfigurationPropertiesï¼šæ³¨è§£ç”¨äºå°†å¤–éƒ¨é…ç½®ï¼ˆå¦‚æ¥è‡ªpropertiesæ–‡ä»¶ã€YAMLæ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ï¼‰ç»‘å®šåˆ°JavaBeanä¸Šã€‚å®ƒçš„ä½œç”¨æ˜¯å°†é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§æ˜ å°„åˆ°JavaBeançš„å±æ€§ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è¿™äº›é…ç½®å±æ€§ã€‚
@SpringBootTestï¼šç”¨äºæµ‹è¯• Spring Boot åº”ç”¨ï¼Œæä¾›æµ‹è¯•ç¯å¢ƒçš„æ”¯æŒ
@EnableConfigurationPropertiesï¼šå¯ç”¨å¯¹é…ç½®å±æ€§çš„æ”¯æŒï¼Œå…è®¸å°†é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§æ³¨å…¥åˆ° bean ä¸­ã€‚


Springï¼š
@Component 
@ComponentScan 
@Conditional 
</code></pre>
<pre><code class="java">@SpringBootApplication æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå®ƒç»“åˆäº†ä»¥ä¸‹ä¸‰ä¸ªæ³¨è§£çš„åŠŸèƒ½ï¼š
1. @SpringBootConfiguration: è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªSpring Booté…ç½®ç±»ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª@Configurationæ³¨è§£ï¼Œç”¨äºå®šä¹‰é…ç½®ç±»ï¼Œå¯ä»¥åŒ…å«å¤šä¸ª@Beanæ³¨è§£çš„æ–¹æ³•ã€‚
2. @EnableAutoConfiguration: å‘Šè¯‰Spring BootåŸºäºç±»è·¯å¾„è®¾ç½®ã€å…¶ä»–beanå’Œå„ç§å±æ€§è®¾ç½®æ¥æ·»åŠ beanã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ·»åŠ äº†spring-webmvcå’Œthymeleafçš„ä¾èµ–ï¼Œè¿™ä¸ªæ³¨è§£å°±ä¼šè‡ªåŠ¨é…ç½®ä½ çš„åº”ç”¨ç¨‹åºä¸ºä¸€ä¸ªwebåº”ç”¨ç¨‹åºã€‚
3. @ComponentScan: å‘Šè¯‰Springåœ¨åŒ…åŠå…¶å­åŒ…ä¸‹æ‰«ææ³¨è§£å®šä¹‰çš„ç»„ä»¶ï¼ˆå¦‚@Component, @Service, @Repositoryç­‰ï¼‰ã€‚
</code></pre>
<h4 id="aopåœ¨é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ä½¿ç”¨ï¼Ÿaopä½¿ç”¨çš„ä¸€äº›æ³¨è§£åŠå…¶åŠŸèƒ½"><a href="#aopåœ¨é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ä½¿ç”¨ï¼Ÿaopä½¿ç”¨çš„ä¸€äº›æ³¨è§£åŠå…¶åŠŸèƒ½" class="headerlink" title="aopåœ¨é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ä½¿ç”¨ï¼Ÿaopä½¿ç”¨çš„ä¸€äº›æ³¨è§£åŠå…¶åŠŸèƒ½"></a><strong>aopåœ¨é¡¹ç›®ä¸­æœ‰æ²¡æœ‰ä½¿ç”¨ï¼Ÿaopä½¿ç”¨çš„ä¸€äº›æ³¨è§£åŠå…¶åŠŸèƒ½</strong></h4><p>ä¸€å®šè¦æè¿°é¡¹ç›®åœºæ™¯ï¼Œwebä½¿ç”¨aopæ‰“å°æ“ä½œæ—¥å¿—ã€ä½¿ç”¨aopåšæ•°æ®è„±æ•(150***8786)<br><u>è¿‡æ»¤å™¨</u>æ˜¯ServletæŠ€æœ¯çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯Java EEè§„èŒƒçš„ä¸€éƒ¨åˆ†<br><u>æ‹¦æˆªå™¨</u>æ˜¯Spring MVCæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåœ¨å¤„ç†HTTPè¯·æ±‚æ—¶æ‹¦æˆªæ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨ã€‚<br>AOPåº•å±‚æ˜¯åŠ¨æ€ä»£ç†è®¾è®¡æ¨¡å¼ï¼Œåœ¨<u>ç†è®ºä¸Š</u>æ•ˆæœåœ¨ä¸€å®šç¨‹åº¦ä¸Šç›¸åŒ<br>è¿‡æ»¤å™¨æ‹¦æˆªå™¨ä¸€èˆ¬æ‹¦æˆªæŸä¸ªwebçš„å‰åï¼Œåœ¨controlleræ‰§è¡Œå‰å<br>AOPæ˜¯ä¸‡ç‰©çš†å¯æ‹¦æˆªã€ç”šè‡³æ¥å£å’Œç±»éƒ½å¯ä»¥åˆ‡ï¼Œå¯ä»¥å¢å¼ºcontrollerã€serviceã€mapperâ€¦â€¦</p>
<p><u>å®šä¹‰ä¸€ä¸ªåˆ‡é¢ç±» <code>@Aspect</code> å£°æ˜ä¸ºåˆ‡é¢ç±» + @Component</u><br><u>å®šä¹‰åˆ‡ç‚¹ <code>@Pointcut</code> å£°æ˜åˆ‡ç‚¹è¡¨è¾¾å¼</u></p>
<blockquote>
<p>egï¼š@AfterReturning(pointcut &#x3D; â€œexecution(public String com.example.yourpackage.Controller.*(..))â€, returning &#x3D; â€œresultâ€)</p>
</blockquote>
<h6 id="é€šçŸ¥"><a href="#é€šçŸ¥" class="headerlink" title="é€šçŸ¥"></a>é€šçŸ¥</h6><ul>
<li>å‰ç½®  @Before</li>
<li>åç½®  @After</li>
<li>è¿”å›  @AfterReturning</li>
<li>å¼‚å¸¸  @AfterThrowing</li>
<li>ç¯ç»•  @Around</li>
</ul>
<blockquote>
<h3 id="ğŸ’¬-æœ‰æ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨-AOPï¼Ÿç”¨æ¥åšä»€ä¹ˆï¼Ÿ"><a href="#ğŸ’¬-æœ‰æ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨-AOPï¼Ÿç”¨æ¥åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="ğŸ’¬ æœ‰æ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ AOPï¼Ÿç”¨æ¥åšä»€ä¹ˆï¼Ÿ"></a>ğŸ’¬ <strong>æœ‰æ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ AOPï¼Ÿç”¨æ¥åšä»€ä¹ˆï¼Ÿ</strong></h3><blockquote>
<p>æœ‰ä½¿ç”¨ï¼Œä¸»è¦åº”ç”¨åœºæ™¯æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>ä¸€æ˜¯ <strong>æ“ä½œæ—¥å¿—è®°å½•</strong>ï¼šåœ¨ Web é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ AOP æ‹¦æˆª Controller å±‚æ–¹æ³•ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œåè®°å½•æ“ä½œäººã€æ“ä½œç±»å‹ã€æ¥å£è·¯å¾„ç­‰ä¿¡æ¯ï¼Œç”¨äºå®¡è®¡å’Œæ’æŸ¥é—®é¢˜ã€‚</li>
<li>äºŒæ˜¯ <strong>æ•°æ®è„±æ•å¤„ç†</strong>ï¼šåœ¨æŸäº›è¿”å›å€¼ä¸­åŒ…å«æ‰‹æœºå·ã€èº«ä»½è¯ç­‰æ•æ„Ÿå­—æ®µï¼Œé€šè¿‡ AOP æ‹¦æˆª Service è¿”å›ç»“æœï¼Œåœ¨è¿”å›ç»™å‰ç«¯å‰è¿›è¡Œç»Ÿä¸€è„±æ•ï¼ˆå¦‚ï¼š150***8786ï¼‰ã€‚</li>
</ul>
</blockquote>
<pre><code class="java">@Aspect
@Component
public class LogAspect &#123;

    // å®šä¹‰åˆ‡ç‚¹ï¼Œæ‹¦æˆªæ‰€æœ‰ controller åŒ…ä¸‹çš„æ–¹æ³•
    @Pointcut(&quot;execution(* com.example.controller..*(..))&quot;)
    public void controllerPointcut() &#123;&#125;

    // ç¯ç»•é€šçŸ¥
    @Around(&quot;controllerPointcut()&quot;)
    public Object doAround(ProceedingJoinPoint joinPoint) throws Throwable &#123;
        long start = System.currentTimeMillis();
        try &#123;
            return joinPoint.proceed();
        &#125; finally &#123;
            long end = System.currentTimeMillis();
            System.out.println(&quot;æ¥å£è€—æ—¶ï¼š&quot; + (end - start) + &quot;ms&quot;);
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="ğŸ§ -AOP-é€šçŸ¥ç±»å‹ç®€è¿°ï¼ˆç­”é¢˜å»ºè®®ï¼‰"><a href="#ğŸ§ -AOP-é€šçŸ¥ç±»å‹ç®€è¿°ï¼ˆç­”é¢˜å»ºè®®ï¼‰" class="headerlink" title="ğŸ§  AOP é€šçŸ¥ç±»å‹ç®€è¿°ï¼ˆç­”é¢˜å»ºè®®ï¼‰"></a><strong>ğŸ§  AOP é€šçŸ¥ç±»å‹ç®€è¿°ï¼ˆç­”é¢˜å»ºè®®ï¼‰</strong></h3><table>
<thead>
<tr>
<th>é€šçŸ¥ç±»å‹</th>
<th>æ³¨è§£</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>å‰ç½®é€šçŸ¥</td>
<td><code>@Before</code></td>
<td>åœ¨æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œ</td>
</tr>
<tr>
<td>åç½®é€šçŸ¥</td>
<td><code>@After</code></td>
<td>æ–¹æ³•æ‰§è¡Œåï¼ˆæ— è®ºæˆåŠŸæˆ–å¼‚å¸¸ï¼‰</td>
</tr>
<tr>
<td>è¿”å›é€šçŸ¥</td>
<td><code>@AfterReturning</code></td>
<td>æ–¹æ³•<strong>æˆåŠŸè¿”å›å</strong>æ‰§è¡Œï¼Œå¯è·å–è¿”å›å€¼</td>
</tr>
<tr>
<td>å¼‚å¸¸é€šçŸ¥</td>
<td><code>@AfterThrowing</code></td>
<td>æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œ</td>
</tr>
<tr>
<td>ç¯ç»•é€šçŸ¥</td>
<td><code>@Around</code></td>
<td>æ–¹æ³•æ‰§è¡Œå‰åéƒ½å¯æ‰§è¡Œï¼Œé€‚åˆç»Ÿä¸€å¤„ç†ï¼ˆå¦‚ tryâ€¦finallyï¼‰</td>
</tr>
</tbody></table>
<h3 id="ä½ åœ¨é¡¹ç›®ä¸­é‡åˆ°çš„-AOP-æ³¨æ„äº‹é¡¹"><a href="#ä½ åœ¨é¡¹ç›®ä¸­é‡åˆ°çš„-AOP-æ³¨æ„äº‹é¡¹" class="headerlink" title="ä½ åœ¨é¡¹ç›®ä¸­é‡åˆ°çš„ AOP æ³¨æ„äº‹é¡¹"></a><strong>ä½ åœ¨é¡¹ç›®ä¸­é‡åˆ°çš„ AOP æ³¨æ„äº‹é¡¹</strong></h3><ul>
<li>å¦‚æœä½ åœ¨ AOP ä¸­ä½¿ç”¨ <code>ThreadLocal</code>ï¼ˆå¦‚å­˜å‚¨ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼‰ï¼Œ<strong>ä¸€å®šè¦åœ¨æ–¹æ³•æ‰§è¡Œå®Œåè°ƒç”¨ <code>remove()</code> é‡Šæ”¾èµ„æº</strong>ï¼Œå¦åˆ™å¯èƒ½é€ æˆ<strong>å†…å­˜æ³„æ¼</strong>ã€‚</li>
<li>æ¨èä½¿ç”¨ <code>@Around</code> + <code>try-finally</code> æ¨¡å¼ï¼Œ<strong>æ— è®ºæ˜¯å¦æŠ›å¼‚å¸¸ï¼Œfinally éƒ½èƒ½æ‰§è¡Œ</strong>ï¼Œæ¯”å¦‚æ¸…ç†ä¸Šä¸‹æ–‡ã€‚</li>
<li><code>@AfterReturning</code>ï¼š<strong>ä»…åœ¨æ–¹æ³•æˆåŠŸè¿”å›æ—¶æ‰§è¡Œ</strong>ï¼Œ<strong>ä¸ä¼šå¤„ç†å¼‚å¸¸æƒ…å†µ</strong>ï¼Œè¿™ä¸€ç‚¹é¢è¯•å¸¸è€ƒã€‚</li>
<li>AOP æ˜¯åŸºäº <strong>åŠ¨æ€ä»£ç†æœºåˆ¶ï¼ˆJDK æˆ– CGLIBï¼‰</strong>ï¼Œæœ¬è´¨æ˜¯å¯¹æ–¹æ³•çš„å¢å¼ºã€‚å’Œæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æœ€å¤§çš„ä¸åŒæ˜¯ï¼š<strong>AOP ä¸æ˜¯ä»…é™äº HTTP è¯·æ±‚ï¼Œå¯ä»¥å¢å¼ºä»»æ„ Bean çš„ä»»æ„æ–¹æ³•ã€‚</strong></li>
</ul>
</blockquote>
<h4 id="ä½ åœ¨å…¬å¸é‡Œè´Ÿè´£çš„å†…å®¹"><a href="#ä½ åœ¨å…¬å¸é‡Œè´Ÿè´£çš„å†…å®¹" class="headerlink" title="ä½ åœ¨å…¬å¸é‡Œè´Ÿè´£çš„å†…å®¹"></a><strong>ä½ åœ¨å…¬å¸é‡Œè´Ÿè´£çš„å†…å®¹</strong></h4><h4 id="æƒ³åœ¨controllerè®¿é—®å®Œä¹‹åï¼Œæƒ³åœ¨aopå®ç°ä¹‹åå†è¿›è¡Œæ“ä½œ"><a href="#æƒ³åœ¨controllerè®¿é—®å®Œä¹‹åï¼Œæƒ³åœ¨aopå®ç°ä¹‹åå†è¿›è¡Œæ“ä½œ" class="headerlink" title="æƒ³åœ¨controllerè®¿é—®å®Œä¹‹åï¼Œæƒ³åœ¨aopå®ç°ä¹‹åå†è¿›è¡Œæ“ä½œ"></a><strong>æƒ³åœ¨controllerè®¿é—®å®Œä¹‹åï¼Œæƒ³åœ¨aopå®ç°ä¹‹åå†è¿›è¡Œæ“ä½œ</strong></h4><p>UserThreadLocal åœ¨æ‰§è¡Œå®Œä¹‹åè¦ remove å‡ºå»ï¼ŒæŠ›å¼‚å¸¸ä¹Ÿä¼šæ‰§è¡Œ<br>@After ä¸ç®¡æœ‰æ— å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ<br>@Around ç»“åˆtryâ€¦catchâ€¦finally é‡Œä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·æ•ˆæœ</p>
<blockquote>
<p><code>@After</code>ï¼šè¿™ä¸ªæ³¨è§£ç”¨äºå®šä¹‰ä¸€ä¸ªé€šçŸ¥ï¼ˆAdviceï¼‰ï¼Œå®ƒåœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼Œæ— è®ºç›®æ ‡æ–¹æ³•æ‰§è¡Œçš„ç»“æœå¦‚ä½•ï¼ˆæˆåŠŸæˆ–å¼‚å¸¸ï¼‰ã€‚</p>
</blockquote>
<pre><code class="java">@Aspect
@Component
public class AroundFinallyAspect &#123;

    // å®šä¹‰åˆ‡ç‚¹
    @Pointcut(&quot;execution(* com.example.yourpackage.controller..*(..))&quot;)
    public void controllerMethods() &#123;
    &#125;

    // ç¯ç»•é€šçŸ¥
    @Around(&quot;controllerMethods()&quot;)
    public Object aroundAdvice(ProceedingJoinPoint joinPoint) throws Throwable &#123;
        Object result = null;
        try &#123;
            // åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œ
            result = joinPoint.proceed(); // æ‰§è¡Œç›®æ ‡æ–¹æ³•
            // åœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åæ‰§è¡Œ
        &#125; catch (Throwable e) &#123;
            // åœ¨ç›®æ ‡æ–¹æ³•æŠ›å‡ºå¼‚å¸¸æ—¶æ‰§è¡Œ
            throw e; // å¯ä»¥é€‰æ‹©å¤„ç†å¼‚å¸¸æˆ–è€…é‡æ–°æŠ›å‡º
        &#125; finally &#123;
            // æ— è®ºç›®æ ‡æ–¹æ³•æ˜¯å¦æˆåŠŸæ‰§è¡Œæˆ–è€…æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™é‡Œçš„ä»£ç éƒ½ä¼šæ‰§è¡Œ
            performFinallyAction();
        &#125;
        return result;
    &#125;

    private void performFinallyAction() &#123;
        // åœ¨è¿™é‡Œæ”¾ç½®æœ€ç»ˆè¦æ‰§è¡Œçš„ä»£ç 
    &#125;
&#125;

--------------------------------------------------------------------------------
// åç½®é€šçŸ¥
    @After(&quot;execution(* com.example.service.*.*(..))&quot;)
    public void afterAdvice(JoinPoint joinPoint) &#123;
        // åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œçš„é€»è¾‘
    &#125;

    // è¿”å›åé€šçŸ¥
    @AfterReturning(pointcut = &quot;execution(* com.example.service.*.*(..))&quot;, returning = &quot;result&quot;)
    public void afterReturningAdvice(JoinPoint joinPoint, Object result) &#123;
        // åœ¨ç›®æ ‡æ–¹æ³•æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç»“æœåæ‰§è¡Œçš„é€»è¾‘
    &#125;

åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œä½ ç›´æ¥åœ¨@Afteræ³¨è§£ä¸­æŒ‡å®šäº†åˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œå› æ­¤ä¸éœ€è¦é¢å¤–çš„pointcutå±æ€§ã€‚

å¯¹äº@AfterReturningæ³¨è§£ï¼Œå®ƒä¸ä»…éœ€è¦åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œé€šçŸ¥ï¼Œè¿˜éœ€è¦è®¿é—®ç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ã€‚å› æ­¤ï¼Œ@AfterReturningæ³¨è§£æœ‰ä¸€ä¸ªé¢å¤–çš„pointcutå±æ€§ï¼Œç”¨äºæŒ‡å®šåˆ‡ç‚¹è¡¨è¾¾å¼ã€‚æ­¤å¤–ï¼Œ@AfterReturningæ³¨è§£è¿˜æœ‰ä¸€ä¸ªreturningå±æ€§ï¼Œç”¨äºæŒ‡å®šä¸€ä¸ªå‚æ•°åï¼Œè¯¥å‚æ•°å°†æ¥æ”¶ç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼
</code></pre>
<p>@AfterReturningï¼šåœ¨æ–¹æ³•æ‰§è¡Œåè¿”å›ç»“æœåæ‰§è¡Œé€šçŸ¥ã€‚ã€å¦‚æœæœ‰å¼‚å¸¸ä¸ä¼šå¤„ç†ã€‘</p>
<blockquote>
<p>æˆ‘æ¥å¸®ä½ <strong>é€šä¿—ä¸€ç‚¹æ¢³ç†è¿™æ®µ AOP çš„ä½¿ç”¨é€»è¾‘å’Œè¿è¡Œæœºåˆ¶</strong>ï¼Œä½ å¯ä»¥ç±»æ¯”æˆâ€œç¨‹åºåœ¨è¿è¡Œåˆ°æŸä¸ªç‚¹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä½ é¢„è®¾çš„å¢å¼ºä»£ç â€ã€‚</p>
<h2 id="âœ…-ä¸¾ä¸ªä¾‹å­ä½ å°±æ˜ç™½äº†ï¼š"><a href="#âœ…-ä¸¾ä¸ªä¾‹å­ä½ å°±æ˜ç™½äº†ï¼š" class="headerlink" title="âœ… ä¸¾ä¸ªä¾‹å­ä½ å°±æ˜ç™½äº†ï¼š"></a>âœ… ä¸¾ä¸ªä¾‹å­ä½ å°±æ˜ç™½äº†ï¼š</h2><p>ä½ å†™äº†ä¸ª Controllerï¼š</p>
<pre><code class="java">@RestController
public class TestController &#123;
    @GetMapping(&quot;/hello&quot;)
    public String hello() &#123;
        System.out.println(&quot;æ­£åœ¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘&quot;);
        return &quot;Hello World&quot;;
    &#125;
&#125;
</code></pre>
<h3 id="âš™ï¸-å½“ä½ è®¿é—®-helloï¼ŒSpring-æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š"><a href="#âš™ï¸-å½“ä½ è®¿é—®-helloï¼ŒSpring-æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="âš™ï¸ å½“ä½ è®¿é—® /helloï¼ŒSpring æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š"></a>âš™ï¸ å½“ä½ è®¿é—® <code>/hello</code>ï¼ŒSpring æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</h3><table>
<thead>
<tr>
<th>æ­¥éª¤</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody><tr>
<td>1ï¸âƒ£</td>
<td>æ‰§è¡Œä½ çš„ AOP ä¸­ <code>@Around</code> æ–¹æ³•ï¼ˆaroundAdviceï¼‰</td>
</tr>
<tr>
<td>2ï¸âƒ£</td>
<td><code>joinPoint.proceed()</code> è§¦å‘ç›®æ ‡æ–¹æ³•ï¼ˆå³ <code>hello()</code>ï¼‰æ‰§è¡Œ</td>
</tr>
<tr>
<td>3ï¸âƒ£</td>
<td>æ–¹æ³•è¿”å›æˆ–æŠ›å¼‚å¸¸ï¼Œfinally ä¸€å®šä¼šæ‰§è¡Œ</td>
</tr>
<tr>
<td>4ï¸âƒ£</td>
<td>AOP æŠŠæœ€ç»ˆè¿”å›å€¼äº¤å› Spring ç»§ç»­å“åº”å‰ç«¯</td>
</tr>
</tbody></table>
<h2 id="âœ…-è¡¥å……ç†è§£ï¼šexecution-è¡¨è¾¾å¼"><a href="#âœ…-è¡¥å……ç†è§£ï¼šexecution-è¡¨è¾¾å¼" class="headerlink" title="âœ… è¡¥å……ç†è§£ï¼šexecution è¡¨è¾¾å¼"></a>âœ… è¡¥å……ç†è§£ï¼šexecution è¡¨è¾¾å¼</h2><p>ä½ è¿™ä¸ªè¡¨è¾¾å¼ï¼š</p>
<pre><code class="java">execution(* com.example.yourpackage.controller..*(..))
</code></pre>
<ul>
<li><code>*</code>ï¼šåŒ¹é…æ‰€æœ‰è¿”å›å€¼ç±»å‹</li>
<li><code>com.example.yourpackage.controller..*</code>ï¼šåŒ¹é…è¯¥åŒ…åŠå­åŒ…çš„æ‰€æœ‰ç±»</li>
<li><code>*</code>ï¼šåŒ¹é…æ‰€æœ‰æ–¹æ³•</li>
<li><code>(..)</code>ï¼šåŒ¹é…ä»»æ„å‚æ•°ç±»å‹å’Œä¸ªæ•°</li>
</ul>
<p>ğŸ§  æ‰€ä»¥å¯ä»¥ç†è§£æˆï¼š**â€å‡¡æ˜¯ controller åŒ…ä¸‹çš„ä»»ä½•æ–¹æ³•ï¼ŒAOP éƒ½è¦æ’æ‰‹â€**</p>
<p>ä½ å°±æ˜¯å‘Šè¯‰ Spring AOPï¼šâ€œå½“ä½ è¿è¡Œåˆ°è¿™äº›æ–¹æ³•æ—¶ï¼Œå…ˆæ¥æ‰¾æˆ‘æ‰§è¡Œä¸€äº›é¢å¤–æ“ä½œâ€ï¼Œè¿™å°±æ˜¯<strong>åˆ‡é¢å¢å¼ºçš„ç²¾é«“</strong>ã€‚</p>
</blockquote>
<h4 id="ä½ ä»¬è¿™ä¸ªé¡¹ç›®æ€ä¹ˆæŠ€æœ¯é€‰å‹çš„"><a href="#ä½ ä»¬è¿™ä¸ªé¡¹ç›®æ€ä¹ˆæŠ€æœ¯é€‰å‹çš„" class="headerlink" title="ä½ ä»¬è¿™ä¸ªé¡¹ç›®æ€ä¹ˆæŠ€æœ¯é€‰å‹çš„"></a>ä½ ä»¬è¿™ä¸ªé¡¹ç›®æ€ä¹ˆæŠ€æœ¯é€‰å‹çš„</h4><p>æˆ‘è¿›åˆ°é¡¹ç›®ä¸­å¾ˆå¤šå·²ç»ç¡®è®¤ä¸‹æ¥çš„ ä¸€èˆ¬ç”±ç»„é•¿ç¡®å®šäº†</p>
<h6 id="é‚£ä½ è‡ªå·±æ€ä¹ˆæƒ³çš„ï¼Ÿ-å¼€æ”¾æ€§é—®é¢˜"><a href="#é‚£ä½ è‡ªå·±æ€ä¹ˆæƒ³çš„ï¼Ÿ-å¼€æ”¾æ€§é—®é¢˜" class="headerlink" title="é‚£ä½ è‡ªå·±æ€ä¹ˆæƒ³çš„ï¼Ÿ[å¼€æ”¾æ€§é—®é¢˜]"></a>é‚£ä½ è‡ªå·±æ€ä¹ˆæƒ³çš„ï¼Ÿ[å¼€æ”¾æ€§é—®é¢˜]</h6><p>é€‰xxxæŠ€æœ¯ ç½‘ä¸Šèµ„æ–™&#x2F;å¤‡ä¹¦ æ¯”è¾ƒå¤šå¯ä»¥å‚è€ƒ[ç”¨çš„äººå¤š]<br>å­¦ä¹ æˆæœ¬[æ¡†æ¶å‰å®³ä½†ä¸Šæ‰‹å¤æ‚ä¸å¥½ç”¨]<br>ç¤¾åŒºçš„æ´»è·ƒåº¦[å®˜ç½‘æŒç»­æ›´æ–°ç‰ˆæœ¬ æ¡†æ¶ä¼šä¸æ–­å‘å±•]</p>
<h4 id="ä½ å¤„äºåç«¯çš„ä»€ä¹ˆä½ç½®"><a href="#ä½ å¤„äºåç«¯çš„ä»€ä¹ˆä½ç½®" class="headerlink" title="ä½ å¤„äºåç«¯çš„ä»€ä¹ˆä½ç½®"></a>ä½ å¤„äºåç«¯çš„ä»€ä¹ˆä½ç½®</h4><p>åˆçº§ ä¸­çº§ é«˜çº§<br>ä¸­çº§ éª¨å¹²å¼€å‘ä½ç½®[ååŠ©ç»„é•¿å®Œæˆ]<br>ä¸­é«˜çº§ å®Œæˆè®¾è®¡ç±»</p>
<h4 id="ä½ å¯¹ä½ çš„èŒä¸šè§„åˆ’æ˜¯ä»€ä¹ˆ"><a href="#ä½ å¯¹ä½ çš„èŒä¸šè§„åˆ’æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä½ å¯¹ä½ çš„èŒä¸šè§„åˆ’æ˜¯ä»€ä¹ˆ"></a>ä½ å¯¹ä½ çš„èŒä¸šè§„åˆ’æ˜¯ä»€ä¹ˆ</h4><p>è®²å®é™…çš„è¯<br>æƒ³æˆä¸ºé«˜çº§å¼€å‘&#x2F;æŸä¸ªé¢†åŸŸçš„ä¸“å®¶<br>æå‰äº†è§£å…¬å¸é¢†åŸŸï¼Œæœ‰å¤‡è€Œæ¥</p>
<h4 id="javaåŸºæœ¬ç±»å‹"><a href="#javaåŸºæœ¬ç±»å‹" class="headerlink" title="javaåŸºæœ¬ç±»å‹"></a>javaåŸºæœ¬ç±»å‹</h4><img src="C:\Users\Pluminary\AppData\Roaming\Typora\typora-user-images\image-20241222141950707.png" alt="image-20241222141950707" style="zoom:200%;" />

<p>short   å¯ä»¥å ä¸¤ä¸ªå­—èŠ‚   å¯ä»¥ç”¨16ä½<br>int        å¯ä»¥å å››ä¸ªå­—èŠ‚    -21äº¿ ~ 21äº¿<br>long     å¯ä»¥å å…«ä¸ªå­—èŠ‚   å¤©æ–‡æ•°å­—<br>float      å¯ä»¥å å››ä¸ªå­—èŠ‚ 0.2F&#x2F;f<br>double  å¯ä»¥å å…«ä¸ªå­—èŠ‚ 0.2D&#x2F;d</p>
<p>float doubleå°½é‡ä¸è¦è¿›è¡Œè¿ç®— ï¼Œåœ¨Javaä¸­è¿›è¡Œé‡‘é’±è¿ç®—æ—¶ï¼Œåº”å½“ç‰¹åˆ«æ³¨æ„æµ®ç‚¹æ•°çš„ç²¾åº¦é—®é¢˜ï¼Œå› ä¸ºæµ®ç‚¹æ•°ï¼ˆå¦‚<code>float</code>å’Œ<code>double</code>ï¼‰åœ¨è¡¨ç¤ºæŸäº›æ•°å€¼æ—¶å¯èƒ½ä¼šä¸¢å¤±ç²¾åº¦ï¼Œè¿™å¯¹äºéœ€è¦ç²¾ç¡®è®¡ç®—çš„é‡‘èè®¡ç®—æ¥è¯´æ˜¯éå¸¸ä¸åˆé€‚çš„ã€‚</p>
<p>1.é‡‘é’±è½¬æˆåˆ† å‘ä¸‹å–æ•´<br>2.<strong>BigDecimal</strong></p>
<p>ASCIIç å 1ä¸ªå­—èŠ‚ â†’ Unicodeå­—ç¬¦å 2ä¸ªå­—èŠ‚ã€æœ‰äº›æ±‰å­—å­˜ä¸äº†ã€‘â†’ UTF-8å 1-3ä¸ªå­—èŠ‚[çµæ´»å¯å˜]<br>åœ¨æˆ‘ä»¬æ€§èƒ½ä¸­ä¸€èˆ¬èµ°Unicodeç¼–ç æ€§èƒ½æ›´é«˜ä¸€ç‚¹ åœ¨ç½‘ç»œä¸­&#x2F;å­˜å…¥ç£ç›˜Unicodeè½¬æˆASCIIç </p>
<p>jdkï¼Ÿä¹‹å jdkå¼€å§‹å­˜å‚¨å¤§é‡è‹±æ–‡å’Œæ•°å­— Stringç±»ä¹Ÿä½œäº†æ›´æ–° ä¸æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç±»å‹ è€Œæ˜¯åŸºäºbyteæ•°ç»„</p>
<pre><code class="java">åœ¨Javaçš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼ˆä¾‹å¦‚JDK 1.4åŠä¹‹å‰ç‰ˆæœ¬ï¼‰ï¼ŒStringç±»å†…éƒ¨ç¡®å®ä½¿ç”¨charæ•°ç»„æ¥å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®ã€‚æ¯ä¸ªcharåœ¨Javaä¸­å ç”¨16ä½ï¼ˆ2ä¸ªå­—èŠ‚ï¼‰ï¼Œè¿™æ„å‘³ç€ä¸ç®¡å­˜å‚¨çš„æ˜¯è‹±æ–‡å­—ç¬¦è¿˜æ˜¯æ•°å­—ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½ä¼šå ç”¨2ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ã€‚

ä»JDK 5å¼€å§‹ï¼ŒJavaå¹³å°å¼•å…¥äº†ä¸€äº›å˜åŒ–ï¼Œä½†Stringç±»çš„å†…éƒ¨è¡¨ç¤ºä»ç„¶åŸºäºcharæ•°ç»„ã€‚ç›´åˆ°JDK 6å’ŒJDK 7ï¼ŒStringç±»çš„å†…éƒ¨è¡¨ç¤ºå¹¶æ²¡æœ‰æ”¹ä¸ºåŸºäºbyteæ•°ç»„ã€‚

çœŸæ­£å‘ç”Ÿå˜åŒ–çš„æ˜¯åœ¨JDK 9ä¸­ï¼ŒStringç±»å†…éƒ¨è¡¨ç¤ºä»charæ•°ç»„è½¬å˜ä¸ºbyteæ•°ç»„åŠ ä¸Šä¸€ä¸ªç¼–ç æ ‡è¯†ï¼ˆcoderï¼‰ï¼Œè¿™ç§æ”¹å˜æ˜¯ä¸ºäº†æ›´æœ‰æ•ˆåœ°å­˜å‚¨åªæœ‰ASCIIå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ASCIIå­—ç¬¦åªéœ€è¦ä¸€ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œå› æ­¤ä½¿ç”¨byteæ•°ç»„å¯ä»¥èŠ‚çœå†…å­˜ç©ºé—´ã€‚å½“å­—ç¬¦ä¸²åŒ…å«Unicodeå­—ç¬¦æ—¶ï¼ŒStringç±»å¯èƒ½ä¼šä½¿ç”¨æ›´å¤šçš„ç¼–ç æ–¹å¼ï¼Œä¾‹å¦‚LATIN1æˆ–UTF-16ã€‚
</code></pre>
<h4 id="Vueçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Vueçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Vueçš„ç”Ÿå‘½å‘¨æœŸ"></a>Vueçš„ç”Ÿå‘½å‘¨æœŸ</h4><p>ç”Ÿå‘½å‘¨æœŸçš„å…«ä¸ªé˜¶æ®µï¼šæ¯è§¦å‘ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•(é’©å­)</p>
<ol>
<li>beforeCreateåˆ›å»ºå‰</li>
<li>createdåˆ›å»ºå</li>
<li>beforeMountè½½å…¥å‰</li>
<li>mountedæŒ‚è½½å®Œæˆ</li>
<li>beforeUpdateæ•°æ®æ›´æ–°å‰</li>
<li>updatedæ•°æ®æ›´æ–°å</li>
<li>beforeUnmountç»„ä»¶é”€æ¯å‰</li>
<li>unmountedç»„ä»¶é”€æ¯å</li>
</ol>
<h4 id="Stringæ˜¯åŸºç¡€ç±»å‹å—"><a href="#Stringæ˜¯åŸºç¡€ç±»å‹å—" class="headerlink" title="Stringæ˜¯åŸºç¡€ç±»å‹å—"></a>Stringæ˜¯åŸºç¡€ç±»å‹å—</h4><p>ä¸æ˜¯ï¼Œæ˜¯<code>java.lang</code>ä¸‹çš„ç±»</p>
<blockquote>
<p>String åœ¨ Java ä¸­å¹¶ä¸æ˜¯åŸºç¡€ç±»å‹ï¼Œè€Œæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ã€‚å› ä¸º String æ˜¯ä¸€ä¸ªç±»ï¼Œæ‰€ä»¥å®ƒæ˜¯å¼•ç”¨ç±»å‹ï¼Œæ„å‘³ç€å½“æˆ‘ä»¬å£°æ˜ä¸€ä¸ª String å˜é‡æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯æŒ‡å‘ä¸€ä¸ª String å¯¹è±¡çš„å¼•ç”¨</p>
</blockquote>
<pre><code class="java">String çš„ç‰¹æ€§
ä¸å¯å˜æ€§ï¼šString å¯¹è±¡ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½è¢«ä¿®æ”¹ã€‚ä»»ä½•æ”¹å˜ String å†…å®¹çš„æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ String å¯¹è±¡ã€‚
çº¿ç¨‹å®‰å…¨ï¼šç”±äº String çš„ä¸å¯å˜æ€§ï¼Œå®ƒä»¬æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥è‡ªç”±åœ°åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«ã€‚
å­—ç¬¦ä¸²æ± ï¼šä¸ºäº†æé«˜æ€§èƒ½å’Œå‡å°‘å†…å­˜ä½¿ç”¨ï¼ŒJava ä¸º String æä¾›äº†å­—ç¬¦ä¸²å¸¸é‡æ± ï¼ˆString Poolï¼‰ã€‚å½“åˆ›å»ºä¸€ä¸ªæ–°å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²æ± ä¸­å·²ç»å­˜åœ¨ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šè¿”å›æ± ä¸­çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚
</code></pre>
<h4 id="javaé›†åˆä¸­listå’Œsetçš„åŒºåˆ«"><a href="#javaé›†åˆä¸­listå’Œsetçš„åŒºåˆ«" class="headerlink" title="javaé›†åˆä¸­listå’Œsetçš„åŒºåˆ«?"></a>javaé›†åˆä¸­listå’Œsetçš„åŒºåˆ«?</h4><p>éƒ½æ˜¯æ¥å£ æŸä¸ªå®ç°ç±»</p>
<p>å•é“¾ æœ‰é¡ºåº å¯é‡å¤ æœ‰ç´¢å¼•[æœ‰ä¸‹æ ‡]<br>å•é“¾ ä¸å¯é‡å¤ æ— ç´¢å¼•[æ— ä¸‹æ ‡] ä¸èƒ½è¯´æ˜¯æ— åº å› ä¸ºTreeSetæœ‰åº HashSetå°±æ˜¯æ— åºçš„</p>
<h4 id="åšäº†å‡ å¹´å¼€å‘å‘¢-å®é™…å‡ ä¸ªé¡¹ç›®"><a href="#åšäº†å‡ å¹´å¼€å‘å‘¢-å®é™…å‡ ä¸ªé¡¹ç›®" class="headerlink" title="åšäº†å‡ å¹´å¼€å‘å‘¢? å®é™…å‡ ä¸ªé¡¹ç›®?"></a>åšäº†å‡ å¹´å¼€å‘å‘¢? å®é™…å‡ ä¸ªé¡¹ç›®?</h4><p>ä¸‰å¹´[åˆä¸­çº§] â†’ å››~äº”ä¸ªé¡¹ç›®</p>
<h4 id="ä½ è§‰å¾—æ•²ä»£ç æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ"><a href="#ä½ è§‰å¾—æ•²ä»£ç æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä½ è§‰å¾—æ•²ä»£ç æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ?"></a>ä½ è§‰å¾—æ•²ä»£ç æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ?</h4><p><strong>ç†è§£éœ€æ±‚</strong>ã€<strong>å‰æœŸè®¾è®¡å·¥ä½œ</strong>[æ•°æ®åº“ã€æ¥å£ â†’ æµç¨‹å›¾(æ€è·¯æ¸…æ™°)]ã€<strong>ç¼–ç é˜¶æ®µ</strong>[è€ƒè™‘æ–¹æ³•å°è£…ã€æ³¨é‡Šã€è€ƒè™‘ä»£ç åæœŸå’Œç»´æŠ¤æ€§(è®¾è®¡æ¨¡å¼ â†’ å¯ç»´æŠ¤æ€§+æ‰©å±•æ€§)]ã€<strong>ç¼–ç é£æ ¼</strong>[é˜¿é‡Œå·´å·´è§„èŒƒ]</p>
<h4 id="ä½ çš„é¡¹ç›®æœ‰ä¸Šçº¿å—-å¤šå°‘äººè¿›è¡Œå¼€å‘-ä½ ä¸»è¦è´Ÿè´£åç«¯å—"><a href="#ä½ çš„é¡¹ç›®æœ‰ä¸Šçº¿å—-å¤šå°‘äººè¿›è¡Œå¼€å‘-ä½ ä¸»è¦è´Ÿè´£åç«¯å—" class="headerlink" title="ä½ çš„é¡¹ç›®æœ‰ä¸Šçº¿å—? å¤šå°‘äººè¿›è¡Œå¼€å‘? ä½ ä¸»è¦è´Ÿè´£åç«¯å—?"></a>ä½ çš„é¡¹ç›®æœ‰ä¸Šçº¿å—? å¤šå°‘äººè¿›è¡Œå¼€å‘? ä½ ä¸»è¦è´Ÿè´£åç«¯å—?</h4><p>æœ‰ï¼Œä»‹ç»ä¸€ä¸‹é¡¹ç›®ç»„æˆç»“æ„ï¼Œæ˜¯çš„[å†é—®å†å›ç­”]</p>
<h4 id="SpringBootçš„è‡ªåŠ¨è£…é…åŸç†-å¯åŠ¨è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†-SpringBootå¯åŠ¨åŸç†-amp-amp-å¦‚ä½•å†…åµŒå¤–éƒ¨åŸä»¶"><a href="#SpringBootçš„è‡ªåŠ¨è£…é…åŸç†-å¯åŠ¨è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†-SpringBootå¯åŠ¨åŸç†-amp-amp-å¦‚ä½•å†…åµŒå¤–éƒ¨åŸä»¶" class="headerlink" title="SpringBootçš„è‡ªåŠ¨è£…é…åŸç†[å¯åŠ¨è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†]SpringBootå¯åŠ¨åŸç†&amp;&amp;å¦‚ä½•å†…åµŒå¤–éƒ¨åŸä»¶"></a><span style = "color:red"><strong>SpringBootçš„è‡ªåŠ¨è£…é…åŸç†</strong></span>[å¯åŠ¨è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†]<del>SpringBootå¯åŠ¨åŸç†&amp;&amp;å¦‚ä½•å†…åµŒå¤–éƒ¨åŸä»¶</del></h4><p>Spring Bootçš„è‡ªåŠ¨è£…é…åŸç†æ˜¯åŸºäºSpringæ¡†æ¶çš„IoCï¼ˆæ§åˆ¶åè½¬ï¼‰å’ŒDIï¼ˆä¾èµ–æ³¨å…¥ï¼‰çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¹¶ç»“åˆäº†ä¸€ç³»åˆ—çš„çº¦å®šå’Œæ¡ä»¶æ³¨è§£æ¥å®ç°é…ç½®ç±»çš„è‡ªåŠ¨åŠ è½½å’ŒBeançš„è‡ªåŠ¨æ³¨å†Œ</p>
<blockquote>
<ol>
<li><strong>å¯åŠ¨ç±»</strong>ï¼šSpring Boot åº”ç”¨é€šå¸¸æœ‰ä¸€ä¸ªå¸¦æœ‰ <code>@SpringBootApplication</code> æ³¨è§£çš„å¯åŠ¨ç±»ã€‚è¿™ä¸ªæ³¨è§£æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå®ƒåŒ…å«äº† <code>@Configuration</code>ã€<code>@EnableAutoConfiguration</code> å’Œ <code>@ComponentScan</code>ã€‚</li>
<li><strong>@EnableAutoConfiguration</strong>ï¼šè¿™ä¸ªæ³¨è§£æ˜¯è‡ªåŠ¨è£…é…çš„å…³é”®ã€‚å®ƒå‘Šè¯‰ Spring Boot æ ¹æ®ç±»è·¯å¾„ä¸‹çš„ç±»ã€Bean çš„å®šä¹‰ä»¥åŠå„ç§å±æ€§è®¾ç½®ï¼Œè‡ªåŠ¨é…ç½® Spring åº”ç”¨ã€‚è¿™ä¸ªæ³¨è§£ä¼šå¯¼å…¥ <code>AutoConfigurationImportSelector</code> ç±»ï¼Œè¯¥ç±»ä¼šè¯»å–æ‰€æœ‰ <code>spring.factories</code> æ–‡ä»¶ä¸­çš„ <code>EnableAutoConfiguration</code> æ¡ç›®ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºé…ç½®ç±»å¯¼å…¥ã€‚</li>
<li><strong>æ¡ä»¶åŒ–é…ç½®</strong>ï¼šSpring Boot ä½¿ç”¨ <code>@Conditional</code> æ³¨è§£åŠå…¶ä¸€ç³»åˆ—çš„æ´¾ç”Ÿæ³¨è§£ï¼ˆå¦‚ <code>@ConditionalOnClass</code>ã€<code>@ConditionalOnMissingBean</code> ç­‰ï¼‰æ¥ç¡®ä¿åªæœ‰åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶ï¼Œé…ç½®ç±»æˆ– Bean æ‰ä¼šè¢«åˆ›å»ºã€‚</li>
<li><strong>é…ç½®ç±»</strong>ï¼šè‡ªåŠ¨è£…é…æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„é…ç½®ç±»æ¥å®ç°çš„ï¼Œè¿™äº›é…ç½®ç±»åŒ…å«äº† <code>@Bean</code> æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå’Œé…ç½® Spring å®¹å™¨ä¸­çš„ Beanã€‚</li>
</ol>
</blockquote>
<h6 id="è‡ªå®šä¹‰Starter"><a href="#è‡ªå®šä¹‰Starter" class="headerlink" title="è‡ªå®šä¹‰Starter"></a>è‡ªå®šä¹‰Starter</h6><pre><code class="xml">&lt;!-- Mavené¡¹ç›®çš„ä¾èµ–ç¤ºä¾‹ --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.xxx&lt;/groupId&gt;
    &lt;artifactId&gt;xxx-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p><strong>ä¸‰å¤§ä¼˜ç‚¹</strong>ï¼šä¾èµ–Mavenç‰¹æ€§[ä¾èµ–ä¼ é€’]  è‡ªåŠ¨é…ç½®  å†…åµŒTomcat<br>Spring Bootçš„è‡ªåŠ¨è£…é…åŸç†æ˜¯<br>åœ¨<code>src/main/resources/META-INF</code>ç›®å½•ä¸‹åˆ›å»º<code>spring.factories</code>æ–‡ä»¶ï¼Œæ·»åŠ è‡ªåŠ¨é…ç½®ç±»çš„å…¨é™å®šå<br>æˆ‘ä»¬å¯ä»¥åœ¨-infoå®šä¹‰spring.factoriesä½äº<code>META-INF</code>ç›®å½•ä¸‹ï¼ŒSpring Bootä½¿ç”¨å®ƒæ¥å‘ç°å’ŒåŠ è½½è‡ªåŠ¨é…ç½®ç±»ã€‚</p>
<p><strong>é…ç½®ç±»æ‰«æ</strong>: é€šè¿‡<code>@SpringBootApplication</code>æ³¨è§£ï¼ŒSpring Bootä¼šè§¦å‘å¯¹<code>@EnableAutoConfiguration</code>æ³¨è§£çš„å¤„ç†ï¼Œè¯¥æ³¨è§£ä¼šæŸ¥æ‰¾<code>spring.factories</code>æ–‡ä»¶ä¸­å®šä¹‰çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</p>
<p>Mavené‡Œé¢å†™testç±» ç”¨configurationå£°æ˜ å†™å¾ˆå¤šçš„testç±» ä½†æ˜¯æˆ‘å¯ä»¥è‡ªå·±å†™testç±»ç„¶åè°ƒä¸åŒçš„æ–¹æ³• <strong>åº”è¯¥æ€ä¹ˆåŠ</strong>ï¼Ÿ@Conditional[Springçš„æ³¨è§£] â†’ åšæˆéå¸¸çµæ´»çš„ å¦‚æœæ²¡æœ‰å°±ç”¨è‡ªå·±å†™çš„ </p>
<h4 id="Springé‡Œé¢çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º"><a href="#Springé‡Œé¢çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º" class="headerlink" title="Springé‡Œé¢çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º"></a><strong>Springé‡Œé¢çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸º</strong></h4><p>åœ¨Springæ¡†æ¶ä¸­ï¼Œäº‹åŠ¡ä¼ æ’­è¡Œä¸ºå®šä¹‰äº†äº‹åŠ¡æ–¹æ³•ä¹‹é—´çš„è°ƒç”¨å…³ç³»ï¼Œå³ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œäº‹åŠ¡åº”è¯¥å¦‚ä½•ä¼ æ’­ã€‚</p>
<ol>
<li><span style = "color:blue"><u><strong>REQUIRED</strong>ï¼ˆé»˜è®¤å€¼ï¼‰</u></span> required<ul>
<li>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚</li>
</ul>
</li>
<li><strong>SUPPORTS</strong> supports<ul>
<li>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><strong>MANDATORY</strong> mandatory<ul>
<li>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
</li>
<li><strong>REQUIRES_NEW</strong> requires_new<ul>
<li>åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·å½“å‰äº‹åŠ¡ã€‚</li>
</ul>
</li>
<li><strong>NOT_SUPPORTED</strong> not_supported<ul>
<li>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œæ“ä½œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·å½“å‰äº‹åŠ¡ã€‚</li>
</ul>
</li>
<li><strong>NEVER</strong> never<ul>
<li>ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ul>
</li>
<li><strong>NESTED</strong> nested<ul>
<li>å¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è¡Œä¸ºç±»ä¼¼äº<code>REQUIRED</code>ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p>REQUIREDï¼šé€šå¸¸ç”¨äºæ–¹æ³•éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­è¿è¡Œï¼Œä½†å¦‚æœå·²ç»æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œï¼Œé‚£ä¹ˆå®ƒåº”è¯¥åŠ å…¥è¿™ä¸ªäº‹åŠ¡ã€‚<br>SUPPORTSï¼šç”¨äºæ–¹æ³•ä¸éœ€è¦äº‹åŠ¡ä¸Šä¸‹æ–‡ï¼Œä½†å¦‚æœå·²ç»åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¿è¡Œã€‚<br>MANDATORYï¼šç”¨äºæ–¹æ³•å¿…é¡»åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚<br><strong>REQUIRES_NEW</strong>ï¼šç”¨äºæ–¹æ³•å¿…é¡»åœ¨è‡ªå·±çš„æ–°äº‹åŠ¡ä¸­è¿è¡Œï¼Œå³ä½¿å½“å‰å·²ç»æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œã€‚<br>[ä¸€èˆ¬é€‚ç”¨äºä¸ç®¡æœ‰æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ éƒ½è¦è®°å½•æŸäº›æ“ä½œæ—¥å¿— ä¸èƒ½åœ¨åŒä¸€ä¸ªç±»é‡Œåº•å±‚æ˜¯åŠ¨æ€ä»£ç†]<br>[å¦‚æœa()å’Œb()æ–¹æ³•åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”a()ç›´æ¥è°ƒç”¨b()ï¼Œé‚£ä¹ˆSpringçš„äº‹åŠ¡ä»£ç†æ— æ³•æ‹¦æˆªè¿™ä¸ªå†…éƒ¨è°ƒç”¨ï¼Œå› æ­¤b()çš„REQUIRES_NEWäº‹åŠ¡ä¼ æ’­è¡Œä¸ºä¸ä¼šç”Ÿæ•ˆã€‚è¿™æ˜¯å› ä¸ºå†…éƒ¨æ–¹æ³•è°ƒç”¨ä¸ä¼šé€šè¿‡ä»£ç†ï¼Œè€Œæ˜¯ç›´æ¥åœ¨åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ä¸Šè°ƒç”¨ã€‚]</p>
<pre><code class="java">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.transaction.annotation.Propagation;

@Service
public class MyService &#123;

@Autowired
private MyService self; // æ³¨å…¥è‡ªèº«ä»£ç†å®ä¾‹

public void methodA() &#123;
// ... ä¸šåŠ¡é€»è¾‘ ...

self.methodB(); // é€šè¿‡ä»£ç†å®ä¾‹è°ƒç”¨ï¼Œäº‹åŠ¡æ³¨è§£å°†ç”Ÿæ•ˆ
&#125;

@Transactional(propagation = Propagation.REQUIRES_NEW)
public void methodB() &#123;
// ... ä¸šåŠ¡é€»è¾‘ ...
&#125;
&#125;
</code></pre>
<p>NOT_SUPPORTEDï¼šç”¨äºæ–¹æ³•ä¸åº”è¯¥åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœæœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œï¼Œå®ƒå°†è¢«æŒ‚èµ·ã€‚<br>NEVERï¼šç”¨äºæ–¹æ³•ç»å¯¹ä¸åº”è¯¥åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœæœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œï¼Œå°†æŠ›å‡ºå¼‚å¸¸ã€‚<br>NESTEDï¼šç”¨äºæ–¹æ³•åº”è¯¥åœ¨åµŒå¥—äº‹åŠ¡ä¸­è¿è¡Œï¼ŒåµŒå¥—äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºå¤–éƒ¨äº‹åŠ¡è¿›è¡Œæäº¤æˆ–å›æ»š</p>
<h2 id="Spring-äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå¯¹æ¯”è¡¨"><a href="#Spring-äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå¯¹æ¯”è¡¨" class="headerlink" title="Spring äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå¯¹æ¯”è¡¨"></a>Spring äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå¯¹æ¯”è¡¨</h2><table>
<thead>
<tr>
<th><strong>ä¼ æ’­è¡Œä¸º</strong></th>
<th><strong>æ˜¯å¦åŠ å…¥å½“å‰äº‹åŠ¡</strong></th>
<th><strong>å½“å‰æ— äº‹åŠ¡æ˜¯å¦æ–°å»ºäº‹åŠ¡</strong></th>
<th><strong>å½“å‰æœ‰äº‹åŠ¡æ˜¯å¦æŒ‚èµ·åŸäº‹åŠ¡</strong></th>
<th><strong>å¸¸è§ç”¨é€” &#x2F; åœºæ™¯ä¸¾ä¾‹</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>REQUIRED</strong>ï¼ˆé»˜è®¤ï¼‰</td>
<td>âœ…åŠ å…¥</td>
<td>âœ…æ–°å»º</td>
<td>âŒä¸æŒ‚èµ·</td>
<td>å¤§å¤šæ•°ä¸šåŠ¡é€»è¾‘ï¼Œé»˜è®¤å³å¯ï¼ˆå¦‚ç”¨æˆ·ä¸‹å•ï¼‰</td>
</tr>
<tr>
<td><strong>SUPPORTS</strong></td>
<td>âœ…åŠ å…¥</td>
<td>âŒä¸æ–°å»ºï¼Œç›´æ¥è¿è¡Œ</td>
<td>âŒä¸æŒ‚èµ·</td>
<td>éæ ¸å¿ƒæ“ä½œï¼Œäº‹åŠ¡å¯æœ‰å¯æ— ï¼ˆå¦‚æŸ¥è¯¢ã€æ‰“æ—¥å¿—ã€éæ•æ„Ÿæ¥å£ï¼‰</td>
</tr>
<tr>
<td><strong>MANDATORY</strong></td>
<td>âœ…åŠ å…¥</td>
<td>âŒä¸æ–°å»º â†’ æŠ¥é”™</td>
<td>âŒä¸æŒ‚èµ·</td>
<td>å¼ºä¾èµ–äº‹åŠ¡ç¯å¢ƒï¼Œå¦‚åœ¨å·²æœ‰äº‹åŠ¡å†…å¼ºåˆ¶åšæŸä¸ªæ“ä½œï¼ˆå¦‚å®¡è®¡ç»„ä»¶ï¼‰</td>
</tr>
<tr>
<td><strong>REQUIRES_NEW</strong></td>
<td>âŒä¸åŠ å…¥</td>
<td>âœ…æ–°å»º</td>
<td>âœ…æŒ‚èµ·åŸäº‹åŠ¡</td>
<td><strong>æ—¥å¿—è®°å½•ã€è¡¥å¿äº‹åŠ¡ç­‰</strong>ã€‚å¦‚ä¸»é€»è¾‘å›æ»šäº†ï¼Œæ—¥å¿—ä¹Ÿå¿…é¡»å†™å…¥æ•°æ®åº“</td>
</tr>
<tr>
<td><strong>NOT_SUPPORTED</strong></td>
<td>âŒä¸åŠ å…¥</td>
<td>âœ…ä»¥éäº‹åŠ¡è¿è¡Œ</td>
<td>âœ…æŒ‚èµ·åŸäº‹åŠ¡</td>
<td>ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨ã€ä¸èƒ½ç”¨äº‹åŠ¡çš„åœºæ™¯ï¼ˆå¦‚è¯»åº“å‹åŠ›å¤§ï¼Œå¿…é¡»ç«‹å³è¿”å›ï¼‰</td>
</tr>
<tr>
<td><strong>NEVER</strong></td>
<td>âŒä¸åŠ å…¥</td>
<td>âœ…ä»¥éäº‹åŠ¡è¿è¡Œ</td>
<td>âŒä¸æŒ‚èµ· â†’ å¦‚æœæœ‰äº‹åŠ¡ â†’ æŠ¥é”™</td>
<td>ä¸¥ç¦äº‹åŠ¡åœºæ™¯ï¼Œä¾‹å¦‚ä½ è°ƒç”¨äº†ä¸€ä¸ªåªèƒ½åœ¨æ— äº‹åŠ¡ç¯å¢ƒä¸‹å·¥ä½œçš„æ¥å£</td>
</tr>
<tr>
<td><strong>NESTED</strong></td>
<td>âœ…ä½œä¸ºåµŒå¥—äº‹åŠ¡</td>
<td>âœ…æ–°å»ºï¼ˆåµŒå¥—ï¼‰</td>
<td>âŒä¸æŒ‚èµ·</td>
<td>å­äº‹åŠ¡å¤±è´¥å¯ä»¥å•ç‹¬å›æ»šä½†ä¸»äº‹åŠ¡ä¸å½±å“ï¼ˆä¾‹å¦‚æ›´æ–°å¤šä¸ªæ¨¡å—ï¼Œä¸€ä¸ªå¤±è´¥ä¸å½±å“å…¶ä»–ï¼‰</td>
</tr>
</tbody></table>
<h2 id="ğŸ§ -å¿«é€Ÿè®°å¿†æŠ€å·§"><a href="#ğŸ§ -å¿«é€Ÿè®°å¿†æŠ€å·§" class="headerlink" title="ğŸ§  å¿«é€Ÿè®°å¿†æŠ€å·§"></a>ğŸ§  å¿«é€Ÿè®°å¿†æŠ€å·§</h2><table>
<thead>
<tr>
<th>è®°å¿†å…³é”®è¯</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>REQUIRED</strong> å°±åƒâ€œæˆ‘æœ‰å°±ç”¨ï¼Œæ²¡æœ‰æˆ‘è‡ªå·±å»ºâ€ â†’ é»˜è®¤å€¼</td>
<td></td>
</tr>
<tr>
<td><strong>REQUIRES_NEW</strong> â€œè°éƒ½æœ‰æˆ‘ä¸ç®¡ï¼Œæˆ‘è‡ªå·±å¼€æ–°å·â€</td>
<td></td>
</tr>
<tr>
<td><strong>SUPPORTS</strong> â€œéšç¼˜ï¼Œæœ‰å°±ä¸Šï¼Œæ²¡æœ‰å°±è£¸è·‘â€</td>
<td></td>
</tr>
<tr>
<td><strong>MANDATORY</strong> â€œå¿…é¡»æœ‰äº‹åŠ¡ï¼Œæ²¡æœ‰å°±ä¸å¹²â€</td>
<td></td>
</tr>
<tr>
<td><strong>NOT_SUPPORTED</strong> â€œä½ ä»¬å¼€ä¼šæˆ‘ä¸å‚ä¸ï¼Œæˆ‘è¦å•å¹²â€</td>
<td></td>
</tr>
<tr>
<td><strong>NEVER</strong> â€œä½ ä»¬åˆ«å¼€ä¼šï¼Œæˆ‘ä¸€å¼€ä¼šå°±ç‚¸â€</td>
<td></td>
</tr>
<tr>
<td><strong>NESTED</strong> â€œæˆ‘æ˜¯ä½ è‚šå­é‡Œçš„å°äº‹åŠ¡ï¼Œå•ç‹¬å—ç½šï¼Œå¦ˆä½ åˆ«å“­â€</td>
<td></td>
</tr>
</tbody></table>
<h2 id="ğŸ’¬-ç¤ºä¾‹è®°å¿†æ³•ï¼ˆåƒè®²æ®µå­ä¸€æ ·ï¼‰ï¼š"><a href="#ğŸ’¬-ç¤ºä¾‹è®°å¿†æ³•ï¼ˆåƒè®²æ®µå­ä¸€æ ·ï¼‰ï¼š" class="headerlink" title="ğŸ’¬ ç¤ºä¾‹è®°å¿†æ³•ï¼ˆåƒè®²æ®µå­ä¸€æ ·ï¼‰ï¼š"></a>ğŸ’¬ ç¤ºä¾‹è®°å¿†æ³•ï¼ˆåƒè®²æ®µå­ä¸€æ ·ï¼‰ï¼š</h2><blockquote>
<p>è€æ¿ï¼ˆäº‹åŠ¡Aï¼‰å«ä½ å¹²æ´»ï¼ˆæ–¹æ³•Bï¼‰ï¼š</p>
<ul>
<li><strong>REQUIRED</strong>ï¼šè€æ¿å·²ç»åœ¨å¼€ä¼šï¼Œæˆ‘å°±è¿›æ¥ä¸€èµ·å¼€ï¼›æ²¡ä¼šè®®æˆ‘å°±è‡ªå·±ç»„ç»‡ä¸€ä¸ª</li>
<li><strong>REQUIRES_NEW</strong>ï¼šæˆ‘ä¸ç®¡è€æ¿åœ¨ä¸åœ¨ï¼Œæˆ‘è‡ªå·±é‡æ–°å¼€ä¸€ä¸ªä¼šï¼ˆæŒ‚èµ·è€æ¿çš„ï¼‰</li>
<li><strong>SUPPORTS</strong>ï¼šè€æ¿å¼€ä¼šæˆ‘å°±è¿›ï¼Œä¸å¼€æˆ‘å°±éšä¾¿å¹²å¹²</li>
<li><strong>MANDATORY</strong>ï¼šè€æ¿å¿…é¡»å…ˆå¼€ä¼šï¼Œå¦åˆ™æˆ‘ä¸å¹²æ´»ï¼ˆæŠ›å¼‚å¸¸ï¼‰</li>
<li><strong>NOT_SUPPORTED</strong>ï¼šè€æ¿è¦æ˜¯å¼€ä¼šï¼Œæˆ‘å°±å»æŠ½æ ¹çƒŸï¼›ä¸å¼€æˆ‘æ‰æ¥å¹²æ´»ï¼ˆæŒ‚èµ·äº‹åŠ¡ï¼‰</li>
<li><strong>NEVER</strong>ï¼šè°å¼€ä¼šæˆ‘è·Ÿè°æ€¥ï¼Œæˆ‘åªå¹²æ²¡æœ‰äº‹åŠ¡çš„æ´»</li>
<li><strong>NESTED</strong>ï¼šè€æ¿å¼€äº†ä¼šï¼Œæˆ‘åœ¨ä¼šé‡Œåˆå¼€äº†ä¸€ä¸ªå­ä¼šï¼Œå‡ºäº†äº‹è‡ªå·±æ‹…è´£ä¸è¿ç´¯è€æ¿</li>
</ul>
</blockquote>
<h2 id="âœ…-é‡ç‚¹æ³¨æ„ï¼ˆå¸¸è€ƒé™·é˜±ï¼‰"><a href="#âœ…-é‡ç‚¹æ³¨æ„ï¼ˆå¸¸è€ƒé™·é˜±ï¼‰" class="headerlink" title="âœ… é‡ç‚¹æ³¨æ„ï¼ˆå¸¸è€ƒé™·é˜±ï¼‰"></a>âœ… é‡ç‚¹æ³¨æ„ï¼ˆå¸¸è€ƒé™·é˜±ï¼‰</h2><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>è€ƒç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td>åŒä¸€ä¸ªç±»ä¸­ a() ç›´æ¥è°ƒç”¨ b()ï¼ˆbæœ‰äº‹åŠ¡ï¼‰</td>
<td><strong>äº‹åŠ¡æ³¨è§£å¤±æ•ˆ</strong>ï¼å› ä¸º Spring æ˜¯åŸºäºä»£ç†çš„ï¼Œè‡ªå·±è°ƒè‡ªå·±ä¸èµ°ä»£ç†ï¼è§£å†³ï¼š<strong>æ³¨å…¥è‡ªå·± <code>@Autowired private Self self;</code> ç„¶å <code>self.b()</code></strong></td>
</tr>
<tr>
<td>ä¸ºä»€ä¹ˆè¦ç”¨ REQUIRES_NEWï¼Ÿ</td>
<td>é˜²æ­¢ä¸»äº‹åŠ¡å›æ»šæ—¶å½±å“æŸäº›<strong>å¿…é¡»æˆåŠŸçš„æ“ä½œ</strong>ï¼ˆå¦‚æ“ä½œæ—¥å¿—ã€å‘é€æ¶ˆæ¯ï¼‰</td>
</tr>
<tr>
<td>NESTED ä¸ REQUIRES_NEW åŒºåˆ«ï¼Ÿ</td>
<td>NESTED ä¾èµ–åŸäº‹åŠ¡ï¼Œæäº¤å›æ»šå¯ä»¥å±€éƒ¨æ§åˆ¶ï¼›REQUIRES_NEW å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°</td>
</tr>
<tr>
<td>ä½¿ç”¨ NOT_SUPPORTED&#x2F;NEVER çš„å…¸å‹åœºæ™¯ï¼Ÿ</td>
<td>è°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£ä¸å…è®¸äº‹åŠ¡å¹²æ‰°ï¼Œå¦‚é˜²æ­¢é•¿äº‹åŠ¡é”è¡¨ç­‰é—®é¢˜</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="ç”¨è¿‡Springçš„äº‹åŠ¡å—"><a href="#ç”¨è¿‡Springçš„äº‹åŠ¡å—" class="headerlink" title="ç”¨è¿‡Springçš„äº‹åŠ¡å—"></a><strong>ç”¨è¿‡Springçš„äº‹åŠ¡å—</strong></h4><p>ä¸€ç»„æ•°æ®åº“çš„å¢åˆ æ”¹æ“ä½œ<br><strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šè¿™æ˜¯Springæ¨èçš„ç”¨æ³•ï¼Œå®ƒé€šè¿‡ä½¿ç”¨æ³¨è§£ï¼ˆå¦‚<code>@Transactional</code>ï¼‰æˆ–åŸºäºXMLçš„é…ç½®æ¥å£°æ˜äº‹åŠ¡è¾¹ç•Œã€‚åº•å±‚åŸºäºAOPå®ç°åŠ¨æ€ä»£ç†å¢å¼ºæ–¹æ³•<br><strong>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šå…è®¸ä½ é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼ç›´æ¥ç®¡ç†äº‹åŠ¡ï¼Œé€šå¸¸ä½¿ç”¨<code>TransactionTemplate</code>æˆ–è€…ç›´æ¥ä½¿ç”¨åº•å±‚çš„<code>PlatformTransactionManager</code>ã€‚</p>
<blockquote>
<h4 id="å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼ˆ-Transactionalï¼‰"><a href="#å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼ˆ-Transactionalï¼‰" class="headerlink" title="å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼ˆ@Transactionalï¼‰"></a>å£°æ˜å¼äº‹åŠ¡ç®¡ç†<del>ï¼ˆ@Transactionalï¼‰</del></h4><pre><code class="java">// ä½ éœ€è¦åœ¨ Spring é…ç½®ä¸­å¯ç”¨äº‹åŠ¡æ³¨è§£æ”¯æŒï¼š
@Configuration
@EnableTransactionManagement
public class SpringConfig &#123;

 @Bean
 public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory) &#123;
     return new JpaTransactionManager(entityManagerFactory);
 &#125;

 // ... å…¶ä»–é…ç½®
&#125;


// ç„¶åï¼Œä½ å¯ä»¥åœ¨æœåŠ¡å±‚çš„æ–¹æ³•ä¸Šä½¿ç”¨ @Transactional æ³¨è§£æ¥å£°æ˜äº‹åŠ¡è¾¹ç•Œï¼š
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@Service
public class AccountService &#123;

 @Autowired
 private AccountRepository accountRepository;

 @Transactional
 public void transferMoney(Long fromAccountId, Long toAccountId, BigDecimal amount) &#123;
     // æ‰§è¡Œè½¬è´¦æ“ä½œï¼Œæ¯”å¦‚ï¼š
     Account fromAccount = accountRepository.findById(fromAccountId).orElseThrow(...);
     Account toAccount = accountRepository.findById(toAccountId).orElseThrow(...);

     fromAccount.setBalance(fromAccount.getBalance().subtract(amount));
     toAccount.setBalance(toAccount.getBalance().add(amount));

     accountRepository.save(fromAccount);
     accountRepository.save(toAccount);

     // å¦‚æœè¿™é‡Œå‘ç”Ÿå¼‚å¸¸ï¼ŒSpring å°†å›æ»šäº‹åŠ¡
 &#125;
&#125;
</code></pre>
<h4 id="ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†"><a href="#ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†" class="headerlink" title="ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†"></a>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†</h4><pre><code class="java">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.TransactionStatus;
import org.springframework.transaction.support.TransactionCallbackWithoutResult;
import org.springframework.transaction.support.TransactionTemplate;

@Service
public class AccountService &#123;

 @Autowired
 private TransactionTemplate transactionTemplate;

 public void transferMoney(Long fromAccountId, Long toAccountId, BigDecimal amount) &#123;
     transactionTemplate.execute(new TransactionCallbackWithoutResult() &#123;
         @Override
         protected void doInTransactionWithoutResult(TransactionStatus status) &#123;
             try &#123;
                 // æ‰§è¡Œè½¬è´¦æ“ä½œï¼Œä¸å£°æ˜å¼äº‹åŠ¡ç®¡ç†ä¸­çš„æ“ä½œç›¸åŒ
                 // ...
             &#125; catch (Exception e) &#123;
                 status.setRollbackOnly(); // å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œæ ‡è®°äº‹åŠ¡å›æ»š
             &#125;
         &#125;
     &#125;);
 &#125;
&#125;
</code></pre>
<h2 id="âœ…-ä¸€å¥è¯ç†è§£"><a href="#âœ…-ä¸€å¥è¯ç†è§£" class="headerlink" title="âœ… ä¸€å¥è¯ç†è§£"></a>âœ… ä¸€å¥è¯ç†è§£</h2><p><strong>Springäº‹åŠ¡</strong> &#x3D; å¸®ä½ ä¿è¯ä¸€ç»„æ•°æ®åº“æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼ˆACIDï¼‰ã€‚</p>
<hr>
<h2 id="ğŸŒŸ-Springäº‹åŠ¡ä½¿ç”¨æ–¹å¼"><a href="#ğŸŒŸ-Springäº‹åŠ¡ä½¿ç”¨æ–¹å¼" class="headerlink" title="ğŸŒŸ Springäº‹åŠ¡ä½¿ç”¨æ–¹å¼"></a>ğŸŒŸ Springäº‹åŠ¡ä½¿ç”¨æ–¹å¼</h2><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>ç‰¹ç‚¹</th>
<th>ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å£°æ˜å¼äº‹åŠ¡</strong>ï¼ˆ@Transactionalï¼‰</td>
<td>æ¨èæ–¹å¼ï¼Œç®€æ´ï¼ŒåŸºäºAOPä»£ç†å¢å¼ºæ–¹æ³•</td>
<td>99%ä¸šåŠ¡åœºæ™¯ï¼Œè½¬è´¦ã€ä¸‹å•ã€åº“å­˜æ‰£å‡</td>
</tr>
<tr>
<td><strong>ç¼–ç¨‹å¼äº‹åŠ¡</strong>ï¼ˆTransactionTemplateï¼‰</td>
<td>è‡ªå·±æ§åˆ¶äº‹åŠ¡å¼€å§‹ã€æäº¤ã€å›æ»šæµç¨‹</td>
<td>ç‰¹æ®Šåœºæ™¯éœ€è¦ç²¾ç»†æ§åˆ¶äº‹åŠ¡ï¼Œå¦‚ä»£ç é€»è¾‘å¤æ‚ã€å¼‚å¸¸å¤„ç†åµŒå¥—</td>
</tr>
</tbody></table>
<h2 id="ğŸ¯-å®æˆ˜ç­”é¢˜æ¨¡æ¿"><a href="#ğŸ¯-å®æˆ˜ç­”é¢˜æ¨¡æ¿" class="headerlink" title="ğŸ¯ å®æˆ˜ç­”é¢˜æ¨¡æ¿"></a>ğŸ¯ å®æˆ˜ç­”é¢˜æ¨¡æ¿</h2><p>â€œåœ¨é¡¹ç›®ä¸­æˆ‘ä¸»è¦ç”¨çš„æ˜¯<strong>å£°æ˜å¼äº‹åŠ¡</strong>ï¼Œé€šè¿‡<code>@Transactional</code>æ³¨è§£æ¥ç®¡ç†äº‹åŠ¡ï¼Œé€šå¸¸æ”¾åœ¨<strong>serviceå±‚</strong>æ–¹æ³•ä¸Šã€‚æ¯”å¦‚ç”¨æˆ·ä¸‹å•æ—¶ï¼Œæˆ‘éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å®Œæˆè®¢å•ç”Ÿæˆã€åº“å­˜æ‰£å‡ã€ç”¨æˆ·ç§¯åˆ†å˜æ›´ï¼Œå¦‚æœä¸­é—´ä»»ä½•ä¸€ç¯å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡éƒ½ä¼šè‡ªåŠ¨å›æ»šï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚â€</p>
<p>â€œæˆ‘è¿˜äº†è§£è¿‡<strong>ç¼–ç¨‹å¼äº‹åŠ¡</strong>ï¼Œåƒä½¿ç”¨<code>TransactionTemplate</code>æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡è¾¹ç•Œï¼Œé€‚åˆä¸€äº›æµç¨‹æ¯”è¾ƒå¤æ‚æˆ–éœ€è¦ç»†ç²’åº¦äº‹åŠ¡æ§åˆ¶çš„ä¸šåŠ¡åœºæ™¯ã€‚â€</p>
<h3 id="Transactional-æ³¨è§£å¸¸ç”¨å±æ€§ï¼š"><a href="#Transactional-æ³¨è§£å¸¸ç”¨å±æ€§ï¼š" class="headerlink" title="@Transactional æ³¨è§£å¸¸ç”¨å±æ€§ï¼š"></a><code>@Transactional</code> æ³¨è§£å¸¸ç”¨å±æ€§ï¼š</h3><table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>propagation</code></td>
<td>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼ˆREQUIRED&#x2F;REQUIRES_NEWç­‰ï¼‰</td>
<td><code>@Transactional(propagation=...)</code></td>
</tr>
<tr>
<td><code>rollbackFor</code></td>
<td>å“ªäº›å¼‚å¸¸ä¼šè§¦å‘å›æ»šï¼ˆé»˜è®¤åªå›æ»šè¿è¡Œæ—¶å¼‚å¸¸ï¼‰</td>
<td><code>@Transactional(rollbackFor=Exception.class)</code></td>
</tr>
<tr>
<td><code>readOnly</code></td>
<td>æ˜¯å¦åªè¯»äº‹åŠ¡ï¼Œä¼˜åŒ–æ€§èƒ½</td>
<td><code>@Transactional(readOnly=true)</code></td>
</tr>
<tr>
<td><code>timeout</code></td>
<td>è¶…æ—¶æ—¶é—´ï¼Œå•ä½ï¼šç§’</td>
<td><code>@Transactional(timeout=5)</code></td>
</tr>
</tbody></table>
<h2 id="ğŸ’¥-æ˜“é”™ç‚¹æç¤ºï¼ˆé¢è¯•å¸¸é—®ï¼‰"><a href="#ğŸ’¥-æ˜“é”™ç‚¹æç¤ºï¼ˆé¢è¯•å¸¸é—®ï¼‰" class="headerlink" title="ğŸ’¥ æ˜“é”™ç‚¹æç¤ºï¼ˆé¢è¯•å¸¸é—®ï¼‰"></a>ğŸ’¥ æ˜“é”™ç‚¹æç¤ºï¼ˆé¢è¯•å¸¸é—®ï¼‰</h2><table>
<thead>
<tr>
<th>é—®é¢˜ç‚¹</th>
<th>æ­£ç¡®åšæ³•</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ³¨è§£åŠ åœ¨controllerå±‚</strong></td>
<td>âŒ â†’ <code>@Transactional</code>åº”åŠ åœ¨<strong>serviceå±‚</strong></td>
</tr>
<tr>
<td><strong>æ–¹æ³•å†…è‡ªå·±è°ƒç”¨è‡ªå·±</strong></td>
<td>âŒ äº‹åŠ¡å¤±æ•ˆï¼åº”é€šè¿‡æ³¨å…¥è‡ªå·±è°ƒç”¨</td>
</tr>
<tr>
<td><strong>åªæŠ›äº†Exceptionæ²¡åŠ rollbackFor</strong></td>
<td>é»˜è®¤åªå›æ»šRuntimeException</td>
</tr>
<tr>
<td><strong>æ•°æ®åº“å¼•æ“ä¸æ˜¯InnoDB</strong></td>
<td>MySQLéœ€ç”¨InnoDBæ‰æ”¯æŒäº‹åŠ¡</td>
</tr>
</tbody></table>
<h2 id="ğŸ”§-å°ç»“ï¼šé¡¹ç›®ä¸­äº‹åŠ¡ç”¨æ³•æ¨¡ç‰ˆ"><a href="#ğŸ”§-å°ç»“ï¼šé¡¹ç›®ä¸­äº‹åŠ¡ç”¨æ³•æ¨¡ç‰ˆ" class="headerlink" title="ğŸ”§ å°ç»“ï¼šé¡¹ç›®ä¸­äº‹åŠ¡ç”¨æ³•æ¨¡ç‰ˆ"></a>ğŸ”§ å°ç»“ï¼šé¡¹ç›®ä¸­äº‹åŠ¡ç”¨æ³•æ¨¡ç‰ˆ</h2><pre><code class="java">@Service
public class OrderService &#123;

    @Autowired
    private OrderMapper orderMapper;

    @Autowired
    private StockMapper stockMapper;

    @Transactional(rollbackFor = Exception.class) // æ¨èåŠ ä¸Š rollbackFor
    public void createOrder(Order order) &#123;
        // 1. åˆ›å»ºè®¢å•
        orderMapper.insert(order);

        // 2. æ‰£å‡åº“å­˜
        stockMapper.deduct(order.getProductId(), order.getQuantity());

        // 3. æ¨¡æ‹Ÿå¼‚å¸¸æµ‹è¯•äº‹åŠ¡å›æ»š
        // int i = 1 / 0;

        // 4. æ’å…¥æ—¥å¿—ç­‰å…¶ä»–æ“ä½œ...
    &#125;
&#125;
</code></pre>
</blockquote>
<h4 id="ä½ ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆæœ‰å“ªäº›ï¼Œç”¨äº†å“ªäº›"><a href="#ä½ ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆæœ‰å“ªäº›ï¼Œç”¨äº†å“ªäº›" class="headerlink" title="ä½ ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆæœ‰å“ªäº›ï¼Œç”¨äº†å“ªäº›?"></a>ä½ ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆæœ‰å“ªäº›ï¼Œç”¨äº†å“ªäº›?</h4><p>SpringBoot Vue Git Maven MyBatisâ€¦â€¦</p>
<h4 id="è§£å†³éš¾ç‚¹çš„å†³ç­–æœ‰å’Œç”¨æˆ·æ²Ÿé€šçš„å—ï¼Ÿ"><a href="#è§£å†³éš¾ç‚¹çš„å†³ç­–æœ‰å’Œç”¨æˆ·æ²Ÿé€šçš„å—ï¼Ÿ" class="headerlink" title="è§£å†³éš¾ç‚¹çš„å†³ç­–æœ‰å’Œç”¨æˆ·æ²Ÿé€šçš„å—ï¼Ÿ"></a>è§£å†³éš¾ç‚¹çš„å†³ç­–æœ‰å’Œç”¨æˆ·æ²Ÿé€šçš„å—ï¼Ÿ</h4><p>æœ‰è¿‡æ²Ÿé€š è®©ä»–ä»¬äº†è§£ä¸€ä¸‹æˆ‘ä»¬çš„æ–¹æ¡ˆ</p>
<h6 id="ä¸‡ä¸€ç”¨æˆ·å¬ä¸æ‡‚æ€ä¹ˆåŠï¼Ÿ"><a href="#ä¸‡ä¸€ç”¨æˆ·å¬ä¸æ‡‚æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="ä¸‡ä¸€ç”¨æˆ·å¬ä¸æ‡‚æ€ä¹ˆåŠï¼Ÿ"></a>ä¸‡ä¸€ç”¨æˆ·å¬ä¸æ‡‚æ€ä¹ˆåŠï¼Ÿ</h6><p>æˆ‘ä¼šç”¨ä¸€äº›æ›´åŠ ç›´ç™½é€šä¿—çš„è¯­è¨€è®©ç”¨æˆ·ç†è§£æˆ‘ä»¬çš„æ–¹æ¡ˆ</p>
<h6 id="ç”¨æˆ·ä¸æ¥å—è¿™ä¸ªæ–¹æ¡ˆæ€ä¹ˆåŠï¼Ÿ"><a href="#ç”¨æˆ·ä¸æ¥å—è¿™ä¸ªæ–¹æ¡ˆæ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="ç”¨æˆ·ä¸æ¥å—è¿™ä¸ªæ–¹æ¡ˆæ€ä¹ˆåŠï¼Ÿ"></a>ç”¨æˆ·ä¸æ¥å—è¿™ä¸ªæ–¹æ¡ˆæ€ä¹ˆåŠï¼Ÿ</h6><p>æˆ‘ä»¬å¯ä»¥æä¾›ä¸æ­¢ä¸€ä¸ªæ–¹æ¡ˆ æˆ–è€… æä¾›ä»–æçš„æ–¹æ¡ˆ ç»¼åˆä¸€ä¸‹å„ç§æ–¹æ¡ˆå‘Šè¯‰å…¶ä¼˜ç¼ºç‚¹(ç«™åœ¨æˆ‘ä»¬çš„ä¸“ä¸šè§’åº¦æ„è§)å’Œé£é™© è®©å®¢æˆ·æ˜çŸ¥ è®©å…¶é€‰æ‹©</p>
<h4 id="é€šå¸¸ä¸€èˆ¬æ€ä¹ˆå­¦ä¹ çš„ï¼Ÿæœ€è¿‘åœ¨ç ”ç©¶ä»€ä¹ˆæŠ€æœ¯ï¼Ÿ"><a href="#é€šå¸¸ä¸€èˆ¬æ€ä¹ˆå­¦ä¹ çš„ï¼Ÿæœ€è¿‘åœ¨ç ”ç©¶ä»€ä¹ˆæŠ€æœ¯ï¼Ÿ" class="headerlink" title="é€šå¸¸ä¸€èˆ¬æ€ä¹ˆå­¦ä¹ çš„ï¼Ÿæœ€è¿‘åœ¨ç ”ç©¶ä»€ä¹ˆæŠ€æœ¯ï¼Ÿ"></a>é€šå¸¸ä¸€èˆ¬æ€ä¹ˆå­¦ä¹ çš„ï¼Ÿ<del>æœ€è¿‘åœ¨ç ”ç©¶ä»€ä¹ˆæŠ€æœ¯ï¼Ÿ</del></h4><p>æƒ³é¢è¯•çš„ç›®çš„ è¦çµ¦å…¬å¸å¸¦æ¥ä¸€äº›å¥½çš„<br>ä¸€èˆ¬<strong>ä»¥å…¬å¸çš„å®é™…é¡¹ç›®ä¸­ä¸ºåˆ‡å…¥ç‚¹</strong>å»å­¦ä¹ ä¼šæ›´æœ‰æ•ˆç‡</p>
<h5 id="å­¦ä¹ ä¸€ä¸ªæ–°çš„æŠ€æœ¯å¤§æ¦‚è¦å¤šä¹…ï¼Ÿ"><a href="#å­¦ä¹ ä¸€ä¸ªæ–°çš„æŠ€æœ¯å¤§æ¦‚è¦å¤šä¹…ï¼Ÿ" class="headerlink" title="å­¦ä¹ ä¸€ä¸ªæ–°çš„æŠ€æœ¯å¤§æ¦‚è¦å¤šä¹…ï¼Ÿ"></a>å­¦ä¹ ä¸€ä¸ªæ–°çš„æŠ€æœ¯å¤§æ¦‚è¦å¤šä¹…ï¼Ÿ</h5><p>1-2å¤© é¦–å…ˆçœ‹å®˜ç½‘ è¿™ä¸ªæŠ€æœ¯æ˜¯è§£å†³å“ªäº› çœ‹æˆ‘ä»¬çš„é¡¹ç›®éœ€è¦å“ªäº›æŠ€æœ¯åˆ‡å…¥ç‚¹èƒ½å¼•ç”¨ ç„¶åå»ä¸“é—¨é’ˆå¯¹è¿™ä¸ªæŠ€æœ¯åŠŸèƒ½ç‚¹å»å­¦ä¹ å¿«é€Ÿä¸Šæ‰‹çš„æ¥å£æ–‡æ¡£</p>
<h4 id="redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ"><a href="#redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ" class="headerlink" title="redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ"></a>redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ</h4><ul>
<li><strong>ä¸»æ•°æ®åŸºäºå†…å­˜æ“ä½œ</strong></li>
<li><strong>Redisæ˜¯å•çº¿ç¨‹</strong>[æ“ä½œæ•°æ®çš„çº¿ç¨‹]ï¼Œé¿å…ä¸Šä¸‹æ–‡çš„é¢‘ç¹åˆ‡æ¢<del>æ•´ä¸ªredisä¸æ˜¯å°±ä¸€ä¸ªçº¿ç¨‹</del></li>
<li><strong>åº•å±‚åŸºäºCè¯­è¨€å®ç°</strong> <del>å¾—ç›Šäºåº•å±‚è‰¯å¥½çš„æ•°æ®ç»“æ„[]</del></li>
<li><strong>åŸºäº<span style = "color:red">éé˜»å¡</span>çš„IO</strong><del>æå‡IOè¯»å†™æ€§èƒ½ï¼ŒNIO,BIO,AIOâ€¦</del></li>
</ul>
<h6 id="Javaå››å¤§æ€æ‰‹"><a href="#Javaå››å¤§æ€æ‰‹" class="headerlink" title="Javaå››å¤§æ€æ‰‹"></a>Javaå››å¤§æ€æ‰‹</h6><p><u>é›†åˆæ•°æ®ç»“æ„     jvm    å¹¶å‘ç¼–ç¨‹    ç½‘ç»œIO</u></p>
<blockquote>
<p>éé˜»å¡IOï¼ˆNon-blocking I&#x2F;Oï¼‰æ˜¯ä¸€ç§IOæ¨¡å‹ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨æ‰§è¡ŒIOæ“ä½œæ—¶ä¸ä¼šè¢«é˜»å¡ï¼Œå³ç¨‹åºå¯ä»¥åœ¨å‘èµ·IOè¯·æ±‚åç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œè€Œä¸éœ€è¦ç­‰å¾…IOæ“ä½œå®Œæˆã€‚ä»¥ä¸‹æ˜¯å…³äºéé˜»å¡IOçš„ä¸€äº›å…³é”®ç‚¹ï¼š</p>
<h3 id="éé˜»å¡IOçš„ç‰¹ç‚¹ï¼š"><a href="#éé˜»å¡IOçš„ç‰¹ç‚¹ï¼š" class="headerlink" title="éé˜»å¡IOçš„ç‰¹ç‚¹ï¼š"></a>éé˜»å¡IOçš„ç‰¹ç‚¹ï¼š</h3><ol>
<li><strong>å¼‚æ­¥æ“ä½œ</strong>ï¼šéé˜»å¡IOæ“ä½œé€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€ç¨‹åºå‘èµ·IOè¯·æ±‚åï¼Œä¸éœ€è¦ç­‰å¾…IOæ“ä½œå®Œæˆï¼Œè€Œæ˜¯å¯ä»¥ç«‹å³è¿”å›å»åšå…¶ä»–äº‹æƒ…ã€‚</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šéé˜»å¡IOå¾€å¾€ä¸äº‹ä»¶é©±åŠ¨æ¨¡å‹ç»“åˆä½¿ç”¨ï¼Œç¨‹åºå¯ä»¥é€šè¿‡ç›‘å¬å™¨æ¥å“åº”IOäº‹ä»¶ï¼ˆå¦‚æ•°æ®å¯è¯»ã€è¿æ¥å¯å†™ç­‰ï¼‰ã€‚</li>
<li><strong>å‡å°‘ç­‰å¾…æ—¶é—´</strong>ï¼šç”±äºç¨‹åºåœ¨ç­‰å¾…IOæ“ä½œå®Œæˆæ—¶ä¸ä¼šé˜»å¡ï¼Œå®ƒå¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œä»è€Œæé«˜äº†ç¨‹åºçš„å“åº”æ€§å’Œååé‡ã€‚</li>
</ol>
<h3 id="éé˜»å¡IOçš„å®ç°æ–¹å¼ï¼š"><a href="#éé˜»å¡IOçš„å®ç°æ–¹å¼ï¼š" class="headerlink" title="éé˜»å¡IOçš„å®ç°æ–¹å¼ï¼š"></a>éé˜»å¡IOçš„å®ç°æ–¹å¼ï¼š</h3><ul>
<li><strong>NIOï¼ˆNew I&#x2F;Oï¼‰</strong>ï¼šåœ¨Javaä¸­ï¼ŒNIOæä¾›äº†ä¸€ç§éé˜»å¡çš„IOæ–¹å¼ï¼Œä½¿ç”¨<code>Selector</code>æ¥ç®¡ç†å¤šä¸ªé€šé“ï¼ˆChannelï¼‰ä¸Šçš„IOäº‹ä»¶ã€‚</li>
<li><strong>AIOï¼ˆAsynchronous I&#x2F;Oï¼‰</strong>ï¼šAIOæ˜¯å¦ä¸€ç§éé˜»å¡IOæ¨¡å‹ï¼Œå®ƒå…è®¸ç¨‹åºå®Œå…¨å¼‚æ­¥åœ°æ‰§è¡ŒIOæ“ä½œï¼Œé€šå¸¸æ˜¯é€šè¿‡å®Œæˆç«¯å£ï¼ˆCompletion Portsï¼‰æ¥å®ç°ã€‚</li>
<li><strong>BIOï¼ˆBlocking I&#x2F;Oï¼‰</strong>ï¼šä¸éé˜»å¡IOç›¸å¯¹çš„æ˜¯é˜»å¡IOï¼Œå…¶ä¸­æ¯ä¸ªIOæ“ä½œéƒ½ä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹ï¼Œç›´åˆ°æ“ä½œå®Œæˆã€‚</li>
</ul>
<h3 id="éé˜»å¡IOçš„ä¼˜åŠ¿ï¼š"><a href="#éé˜»å¡IOçš„ä¼˜åŠ¿ï¼š" class="headerlink" title="éé˜»å¡IOçš„ä¼˜åŠ¿ï¼š"></a>éé˜»å¡IOçš„ä¼˜åŠ¿ï¼š</h3><ul>
<li><strong>èµ„æºåˆ©ç”¨ç‡</strong>ï¼šéé˜»å¡IOå¯ä»¥æ›´æœ‰æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºï¼Œå› ä¸ºå•ä¸ªçº¿ç¨‹å¯ä»¥å¤„ç†å¤šä¸ªIOæ“ä½œã€‚</li>
<li><strong>é«˜å¹¶å‘å¤„ç†</strong>ï¼šåœ¨å¤„ç†å¤§é‡å¹¶å‘è¿æ¥æ—¶ï¼Œéé˜»å¡IOå¯ä»¥æ˜¾è‘—æé«˜ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</li>
</ul>
<h3 id="éé˜»å¡IOåœ¨Redisä¸­çš„åº”ç”¨ï¼š"><a href="#éé˜»å¡IOåœ¨Redisä¸­çš„åº”ç”¨ï¼š" class="headerlink" title="éé˜»å¡IOåœ¨Redisä¸­çš„åº”ç”¨ï¼š"></a>éé˜»å¡IOåœ¨Redisä¸­çš„åº”ç”¨ï¼š</h3><ul>
<li><strong>å•çº¿ç¨‹æ¨¡å‹</strong>ï¼šRedisæ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é”®å€¼å­˜å‚¨æ•°æ®åº“ï¼Œå®ƒä½¿ç”¨å•çº¿ç¨‹æ¨¡å‹æ¥å¤„ç†æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚ã€‚ç”±äºæ“ä½œæ˜¯åŸºäºå†…å­˜çš„ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œè€Œå•çº¿ç¨‹é¿å…äº†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚</li>
<li><strong>éé˜»å¡IOå’Œå¤šè·¯å¤ç”¨</strong>ï¼šå°½ç®¡Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œä½†å®ƒä½¿ç”¨éé˜»å¡IOå’Œå¤šè·¯å¤ç”¨æŠ€æœ¯ï¼ˆå¦‚epollæˆ–kqueueï¼‰æ¥åŒæ—¶å¤„ç†å¤šä¸ªIOæµã€‚è¿™æ„å‘³ç€Rediså¯ä»¥åœ¨ç­‰å¾…IOæ“ä½œï¼ˆå¦‚ç½‘ç»œå“åº”ï¼‰æ—¶ä¸é˜»å¡ï¼Œä»è€Œå¯ä»¥ç»§ç»­å¤„ç†å…¶ä»–è¯·æ±‚ã€‚</li>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šRedisçš„éé˜»å¡IOå’Œå¤šè·¯å¤ç”¨æœºåˆ¶ä½¿å¾—å®ƒå³ä½¿åœ¨é¢å¯¹å¤§é‡å¹¶å‘è¯·æ±‚æ—¶ä¹Ÿèƒ½ä¿æŒé«˜æ€§èƒ½ã€‚</li>
</ul>
</blockquote>
<h4 id="redisçš„æ•°æ®ç±»å‹ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†åˆ«æ˜¯ä»€ä¹ˆ"><a href="#redisçš„æ•°æ®ç±»å‹ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†åˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="redisçš„æ•°æ®ç±»å‹ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†åˆ«æ˜¯ä»€ä¹ˆ"></a>redisçš„æ•°æ®ç±»å‹ä»¥åŠä½¿ç”¨åœºæ™¯åˆ†åˆ«æ˜¯ä»€ä¹ˆ</h4><h6 id="å†™å…¥ä¾èµ–"><a href="#å†™å…¥ä¾èµ–" class="headerlink" title="å†™å…¥ä¾èµ–"></a>å†™å…¥ä¾èµ–</h6><pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;redis.clients&lt;/groupId&gt;
    &lt;artifactId&gt;jedis&lt;/artifactId&gt;
    &lt;version&gt;3.7.0&lt;/version&gt; &lt;!-- Use the latest version available --&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li><p><strong>String</strong>ï¼šå­˜å‚¨å¯¹è±¡ä¿¡æ¯(è½¬JSON)<br>å°†ç”¨æˆ·ä¿¡æ¯åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²åå­˜å‚¨ã€‚</p>
<pre><code class="json">SET user:1000 &#39;&#123;&quot;name&quot;:&quot;Alice&quot;,&quot;age&quot;:30,&quot;email&quot;:&quot;alice@example.com&quot;&#125;&#39;

----------------------------------------------------------------------
import redis.clients.jedis.Jedis;

public class RedisStringExample &#123;
    public static void main(String[] args) &#123;
        Jedis jedis = new Jedis(&quot;localhost&quot;);
        jedis.set(&quot;user:1000&quot;, &quot;&#123;\&quot;name\&quot;:\&quot;Alice\&quot;,\&quot;age\&quot;:30,\&quot;email\&quot;:\&quot;alice@example.com\&quot;&#125;&quot;);
        String userInfo = jedis.get(&quot;user:1000&quot;);
        System.out.println(userInfo);
        
        jedis.incr(&quot;visits&quot;);
        long visits = jedis.get(&quot;visits&quot;);
        System.out.println(&quot;Visits: &quot; + visits);
        
        jedis.close();
    &#125;
&#125;
</code></pre>
</li>
<li><p><strong>List</strong>ï¼šé“¾è¡¨ï¼ŒæŸ¥è¯¢è®°å½•çš„ç¼“å­˜ã€åˆ—è¡¨ï¼Œæœ‹å‹åœˆï¼Œå¾®åšï¼Œé˜Ÿåˆ—æ•°æ®ç»“æ„<br>å¯ä»¥å°†æ•°æ®åº“æŸ¥è¯¢ç»“æœç¼“å­˜ä¸ºä¸€ä¸ªåˆ—è¡¨</p>
<pre><code class="mysql"># æŸ¥è¯¢è®°å½•çš„ç¼“å­˜
LPUSH recent:queries &quot;SELECT * FROM users WHERE age &gt; 30&quot;

# æ¶ˆæ¯é˜Ÿåˆ—
ä½¿ç”¨Listä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”Ÿäº§è€…å°†æ¶ˆæ¯LPUSHåˆ°åˆ—è¡¨ï¼Œæ¶ˆè´¹è€…ä»åˆ—è¡¨ä¸­RPOPæ¶ˆæ¯
LPUSH message:queue &quot;message1&quot;
RPOP message:queue

----------------------------------------------------------------------
import redis.clients.jedis.Jedis;

public class RedisListExample &#123;
    public static void main(String[] args) &#123;
        Jedis jedis = new Jedis(&quot;localhost&quot;);
        jedis.lpush(&quot;recent:queries&quot;, &quot;SELECT * FROM users WHERE age &gt; 30&quot;);
        String query = jedis.rpop(&quot;recent:queries&quot;);
        System.out.println(&quot;Recent Query: &quot; + query);
        
        jedis.close();
    &#125;
&#125;
w
</code></pre>
</li>
<li><p><strong>Hash</strong>ï¼šè·å–å±€éƒ¨å±æ€§ï¼Œå°keyä¸èƒ½è®¾ç½®è¿‡æœŸæ—¶é—´<del>Hashæ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œé€‚åˆå­˜å‚¨å¯¹è±¡</del><br>Hashæ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œé€‚åˆå­˜å‚¨å¯¹è±¡</p>
<pre><code class="mysql">HSET user:1000 name &quot;Alice&quot; age 30 email &quot;alice@example.com&quot;
HGET user:1000 name

----------------------------------------------------------------------
import redis.clients.jedis.Jedis;

public class RedisHashExample &#123;
    public static void main(String[] args) &#123;
        Jedis jedis = new Jedis(&quot;localhost&quot;);
        jedis.hset(&quot;user:1000&quot;, &quot;name&quot;, &quot;Alice&quot;);
        jedis.hset(&quot;user:1000&quot;, &quot;age&quot;, &quot;30&quot;);
        jedis.hset(&quot;user:1000&quot;, &quot;email&quot;, &quot;alice@example.com&quot;);
        
        String name = jedis.hget(&quot;user:1000&quot;, &quot;name&quot;);
        System.out.println(&quot;Name: &quot; + name);
        
        jedis.close();
    &#125;
&#125;
</code></pre>
</li>
<li><p><strong>Set</strong>ï¼šæ— åºä¸å¯é‡å¤çš„ï¼Œæ”¶è—ï¼Œç‚¹èµï¼Œç¤¾äº¤åœºæ™¯ï¼Œèšåˆè®¡ç®—(âˆ©âˆªå·®é›†)<br>ç¤¾äº¤åœºæ™¯ï¼šä½¿ç”¨Setæ¥å­˜å‚¨ç”¨æˆ·çš„å…³æ³¨åˆ—è¡¨ï¼Œç¡®ä¿å…³æ³¨å…³ç³»çš„å”¯ä¸€æ€§ã€‚</p>
<pre><code class="mysql">SADD user:1000:following 2000 3000 4000

----------------------------------------------------------------------
import redis.clients.jedis.Jedis;

public class RedisSetExample &#123;
    public static void main(String[] args) &#123;
        Jedis jedis = new Jedis(&quot;localhost&quot;);
        jedis.sadd(&quot;user:1000:following&quot;, &quot;2000&quot;, &quot;3000&quot;, &quot;4000&quot;);
        Set&lt;String&gt; following = jedis.smembers(&quot;user:1000:following&quot;);
        System.out.println(&quot;Following: &quot; + following);
        
        jedis.close();
    &#125;
&#125;
</code></pre>
<p>èšåˆè®¡ç®—ï¼šè®¡ç®—ä¸¤ä¸ªç”¨æˆ·çš„å…±åŒå…³æ³¨ã€‚</p>
<pre><code class="java">SINTER user:1000:following user:2000:following
</code></pre>
</li>
<li><p><strong>Zset</strong>ï¼šæ’åºåœºæ™¯ï¼Œæ’è¡Œæ¦œï¼Œå§“åæ’åº</p>
<p>æ’è¡Œæ¦œï¼šæ ¹æ®ç”¨æˆ·å¾—åˆ†æ¥å­˜å‚¨æ’è¡Œæ¦œ</p>
<pre><code class="mysql">ZADD leaderboard 1000 Alice 950 Bob 900 Charlie
ZRANGE leaderboard 0 -1 WITHSCORES

----------------------------------------------------------------------
import redis.clients.jedis.Jedis;
import java.util.Set;

public class RedisZsetExample &#123;
    public static void main(String[] args) &#123;
        Jedis jedis = new Jedis(&quot;localhost&quot;);
        jedis.zadd(&quot;leaderboard&quot;, 1000, &quot;Alice&quot;);
        jedis.zadd(&quot;leaderboard&quot;, 950, &quot;Bob&quot;);
        jedis.zadd(&quot;leaderboard&quot;, 900, &quot;Charlie&quot;);
        
        Set&lt;String&gt; leaderboard = jedis.zrange(&quot;leaderboard&quot;, 0, -1);
        System.out.println(&quot;Leaderboard: &quot; + leaderboard);
        
        jedis.close();
    &#125;
&#125;
</code></pre>
<p>å§“åæ’åºï¼šå­˜å‚¨å­¦ç”Ÿå§“åå’Œæˆç»©ï¼Œå¹¶æŒ‰æˆç»©æ’åºã€‚</p>
<pre><code class="mysql">ZADD students 92 John 85 Mary 88 Alice
ZRANGE students 0 -1 WITHSCORES
</code></pre>
</li>
</ul>
<p>åˆ†å¸ƒå¼é”éƒ½å¯ä»¥ç”¨ã€‚Redissonæ˜¯Redisçš„å„¿å­ï¼Œåº•å±‚ä¸ºHash</p>
<h4 id="redisæ•°æ®è¿‡æœŸç­–ç•¥"><a href="#redisæ•°æ®è¿‡æœŸç­–ç•¥" class="headerlink" title="redisæ•°æ®è¿‡æœŸç­–ç•¥"></a>redisæ•°æ®è¿‡æœŸç­–ç•¥</h4><ul>
<li><p>æƒ°æ€§åˆ é™¤ï¼šé”®è¿‡æœŸæ—¶ä¸ä¼šç«‹å³åˆ é™¤ï¼Œå½“è®¿é—®è¯¥é”®æ—¶åˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸå°±åˆ é™¤<br><strong>æƒ°æ€§åˆ é™¤ç­–ç•¥æ˜¯åœ¨è®¿é—®é”®æ—¶æ£€æŸ¥é”®æ˜¯å¦è¿‡æœŸ</strong>ï¼Œå¦‚æœè¿‡æœŸåˆ™åˆ é™¤ã€‚</p>
<pre><code class="java">import redis.clients.jedis.Jedis;

public class LazyExpiration &#123;
    private Jedis jedis;

    public LazyExpiration() &#123;
        // è¿æ¥åˆ°RedisæœåŠ¡å™¨
        this.jedis = new Jedis(&quot;localhost&quot;);
    &#125;

    public String getKey(String key) &#123;
        // æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
        if (!jedis.exists(key)) &#123;
            return null;
        &#125;

        // æ£€æŸ¥é”®æ˜¯å¦è¿‡æœŸ
        if (isExpired(key)) &#123;
            // å¦‚æœé”®å·²è¿‡æœŸï¼Œåˆ™åˆ é™¤å®ƒ
            jedis.del(key);
            return null;
        &#125;

        // å¦‚æœé”®æœªè¿‡æœŸï¼Œè¿”å›é”®çš„å€¼
        return jedis.get(key);
    &#125;

    private boolean isExpired(String key) &#123;
        // è·å–é”®çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ï¼Œå¦‚æœè¿”å›å€¼å¤§äº0ï¼Œåˆ™é”®æœªè¿‡æœŸ
        return jedis.ttl(key) == -2;
    &#125;

    public static void main(String[] args) &#123;
        LazyExpiration lazyExpiration = new LazyExpiration();
        String value = lazyExpiration.getKey(&quot;myKey&quot;);
        if (value != null) &#123;
            System.out.println(&quot;Key value: &quot; + value);
        &#125; else &#123;
            System.out.println(&quot;Key does not exist or has expired.&quot;);
        &#125;
    &#125;
&#125;
</code></pre>
</li>
<li><p>å®šæ—¶åˆ é™¤ï¼šè®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´ï¼Œå½“é”®è¿‡æœŸæ—¶ï¼Œç«‹å³åˆ é™¤</p>
<pre><code class="java">import redis.clients.jedis.Jedis;

public class ActiveExpiration &#123;
    private Jedis jedis;

    public ActiveExpiration() &#123;
        // è¿æ¥åˆ°RedisæœåŠ¡å™¨
        this.jedis = new Jedis(&quot;localhost&quot;);
    &#125;

    public void activeExpireCycle() &#123;
        // éšæœºæ£€æŸ¥ä¸€å®šæ•°é‡çš„é”®
        for (int i = 0; i &lt; 10; i++) &#123;
            String key = jedis.randomKey();
            if (key != null &amp;&amp; isExpired(key)) &#123;
                // å¦‚æœé”®å·²è¿‡æœŸï¼Œåˆ™åˆ é™¤å®ƒ
                jedis.del(key);
            &#125;
        &#125;
    &#125;

    private boolean isExpired(String key) &#123;
        // è·å–é”®çš„å‰©ä½™ç”Ÿå­˜æ—¶é—´ï¼Œå¦‚æœè¿”å›å€¼å¤§äº0ï¼Œåˆ™é”®æœªè¿‡æœŸ
        return jedis.ttl(key) == -2;
    &#125;

    public void runPeriodicTask() &#123;
        // å®šæ—¶ä»»åŠ¡ï¼ŒæŒ‰ç…§ä¸€å®šçš„é¢‘ç‡è¿è¡Œ
        while (true) &#123;
            activeExpireCycle();
            try &#123;
                Thread.sleep(1000); // æ¯ç§’æ‰§è¡Œä¸€æ¬¡
            &#125; catch (InterruptedException e) &#123;
                e.printStackTrace();
            &#125;
        &#125;
    &#125;

    public static void main(String[] args) &#123;
        ActiveExpiration activeExpiration = new ActiveExpiration();
        // å¯åŠ¨å®šæ—¶ä»»åŠ¡
        activeExpiration.runPeriodicTask();
    &#125;
&#125;
</code></pre>
</li>
</ul>
<h6 id="é«˜è–ªå†²åˆº-â†’-å®šæ—¶åˆ é™¤è¯¦ç»†ç­–ç•¥"><a href="#é«˜è–ªå†²åˆº-â†’-å®šæ—¶åˆ é™¤è¯¦ç»†ç­–ç•¥" class="headerlink" title="é«˜è–ªå†²åˆº â†’ å®šæ—¶åˆ é™¤è¯¦ç»†ç­–ç•¥"></a><span style = "color:red">é«˜è–ªå†²åˆº â†’ å®šæ—¶åˆ é™¤è¯¦ç»†ç­–ç•¥</span></h6><blockquote>
<p>è¦æ‰«ææ‰€æœ‰çš„å®šæœŸä»»åŠ¡åˆ é™¤ æœ‰ç­–ç•¥å¯ä»¥è®¾ç½®é˜ˆå€¼</p>
</blockquote>
<h4 id="å•¥æ—¶å€™ç¦»èŒçš„ï¼ŸåŠä¸ªæœˆå¤ªé•¿äº†"><a href="#å•¥æ—¶å€™ç¦»èŒçš„ï¼ŸåŠä¸ªæœˆå¤ªé•¿äº†" class="headerlink" title="å•¥æ—¶å€™ç¦»èŒçš„ï¼ŸåŠä¸ªæœˆå¤ªé•¿äº†"></a>å•¥æ—¶å€™ç¦»èŒçš„ï¼Ÿ<del>åŠä¸ªæœˆå¤ªé•¿äº†</del></h4><p>åˆšåˆšç¦»èŒ ä¹Ÿæ˜¯åˆšåˆšå¼€å§‹æŠ•</p>
<h4 id="ä¸»è¦å·¥ä½œèŒè´£"><a href="#ä¸»è¦å·¥ä½œèŒè´£" class="headerlink" title="ä¸»è¦å·¥ä½œèŒè´£"></a>ä¸»è¦å·¥ä½œèŒè´£</h4><p>ä¸»è¦è´Ÿè´£åç«¯å·¥ä½œï¼ŒååŠ©æµ‹è¯•ï¼Œè¿ç»´ä¸Šçº¿</p>
<h4 id="ä½ å¯¹å‰ç«¯æœ‰äº†è§£è¿‡å—ï¼Ÿ"><a href="#ä½ å¯¹å‰ç«¯æœ‰äº†è§£è¿‡å—ï¼Ÿ" class="headerlink" title="ä½ å¯¹å‰ç«¯æœ‰äº†è§£è¿‡å—ï¼Ÿ"></a>ä½ å¯¹å‰ç«¯æœ‰äº†è§£è¿‡å—ï¼Ÿ</h4><p>æœ‰äº†è§£è¿‡ï¼Œå¦‚HTMLã€CSSã€JavaScriptã€æ¡†æ¶[Vueã€Element]ç­‰ å¯ä»¥å¾ˆå¿«çš„ä¸Šæ‰‹<br><u>æˆ‘ä¸»è¦ä¸“é•¿åœ¨äºåç«¯å¼€å‘ï¼Œå¯ä»¥å­¦ä¹ å’Œäº†è§£æ›´å¤šçš„å‰ç«¯çŸ¥è¯†</u>ã€‚</p>
<h4 id="å„ç§æ·˜æ±°ç­–ç•¥ä»‹ç»"><a href="#å„ç§æ·˜æ±°ç­–ç•¥ä»‹ç»" class="headerlink" title="å„ç§æ·˜æ±°ç­–ç•¥ä»‹ç»"></a>å„ç§æ·˜æ±°ç­–ç•¥ä»‹ç»</h4><blockquote>
<p>Redisæä¾›äº†8ç§æ·˜æ±°ç­–ç•¥ï¼Œå¯ä»¥åˆ†æˆä¸¤å¤§ç±»ï¼š</p>
<p><strong>1ã€é’ˆå¯¹æ‰€æœ‰é”®çš„ç­–ç•¥ï¼š</strong>å¯¹æ‰€æœ‰é”®è¿›è¡Œé€‰æ‹©å’Œæ·˜æ±°ã€‚</p>
<p><strong>2ã€ä»…é’ˆå¯¹æœ‰è¿‡æœŸæ—¶é—´çš„é”®çš„ç­–ç•¥ï¼š</strong>åªåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä¸­é€‰æ‹©æ·˜æ±°å¯¹è±¡ã€‚</p>
</blockquote>
<p><strong>ä»¥ä¸‹å…·ä½“ç­–ç•¥ï¼š</strong><br><strong>å¯ä»¥åŒºåˆ†ä¸ºä¸¤ç±»</strong>ï¼š[æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´çš„key  ä¸ç®¡ä½ æœ‰æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´]</p>
<h5 id="1-noevictionã€é»˜è®¤ã€‘"><a href="#1-noevictionã€é»˜è®¤ã€‘" class="headerlink" title="1. noevictionã€é»˜è®¤ã€‘"></a>1. <strong>noeviction</strong>ã€é»˜è®¤ã€‘</h5><ul>
<li><strong>æè¿°</strong>ï¼šè¾¾åˆ°å†…å­˜é™åˆ¶æ—¶ï¼Œä¸å†æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œç›´æ¥æ‹’ç»æ‰€æœ‰å†™å…¥è¯·æ±‚ï¼ˆåŒ…æ‹¬æ’å…¥å’Œæ›´æ–°ï¼‰ã€‚[å¯ä»¥è¯» ä½†æ˜¯æ‹’ç»å†™è¯·æ±‚]</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<u>å¸Œæœ›æ•°æ®æ°¸ä¸ä¸¢å¤±çš„åœºæ™¯</u>ï¼Œä½†éœ€è¦ä¿è¯å†…å­˜å……è¶³ï¼Œå¦åˆ™ä¼šå¯¼è‡´å†™å…¥æ“ä½œå¤±è´¥ã€‚</li>
</ul>
<h5 id="2-allkeys-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰"><a href="#2-allkeys-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰" class="headerlink" title="2. allkeys-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰"></a>2. <strong>allkeys-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰</strong></h5><ul>
<li><strong>æè¿°</strong>ï¼šåœ¨æ‰€æœ‰çš„é”®ä¸­ä½¿ç”¨ LRUç®—æ³•ï¼Œåˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é”®ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚åˆç¼“å­˜åœºæ™¯ï¼Œä¿ç•™<strong>é¢‘ç¹è®¿é—®</strong>çš„é”®ï¼Œé€å‡ºå¾ˆå°‘è¢«è®¿é—®çš„é”®ã€‚</li>
</ul>
<h5 id="3-allkeys-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘"><a href="#3-allkeys-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘" class="headerlink" title="3. allkeys-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘"></a>3. <strong>allkeys-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰</strong>ã€ç”µå•†ã€‘</h5><ul>
<li><strong>æè¿°</strong>ï¼šåœ¨æ‰€æœ‰é”®ä¸­ä½¿ç”¨ LFU ç®—æ³•ï¼Œåˆ é™¤ä½¿ç”¨é¢‘ç‡æœ€ä½çš„é”®ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºéœ€æ ¹æ®<strong>ä½¿ç”¨é¢‘ç‡</strong>è¿›è¡Œæ·˜æ±°çš„åœºæ™¯ï¼Œæ›´å…³æ³¨è®¿é—®æ¬¡æ•°è€Œéè®¿é—®æ—¶é—´ã€‚</li>
</ul>
<h5 id="4-volatile-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰"><a href="#4-volatile-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰" class="headerlink" title="4. volatile-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰"></a>4. <strong>volatile-lruï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰</strong></h5><ul>
<li><strong>æè¿°</strong>ï¼šä»…å¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä½¿ç”¨ LRU ç®—æ³•ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚åˆç¼“å­˜ä¸€äº›æœ‰è¿‡æœŸæ—¶é—´çš„æ•°æ®ï¼Œå¸Œæœ›æ ¹æ®<strong>è®¿é—®é¢‘ç‡</strong>æ¥è¿›è¡Œå†…å­˜ç®¡ç†çš„åœºæ™¯ã€‚</li>
</ul>
<h5 id="5-volatile-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘"><a href="#5-volatile-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘" class="headerlink" title="5. volatile-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘"></a>5. <strong>volatile-lfuï¼ˆæœ€å°‘ä½¿ç”¨é¢‘ç‡ï¼‰ã€ç”µå•†ã€‘</strong></h5><ul>
<li><strong>æè¿°</strong>ï¼šä»…å¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä½¿ç”¨ LFUç®—æ³•ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šåŒ volatile-lruï¼Œä½†æ›´å…³æ³¨<strong>ä½¿ç”¨é¢‘ç‡</strong>ã€‚</li>
</ul>
<h5 id="6-allkeys-random"><a href="#6-allkeys-random" class="headerlink" title="6. allkeys-random"></a>6. <strong>allkeys-random</strong></h5><ul>
<li><strong>æè¿°</strong>ï¼šåœ¨æ‰€æœ‰é”®ä¸­éšæœºé€‰æ‹©åˆ é™¤æŸä¸ªé”®ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºç¼“å­˜æ•°æ®è®¿é—®é¢‘ç‡æ²¡æœ‰æ˜æ˜¾å·®å¼‚çš„æƒ…å†µã€‚</li>
</ul>
<h5 id="7-volatile-random"><a href="#7-volatile-random" class="headerlink" title="7. volatile-random"></a>7. <strong>volatile-random</strong></h5><ul>
<li><strong>æè¿°</strong>ï¼šåœ¨æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä¸­éšæœºé€‰æ‹©åˆ é™¤æŸä¸ªé”®ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚åˆç¼“å­˜å¸¦æœ‰è¿‡æœŸæ—¶é—´çš„æ•°æ®ï¼Œåˆ é™¤å“ªä¸ªæ•°æ®ä¸é‡è¦çš„åœºæ™¯ã€‚</li>
</ul>
<h5 id="8-volatile-ttl"><a href="#8-volatile-ttl" class="headerlink" title="8. volatile-ttl"></a>8. <strong>volatile-ttl</strong></h5><ul>
<li><strong>æè¿°</strong>ï¼šåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ä¸­ï¼Œä¼˜å…ˆåˆ é™¤å‰©ä½™ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼‰è¾ƒçŸ­çš„é”®ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚åˆå¸Œæœ›ä¼˜å…ˆæ¸…ç†<strong>å³å°†è¿‡æœŸ</strong>çš„æ•°æ®çš„åœºæ™¯ã€‚</li>
</ul>
<pre><code class="java">import redis.clients.jedis.Jedis;

public class RedisMaxMemoryPolicyExample &#123;
    private Jedis jedis;

    public RedisMaxMemoryPolicyExample() &#123;
        // è¿æ¥åˆ°RedisæœåŠ¡å™¨
        this.jedis = new Jedis(&quot;localhost&quot;);
    &#125;

    public void setMaxMemoryPolicy(String policy) &#123;
        // è®¾ç½®Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥
        jedis.configSet(&quot;maxmemory-policy&quot;, policy);
    &#125;

    public String getMaxMemoryPolicy() &#123;
        // è·å–å½“å‰Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥
        return jedis.configGet(&quot;maxmemory-policy&quot;).get(1);
    &#125;

    public static void main(String[] args) &#123;
        RedisMaxMemoryPolicyExample example = new RedisMaxMemoryPolicyExample();

        // è®¾ç½®ä¸åŒçš„å†…å­˜æ·˜æ±°ç­–ç•¥
        example.setMaxMemoryPolicy(&quot;noeviction&quot;);       // é»˜è®¤ç­–ç•¥ï¼Œæ‹’ç»å†™è¯·æ±‚
        example.setMaxMemoryPolicy(&quot;allkeys-lru&quot;);      // æ‰€æœ‰é”®ä½¿ç”¨LRUæ·˜æ±°
        example.setMaxMemoryPolicy(&quot;allkeys-lfu&quot;);      // æ‰€æœ‰é”®ä½¿ç”¨LFUæ·˜æ±°
        example.setMaxMemoryPolicy(&quot;volatile-lru&quot;);     // ä»…æœ‰è¿‡æœŸæ—¶é—´çš„é”®ä½¿ç”¨LRUæ·˜æ±°
        example.setMaxMemoryPolicy(&quot;volatile-lfu&quot;);     // ä»…æœ‰è¿‡æœŸæ—¶é—´çš„é”®ä½¿ç”¨LFUæ·˜æ±°
        example.setMaxMemoryPolicy(&quot;allkeys-random&quot;);   // æ‰€æœ‰é”®éšæœºæ·˜æ±°
        example.setMaxMemoryPolicy(&quot;volatile-random&quot;);  // ä»…æœ‰è¿‡æœŸæ—¶é—´çš„é”®éšæœºæ·˜æ±°
        example.setMaxMemoryPolicy(&quot;volatile-ttl&quot;);     // ä¼˜å…ˆæ·˜æ±°TTLè¾ƒçŸ­çš„é”®

        // è·å–å½“å‰å†…å­˜æ·˜æ±°ç­–ç•¥
        String currentPolicy = example.getMaxMemoryPolicy();
        System.out.println(&quot;Current Max Memory Policy: &quot; + currentPolicy);
    &#125;
&#125;
</code></pre>
<h4 id="ç¼“å­˜ä¸‰å…„å¼Ÿ-ç©¿é€ã€å‡»ç©¿ã€é›ªå´©"><a href="#ç¼“å­˜ä¸‰å…„å¼Ÿ-ç©¿é€ã€å‡»ç©¿ã€é›ªå´©" class="headerlink" title="ç¼“å­˜ä¸‰å…„å¼Ÿ(ç©¿é€ã€å‡»ç©¿ã€é›ªå´©)"></a>ç¼“å­˜ä¸‰å…„å¼Ÿ(ç©¿é€ã€å‡»ç©¿ã€é›ªå´©)</h4><p>ä¸€èˆ¬åœ¨è¯»ç¼“å­˜çš„æ—¶å€™å‡ºç°çš„é—®é¢˜ã€‚<strong>æ€è·¯</strong>ï¼šäº§ç”Ÿçš„åŸå›  + è§£å†³çš„æ–¹æ¡ˆ</p>
<p>&#x3D;&#x3D;<strong>ç¼“å­˜ç©¿é€</strong>&#x3D;&#x3D;ï¼šç”¨æˆ·æˆ–å‰ç«¯æŸ¥è¯¢åˆ°ä¸€ä¸ªåœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå…ˆæŸ¥rediså†èµ°æ•°æ®åº“ã€‚å¯¹æ•°æ®åº“å‹åŠ›ä¼šå¾ˆå¤§ã€‚<u>å…³ç³»å‹æ•°æ®åº“æ˜¯æ€§èƒ½çš„ç“¶é¢ˆ å¸Œæœ›æŠŠé«˜æ•°é‡éƒ½æŒ¡åœ¨æ•°æ®åº“å‰é¢</u>ã€‚æŸ¥è¯¢ä¸€ä¸ª<strong>ä¸å­˜åœ¨</strong>çš„æ•°æ®ï¼ŒmysqlæŸ¥è¯¢ä¸åˆ°æ•°æ®ä¹Ÿä¸ä¼šç›´æ¥å†™å…¥ç¼“å­˜ï¼Œå°±ä¼šå¯¼è‡´æ¯æ¬¡è¯·æ±‚éƒ½æŸ¥è¯¢æ•°æ®åº“(å¯èƒ½åŸå› æ˜¯æ•°æ®åº“è¢«æ”»å‡»äº† å‘é€äº†å‡çš„&#x2F;å¤§æ•°æ®é‡çš„è¯·æ±‚url)</p>
<ul>
<li><strong>è§£å†³æ–¹æ¡ˆä¸€</strong>ï¼š<u>ç¼“å­˜ç©ºæ•°æ®</u>ï¼ŒæŸ¥è¯¢è¿”å›çš„æ•°æ®ä¸ºç©ºï¼Œä»æŠŠè¿™ä¸ªç©ºç»“æœè¿›è¡Œç¼“å­˜ <strong>{key:1, value:null}</strong> ã€ç©ºå­—ç¬¦ä¸²ã€‘<del>æ²¡æœ‰Nullçš„æ•°æ®ç±»å‹</del>ä¸‹ä¸€æ¬¡è¯»å–ç›´æ¥æŠŠç©ºä¸²è¿”å›<br>ä¼˜ç‚¹ï¼šç®€å•<br>ç¼ºç‚¹ï¼šæ¶ˆè€—å†…å­˜ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸ä¸€è‡´çš„é—®é¢˜</li>
</ul>
<p>å¦‚æœä¸€ç›´æ¨¡æ‹Ÿä¸€ä¸ªä¸åŒçš„ä¸å­˜åœ¨çš„key è¿™æ—¶å€™å°±è¦ç”¨åˆ°<strong>å¸ƒéš†è¿‡æ»¤å™¨</strong></p>
<ul>
<li><p><strong>è§£å†³æ–¹æ¡ˆäºŒ</strong>ï¼š<u>å¸ƒéš†è¿‡æ»¤å™¨</u> (æ‹¦æˆªä¸å­˜åœ¨çš„æ•°æ®)<br>[å•†å“è¯»å¤šå†™å°‘ä¸Šç¼“å­˜ï¼Œè¦æŠŠå•†å“æ•°æ®å†™åˆ°å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œä»¥å•†å“çš„id<del>ç‹¬ä¸€æ— äºŒ</del>è®¡ç®—hashcodeï¼Œç”¨å¸ƒéš†è¿‡æ»¤å™¨ã€‚å–æ¨¡æ•°ç»„è½åˆ°æ¡¶å†… ä¼šæŠŠ0ç½®ä¸º1]<br>æœ‰å¾ˆå¤šä¸ªäºŒè¿›åˆ¶æ•°ç»„æ¯ä¸ªäºŒè¿›åˆ¶æ•°ç»„ç”¨ä¸åŒçš„hashç®—æ³•è¿›è¡Œè®¡ç®—æ­¤æ—¶è½åˆ°çš„æ¡¶å°±ä¸ä¸€æ ·<br>ä½œç”¨ï¼šè¯»çš„æ—¶å€™ å‰ç«¯ä¼ id ä¹‹å‰æ€ä¹ˆå†™è¿›å»å°±æ€ä¹ˆæ‹¿å‡ºæ¥ã€‚[ä½è¿ç®—(ä¸)é€Ÿåº¦å¾ˆå¿« æŠŠå¤šä¸ªæ•°ç»„çš„æ•°æ®æ‹¿å‡ºæ¥ä¸è¿ç®—å¦‚æœéƒ½æ˜¯1 åˆ™è¿™ä¸ªæ•°æ®å¯èƒ½å­˜åœ¨<del>å†æŸ¥ä¸€éç¼“å­˜</del> è‹¥ä¸å­˜åœ¨ç›´æ¥returnè¿”å›] å¸ƒéš†è¿‡æ»¤å™¨è¯´ä½ ä¸å­˜åœ¨ ä¸€å®šä¸å­˜åœ¨ï¼Œè¯´ä½ å­˜åœ¨ åˆ™å¯èƒ½å­˜åœ¨[å“ˆå¸Œå†²çª] </p>
<h6 id="â˜…-é¡¹ç›®ä¸Šçº¿å¾ˆä¹…äº†-å•†å“æ—©å°±ä¸‹æ¶ä¸å–äº†-è¿™æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#â˜…-é¡¹ç›®ä¸Šçº¿å¾ˆä¹…äº†-å•†å“æ—©å°±ä¸‹æ¶ä¸å–äº†-è¿™æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="â˜… é¡¹ç›®ä¸Šçº¿å¾ˆä¹…äº† å•†å“æ—©å°±ä¸‹æ¶ä¸å–äº† è¿™æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>â˜… é¡¹ç›®ä¸Šçº¿å¾ˆä¹…äº† å•†å“æ—©å°±ä¸‹æ¶ä¸å–äº† <strong>è¿™æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜</strong>ï¼Ÿ</h6><p>è¿™æ—¶å€™å¸ƒéš†è¿‡æ»¤å™¨è¿˜æœ‰ä¹‹å‰çš„ç—•è¿¹ï¼Œéœ€è¦æŠŠé‚£äº›1è®¾ç½®ä¸º0ã€‚<br>å¸ƒéš†è¿‡æ»¤å™¨ ä¸æ”¯æŒå¯¹æŸä¸ªçš„1è®¾ç½®0 â†’ å› ä¸ºæœ‰å“ˆå¸Œå†²çª<del>æˆ‘ä¸çŸ¥é“è¿™ä¸ª1æ›¾ç»æ˜¯èª°è®¾ç½®çš„</del><br>æ”¯æŒå°†æ•´ä¸ªéƒ½ç½®ä¸º0ï¼Œä¹‹åå¯ä»¥æä¸ªå®šæ—¶ä»»åŠ¡<br><strong>å¸ƒéš†è¿‡æ»¤å™¨å…·ä½“å®ç°</strong>ï¼šRedisã€Redission<del>äº²å„¿å­</del>ã€1cacheã€å’–å•¡å› ï¼ˆCaffeine<del>æä¾›äº†ä¸€ç§éå¸¸é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„ç¼“å­˜è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ”¯æŒå¤šç§ç¼“å­˜è¿‡æœŸç­–ç•¥</del>ï¼‰ã€Guava<del>è°·æ­Œ</del></p>
<h6 id="â˜…-ä»¥å‰æ²¡è®¾ç½®è¿‡ä¸”ä¸Šæ¶è¿‡-åé¢åŠ äº†å¸ƒéš†ï¼Œåé¢è¦æŠŠä¹‹å‰æ‰€æœ‰æ•°æ®é‡æ–°æè¿›å»-æ€ä¹ˆè§£å†³ï¼Ÿå­˜é‡æ•°æ®"><a href="#â˜…-ä»¥å‰æ²¡è®¾ç½®è¿‡ä¸”ä¸Šæ¶è¿‡-åé¢åŠ äº†å¸ƒéš†ï¼Œåé¢è¦æŠŠä¹‹å‰æ‰€æœ‰æ•°æ®é‡æ–°æè¿›å»-æ€ä¹ˆè§£å†³ï¼Ÿå­˜é‡æ•°æ®" class="headerlink" title="â˜… ä»¥å‰æ²¡è®¾ç½®è¿‡ä¸”ä¸Šæ¶è¿‡ åé¢åŠ äº†å¸ƒéš†ï¼Œåé¢è¦æŠŠä¹‹å‰æ‰€æœ‰æ•°æ®é‡æ–°æè¿›å» æ€ä¹ˆè§£å†³ï¼Ÿå­˜é‡æ•°æ®"></a>â˜… ä»¥å‰æ²¡è®¾ç½®è¿‡ä¸”ä¸Šæ¶è¿‡ åé¢åŠ äº†å¸ƒéš†ï¼Œåé¢è¦æŠŠä¹‹å‰æ‰€æœ‰æ•°æ®é‡æ–°æè¿›å» <strong>æ€ä¹ˆè§£å†³</strong>ï¼Ÿ<del>å­˜é‡æ•°æ®</del></h6><p>å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡</p>
<h6 id="â˜…-åœºæ™¯ï¼šå·¥å•†é“¶è¡Œç»Ÿè®¡æ¯å¤©çš„ç”¨æˆ·æ—¥æ´»é‡-ä¸Šçº¿å°±ç®—-è¦æŸ¥è¯¢æŸä¸ªäººè¿ç»­ä¸ƒå¤©ç­¾åˆ°-æ€ä¹ˆæŸ¥-ç”¨ä½å›¾-ç”¨æˆ·é‡å¤ªå¤šäº†"><a href="#â˜…-åœºæ™¯ï¼šå·¥å•†é“¶è¡Œç»Ÿè®¡æ¯å¤©çš„ç”¨æˆ·æ—¥æ´»é‡-ä¸Šçº¿å°±ç®—-è¦æŸ¥è¯¢æŸä¸ªäººè¿ç»­ä¸ƒå¤©ç­¾åˆ°-æ€ä¹ˆæŸ¥-ç”¨ä½å›¾-ç”¨æˆ·é‡å¤ªå¤šäº†" class="headerlink" title="â˜… åœºæ™¯ï¼šå·¥å•†é“¶è¡Œç»Ÿè®¡æ¯å¤©çš„ç”¨æˆ·æ—¥æ´»é‡[ä¸Šçº¿å°±ç®—]  è¦æŸ¥è¯¢æŸä¸ªäººè¿ç»­ä¸ƒå¤©ç­¾åˆ° æ€ä¹ˆæŸ¥(ç”¨ä½å›¾)ç”¨æˆ·é‡å¤ªå¤šäº†"></a>â˜… åœºæ™¯ï¼šå·¥å•†é“¶è¡Œç»Ÿè®¡æ¯å¤©çš„ç”¨æˆ·æ—¥æ´»é‡[ä¸Šçº¿å°±ç®—]  è¦æŸ¥è¯¢æŸä¸ªäººè¿ç»­ä¸ƒå¤©ç­¾åˆ° æ€ä¹ˆæŸ¥(ç”¨ä½å›¾)<del>ç”¨æˆ·é‡å¤ªå¤šäº†</del></h6><p>æä¸€ä¸ªäºŒè¿›åˆ¶æ•°ç»„ï¼Œ10äº¿é•¿åº¦çš„æ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æ˜¯ä¸€ä¸ªbit &#x3D; 10äº¿ä¸ªä½ï¼Œä¸€ä¸ªå­—èŠ‚<del>1&#x2F;bit</del>&#x3D;8ä¸ªä½ï¼Œç»¼åˆè®¡ç®—åå¤§æ¦‚æ¶ˆè€—119MBçš„ç©ºé—´<del>æ¯å¤©</del>ã€‚ç”¨ç”¨æˆ·idå»hash å¦‚æœç”¨æˆ·ç™»å½•å°†0ç½®ä¸º1<del>æœ‰å•ç‹¬çš„ä½å›¾ç»“æ„</del>ï¼Œç»Ÿè®¡æ—¶é—´å°±å¯ä»¥æ‹¿æ—¥æœŸ å¾€å‰é¢æ•° æ‹¿æŸä¸ªidå»å–æ¨¡å¾—åˆ°æ¡¶ æ‰¾å‰ä¸ƒä¸ªï¼Œå»è¿›è¡Œä¸è¿ç®—ï¼Œè¿ç»­ä¸º1å°±è¾¾åˆ°äº†é‡å¤è¿ç»­ä¸ƒå¤©å‰ç«¯ã€‚å¦åˆ™éè¿ç»­ä¸ƒå¤©ã€‚</p>
<p>åœ¨ç¼“å­˜é¢„çƒ­æ—¶ï¼Œè¦é¢„çƒ­å¸ƒéš†è¿‡æ»¤å™¨ã€‚æ ¹æ®idæŸ¥è¯¢æ–‡ç« æ—¶æŸ¥è¯¢å¸ƒéš†è¿‡æ»¤å™¨å¦‚æœä¸å­˜åœ¨ç›´æ¥è¿”å›</p>
<pre><code class="java">import redis.clients.jedis.Jedis;

public class DailyActiveUserCounter &#123;
    private Jedis jedis;

    public DailyActiveUserCounter() &#123;
        this.jedis = new Jedis(&quot;localhost&quot;); // è¿æ¥åˆ°RedisæœåŠ¡å™¨
    &#125;

    // æ˜ å°„ç”¨æˆ·IDåˆ°ä½å›¾çš„é”®
    private String getUserBitmapKey(long userId, int day) &#123;
        return &quot;user:bitmap:&quot; + userId + &quot;:&quot; + day;
    &#125;

    // ç”¨æˆ·ç­¾åˆ°
    public void userSignIn(long userId, int day) &#123;
        String key = getUserBitmapKey(userId, day);
        jedis.setbit(key, userId % 86400, true); // å‡è®¾ä¸€å¤©æœ‰86400ç§’ï¼Œä½¿ç”¨ç§’æ•°ä½œä¸ºåç§»é‡
    &#125;

    // æ£€æŸ¥ç”¨æˆ·è¿ç»­ä¸ƒå¤©çš„ç­¾åˆ°æƒ…å†µ
    public boolean checkContinuousSignIn(long userId, int day) &#123;
        for (int i = 0; i &lt; 7; i++) &#123;
            String key = getUserBitmapKey(userId, day - i);
            if (jedis.getbit(key, userId % 86400) == false) &#123;
                return false; // å¦‚æœåœ¨è¿ç»­çš„ä¸ƒå¤©å†…æœ‰ä¸€å¤©æ²¡æœ‰ç­¾åˆ°ï¼Œåˆ™è¿”å›false
            &#125;
        &#125;
        return true; // è¿ç»­ä¸ƒå¤©éƒ½æœ‰ç­¾åˆ°
    &#125;

    public static void main(String[] args) &#123;
        DailyActiveUserCounter counter = new DailyActiveUserCounter();

        // å‡è®¾ç”¨æˆ·IDä¸º12345ï¼Œä»Šå¤©ç­¾åˆ°
        long userId = 12345;
        int today = 1; // å‡è®¾ä»Šå¤©æ˜¯ç¬¬1å¤©
        counter.userSignIn(userId, today);

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è¿ç»­ä¸ƒå¤©ç­¾åˆ°
        boolean isContinuous = counter.checkContinuousSignIn(userId, today);
        System.out.println(&quot;User &quot; + userId + &quot; has signed in for 7 consecutive days: &quot; + isContinuous);
    &#125;
&#125;
</code></pre>
<p>**bitmapï¼ˆä½å›¾ï¼‰<del>å·¨å¤§çš„äºŒè¿›åˆ¶æ•°ç»„</del>**ï¼šç›¸å½“äºä¸€ä¸ªä»¥bitä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨äºŒè¿›åˆ¶æ•°0æˆ–1</p>
<p><strong>å¸ƒéš†è¿‡æ»¤å™¨ä½œç”¨</strong>ï¼šå¯ä»¥ç”¨äºæ£€ç´¢ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­</p>
<ul>
<li><strong>å­˜å‚¨æ•°æ®</strong>ï¼šidä¸º1çš„æ•°æ®ï¼Œé€šè¿‡å¤šä¸ªhashå‡½æ•°è·å–hashå€¼ï¼Œæ ¹æ®hashè®¡ç®—æ•°ç»„å¯¹åº”ä½ç½®<strong>æ”¹ä¸º1</strong></li>
<li><strong>æŸ¥è¯¢æ•°æ®</strong>ï¼šä½¿ç”¨ç›¸åŒhashå‡½æ•°è·å–hashå€¼ï¼Œåˆ¤æ–­å¯¹åº”ä½ç½®æ˜¯å¦éƒ½ä¸º1</li>
</ul>
<p>å­˜åœ¨<strong>è¯¯åˆ¤ç‡</strong>ï¼šæ•°ç»„è¶Šå° è¯¯åˆ¤ç‡è¶Šå¤§ ã€è¦æ•°ç»„è¶³å¤Ÿå¤§ è¯¯åˆ¤ç‡å°±å°ã€‘</p>
<pre><code class="java">bloomFilter.tryInit(size, 0.05) //è¯¯åˆ¤ç‡5%
</code></pre>
</li>
</ul>
<p>&#x3D;&#x3D;<strong>ç¼“å­˜å‡»ç©¿</strong>&#x3D;&#x3D;ï¼šç»™æŸ<strong>ä¸€ä¸ª</strong>çƒ­ç‚¹keyè®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œå½“keyè¿‡æœŸçš„æ—¶å€™ï¼Œæ°å¥½è¿™ä¸ªæ—¶é—´ç‚¹å¯¹è¿™ä¸ªkeyæœ‰å¤§é‡çš„å¹¶å‘è¯·æ±‚è¿‡æ¥ï¼Œè¿™äº›å¹¶å‘è¯·æ±‚å¯èƒ½ä¸€ç¬é—´æŠŠDBå‡»ç©¿<del>å¾®åš[é¹¿æ™—+å…³æ™“å½¤]</del>ã€å¹¶å‘åŒä¸€æ—¶é—´è®¿é—®ã€‘</p>
<ul>
<li><p><strong>è§£å†³æ–¹æ¡ˆä¸€</strong>ï¼š<strong>äº’æ–¥é”</strong>ã€æ•°æ®<strong>å¼ºä¸€è‡´æ€§</strong> æ€§èƒ½å·® (é“¶è¡Œ)ã€‘[æ§åˆ¶ä¸€ä¸ªä¸ªæ¥è®¿é—®çš„æ¬¡æ•°]</p>
<p><del>AQSã€ReentrantLock</del>æ˜¯è¿›ç¨‹çº§åˆ«çš„äº’æ–¥é”ï¼Œå› ä¸ºæœ‰æ•°æ®åœ¨èŠ‚ç‚¹1æˆ–èŠ‚ç‚¹2ï¼Œ<strong>åˆ†å¸ƒå¼é”</strong>æ˜¯åœ¨ä¸åŒåœºæ™¯éƒ½å¯ä»¥é”ä¹Ÿå¯ä»¥æ§åˆ¶è®¿é—®é¡ºåºã€‚</p>
<p>ä»¥å•†å“idä½œä¸ºkey  å…ˆrediså¼€å§‹æŸ¥ç¼“å­˜ åˆ¤æ–­æ˜¯å¦ä¸ºç©º ä¸ä¸ºç©ºç›´æ¥returnåè§£é”ï¼Œç©ºå°±å…ˆ<strong>åŠ é”</strong> å»æ•°æ®åº“æŸ¥å®Œå¤‡ä»½ä¸€ä»½rediså<strong>è§£é”</strong>ã€‚è¢«é”çš„å…¶ä»–çº¿ç¨‹åœ¨å¤–é¢ç­‰å¾…ã€‚</p>
<h6 id="â˜…-100ä¸ªäººè®¿é—®åŒä¸€ä¸ªå•†å“ï¼Œåªæœ‰ä¸€ä¸ªæŠ¢åˆ°é”ï¼Œå‰©ä¸‹çš„99ä¸ªäººä¹Ÿè¦æŸ¥redisç¼“å­˜å’Œæ•°æ®åº“ã€‚"><a href="#â˜…-100ä¸ªäººè®¿é—®åŒä¸€ä¸ªå•†å“ï¼Œåªæœ‰ä¸€ä¸ªæŠ¢åˆ°é”ï¼Œå‰©ä¸‹çš„99ä¸ªäººä¹Ÿè¦æŸ¥redisç¼“å­˜å’Œæ•°æ®åº“ã€‚" class="headerlink" title="â˜… 100ä¸ªäººè®¿é—®åŒä¸€ä¸ªå•†å“ï¼Œåªæœ‰ä¸€ä¸ªæŠ¢åˆ°é”ï¼Œå‰©ä¸‹çš„99ä¸ªäººä¹Ÿè¦æŸ¥redisç¼“å­˜å’Œæ•°æ®åº“ã€‚"></a>â˜… 100ä¸ªäººè®¿é—®åŒä¸€ä¸ªå•†å“ï¼Œåªæœ‰ä¸€ä¸ªæŠ¢åˆ°é”ï¼Œå‰©ä¸‹çš„99ä¸ªäººä¹Ÿè¦æŸ¥redisç¼“å­˜å’Œæ•°æ®åº“ã€‚</h6><p>æ–¹æ¡ˆï¼š**<u>åŒé‡ç¼“å­˜æ ¡éªŒ</u>**  å…ˆæŸ¥ç¼“å­˜ æŸ¥ä¸åˆ°åŠ é” å†æŸ¥ç¼“å­˜ æŸ¥ä¸åˆ°å†å»æ•°æ®åº“ æŸ¥å®Œåçœ‹æ˜¯å¦å¤‡ä»½åè§£é”<del>å†·ä»£ç </del></p>
<p>1.æŸ¥è¯¢ç¼“å­˜,æœªå‘½ä¸­ â†’ 2.<strong>è·å–äº’æ–¥é”æˆåŠŸ</strong> â†’ 3.æŸ¥è¯¢æ•°æ®åº“é‡å»ºç¼“å­˜æ•°æ® â†’ 4.å†™å…¥ç¼“å­˜ â†’ 5.é‡Šæ”¾é”</p>
<p>1.æŸ¥è¯¢ç¼“å­˜,æœªå‘½ä¸­ â†’ 2.<strong>è·å–äº’æ–¥é”å¤±è´¥</strong> â†’ 3.ä¼‘çœ ä¸€ä¼šå†é‡è¯• â†’ 4.å†™å…¥ç¼“å­˜é‡è¯• â†’ 5.ç¼“å­˜å‘½ä¸­</p>
</li>
<li><p><strong>è§£å†³æ–¹æ¡ˆäºŒ</strong>ï¼š<strong>é€»è¾‘è¿‡æœŸ</strong>[  <u><em>ä¸è®¾ç½®è¿‡æœŸæ—¶é—´</em></u>  ] ã€é«˜å¯ç”¨ æ€§èƒ½ä¼˜ ä¸èƒ½ä¿è¯æ•°æ®ç»å¯¹ä¸€è‡´ (ç”¨æˆ·ä½“éªŒ)ã€‘</p>
<blockquote>
<p>åœ¨æ•°æ®åº“ä¸€æ¡æ•°æ®é‡Œé¢æ·»åŠ ä¸€ä¸ª          â€œexpireâ€: 153213455</p>
</blockquote>
<p>1.æŸ¥è¯¢ç¼“å­˜,å‘ç°é€»è¾‘æ—¶é—´å·²è¿‡æœŸ â†’ 2.è·å–äº’æ–¥é”æˆåŠŸ â†’ 3.å¼€å¯çº¿ç¨‹ â†“â†’ 4.è¿”å›è¿‡æœŸæ•°æ®</p>
<p>â€‹                ã€åœ¨æ–°çš„çº¿ç¨‹ã€‘â†’ 1.æŸ¥è¯¢æ•°æ®åº“é‡å»ºç¼“å­˜æ•°æ® â†’ 2.å†™å…¥ç¼“å­˜,é‡ç½®é€»è¾‘è¿‡æœŸæ—¶é—´ â†’ 3.é‡Šæ”¾é”<br>1.æŸ¥è¯¢æ•°æ®ç¼“å­˜,å‘ç°é€»è¾‘æ—¶é—´å·²è¿‡æœŸ â†’ 2.è·å–äº’æ–¥é”å¤±è´¥ â†’ 3.è¿”å›è¿‡æœŸæ•°æ®</p>
</li>
</ul>
<p>&#x3D;&#x3D;<strong>ç¼“å­˜é›ªå´©</strong>&#x3D;&#x3D;ï¼šåœ¨åŒä¸€ä¸ªæ—¶æ®µå†…<strong>å¤§é‡</strong>çš„ç¼“å­˜keyåŒæ—¶å¤±æ•ˆæˆ–è€…<u>RedisæœåŠ¡å®•æœº</u>ï¼Œå¯¼è‡´å¤§é‡è¯·æ±‚åˆ°è¾¾æ•°æ®åº“ï¼Œå¸¦æ¥å‹åŠ›</p>
<ul>
<li><strong>è§£å†³æ–¹æ¡ˆä¸€ï¼š</strong>ç»™ä¸åŒçš„keyçš„TTL(è¿‡æœŸæ—¶é—´)æ·»åŠ éšæœºå€¼<del>ä¸åœ¨åŒä¸€æ—¶é—´è¿‡æœŸ</del></li>
<li><strong>è§£å†³æ–¹æ¡ˆäºŒï¼š</strong>åˆ©ç”¨Redisé›†ç¾¤æé«˜æœåŠ¡çš„å¯ç”¨æ€§ ã€å“¨å…µæ¨¡å¼ã€é›†ç¾¤æ¨¡å¼ã€‘</li>
<li><strong>è§£å†³æ–¹æ¡ˆä¸‰ï¼š</strong><u>ç»™ç¼“å­˜ä¸šåŠ¡æ·»åŠ <strong>é™çº§</strong>é™æµç­–ç•¥</u>ã€nginxã€springcloudã€gatewayã€‘</li>
<li><strong>è§£å†³æ–¹æ¡ˆå››ï¼š</strong>ç»™ä¸šåŠ¡æ·»åŠ å¤šçº§ç¼“å­˜ ã€Guava(åšä¸€çº§ç¼“å­˜ ç„¶åRedisæ˜¯äºŒçº§ç¼“å­˜)æˆ–Caffeineã€‘</li>
</ul>
<h6 id="â˜…-rediså®•æœºçš„æ—¶å€™-å†RedisTemplate-set-åä¼šæŠ¥é”™-ä½†æ˜¯ç°åœ¨mysqlè¿˜å¯ä»¥è®¿é—®-åº”è¯¥æ€ä¹ˆåŠï¼Ÿ"><a href="#â˜…-rediså®•æœºçš„æ—¶å€™-å†RedisTemplate-set-åä¼šæŠ¥é”™-ä½†æ˜¯ç°åœ¨mysqlè¿˜å¯ä»¥è®¿é—®-åº”è¯¥æ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="â˜… rediså®•æœºçš„æ—¶å€™ å†RedisTemplate.set()åä¼šæŠ¥é”™ ä½†æ˜¯ç°åœ¨mysqlè¿˜å¯ä»¥è®¿é—® åº”è¯¥æ€ä¹ˆåŠï¼Ÿ"></a>â˜… rediså®•æœºçš„æ—¶å€™ å†RedisTemplate.set()åä¼šæŠ¥é”™ ä½†æ˜¯ç°åœ¨mysqlè¿˜å¯ä»¥è®¿é—® åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</h6><p><strong>try catch åœ¨é‡Œé¢ç»§ç»­å†å»æŸ¥mysqlæ•°æ®åº“</strong></p>
<h6 id="é™çº§ä»£ç ï¼šå¯¹äºè¯»æ“ä½œï¼Œå¦‚æœRedisç¼“å­˜å¤±æ•ˆï¼Œå¯ä»¥ç›´æ¥ä»MySQLæ•°æ®åº“è¯»å–æ•°æ®ã€‚"><a href="#é™çº§ä»£ç ï¼šå¯¹äºè¯»æ“ä½œï¼Œå¦‚æœRedisç¼“å­˜å¤±æ•ˆï¼Œå¯ä»¥ç›´æ¥ä»MySQLæ•°æ®åº“è¯»å–æ•°æ®ã€‚" class="headerlink" title="é™çº§ä»£ç ï¼šå¯¹äºè¯»æ“ä½œï¼Œå¦‚æœRedisç¼“å­˜å¤±æ•ˆï¼Œå¯ä»¥ç›´æ¥ä»MySQLæ•°æ®åº“è¯»å–æ•°æ®ã€‚"></a>é™çº§ä»£ç ï¼šå¯¹äºè¯»æ“ä½œï¼Œå¦‚æœRedisç¼“å­˜å¤±æ•ˆï¼Œå¯ä»¥ç›´æ¥ä»MySQLæ•°æ®åº“è¯»å–æ•°æ®ã€‚</h6><pre><code class="java">public boolean setData(String key, String value) &#123;
    try &#123;
        // å°è¯•å°†æ•°æ®è®¾ç½®åˆ°Redis
        redisTemplate.opsForValue().set(key, value);
        return true;
    &#125; catch (Exception e) &#123;
        // æ—¥å¿—è®°å½•Redisé”™è¯¯
        log.error(&quot;Redis is down, failing over to MySQL&quot;, e);
        
        // Redisè®¾ç½®å¤±è´¥ï¼Œé™çº§åˆ°MySQL
        return setDataToMySQL(key, value);
    &#125;
&#125;

private boolean setDataToMySQL(String key, String value) &#123;
    // è¿™é‡Œå®ç°å°†æ•°æ®å†™å…¥MySQLçš„é€»è¾‘
    // ä¾‹å¦‚ï¼š
    // mySqlTemplate.update(&quot;INSERT INTO cache (key, value) VALUES (?, ?)&quot;, key, value);
    // æ³¨æ„ï¼šè¿™é‡Œçš„mySqlTemplateå’ŒSQLè¯­å¥éœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
    return true; // å‡è®¾å†™å…¥æˆåŠŸ
&#125;
</code></pre>
<h6 id="å¦‚æœå…¬å¸å¯¹è¦æ±‚æ›´é«˜ï¼Œéœ€è¦é™æµé™çº§ã€ç†”æ–­"><a href="#å¦‚æœå…¬å¸å¯¹è¦æ±‚æ›´é«˜ï¼Œéœ€è¦é™æµé™çº§ã€ç†”æ–­" class="headerlink" title="å¦‚æœå…¬å¸å¯¹è¦æ±‚æ›´é«˜ï¼Œéœ€è¦é™æµé™çº§ã€ç†”æ–­"></a>å¦‚æœå…¬å¸å¯¹è¦æ±‚æ›´é«˜ï¼Œéœ€è¦é™æµ<del>é™çº§ã€ç†”æ–­</del></h6><p>åŒä¸€æ—¶é—´è®¾ç½®QPSä¸º100 è¶…è¿‡çš„è¿”å›å‹å¥½æç¤º[å•†å“å¤ªç«çˆ†å•¦ï¼Œè¯·ç¨åå†è¯•]</p>
<h4 id="ä½ æœ‰è‡ªå·±éƒ¨ç½²è¿‡ç¯å¢ƒå—"><a href="#ä½ æœ‰è‡ªå·±éƒ¨ç½²è¿‡ç¯å¢ƒå—" class="headerlink" title="ä½ æœ‰è‡ªå·±éƒ¨ç½²è¿‡ç¯å¢ƒå—"></a>ä½ æœ‰è‡ªå·±éƒ¨ç½²è¿‡ç¯å¢ƒå—</h4><p>å…¬å¸é‡Œé¢ç”¨ Jenkins + docker æµ‹è¯•ç¯å¢ƒæˆ‘ä»¬éƒ¨ç½² ç”Ÿäº§ç¯å¢ƒæ˜¯ç»„é•¿éƒ¨ç½²</p>
<h4 id="æœªæ¥1-3å¹´è§„åˆ’"><a href="#æœªæ¥1-3å¹´è§„åˆ’" class="headerlink" title="æœªæ¥1-3å¹´è§„åˆ’"></a>æœªæ¥1-3å¹´è§„åˆ’</h4><p>å°†å…·ä½“ä¸€ç‚¹ï¼Œä»ä¸šåŠ¡æŠ€æœ¯ä¸Šæå‡è‡ªå·±çš„æ·±åº¦å’Œå¹¿åº¦è¾¾åˆ°é«˜çº§å·¥ç¨‹å¸ˆ</p>
<h4 id="ä½ å¹³æ—¶åšç¬”è®°å—"><a href="#ä½ å¹³æ—¶åšç¬”è®°å—" class="headerlink" title="ä½ å¹³æ—¶åšç¬”è®°å—"></a>ä½ å¹³æ—¶åšç¬”è®°å—</h4><p>æœ‰åšç¬”è®° Xmind + Markdown<br>å› ä¸ºæˆ‘è§‰å¾—æ— è®ºä»ç½‘ä¸Šçš„è¿˜æ˜¯åˆ«äººè¯·æ•™çš„ä¸ç»å†æˆ‘çš„æ¶ˆåŒ–éƒ½ä¸æ˜¯æˆ‘çš„ä¸œè¥¿<br>æˆ‘è¿˜æ˜¯ä¼šå°†è¿™äº›çŸ¥è¯†ç‚¹æ€»ç»“èµ·æ¥å˜æˆè‡ªå·±çš„çŸ¥è¯†</p>
<h4 id="ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿ-amp-amp-åŠ¨æ€ä»£ç†æœ‰å“ªäº›ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿ-amp-amp-åŠ¨æ€ä»£ç†æœ‰å“ªäº›ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿ&amp;&amp; åŠ¨æ€ä»£ç†æœ‰å“ªäº›ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†ï¼Ÿ&amp;&amp; åŠ¨æ€ä»£ç†æœ‰å“ªäº›ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ</h4><h6 id="ä»£ç†æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼-ç”¨æ¥å¢å¼ºç›®æ ‡çš„é€»è¾‘-ä¸è¢«å¢å¼ºçš„å¹¶æ²¡æœ‰å¤ªå¤§å…³ç³»è£…é¥°è€…æ¨¡å¼"><a href="#ä»£ç†æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼-ç”¨æ¥å¢å¼ºç›®æ ‡çš„é€»è¾‘-ä¸è¢«å¢å¼ºçš„å¹¶æ²¡æœ‰å¤ªå¤§å…³ç³»è£…é¥°è€…æ¨¡å¼" class="headerlink" title="ä»£ç†æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ ç”¨æ¥å¢å¼ºç›®æ ‡çš„é€»è¾‘ ä¸è¢«å¢å¼ºçš„å¹¶æ²¡æœ‰å¤ªå¤§å…³ç³»è£…é¥°è€…æ¨¡å¼"></a>ä»£ç†æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ ç”¨æ¥å¢å¼ºç›®æ ‡çš„é€»è¾‘ ä¸è¢«å¢å¼ºçš„å¹¶æ²¡æœ‰å¤ªå¤§å…³ç³»<del>è£…é¥°è€…æ¨¡å¼</del></h6><p>åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰ä¼šäº§ç”Ÿä»£ç†ç±»åŠ è½½åˆ°æˆ‘ä»¬jvmä¸­yamlæ–‡ä»¶</p>
<ul>
<li><h6 id="JDKåŠ¨æ€ä»£ç†æ˜¯-åŸºäºæ¥å£å®ç°æ¥å®ç°å¢å¼º"><a href="#JDKåŠ¨æ€ä»£ç†æ˜¯-åŸºäºæ¥å£å®ç°æ¥å®ç°å¢å¼º" class="headerlink" title="JDKåŠ¨æ€ä»£ç†æ˜¯ åŸºäºæ¥å£å®ç°æ¥å®ç°å¢å¼º"></a>JDKåŠ¨æ€ä»£ç†æ˜¯ <u>åŸºäºæ¥å£å®ç°æ¥å®ç°å¢å¼º</u></h6><p>[txtæ–‡æœ¬ æŠŠç›®æ ‡å¢å¼ºç±» ä½œä¸ºæ¥å£<del>æœ¬èº«å°±æ˜¯æ¥å£</del> å®ç°è¿‡æ¥å†™æˆæºç  æºæ–‡ä»¶ å†ç”¨jdkå·¥å…·æŠŠæºç ç¼–è¯‘æˆclasså­—èŠ‚ç  å†ç”¨ç±»åŠ è½½å™¨æŠŠclassåŠ è½½åˆ°jvmä¸­]</p>
</li>
<li><h6 id="CGLIBåŠ¨æ€ä»£ç†æ˜¯-åŸºäºç»§æ‰¿ç›®æ ‡ç±»å¹¶è¦†å†™å…¶æ–¹æ³•æ¥å®ç°"><a href="#CGLIBåŠ¨æ€ä»£ç†æ˜¯-åŸºäºç»§æ‰¿ç›®æ ‡ç±»å¹¶è¦†å†™å…¶æ–¹æ³•æ¥å®ç°" class="headerlink" title="CGLIBåŠ¨æ€ä»£ç†æ˜¯ åŸºäºç»§æ‰¿ç›®æ ‡ç±»å¹¶è¦†å†™å…¶æ–¹æ³•æ¥å®ç°"></a>CGLIBåŠ¨æ€ä»£ç†æ˜¯ <u>åŸºäºç»§æ‰¿ç›®æ ‡ç±»å¹¶è¦†å†™å…¶æ–¹æ³•æ¥å®ç°</u></h6><p>[ASNå­—èŠ‚ç æœºåˆ¶ç›´æ¥ç”Ÿæˆclass ç›´æ¥åŠ è½½åˆ°å†…å­˜ä¸­]<del>æ€§èƒ½è¾ƒé«˜ï¼Œé€Ÿåº¦æ›´å¿«ã€‚å› ä¸ºç›´æ¥ç”Ÿæˆclass</del></p>
</li>
</ul>
<p>è¦è°ƒç”¨æŸä¸ªæ–¹æ³• CGLIBæ€§èƒ½é«˜ æ˜¯é€šè¿‡åå°„æ¥å®ç°çš„ è€ç‰ˆæœ¬çš„jdkçš„åå°„æ€§èƒ½è¾ƒä½ã€‚å¦‚ä»Šåœ¨è°ƒç”¨æ–¹æ³•çš„æ€§èƒ½ä¸Šå·®è·ä¸å¤§</p>
<p><strong>åŒºåˆ«</strong>ï¼š</p>
<ul>
<li>JDKåŠ¨æ€ä»£ç†è¦æ±‚ç›®æ ‡ç±»å¿…é¡»å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ï¼Œè€ŒCGLIBæ²¡æœ‰è¿™ä¸ªè¦æ±‚ã€‚</li>
<li>JDKåŠ¨æ€ä»£ç†ç”Ÿæˆçš„ä»£ç†ç±»æ˜¯æ¥å£çš„å®ç°ï¼Œè€ŒCGLIBç”Ÿæˆçš„<strong>ä»£ç†</strong>ç±»æ˜¯ç›®æ ‡ç±»çš„å­ç±»ã€‚</li>
<li>æ€§èƒ½ä¸Šï¼ŒCGLIBé€šå¸¸æ¯”JDKåŠ¨æ€ä»£ç†æ›´å¿«ï¼Œå› ä¸ºå®ƒç›´æ¥æ“ä½œå­—èŠ‚ç ç”Ÿæˆæ–°çš„ç±»ã€‚</li>
</ul>
<h4 id="ä»€ä¹ˆæ ·çš„ä»£ç æ˜¯é™æ€ä»£ç†ï¼Ÿ"><a href="#ä»€ä¹ˆæ ·çš„ä»£ç æ˜¯é™æ€ä»£ç†ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ ·çš„ä»£ç æ˜¯é™æ€ä»£ç†ï¼Ÿ"></a>ä»€ä¹ˆæ ·çš„ä»£ç æ˜¯é™æ€ä»£ç†ï¼Ÿ</h4><p>å‘ç”Ÿåœ¨æˆ‘ä»¬å†™ä»£ç çš„è¿‡ç¨‹ä¸­ åœ¨ç¼–è¯‘é˜¶æ®µäº§ç”Ÿäº†ä»£ç†ç±»<br>é™æ€ä»£ç†æ˜¯æŒ‡ä»£ç†ç±»åœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šï¼Œé€šå¸¸ç”±ç¨‹åºå‘˜æ‰‹åŠ¨ç¼–å†™</p>
<h4 id="ä½ ç”¨è¿‡Linuxå—ï¼Ÿ"><a href="#ä½ ç”¨è¿‡Linuxå—ï¼Ÿ" class="headerlink" title="ä½ ç”¨è¿‡Linuxå—ï¼Ÿ"></a>ä½ ç”¨è¿‡Linuxå—ï¼Ÿ</h4><p>æ˜¯çš„ï¼Œæˆ‘åœ¨å·¥ä½œä¸­ç»å¸¸ä½¿ç”¨Linuxæ“ä½œç³»ç»Ÿã€‚æˆ‘ç†Ÿæ‚‰Linuxçš„åŸºæœ¬å‘½ä»¤<br>åŸºç¡€çš„å‘½ä»¤ï¼šxxxã€æŸ¥çœ‹ä¹‹å‰ç¬”è®°ã€‘</p>
<h4 id="ä½ å·¥ä½œçš„æ—¶å€™æœ‰éœ€æ±‚æ–‡æ¡£å—ï¼Ÿ"><a href="#ä½ å·¥ä½œçš„æ—¶å€™æœ‰éœ€æ±‚æ–‡æ¡£å—ï¼Ÿ" class="headerlink" title="ä½ å·¥ä½œçš„æ—¶å€™æœ‰éœ€æ±‚æ–‡æ¡£å—ï¼Ÿ"></a>ä½ å·¥ä½œçš„æ—¶å€™æœ‰éœ€æ±‚æ–‡æ¡£å—ï¼Ÿ</h4><p>æœ‰çš„ï¼Œ<strong>æœ‰ä¸€äº›ç®€å•çš„éœ€æ±‚æ˜¯æ²¡æœ‰çš„</strong>[æ²Ÿé€šæˆæœ¬å¤ªé«˜äº†]<br><strong>ç¨å¾®å¤æ‚çš„éœ€æ±‚ä¼šæœ‰éœ€æ±‚æ–‡æ¡£</strong>ï¼Œæˆ‘ä¼šæ ¹æ®éœ€æ±‚æ–‡æ¡£æ¥ç†è§£é¡¹ç›®éœ€æ±‚ï¼Œå¹¶è¿›è¡Œç³»ç»Ÿè®¾è®¡å’Œå¼€å‘ã€‚</p>
<h4 id="ä½ æœ‰ä»€ä¹ˆéœ€è¦äº†è§£çš„ï¼Ÿä¸è¦éš¾ä¸ºé¢è¯•å®˜-ä¸é—®æŠ€æœ¯æ ˆ"><a href="#ä½ æœ‰ä»€ä¹ˆéœ€è¦äº†è§£çš„ï¼Ÿä¸è¦éš¾ä¸ºé¢è¯•å®˜-ä¸é—®æŠ€æœ¯æ ˆ" class="headerlink" title="ä½ æœ‰ä»€ä¹ˆéœ€è¦äº†è§£çš„ï¼Ÿä¸è¦éš¾ä¸ºé¢è¯•å®˜,ä¸é—®æŠ€æœ¯æ ˆ"></a><span style="color:red">ä½ æœ‰ä»€ä¹ˆéœ€è¦äº†è§£çš„ï¼Ÿ</span><del>ä¸è¦éš¾ä¸ºé¢è¯•å®˜,ä¸é—®æŠ€æœ¯æ ˆ</del></h4><p>æˆ‘æƒ³äº†è§£ä¸€ä¸‹è´µå…¬å¸çš„ä¸šåŠ¡æ˜¯ä»€ä¹ˆâ€¦å¥½çš„é‚£æˆ‘è¿™å—å·²ç»æ²¡æœ‰ä»€ä¹ˆæƒ³äº†è§£çš„äº† <span style="color:red">æ„Ÿè°¢é¢è¯•å®˜</span><br>HRï¼šæƒ³äº†è§£ä¸€ä¸‹è´µå…¬å¸çš„ä¸Šç­æ—¶é—´â€¦<br>æˆ‘æ²¡æœ‰ä»€ä¹ˆæƒ³äº†è§£çš„ï¼Œæ¥ä¹‹å‰æœ‰äº†è§£è¿‡è´µå…¬å¸</p>
<h4 id="å¹³æ—¶ç”¨æ³¨è§£åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„è¿˜æ˜¯å¤šä¾‹çš„ï¼Ÿ"><a href="#å¹³æ—¶ç”¨æ³¨è§£åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„è¿˜æ˜¯å¤šä¾‹çš„ï¼Ÿ" class="headerlink" title="å¹³æ—¶ç”¨æ³¨è§£åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„è¿˜æ˜¯å¤šä¾‹çš„ï¼Ÿ"></a>å¹³æ—¶ç”¨æ³¨è§£åˆ›å»ºçš„beanæ˜¯å•ä¾‹çš„è¿˜æ˜¯å¤šä¾‹çš„ï¼Ÿ</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé€šè¿‡æ³¨è§£ï¼ˆå¦‚@Componentã€@Serviceã€@Repositoryã€@Beanç­‰ï¼‰åˆ›å»ºçš„Beanæ˜¯å•ä¾‹çš„ã€‚å¦‚æœéœ€è¦åˆ›å»ºå¤šä¾‹Beanï¼Œå¯ä»¥åœ¨æ³¨è§£ä¸Šæ·»åŠ @Scope(â€œprototypeâ€)æ¥æŒ‡å®šã€‚</p>
<pre><code class="java">// å•ä¾‹Bean
import org.springframework.stereotype.Component;

@Component
public class SingletonBean &#123;
    // Beançš„ä»£ç 
&#125;

----------------------------------------------------
    
// å¤šä¾‹Bean

import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

@Component
@Scope(&quot;prototype&quot;)
public class PrototypeBean &#123;
    // Beançš„ä»£ç 
&#125;
</code></pre>
<h4 id="SQLè¯­å¥çš„æ‰§è¡Œé¡ºåºï¼Œä¸ºä»€ä¹ˆé¡ºåºæ˜¯è¿™æ ·æ’çš„ï¼Œè¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿æˆ–è€…å¥½å¤„ï¼Ÿ"><a href="#SQLè¯­å¥çš„æ‰§è¡Œé¡ºåºï¼Œä¸ºä»€ä¹ˆé¡ºåºæ˜¯è¿™æ ·æ’çš„ï¼Œè¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿æˆ–è€…å¥½å¤„ï¼Ÿ" class="headerlink" title="SQLè¯­å¥çš„æ‰§è¡Œé¡ºåºï¼Œä¸ºä»€ä¹ˆé¡ºåºæ˜¯è¿™æ ·æ’çš„ï¼Œè¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿æˆ–è€…å¥½å¤„ï¼Ÿ"></a>SQLè¯­å¥çš„æ‰§è¡Œé¡ºåºï¼Œä¸ºä»€ä¹ˆé¡ºåºæ˜¯è¿™æ ·æ’çš„ï¼Œè¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿æˆ–è€…å¥½å¤„ï¼Ÿ</h4><p><code>FROM -&gt; Join -&gt; WHERE -&gt; GROUP BY -&gt; HAVING -&gt; SELECT -&gt; ORDER BY -&gt; limit</code><br>è¿™æ ·çš„é¡ºåºæ˜¯ä¸ºäº†ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ã€‚é¦–å…ˆç¡®å®šæ•°æ®æ¥æºï¼ˆFROMï¼‰ï¼Œç„¶åç­›é€‰å‡ºæ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼ˆWHEREï¼‰ï¼Œæ¥ç€è¿›è¡Œåˆ†ç»„ï¼ˆGROUP BYï¼‰ï¼Œåœ¨åˆ†ç»„çš„åŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥ç­›é€‰ï¼ˆHAVINGï¼‰ï¼Œç„¶åé€‰æ‹©éœ€è¦çš„æ•°æ®ï¼ˆSELECTï¼‰ï¼Œæœ€åå¯¹ç»“æœè¿›è¡Œæ’åºï¼ˆORDER BYï¼‰ã€‚è¿™æ ·çš„é¡ºåºå¯ä»¥å‡å°‘ä¸­é—´ç»“æœé›†çš„å¤§å°ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>
<h6 id="ä¹¦å†™é¡ºåº"><a href="#ä¹¦å†™é¡ºåº" class="headerlink" title="ä¹¦å†™é¡ºåº"></a>ä¹¦å†™é¡ºåº</h6><p><code>select -&gt; from -&gt; join -&gt; on -&gt; where -&gt; group by -&gt; having -&gt; order by -&gt; limit</code></p>
<blockquote>
<h2 id="SQLçš„â€œå†™æ³•é¡ºåºâ€-vs-â€œæ‰§è¡Œé¡ºåºâ€"><a href="#SQLçš„â€œå†™æ³•é¡ºåºâ€-vs-â€œæ‰§è¡Œé¡ºåºâ€" class="headerlink" title="SQLçš„â€œå†™æ³•é¡ºåºâ€ vs â€œæ‰§è¡Œé¡ºåºâ€"></a>SQLçš„â€œå†™æ³•é¡ºåºâ€ vs â€œæ‰§è¡Œé¡ºåºâ€</h2><table>
<thead>
<tr>
<th>ä¹¦å†™é¡ºåºï¼ˆä½ å†™çš„æ—¶å€™ï¼‰</th>
<th>å®é™…æ‰§è¡Œé¡ºåºï¼ˆæ•°æ®åº“å¼•æ“æ‰§è¡Œæ—¶ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>SELECT â€¦ FROM â€¦</td>
<td><strong>FROM</strong>ï¼ˆç¡®å®šæ•°æ®æºï¼‰</td>
</tr>
<tr>
<td>[JOIN â€¦ ON â€¦]</td>
<td><strong>JOIN&#x2F;ON</strong>ï¼ˆè¡¨è¿æ¥ï¼‰</td>
</tr>
<tr>
<td>WHERE â€¦</td>
<td><strong>WHERE</strong>ï¼ˆè¡Œè¿‡æ»¤ï¼‰</td>
</tr>
<tr>
<td>GROUP BY â€¦</td>
<td><strong>GROUP BY</strong>ï¼ˆåˆ†ç»„ï¼‰</td>
</tr>
<tr>
<td>HAVING â€¦</td>
<td><strong>HAVING</strong>ï¼ˆç»„è¿‡æ»¤ï¼‰</td>
</tr>
<tr>
<td>SELECT â€¦</td>
<td><strong>SELECT</strong>ï¼ˆåˆ—ç­›é€‰&#x2F;è¡¨è¾¾å¼ï¼‰</td>
</tr>
<tr>
<td>ORDER BY â€¦</td>
<td><strong>ORDER BY</strong>ï¼ˆæ’åºï¼‰</td>
</tr>
<tr>
<td>LIMIT â€¦</td>
<td><strong>LIMIT</strong>ï¼ˆåˆ†é¡µ&#x2F;æˆªæ–­ï¼‰</td>
</tr>
</tbody></table>
<h2 id="ä¸ºä»€ä¹ˆæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·è®¾è®¡çš„ï¼Ÿï¼ˆæ ¸å¿ƒï¼‰"><a href="#ä¸ºä»€ä¹ˆæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·è®¾è®¡çš„ï¼Ÿï¼ˆæ ¸å¿ƒï¼‰" class="headerlink" title="ä¸ºä»€ä¹ˆæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·è®¾è®¡çš„ï¼Ÿï¼ˆæ ¸å¿ƒï¼‰"></a>ä¸ºä»€ä¹ˆ<strong>æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·è®¾è®¡çš„</strong>ï¼Ÿï¼ˆæ ¸å¿ƒï¼‰</h2><h3 id="ğŸŒŸ1-å…ˆFROMï¼š"><a href="#ğŸŒŸ1-å…ˆFROMï¼š" class="headerlink" title="ğŸŒŸ1. å…ˆFROMï¼š"></a>ğŸŒŸ1. <strong>å…ˆFROM</strong>ï¼š</h3><p>ç¡®å®š<strong>è¦æ“ä½œçš„è¡¨æˆ–è§†å›¾</strong>ï¼Œè¿™æ˜¯åŸºç¡€ï¼Œåé¢æ‰€æœ‰æ­¥éª¤éƒ½åŸºäºè¿™ä¸ªâ€œæ•°æ®æºâ€ã€‚</p>
<h3 id="ğŸŒŸ2-JOIN-x2F-ONï¼š"><a href="#ğŸŒŸ2-JOIN-x2F-ONï¼š" class="headerlink" title="ğŸŒŸ2. JOIN&#x2F;ONï¼š"></a>ğŸŒŸ2. <strong>JOIN&#x2F;ON</strong>ï¼š</h3><p>åœ¨å¤šä¸ªè¡¨ä¹‹é—´æ„å»ºè¿æ¥å…³ç³»ï¼Œå†³å®šä½ ä»è¿™äº›è¡¨ä¸­<strong>æ€æ ·æ‹¼æ¥å‡ºä¸€å¼ â€œä¸´æ—¶å¤§è¡¨â€</strong>ã€‚</p>
<h3 id="ğŸŒŸ3-WHEREï¼š"><a href="#ğŸŒŸ3-WHEREï¼š" class="headerlink" title="ğŸŒŸ3. WHEREï¼š"></a>ğŸŒŸ3. <strong>WHERE</strong>ï¼š</h3><p>åœ¨JOINåå¯¹ä¸´æ—¶è¡¨åš<strong>è¡Œçº§è¿‡æ»¤</strong>ï¼Œåªä¿ç•™ç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚<br> ğŸ‘‰ è¿™æ ·å¯ä»¥å°½æ—©â€œå‡å°æ•°æ®é‡â€ï¼Œ<strong>æå‡åç»­å¤„ç†æ•ˆç‡ï¼ˆæ¯”å¦‚åˆ†ç»„ï¼‰</strong>ã€‚</p>
<h3 id="ğŸŒŸ4-GROUP-BYï¼š"><a href="#ğŸŒŸ4-GROUP-BYï¼š" class="headerlink" title="ğŸŒŸ4. GROUP BYï¼š"></a>ğŸŒŸ4. <strong>GROUP BY</strong>ï¼š</h3><p>åŸºäºä¿ç•™çš„æ•°æ®æŒ‰æŸä¸ªå­—æ®µåš<strong>åˆ†ç»„èšåˆ</strong>ï¼Œå¦‚ç»Ÿè®¡ã€æ±‚å’Œç­‰ã€‚</p>
<h3 id="ğŸŒŸ5-HAVINGï¼š"><a href="#ğŸŒŸ5-HAVINGï¼š" class="headerlink" title="ğŸŒŸ5. HAVINGï¼š"></a>ğŸŒŸ5. <strong>HAVING</strong>ï¼š</h3><p>å¯¹<strong>èšåˆåçš„ç»„</strong>è¿›è¡Œç­›é€‰ï¼ˆå¦‚ï¼šåªä¿ç•™æ€»é‡‘é¢ &gt; 1000 çš„ç»„ï¼‰ã€‚</p>
<h3 id="ğŸŒŸ6-SELECTï¼š"><a href="#ğŸŒŸ6-SELECTï¼š" class="headerlink" title="ğŸŒŸ6. SELECTï¼š"></a>ğŸŒŸ6. <strong>SELECT</strong>ï¼š</h3><p>é€‰æ‹©è¿”å›å“ªäº›å­—æ®µï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½åŒ…å«èšåˆå‡½æ•°ï¼ˆå¦‚ <code>COUNT(*)</code>, <code>SUM()</code>ï¼‰ï¼Œæ­¤æ—¶ç»„å·²ç»å­˜åœ¨äº†ã€‚</p>
<h3 id="ğŸŒŸ7-ORDER-BYï¼š"><a href="#ğŸŒŸ7-ORDER-BYï¼š" class="headerlink" title="ğŸŒŸ7. ORDER BYï¼š"></a>ğŸŒŸ7. <strong>ORDER BY</strong>ï¼š</h3><p>å¯¹æœ€ç»ˆç»“æœ<strong>æ’åº</strong>ï¼Œè¿™ä¸ªé˜¶æ®µæ‰æœ‰æœºä¼šçœ‹åˆ°å®Œæ•´ç»“æœã€‚</p>
<h3 id="ğŸŒŸ8-LIMITï¼š"><a href="#ğŸŒŸ8-LIMITï¼š" class="headerlink" title="ğŸŒŸ8. LIMITï¼š"></a>ğŸŒŸ8. <strong>LIMIT</strong>ï¼š</h3><p>åªå–å‰å‡ è¡Œï¼Œ<strong>åˆ†é¡µä¼˜åŒ–</strong>çš„æœ€åä¸€ç¯ï¼Œå‡å°‘ç»“æœè¾“å‡ºä½“ç§¯</p>
<pre><code class="mysql">SELECT u.username, SUM(o.amount) AS total_amount
FROM user u
JOIN `order` o ON u.id = o.user_id
WHERE o.status = &#39;paid&#39;
GROUP BY u.id
HAVING total_amount &gt; 0
ORDER BY total_amount DESC
LIMIT 5;
</code></pre>
<h2 id="è¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"><a href="#è¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ" class="headerlink" title="è¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"></a>è¿™æ ·çš„é¡ºåºæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h2><table>
<thead>
<tr>
<th>é˜¶æ®µ</th>
<th>ç›®çš„&#x2F;ä¼˜åŠ¿</th>
</tr>
</thead>
<tbody><tr>
<td>FROM+JOIN</td>
<td>å…ˆæ„å»ºå¤§æ•°æ®æºç»“æ„ï¼Œä½œä¸ºåç»­å¤„ç†åŸºç¡€</td>
</tr>
<tr>
<td>WHERE</td>
<td>å°½æ—©è¿‡æ»¤ä¸å¿…è¦çš„æ•°æ® â†’ <strong>æé«˜æ€§èƒ½ï¼ˆå‡å°‘åç»­æ•°æ®é‡ï¼‰</strong></td>
</tr>
<tr>
<td>GROUP BY</td>
<td>åªå¯¹ä¿ç•™ä¸‹æ¥çš„æ•°æ®åšèšåˆï¼Œ<strong>æé«˜åˆ†ç»„æ•ˆç‡</strong></td>
</tr>
<tr>
<td>HAVING</td>
<td>èšåˆåå†è¿‡æ»¤ï¼Œé¿å…è¯¯ç­›ä¸å®Œæ•´ç»„</td>
</tr>
<tr>
<td>SELECT</td>
<td>æœ€åé€‰æ‹©å­—æ®µï¼Œ<strong>ä¿è¯è¡¨è¾¾å¼éƒ½åˆæ³•ä¸”æ•°æ®é½å…¨</strong></td>
</tr>
<tr>
<td>ORDER BY</td>
<td>æ’åºé€šå¸¸å¼€é”€å¤§ï¼Œ<strong>æ”¾æœ€åæ‰§è¡Œ</strong>æœ€åˆç†</td>
</tr>
<tr>
<td>LIMIT</td>
<td>æ§åˆ¶è¾“å‡ºé‡ï¼Œ<strong>æé«˜å“åº”é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒ</strong></td>
</tr>
</tbody></table>
<h2 id="é¢è¯•å¦‚ä½•å›ç­”ï¼ˆå»ºè®®æ¨¡æ¿ï¼‰"><a href="#é¢è¯•å¦‚ä½•å›ç­”ï¼ˆå»ºè®®æ¨¡æ¿ï¼‰" class="headerlink" title="é¢è¯•å¦‚ä½•å›ç­”ï¼ˆå»ºè®®æ¨¡æ¿ï¼‰"></a>é¢è¯•å¦‚ä½•å›ç­”ï¼ˆå»ºè®®æ¨¡æ¿ï¼‰</h2><p>â€œSQLçš„æ‰§è¡Œé¡ºåºè®¾è®¡æ˜¯ä¸ºäº†æœ€å¤§é™åº¦æå‡æŸ¥è¯¢æ•ˆç‡ã€‚å…ˆæ‰§è¡ŒFROMå’ŒJOINæ˜¯å› ä¸ºå¿…é¡»å…ˆæ„å»ºæ•°æ®æºï¼›ç„¶åç”¨WHEREå°½æ—©è¿‡æ»¤è¡Œï¼Œé¿å…æ— æ„ä¹‰çš„æ•°æ®è¿›å…¥åˆ†ç»„ã€æ’åºç­‰æ›´è€—æ€§èƒ½çš„é˜¶æ®µï¼›GROUP BYåœ¨WHEREè¿‡æ»¤åè¿›è¡Œï¼ŒHAVINGåˆ™æ˜¯å¯¹èšåˆç»“æœå†åšç­›é€‰ï¼›SELECTæœ€åæ‰æ‰§è¡Œï¼Œæ˜¯å› ä¸ºåªæœ‰åœ¨å‰é¢éƒ½å¤„ç†å®Œåï¼Œæ‰èƒ½ç¡®å®šå“ªäº›å­—æ®µå¯ç”¨ï¼›ORDER BY å’Œ LIMITæ˜¯æœ€ç»ˆç»“æœçš„åŠ å·¥ã€‚è¿™ç§é¡ºåºæ˜¯æ•°æ®åº“æ‰§è¡Œä¼˜åŒ–çš„æ ¸å¿ƒé€»è¾‘ã€‚â€</p>
</blockquote>
<h4 id="çº¿ä¸Šé¡¹ç›®å‘ç”Ÿæ­»é”å¦‚ä½•å»è§£å†³ï¼Ÿ-æˆ‘æš‚æ—¶æ²¡é‡åˆ°è¿‡â†’åˆ†å¸ƒå¼äº‹åŠ¡ä¸Šå»ç­”"><a href="#çº¿ä¸Šé¡¹ç›®å‘ç”Ÿæ­»é”å¦‚ä½•å»è§£å†³ï¼Ÿ-æˆ‘æš‚æ—¶æ²¡é‡åˆ°è¿‡â†’åˆ†å¸ƒå¼äº‹åŠ¡ä¸Šå»ç­”" class="headerlink" title="çº¿ä¸Šé¡¹ç›®å‘ç”Ÿæ­»é”å¦‚ä½•å»è§£å†³ï¼Ÿ æˆ‘æš‚æ—¶æ²¡é‡åˆ°è¿‡â†’åˆ†å¸ƒå¼äº‹åŠ¡ä¸Šå»ç­”"></a>çº¿ä¸Šé¡¹ç›®å‘ç”Ÿæ­»é”å¦‚ä½•å»è§£å†³ï¼Ÿ <del>æˆ‘æš‚æ—¶æ²¡é‡åˆ°è¿‡â†’åˆ†å¸ƒå¼äº‹åŠ¡ä¸Šå»ç­”</del></h4><p><strong>æ­»é”</strong>ï¼šä¸¤ä¸ªçº¿ç¨‹äº‰å¤ºä¸¤ä¸ªèµ„æºçš„æ—¶å€™  <code>1çº¿ç¨‹æ‹¿åˆ°a æƒ³æ‹¿b   2çº¿ç¨‹æ‹¿åˆ°äº†b æƒ³æ‹¿a</code><br><strong>å››ä¸ªåŸå› </strong>ï¼š<u>äº’æ–¥æ¡ä»¶ è¯·æ±‚ä¿æŒ ä¸å¯å‰¥å¤º å¾ªç¯ç­‰å¾…</u><br>äº§ç”Ÿæ­»é”çš„å››ä¸ªå› ç´  åŒæ—¶æ»¡è¶³æ‰ä¼šæ­»é”     æƒ³è¦è§£å†³æ­»é” éœ€è¦æ‰“ç ´å…¶ä¸­ä¸€ä¸ªåŸå› å°±è¡Œ</p>
<blockquote>
<ol>
<li><strong>äº’æ–¥æ¡ä»¶ï¼ˆMutual Exclusionï¼‰</strong>ï¼šèµ„æºä¸èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨ã€‚å³æŸä¸ªèµ„æºåœ¨ä¸€æ®µæ—¶é—´å†…åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…è¯¥èµ„æºè¢«é‡Šæ”¾åæ‰èƒ½ä½¿ç”¨ã€‚</li>
<li><strong>æŒæœ‰å’Œç­‰å¾…æ¡ä»¶ï¼ˆHold and Waitï¼‰</strong>ï¼šçº¿ç¨‹è‡³å°‘æŒæœ‰ä¸€ä¸ªèµ„æºï¼Œå¹¶ä¸”æ­£åœ¨ç­‰å¾…è·å–é¢å¤–çš„èµ„æºï¼Œè€Œè¯¥èµ„æºåˆè¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ã€‚</li>
<li><strong>éæŠ¢å æ¡ä»¶ï¼ˆNo Preemptionï¼‰</strong>ï¼šå·²ç»åˆ†é…ç»™æŸä¸ªçº¿ç¨‹çš„èµ„æºåœ¨è¯¥çº¿ç¨‹å®Œæˆä»»åŠ¡å‰ä¸èƒ½è¢«æŠ¢å ï¼Œå³åªèƒ½ç”±çº¿ç¨‹è‡ªå·±é‡Šæ”¾ã€‚</li>
<li><strong>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼ˆCircular Waitï¼‰</strong>ï¼šå­˜åœ¨ä¸€ç§çº¿ç¨‹èµ„æºçš„å¾ªç¯ç­‰å¾…é“¾ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªçº¿ç¨‹æ‰€æŒæœ‰çš„èµ„æºã€‚</li>
</ol>
</blockquote>
<blockquote>
<h4 id="åœ¨å®é™…æ“ä½œä¸­ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ‰“ç ´æ­»é”çš„å…·ä½“æ–¹æ³•ï¼š"><a href="#åœ¨å®é™…æ“ä½œä¸­ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ‰“ç ´æ­»é”çš„å…·ä½“æ–¹æ³•ï¼š" class="headerlink" title="åœ¨å®é™…æ“ä½œä¸­ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ‰“ç ´æ­»é”çš„å…·ä½“æ–¹æ³•ï¼š"></a>åœ¨å®é™…æ“ä½œä¸­ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ‰“ç ´æ­»é”çš„å…·ä½“æ–¹æ³•ï¼š</h4><ul>
<li><strong>èµ„æºåˆ†é…å›¾</strong>ï¼šä½¿ç”¨èµ„æºåˆ†é…å›¾æ¥æ£€æµ‹å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼Œå¹¶åœ¨æ£€æµ‹åˆ°å¾ªç¯æ—¶é‡‡å–æªæ–½ã€‚</li>
<li><strong>é”æ’åº</strong>ï¼šç¡®ä¿æ‰€æœ‰çº¿ç¨‹ä»¥ç›¸åŒçš„é¡ºåºè·å–é”ï¼Œä»è€Œé¿å…å¾ªç¯ç­‰å¾…ã€‚</li>
<li><strong>è¶…æ—¶æœºåˆ¶</strong>ï¼šçº¿ç¨‹åœ¨è¯·æ±‚èµ„æºæ—¶è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡æ—¶é—´æœªè·å¾—èµ„æºï¼Œåˆ™æ”¾å¼ƒå½“å‰ä»»åŠ¡å¹¶é‡Šæ”¾å·²æŒæœ‰çš„èµ„æºã€‚</li>
<li><strong>æ­»é”æ£€æµ‹ç®—æ³•</strong>ï¼šè¿è¡Œæ­»é”æ£€æµ‹ç®—æ³•ï¼Œå¦‚é“¶è¡Œå®¶ç®—æ³•ï¼Œæ¥æ£€æµ‹ç³»ç»Ÿä¸­çš„æ­»é”ï¼Œå¹¶åœ¨å¿…è¦æ—¶é‡‡å–æªæ–½ã€‚</li>
<li><strong>çº¿ç¨‹ä¸­æ–­</strong>ï¼šå…è®¸ç³»ç»Ÿæˆ–å…¶ä»–çº¿ç¨‹ä¸­æ–­æ­£åœ¨ç­‰å¾…èµ„æºçš„çº¿ç¨‹ã€‚</li>
<li><strong>å›æ»šæ“ä½œ</strong>ï¼šå¦‚æœæ£€æµ‹åˆ°æ­»é”ï¼Œå¯ä»¥è®©æŸäº›çº¿ç¨‹å›æ»šå®ƒä»¬çš„å·¥ä½œï¼Œå¹¶é‡Šæ”¾èµ„æºï¼Œä»è€Œæ‰“ç ´æ­»é”ã€‚</li>
</ul>
</blockquote>
<p>MySQLæ˜¯ä¸ä¼šæœ‰æ­»é”çš„ è‡ªèº«ä¼šæ£€æµ‹ [è®©åé¢çš„è¶…æ—¶é‡Šæ”¾å›æ»š]<br>åœ¨åˆ†å¸ƒå¼äº‹åŠ¡ çº¿ç¨‹1æ‹¿ç€èµ„æºaæ˜¯æ•°æ®åº“1 çº¿ç¨‹2æ‹¿ç€èµ„æºbæ˜¯æ•°æ®åº“2<br>JVMä¸­ä¹Ÿæœ‰æ­»é”ï¼Œjvmæ²¡æœ‰è¶…æ—¶æœºåˆ¶ä¸ä¼šè§£å†³ å¯ä»¥æŸ¥çœ‹å‘½ä»¤æ‰“å°å †æ ˆä¿¡æ¯å¯ä»¥æŸ¥çœ‹å“ªé‡Œäº§ç”Ÿæ­»é”</p>
<blockquote>
<p>ä½ å¯ä»¥ä½¿ç”¨<code>jstack</code>å‘½ä»¤æ¥æ‰“å°æŒ‡å®šè¿›ç¨‹IDçš„Javaå †æ ˆè·Ÿè¸ªä¿¡æ¯ã€‚è¿™ä¸ªå‘½ä»¤å¯ä»¥å¸®åŠ©ä½ åˆ†æçº¿ç¨‹çš„çŠ¶æ€</p>
<ol>
<li><p>é¦–å…ˆï¼Œæ‰¾åˆ°ä½ çš„Javaè¿›ç¨‹IDï¼ˆPIDï¼‰ã€‚ä½ å¯ä»¥ä½¿ç”¨<code>jps</code>å‘½ä»¤æ¥åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Javaè¿›ç¨‹åŠå…¶PIDã€‚</p>
<pre><code>jps
</code></pre>
</li>
<li><p>ä½¿ç”¨<code>jstack</code>å‘½ä»¤æ‰“å°å‡ºè¯¥Javaè¿›ç¨‹çš„å †æ ˆè·Ÿè¸ªã€‚</p>
<pre><code>jstack &lt;PID&gt;
</code></pre>
<p>å°†<code>&lt;PID&gt;</code>æ›¿æ¢ä¸ºå®é™…çš„è¿›ç¨‹IDã€‚</p>
</li>
<li><p>æŸ¥æ‰¾å †æ ˆè·Ÿè¸ªä¸­çš„â€DEADLOCKâ€å…³é”®å­—ã€‚<code>jstack</code>ä¼šè‡ªåŠ¨æ£€æµ‹æ­»é”å¹¶åœ¨è¾“å‡ºä¸­æŠ¥å‘Šã€‚</p>
</li>
</ol>
<p>æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é‡åˆ°æ¥å£å¡ä½ä¸å“åº”çš„æƒ…å†µï¼Œä¼šå…ˆä½¿ç”¨ <code>jps</code> æ‰¾åˆ°ç›®æ ‡ Java è¿›ç¨‹çš„ PIDï¼Œç„¶åç”¨ <code>jstack &lt;PID&gt;</code> å¯¼å‡ºçº¿ç¨‹å †æ ˆæ—¥å¿—ã€‚æˆ‘ä»¬é‡ç‚¹æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ <code>Found one Java-level deadlock</code> çš„æç¤ºï¼Œå¹¶åˆ†æå…·ä½“æ˜¯å“ªå‡ ä¸ªçº¿ç¨‹é”ä½äº†å½¼æ­¤çš„èµ„æºã€‚å¦‚æœç¡®è®¤æ˜¯æ­»é”ï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥åˆ†æä»£ç é€»è¾‘è¿›è¡Œè§£è€¦æˆ–è°ƒæ•´åŠ é”é¡ºåºã€‚</p>
<blockquote>
<p>Found one Java-level deadlock:</p>
<p>â€œThread-1â€:<br>  waiting to lock monitor 0x00000000053c3d28 (object 0x000000076b300030, a java.lang.Object),<br>  which is held by â€œThread-0â€<br>â€œThread-0â€:<br>  waiting to lock monitor 0x00000000053c3d48 (object 0x000000076b300028, a java.lang.Object),<br>  which is held by â€œThread-1â€</p>
<p>Java stack information for the threads listed above:</p>
<p>Thread-1:<br>  at DeadlockDemo.lambda$main$1(DeadlockDemo.java:20)</p>
<ul>
<li>waiting to lock &lt;0x000000076b300030&gt; (a java.lang.Object)</li>
<li>locked &lt;0x000000076b300028&gt; (a java.lang.Object)</li>
</ul>
<p>Thread-0:<br>  at DeadlockDemo.lambda$main$0(DeadlockDemo.java:11)</p>
<ul>
<li>waiting to lock &lt;0x000000076b300028&gt; (a java.lang.Object)</li>
<li>locked &lt;0x000000076b300030&gt; (a java.lang.Object)</li>
</ul>
</blockquote>
</blockquote>
<h4 id="å¦‚æœä½ é‡åˆ°-æ–°çš„-æŠ€æœ¯æ ˆï¼Œæ€ä¹ˆå»è§£å†³"><a href="#å¦‚æœä½ é‡åˆ°-æ–°çš„-æŠ€æœ¯æ ˆï¼Œæ€ä¹ˆå»è§£å†³" class="headerlink" title="å¦‚æœä½ é‡åˆ°(æ–°çš„)æŠ€æœ¯æ ˆï¼Œæ€ä¹ˆå»è§£å†³?"></a>å¦‚æœä½ é‡åˆ°(æ–°çš„)æŠ€æœ¯æ ˆï¼Œæ€ä¹ˆå»è§£å†³?</h4><p>ã€return Previous.notes(NowDay);ã€‘</p>
<h4 id="å¦‚æœä½ åœ¨å®é™…å¼€å‘ä¸­é‡åˆ°é—®é¢˜ï¼Œä½ æ€ä¹ˆå»è§£å†³ï¼Œæ€ä¹ˆå»æ²Ÿé€š"><a href="#å¦‚æœä½ åœ¨å®é™…å¼€å‘ä¸­é‡åˆ°é—®é¢˜ï¼Œä½ æ€ä¹ˆå»è§£å†³ï¼Œæ€ä¹ˆå»æ²Ÿé€š" class="headerlink" title="å¦‚æœä½ åœ¨å®é™…å¼€å‘ä¸­é‡åˆ°é—®é¢˜ï¼Œä½ æ€ä¹ˆå»è§£å†³ï¼Œæ€ä¹ˆå»æ²Ÿé€š?"></a>å¦‚æœä½ åœ¨å®é™…å¼€å‘ä¸­é‡åˆ°é—®é¢˜ï¼Œä½ æ€ä¹ˆå»è§£å†³ï¼Œæ€ä¹ˆå»æ²Ÿé€š?</h4><p>é¦–å…ˆå°è¯•è‡ªå·±è§£å†³é—®é¢˜ï¼Œé€šè¿‡æœç´¢å¼•æ“ã€å®˜æ–¹æ–‡æ¡£ã€Debugç­‰ã€‚<br>å°½å¯èƒ½ä¸è®©è¿™ä¸ªé—®é¢˜ä¸å‡ºç°é£é™© å®åœ¨è§£å†³ä¸äº†å°±å‘ä¸Šåé¦ˆ å¯»æ±‚å¸®åŠ© è¯·æ•™ä¸Šå¸é¢†å¯¼æˆ–åŒäº‹<br>å¹³å¸¸å’Œé¡¹ç›®ç»ç†è¿›è¡Œæ²Ÿé€š å¦‚æœéœ€æ±‚è¯„å®¡æœ‰äº›ä¸ç†è§£è¿˜æ˜¯ä¼šåŠæ—¶æ²Ÿé€š ä¸æ¸…æ¥šçš„ä¸€å®šè¦åŠæ—¶æ˜ç¡®</p>
<h4 id="å¯¹äºåŠ ç­æƒ…å†µæ€ä¹ˆçœ‹"><a href="#å¯¹äºåŠ ç­æƒ…å†µæ€ä¹ˆçœ‹" class="headerlink" title="å¯¹äºåŠ ç­æƒ…å†µæ€ä¹ˆçœ‹?"></a>å¯¹äºåŠ ç­æƒ…å†µæ€ä¹ˆçœ‹?</h4><p>ä¸ºäº†ç¡®ä¿é¡¹ç›®è¿›åº¦å’Œå›¢é˜Ÿåˆ©ç›Šï¼ŒåŠ ç­æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p>
<h4 id="å¤šçº¿ç¨‹æ€ä¹ˆä¿è¯çº¿ç¨‹ä¹‹é—´çš„å®‰å…¨"><a href="#å¤šçº¿ç¨‹æ€ä¹ˆä¿è¯çº¿ç¨‹ä¹‹é—´çš„å®‰å…¨" class="headerlink" title="å¤šçº¿ç¨‹æ€ä¹ˆä¿è¯çº¿ç¨‹ä¹‹é—´çš„å®‰å…¨"></a>å¤šçº¿ç¨‹æ€ä¹ˆä¿è¯çº¿ç¨‹ä¹‹é—´çš„å®‰å…¨</h4><h6 id="åŠ é”-ä¸è®©å¤šçº¿ç¨‹æŠ¢å¤ºèµ„æº"><a href="#åŠ é”-ä¸è®©å¤šçº¿ç¨‹æŠ¢å¤ºèµ„æº" class="headerlink" title="åŠ é”  ä¸è®©å¤šçº¿ç¨‹æŠ¢å¤ºèµ„æº"></a>åŠ é”  ä¸è®©å¤šçº¿ç¨‹æŠ¢å¤ºèµ„æº</h6><p>äº’æ–¥é”ã€è¯»å†™é”ã€çº¿ç¨‹å±€éƒ¨å­˜å‚¨(ThreadLocalæ¯ä¸ªçº¿ç¨‹ç‹¬äº«è‡ªå·±å˜é‡)</p>
<h4 id="mybatisä¸­-å’Œ-çš„åŒºåˆ«ï¼Œå“ªä¸ªæ›´å¥½-ä¸ºä»€ä¹ˆ"><a href="#mybatisä¸­-å’Œ-çš„åŒºåˆ«ï¼Œå“ªä¸ªæ›´å¥½-ä¸ºä»€ä¹ˆ" class="headerlink" title="mybatisä¸­${}å’Œ#{}çš„åŒºåˆ«ï¼Œå“ªä¸ªæ›´å¥½? ä¸ºä»€ä¹ˆ?"></a>mybatisä¸­${}å’Œ#{}çš„åŒºåˆ«ï¼Œå“ªä¸ªæ›´å¥½? ä¸ºä»€ä¹ˆ?</h4><ol>
<li><h5 id="ï¼ˆå­—ç¬¦ä¸²æ›¿æ¢ï¼‰ï¼š"><a href="#ï¼ˆå­—ç¬¦ä¸²æ›¿æ¢ï¼‰ï¼š" class="headerlink" title="${}ï¼ˆå­—ç¬¦ä¸²æ›¿æ¢ï¼‰ï¼š"></a><code>$&#123;&#125;</code>ï¼ˆå­—ç¬¦ä¸²æ›¿æ¢ï¼‰ï¼š</h5><ul>
<li><code>$&#123;&#125;</code>ä¼šå°†å‚æ•°ç›´æ¥æ›¿æ¢åˆ°SQLè¯­å¥ä¸­ï¼Œä¸è¿›è¡Œä»»ä½•è½¬ä¹‰å¤„ç†ã€‚</li>
<li>å®ƒé€‚ç”¨äºåŠ¨æ€SQLä¸­çš„è¡¨åæˆ–åˆ—åï¼Œæˆ–è€…åœ¨SQLè¯­å¥ä¸­éœ€è¦ä½¿ç”¨ç‰¹å®šæ•°æ®åº“å‡½æ•°çš„æƒ…å†µã€‚</li>
<li>ä½¿ç”¨<code>$&#123;&#125;</code>æ—¶ï¼Œå¦‚æœå‚æ•°æ˜¯ç”¨æˆ·è¾“å…¥çš„ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¼•å‘SQLæ³¨å…¥æ”»å‡»ï¼Œå› ä¸ºå®ƒä¸ä¼šå¯¹å‚æ•°è¿›è¡Œè½¬ä¹‰ã€‚</li>
</ul>
</li>
<li><h5 id="ï¼ˆé¢„å¤„ç†è¯­å¥å‚æ•°ï¼‰ï¼š"><a href="#ï¼ˆé¢„å¤„ç†è¯­å¥å‚æ•°ï¼‰ï¼š" class="headerlink" title="#{}ï¼ˆé¢„å¤„ç†è¯­å¥å‚æ•°ï¼‰ï¼š"></a><code>#&#123;&#125;</code>ï¼ˆé¢„å¤„ç†è¯­å¥å‚æ•°ï¼‰ï¼š</h5><ul>
<li><code>#&#123;&#125;</code>ä¼šåˆ›å»ºé¢„å¤„ç†è¯­å¥ï¼ˆprepared statementï¼‰çš„å‚æ•°å ä½ç¬¦ï¼Œå¹¶åœ¨è®¾ç½®å‚æ•°æ—¶è¿›è¡Œé€‚å½“çš„è½¬ä¹‰å¤„ç†ã€‚</li>
<li>å®ƒé€‚ç”¨äºå¤§éƒ¨åˆ†æƒ…å†µï¼Œç‰¹åˆ«æ˜¯å½“<strong>å‚æ•°æ˜¯ç”¨æˆ·è¾“å…¥</strong>æ—¶ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚</li>
<li>MyBatisä¼šæ ¹æ®å‚æ•°çš„ç±»å‹è‡ªåŠ¨é€‰æ‹©<code>setString</code>ã€<code>setInt</code>ã€<code>setDate</code>ç­‰é¢„å¤„ç†è¯­å¥æ–¹æ³•ã€‚</li>
</ul>
</li>
<li><h5 id="åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ-æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒæä¾›äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š"><a href="#åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ-æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒæä¾›äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š" class="headerlink" title="åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ#{}æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒæä¾›äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š"></a>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>#&#123;&#125;</code>æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒæä¾›äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š</h5><ul>
<li><strong>å®‰å…¨æ€§</strong>ï¼š<code>#&#123;&#125;</code>å¯ä»¥é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼Œå› ä¸ºå®ƒä¼š<strong>è‡ªåŠ¨è½¬ä¹‰å‚æ•°</strong>ã€‚</li>
<li><strong>ç±»å‹å¤„ç†</strong>ï¼šMyBatisä¼šæ ¹æ®å‚æ•°çš„å®é™…ç±»å‹æ¥è®¾ç½®é¢„å¤„ç†è¯­å¥çš„å‚æ•°ï¼Œè¿™å‡å°‘äº†ç±»å‹é”™è¯¯çš„å¯èƒ½æ€§ã€‚</li>
<li><strong>å¯è¯»æ€§å’Œç»´æŠ¤æ€§</strong>ï¼šä½¿ç”¨<code>#&#123;&#125;</code>å¯ä»¥ä½¿SQLè¯­å¥æ›´åŠ æ¸…æ™°ï¼Œå› ä¸ºå®ƒæ¸…æ¥šåœ°æ ‡è¯†äº†å‚æ•°çš„ä½ç½®ã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œåœ¨æŸäº›ç‰¹å®šçš„åœºæ™¯ä¸‹ï¼Œå¦‚éœ€è¦åŠ¨æ€åœ°æŒ‡å®šè¡¨åæˆ–åˆ—åæ—¶ï¼Œ<code>$&#123;&#125;</code>æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºé¢„å¤„ç†è¯­å¥</p>
<blockquote>
<h3 id="MyBatis-ä¸­-å’Œ-çš„åŒºåˆ«"><a href="#MyBatis-ä¸­-å’Œ-çš„åŒºåˆ«" class="headerlink" title="MyBatis ä¸­ #{}å’Œ${} çš„åŒºåˆ«"></a>MyBatis ä¸­ <code>#&#123;&#125;</code>å’Œ<code>$&#123;&#125;</code> çš„åŒºåˆ«</h3><table>
<thead>
<tr>
<th>é¡¹ç›®</th>
<th><code>#&#123;&#125;</code>ï¼ˆå ä½ç¬¦ï¼‰</th>
<th><code>$&#123;&#125;</code>ï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>æ›¿æ¢æ–¹å¼</td>
<td>ä½¿ç”¨ <strong>? å ä½ç¬¦</strong></td>
<td><strong>å­—ç¬¦ä¸²ç›´æ¥æ‹¼æ¥è¿›SQL</strong></td>
</tr>
<tr>
<td>æ˜¯å¦è½¬ä¹‰</td>
<td>âœ… è‡ªåŠ¨è½¬ä¹‰ï¼Œå®‰å…¨</td>
<td>âŒ ä¸è½¬ä¹‰ï¼Œæœ‰SQLæ³¨å…¥é£é™©</td>
</tr>
<tr>
<td>ä½¿ç”¨åº•å±‚</td>
<td>JDBC çš„ PreparedStatement</td>
<td>å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ‰§è¡Œå‰å·²æˆå®Œæ•´SQL</td>
</tr>
<tr>
<td>åœºæ™¯</td>
<td>ä¼ å…¥å€¼å¦‚ï¼šç”¨æˆ·åã€IDã€ä»·æ ¼ç­‰å‚æ•°</td>
<td>åŠ¨æ€è¡¨åã€åˆ—åã€æ’åºå­—æ®µã€å‡½æ•°ç­‰</td>
</tr>
<tr>
<td>å®‰å…¨æ€§</td>
<td>å®‰å…¨ï¼Œæ¨èä½¿ç”¨</td>
<td>ä¸å®‰å…¨ï¼Œè°¨æ…ä½¿ç”¨</td>
</tr>
<tr>
<td>ç±»å‹å¤„ç†</td>
<td>âœ… è‡ªåŠ¨å¤„ç†ç±»å‹è½¬æ¢</td>
<td>âŒ ä¸åšç±»å‹å¤„ç†ï¼Œéœ€æ‰‹åŠ¨æ‹¼æ¥æ ¼å¼</td>
</tr>
<tr>
<td>æ€§èƒ½ï¼ˆç¼“å­˜ï¼‰</td>
<td>æ”¯æŒ SQL ç¼“å­˜</td>
<td>ç”±äº SQL å˜åŒ–å¤§ï¼Œç¼“å­˜å‘½ä¸­ä½</td>
</tr>
</tbody></table>
<h4 id="æ­£ç¡®ä½¿ç”¨"><a href="#æ­£ç¡®ä½¿ç”¨" class="headerlink" title="æ­£ç¡®ä½¿ç”¨ #{}"></a>æ­£ç¡®ä½¿ç”¨ <code>#&#123;&#125;</code></h4><pre><code class="xml">&lt;select id=&quot;getUser&quot; resultType=&quot;User&quot;&gt;
  SELECT * FROM users WHERE id = #&#123;userId&#125;
&lt;/select&gt;
</code></pre>
<ul>
<li>è‡ªåŠ¨è½¬ä¸ºï¼š<code>SELECT * FROM users WHERE id = ?</code></li>
<li>å®‰å…¨ï¼Œå¯é˜²æ­¢ SQL æ³¨å…¥ã€‚</li>
</ul>
<h4 id="å¿…é¡»ä½¿ç”¨-çš„åœºæ™¯ï¼ˆåŠ¨æ€è¡¨åæˆ–åˆ—ï¼‰"><a href="#å¿…é¡»ä½¿ç”¨-çš„åœºæ™¯ï¼ˆåŠ¨æ€è¡¨åæˆ–åˆ—ï¼‰" class="headerlink" title="å¿…é¡»ä½¿ç”¨ ${} çš„åœºæ™¯ï¼ˆåŠ¨æ€è¡¨åæˆ–åˆ—ï¼‰"></a>å¿…é¡»ä½¿ç”¨ <code>$&#123;&#125;</code> çš„åœºæ™¯ï¼ˆåŠ¨æ€è¡¨åæˆ–åˆ—ï¼‰</h4><pre><code class="xml">&lt;select id=&quot;selectByColumn&quot; resultType=&quot;User&quot;&gt;
  SELECT * FROM users WHERE $&#123;columnName&#125; = #&#123;value&#125;
&lt;/select&gt;
</code></pre>
<ul>
<li>ç”¨äºï¼šåŠ¨æ€å­—æ®µï¼ˆå¦‚ <code>name</code>ã€<code>email</code>ï¼‰æŸ¥è¯¢ã€‚</li>
<li>æ³¨æ„ï¼š<code>$&#123;columnName&#125;</code> å¯èƒ½æ¥è‡ªç”¨æˆ·è¾“å…¥ï¼Œ<strong>å¿…é¡»ç™½åå•æ ¡éªŒ</strong>ï¼Œå¦åˆ™å®¹æ˜“è¢« SQL æ³¨å…¥ã€‚</li>
</ul>
</blockquote>
</li>
</ol>
<h4 id="è¯´ä¸€ä¸‹å†…è¿æ¥å’Œå¤–è¿æ¥çš„åŒºåˆ«"><a href="#è¯´ä¸€ä¸‹å†…è¿æ¥å’Œå¤–è¿æ¥çš„åŒºåˆ«" class="headerlink" title="è¯´ä¸€ä¸‹å†…è¿æ¥å’Œå¤–è¿æ¥çš„åŒºåˆ«"></a>è¯´ä¸€ä¸‹å†…è¿æ¥å’Œå¤–è¿æ¥çš„åŒºåˆ«</h4><p><strong>å·¦å¤–è¿æ¥ï¼ˆLeft Outer Joinï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šå·¦å¤–è¿æ¥è¿”å›å·¦è¡¨ä¸­çš„æ‰€æœ‰è¡Œï¼Œå³ä½¿åœ¨å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œã€‚å¯¹äºå·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œï¼Œç»“æœé›†ä¸­çš„å³è¡¨éƒ¨åˆ†å°†åŒ…å«NULLã€‚</li>
<li>å¦‚æœå·¦è¡¨æ˜¯ä¸»è¡¨ï¼Œæˆ–è€…å·¦è¡¨ä¸­çš„æ•°æ®æ˜¯æŸ¥è¯¢çš„ä¸»è¦å…³æ³¨ç‚¹ï¼Œè€Œå³è¡¨ä¸­çš„æ•°æ®æ˜¯è¾…åŠ©ä¿¡æ¯æ—¶ï¼Œé€šå¸¸ä½¿ç”¨å·¦å¤–è¿æ¥ã€‚</li>
</ul>
<p><strong>å³å¤–è¿æ¥ï¼ˆRight Outer Joinï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šå³å¤–è¿æ¥è¿”å›å³è¡¨ä¸­çš„æ‰€æœ‰è¡Œï¼Œå³ä½¿åœ¨å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œã€‚å¯¹äºå³è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œï¼Œç»“æœé›†ä¸­çš„å·¦è¡¨éƒ¨åˆ†å°†åŒ…å«NULLã€‚</li>
<li>å¦‚æœå³è¡¨æ˜¯ä¸»è¡¨ï¼Œæˆ–è€…å³è¡¨ä¸­çš„æ•°æ®æ˜¯æŸ¥è¯¢çš„ä¸»è¦å…³æ³¨ç‚¹ï¼Œè€Œå·¦è¡¨ä¸­çš„æ•°æ®æ˜¯è¾…åŠ©ä¿¡æ¯æ—¶ï¼Œé€šå¸¸ä½¿ç”¨å³å¤–è¿æ¥</li>
</ul>
<p><strong>å…¨å¤–è¿æ¥ï¼ˆFull Outer Joinï¼‰</strong>ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šå…¨å¤–è¿æ¥è¿”å›å·¦è¡¨å’Œå³è¡¨ä¸­çš„æ‰€æœ‰è¡Œã€‚å½“æŸè¡Œåœ¨å¦ä¸€ä¸ªè¡¨ä¸­æ²¡æœ‰åŒ¹é…æ—¶ï¼Œç»“æœé›†ä¸­çš„ç›¸åº”éƒ¨åˆ†å°†åŒ…å«NULLã€‚</li>
<li>å…¨å¤–è¿æ¥ä¸å¸¸ç”¨ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¼šè¿”å›å¤§é‡çš„åŒ…å«NULLçš„æ•°æ®ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æŸ¥è¯¢ç»“æœéš¾ä»¥è§£é‡Šã€‚åªæœ‰åœ¨ç¡®å®éœ€è¦ä¸¤è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®æ—¶æ‰ä½¿ç”¨ã€‚</li>
</ul>
<hr>
<blockquote>
<ul>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šå¤–è¿æ¥å¯èƒ½ä¼šæ¯”å†…è¿æ¥ï¼ˆInner Joinï¼‰æ›´æ¶ˆè€—èµ„æºï¼Œç‰¹åˆ«æ˜¯å½“è¡¨å¾ˆå¤§æ—¶ã€‚å¦‚æœå¯èƒ½ï¼Œå°½é‡ä½¿ç”¨å†…è¿æ¥ã€‚</li>
<li><strong>æ•°æ®å®Œæ•´æ€§</strong>ï¼šå¦‚æœä¸šåŠ¡é€»è¾‘è¦æ±‚æŸ¥è¯¢ç»“æœå¿…é¡»åŒ…å«æŸä¸ªè¡¨çš„æ‰€æœ‰è®°å½•ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨ç›¸åº”çš„å¤–è¿æ¥ã€‚</li>
</ul>
<h2 id="å†…è¿æ¥-vs-å¤–è¿æ¥ï¼šæ ¸å¿ƒåŒºåˆ«æ€»ç»“"><a href="#å†…è¿æ¥-vs-å¤–è¿æ¥ï¼šæ ¸å¿ƒåŒºåˆ«æ€»ç»“" class="headerlink" title="å†…è¿æ¥ vs å¤–è¿æ¥ï¼šæ ¸å¿ƒåŒºåˆ«æ€»ç»“"></a>å†…è¿æ¥ vs å¤–è¿æ¥ï¼šæ ¸å¿ƒåŒºåˆ«æ€»ç»“</h2><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
<th>æ˜¯å¦ä¿ç•™éåŒ¹é…è¡Œ</th>
<th>NULL å‡ºç°åœ¨å“ªä¸€è¾¹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å†…è¿æ¥</strong></td>
<td>åªè¿”å›ä¸¤ä¸ªè¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„<strong>äº¤é›†éƒ¨åˆ†</strong></td>
<td>âŒ</td>
<td>âŒ ä¸ä¼šæœ‰ NULL</td>
</tr>
<tr>
<td><strong>å·¦å¤–è¿æ¥</strong></td>
<td>ä¿ç•™<strong>å·¦è¡¨æ‰€æœ‰è®°å½•</strong>ï¼Œå³è¡¨æ²¡æœ‰åŒ¹é…çš„å¡« NULL</td>
<td>âœ…ï¼ˆä¿ç•™å·¦è¡¨ï¼‰</td>
<td>å³è¡¨å­—æ®µä¸º NULL</td>
</tr>
<tr>
<td><strong>å³å¤–è¿æ¥</strong></td>
<td>ä¿ç•™<strong>å³è¡¨æ‰€æœ‰è®°å½•</strong>ï¼Œå·¦è¡¨æ²¡æœ‰åŒ¹é…çš„å¡« NULL</td>
<td>âœ…ï¼ˆä¿ç•™å³è¡¨ï¼‰</td>
<td>å·¦è¡¨å­—æ®µä¸º NULL</td>
</tr>
<tr>
<td><strong>å…¨å¤–è¿æ¥</strong></td>
<td>å·¦å³ä¸¤è¡¨éƒ½ä¿ç•™ï¼Œä¸åŒ¹é…çš„éƒ¨åˆ†å¡« NULLï¼ˆ<strong>å¹¶é›†</strong>ï¼‰</td>
<td>âœ…ï¼ˆéƒ½ä¿ç•™ï¼‰</td>
<td>ä¸¤è¾¹éƒ½å¯èƒ½ä¸º NULL</td>
</tr>
</tbody></table>
<h2 id="âœ…-å›¾ç¤ºè®°å¿†æ³•"><a href="#âœ…-å›¾ç¤ºè®°å¿†æ³•" class="headerlink" title="âœ… å›¾ç¤ºè®°å¿†æ³•"></a>âœ… å›¾ç¤ºè®°å¿†æ³•</h2><ul>
<li><code>A</code> è¡¨åœ¨å·¦è¾¹ï¼Œ<code>B</code> è¡¨åœ¨å³è¾¹ï¼š</li>
</ul>
<pre><code class="css">    INNER JOINï¼š     A âˆ© B
    LEFT JOINï¼š      A âŸ• B
    RIGHT JOINï¼š     A âŸ– B
    FULL JOINï¼š      A âˆª B
</code></pre>
<h2 id="âœ…-å®é™…åº”ç”¨å»ºè®®"><a href="#âœ…-å®é™…åº”ç”¨å»ºè®®" class="headerlink" title="âœ… å®é™…åº”ç”¨å»ºè®®"></a>âœ… å®é™…åº”ç”¨å»ºè®®</h2><table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>æ¨èè¿æ¥æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td>è·å–åŒ¹é…æ•°æ®</td>
<td>INNER JOIN</td>
</tr>
<tr>
<td><strong>ä¸»è¡¨å¿…é¡»å±•ç¤ºï¼Œè¾…è¡¨å¯æ— </strong></td>
<td><strong>LEFT JOIN</strong></td>
</tr>
<tr>
<td>è¾…è¡¨å¿…é¡»å±•ç¤ºï¼Œä¸»è¡¨å¯æ— </td>
<td>RIGHT JOIN</td>
</tr>
<tr>
<td>æ•°æ®å¯¹è´¦&#x2F;å·®å¼‚æ¯”å¯¹&#x2F;å…¨é‡æ±‡æ€»</td>
<td>FULL OUTER JOIN</td>
</tr>
</tbody></table>
<p>å†…è¿æ¥åªè¿”å›æ»¡è¶³æ¡ä»¶çš„äº¤é›†æ•°æ®ï¼Œå¤–è¿æ¥ç”¨äºä¿ç•™æŸä¸€è¾¹æˆ–ä¸¤è¾¹çš„æ‰€æœ‰è®°å½•ã€‚å¸¸ç”¨çš„æ˜¯å·¦å¤–è¿æ¥ï¼Œé€‚åˆä¸»è¡¨ä¸ºä¸»ã€è¾…è¡¨ä¸ºè¾…çš„åœºæ™¯ã€‚å¤–è¿æ¥æ¯”å†…è¿æ¥æ›´å…¨ï¼Œä½†æ€§èƒ½ç•¥ä½ï¼Œå› æ­¤å»ºè®®æ ¹æ®ä¸šåŠ¡åœºæ™¯åˆç†é€‰æ‹©ã€‚</p>
</blockquote>
<h4 id="è‡ªæˆ‘ä»‹ç»"><a href="#è‡ªæˆ‘ä»‹ç»" class="headerlink" title="è‡ªæˆ‘ä»‹ç»"></a>è‡ªæˆ‘ä»‹ç»</h4><p>xxx</p>
<h4 id="ä½ è§‰å¾—å­¦ä¹ æˆ‘ä»¬è¿™äº›æŠ€æœ¯æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ"><a href="#ä½ è§‰å¾—å­¦ä¹ æˆ‘ä»¬è¿™äº›æŠ€æœ¯æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä½ è§‰å¾—å­¦ä¹ æˆ‘ä»¬è¿™äº›æŠ€æœ¯æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ?"></a>ä½ è§‰å¾—å­¦ä¹ æˆ‘ä»¬è¿™äº›æŠ€æœ¯æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆ?</h4><p>é¦–å…ˆè¦æ¸…æ¥š**<u>è¿™ä¸ªæŠ€æœ¯æ˜¯è§£å†³ä»€ä¹ˆé¢†åŸŸçš„é—®é¢˜</u>**ï¼Œå­¦ä¹ æŠ€æœ¯å¾ˆå¤šæ–¹é¢éƒ½æ˜¯ç”¨æ¥æœåŠ¡ä¸šåŠ¡çš„ï¼Œç»“åˆå®é™…ä¸šåŠ¡æ¥å­¦ä¹ æŠ€æœ¯èåˆæ€§ä¼šæ›´å¼º</p>
<h4 id="æŠ€æœ¯æ ˆæœ‰äº›ä¸åŒï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡æ¢æ–¹å‘å‘å±•"><a href="#æŠ€æœ¯æ ˆæœ‰äº›ä¸åŒï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡æ¢æ–¹å‘å‘å±•" class="headerlink" title="æŠ€æœ¯æ ˆæœ‰äº›ä¸åŒï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡æ¢æ–¹å‘å‘å±•?"></a>æŠ€æœ¯æ ˆæœ‰äº›ä¸åŒï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡æ¢æ–¹å‘å‘å±•?</h4><p>æ²¡é—®é¢˜çš„ å› ä¸ºæŠ€æœ¯æ˜¯ç›¸é€šçš„ å¯ä»¥å»å­¦æ–°æŠ€æœ¯</p>
<h3 id="ThreadLocalç›¸å…³é¢è¯•é¢˜"><a href="#ThreadLocalç›¸å…³é¢è¯•é¢˜" class="headerlink" title="ThreadLocalç›¸å…³é¢è¯•é¢˜"></a>ThreadLocalç›¸å…³é¢è¯•é¢˜</h3><h5 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.æ¦‚è¿°"></a>1.æ¦‚è¿°</h5><p>ThreadLocal(å®šä¹‰å…¨å±€é™æ€å˜é‡ é¡¹ç›®ä¸­å…±ç”¨)æ˜¯Javaä¸­çš„ä¸€ä¸ªçº¿ç¨‹å±€éƒ¨å˜é‡å·¥å…·ç±»ï¼Œå®ƒæä¾›äº†ä¸€ç§åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹è®¿é—®è‡ªå·±çš„å˜é‡å‰¯æœ¬çš„æœºåˆ¶ã€‚ThreadLocalä¸­å­˜å‚¨çš„æ•°æ®å¯¹äºæ¯ä¸ªçº¿ç¨‹æ¥è¯´éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<h5 id="2-ä½¿ç”¨åœºæ™¯"><a href="#2-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2. ä½¿ç”¨åœºæ™¯"></a>2. ä½¿ç”¨åœºæ™¯</h5><p>ThreadLocalé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œéœ€è¦ä¿æŒçº¿ç¨‹å®‰å…¨æ€§çš„æ•°æ®è®¿é—®ã€‚</li>
<li>éœ€è¦åœ¨å¤šä¸ªæ–¹æ³•ä¹‹é—´å…±äº«æ•°æ®ï¼Œä½†åˆä¸å¸Œæœ›ä½¿ç”¨ä¼ é€’å‚æ•°çš„æ–¹å¼ã€‚<ul>
<li>åœ¨ä¼ é€’ç™»å½•ç”¨æˆ·idæ˜¯éå¸¸æ–¹ä¾¿ä¸”é€‚ç”¨</li>
</ul>
</li>
</ul>
<p><strong>ä»¥åè·å–ç”¨æˆ·idä¸ç”¨å†è§£ætokenäº†ï¼Œçº¿ç¨‹æ‹¿ä»…ä»…æ‹¿å½“å‰çº¿ç¨‹çš„æ•°æ® æ¯ä¸ªç™»å½•çš„ç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„threadlocalæ•°æ®</strong></p>
<p><strong>ThreadLocal</strong>å¹¶ä¸æ˜¯ä¸€ä¸ªThreadï¼Œ<strong>è€Œæ˜¯Threadçš„å±€éƒ¨å˜é‡</strong>ã€å¯ä»¥å­˜å‚¨æ•°æ®ã€‘<br>ThreadLocal<strong>ä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›å•ç‹¬ä¸€ä»½å­˜å‚¨ç©ºé—´</strong>ï¼Œå…·æœ‰çº¿ç¨‹éš”ç¦»çš„æ•ˆæœï¼Œåªæœ‰åœ¨çº¿ç¨‹å†…æ‰èƒ½è·å–åˆ°å¯¹åº”çš„å€¼ï¼Œçº¿ç¨‹å¤–åˆ™ä¸èƒ½è®¿é—®ã€‚**<u>ThreadLocalå®ç°ä¸€ä¸ªçº¿ç¨‹å†…ä¼ é€’æ•°æ®</u>**[å°±ä¸ç”¨ä¸€ä¸ªä¸ªå‚æ•°å¾€åä¼ é€’äº†]<br>æ³¨æ„ï¼šå®¢æˆ·ç«¯å‘é€çš„æ¯æ¬¡è¯·æ±‚ï¼Œåç«¯çš„tomcatæœåŠ¡å™¨éƒ½ä¼šåˆ†é…ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚</p>
<ul>
<li><strong><u>ä¸€ä¸ªè¯·æ±‚æ˜¯ä¸€ä¸ªçº¿ç¨‹</u></strong>[æ„ä¹‰ï¼šåœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹é‡Œé¢ä½¿ç”¨ThreadLocalå­˜å‚¨ç”¨æˆ·Id åœ¨åé¢controlleræˆ–serviceä¸­å°±å¯ä»¥å–å‡ºæ¥ç”¨æˆ·id]</li>
<li>ç¬¬äºŒä¸ªè¯·æ±‚å°±æ˜¯å¦ä¸€ä¸ªçº¿ç¨‹ çº¿ç¨‹æ± ç”¨å®Œç¬¬ä¸€ä¸ªæ”¾å›çº¿ç¨‹æ±  ä¹Ÿæœ‰å¯èƒ½æŠŠä¸Šä¸€ä¸ªçº¿ç¨‹æ¥ç€ç»™å®ƒç”¨</li>
</ul>
<p><code>postHandle </code>åªæœ‰åœ¨æ­£ç¡®è°ƒç”¨è¿”å›æ‰ä¼šå¼•ç”¨ å¦‚æœæŠ›å‡ºå¼‚å¸¸åˆ™ä¸ä¼šä½¿ç”¨<br><code>afterCompletion </code>æ— è®ºæ€æ ·æœ€åéƒ½è¦è¿è¡Œ</p>
<h4 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h4><h6 id="3-1-åˆ›å»ºThreadLocalå¯¹è±¡"><a href="#3-1-åˆ›å»ºThreadLocalå¯¹è±¡" class="headerlink" title="3.1 åˆ›å»ºThreadLocalå¯¹è±¡"></a>3.1 åˆ›å»ºThreadLocalå¯¹è±¡</h6><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªThreadLocalå¯¹è±¡æ¥å­˜å‚¨çº¿ç¨‹å±€éƒ¨å˜é‡ã€‚å¯ä»¥ä½¿ç”¨ThreadLocalçš„é»˜è®¤æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚ã€ç»™æ¯ä¸ªçº¿ç¨‹æ‹·è´ä¸€ä»½ synchn + Locké”ã€‘</p>
<pre><code class="Java">ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;&gt;();
</code></pre>
<h6 id="3-2-è®¾ç½®çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼"><a href="#3-2-è®¾ç½®çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼" class="headerlink" title="3.2 è®¾ç½®çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼"></a>3.2 è®¾ç½®çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼</h6><p>ä½¿ç”¨<code>set()</code>æ–¹æ³•å¯ä»¥è®¾ç½®å½“å‰çº¿ç¨‹çš„å±€éƒ¨å˜é‡çš„å€¼ã€‚</p>
<pre><code class="Java">threadLocal.set(&quot;value&quot;);
</code></pre>
<h6 id="3-3-è·å–çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼"><a href="#3-3-è·å–çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼" class="headerlink" title="3.3 è·å–çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼"></a>3.3 è·å–çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼</h6><p>ä½¿ç”¨<code>get()</code>æ–¹æ³•å¯ä»¥è·å–å½“å‰çº¿ç¨‹çš„å±€éƒ¨å˜é‡çš„å€¼ã€‚</p>
<pre><code class="Java">String value = threadLocal.get();
</code></pre>
<h6 id="3-4-æ¸…é™¤çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼"><a href="#3-4-æ¸…é™¤çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼" class="headerlink" title="3.4 æ¸…é™¤çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼"></a>3.4 æ¸…é™¤çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼</h6><p>ä½¿ç”¨<code>remove()</code>æ–¹æ³•å¯ä»¥æ¸…é™¤å½“å‰çº¿ç¨‹çš„å±€éƒ¨å˜é‡çš„å€¼ï¼Œå»ºè®®åœ¨æ•´ä¸ªè¯·æ±‚ä½¿ç”¨å®Œä¸€å®šè¦æ‰§è¡Œremoveæ¸…é™¤æ•°æ®ï¼Œä¸ç„¶å¯èƒ½ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼é—®é¢˜ã€‚</p>
<pre><code class="Java">threadLocal.remove();
</code></pre>
<h6 id="ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ThreadLocalã€‚"><a href="#ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ThreadLocalã€‚" class="headerlink" title="ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ThreadLocalã€‚"></a>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ThreadLocalã€‚</h6><pre><code class="Java">public class ThreadLocalTest &#123;

    private static final ThreadLocal THREAD_LOCAL = new ThreadLocal();

    public static void main(String[] args) &#123;

        Thread t1 = new Thread(() -&gt; &#123;
            THREAD_LOCAL.set(&quot;itheima&quot;);// å†™å…¥çº¿ç¨‹æœ¬åœ°å˜é‡
            getData(&quot;t1&quot;);// è¯»å–çº¿ç¨‹æœ¬åœ°å˜é‡
        &#125;, &quot;t1&quot;);

        Thread t2 = new Thread(() -&gt; &#123;
            THREAD_LOCAL.set(&quot;itcast&quot;);// å†™å…¥çº¿ç¨‹æœ¬åœ°å˜é‡
            getData(&quot;t2&quot;);// è¯»å–çº¿ç¨‹æœ¬åœ°å˜é‡
        &#125;, &quot;t2&quot;);

        t1.start();
        t2.start();

    &#125;

    private static void getData(String threadName)&#123;
        Object data = THREAD_LOCAL.get();
        System.out.println(threadName+&quot;-&quot;+data);
    &#125;
&#125;
</code></pre>
<p>è¿è¡Œä»¥ä¸Šä»£ç ï¼Œè¾“å‡ºç»“æœä¸ºï¼š</p>
<pre><code class="Plain">t1-itheima
t2-itcast
</code></pre>
<p>åœ¨ä»»æ„ä½ç½®éƒ½å¯ä»¥è°ƒç”¨Threadlocalï¼Œçº¿ç¨‹éš”ç¦»äº’ä¸å½±å“ï¼Œè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š[æ¯ä¸ªçº¿ç¨‹å­˜ä¸€ä»½ çº¿ç¨‹ä¸å…±äº«]</p>
<p>ç”¨mybatis+å»ºé€ è€…æ¨¡å¼ ä¸€å®šè¦åœ¨ç±»é‡Œé¢åŠ  ä¸€å®šè¦å…·æœ‰æœ‰å‚å’Œæ— å‚æ„é€ ç¼ºä¸€ä¸å¯ å¦åˆ™mybatisæ•°æ®å°è£…æ— æ³•æ˜ å°„<br>@AllArgsConstructor<br>@NoArgsConstructor<br>@Builder</p>
<h4 id="å­—ç¬¦å’Œå­—ç¬¦ä¸²ç±»å‹çš„åŒºåˆ«"><a href="#å­—ç¬¦å’Œå­—ç¬¦ä¸²ç±»å‹çš„åŒºåˆ«" class="headerlink" title="å­—ç¬¦å’Œå­—ç¬¦ä¸²ç±»å‹çš„åŒºåˆ«"></a>å­—ç¬¦å’Œå­—ç¬¦ä¸²ç±»å‹çš„åŒºåˆ«</h4><p>å­—ç¬¦æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ æ²¡æœ‰null ç”¨å•å¼•å·<br>å­—ç¬¦ä¸²æ˜¯å¼•ç”¨æ•°æ®ç±»å‹[ä¸€ä¸ªç±»] ç”¨åŒå¼•å·</p>
<p><img src="C:\Users\Pluminary\AppData\Roaming\Typora\typora-user-images\image-20250102142357092.png" alt="image-20250102142357092"></p>
<h4 id="æ“ä½œå­—ç¬¦ä¸²çš„å·¥å…·ç±»æ˜¯ä»€ä¹ˆ"><a href="#æ“ä½œå­—ç¬¦ä¸²çš„å·¥å…·ç±»æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ“ä½œå­—ç¬¦ä¸²çš„å·¥å…·ç±»æ˜¯ä»€ä¹ˆ"></a>æ“ä½œå­—ç¬¦ä¸²çš„å·¥å…·ç±»æ˜¯ä»€ä¹ˆ</h4><p>apacheçš„commonæä¾›çš„String Utilså·¥å…·ç±»ï¼Œhutoolä¹Ÿæœ‰String Utils</p>
<blockquote>
<h2 id="å­—ç¬¦ä¸²å·¥å…·ç±»"><a href="#å­—ç¬¦ä¸²å·¥å…·ç±»" class="headerlink" title="å­—ç¬¦ä¸²å·¥å…·ç±»"></a><strong>å­—ç¬¦ä¸²å·¥å…·ç±»</strong></h2><table>
<thead>
<tr>
<th>å·¥å…·ç±»åº“</th>
<th>ç±»å</th>
<th>è¯´æ˜ä¸ç‰¹ç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td>Apache Commons</td>
<td><code>StringUtils</code> (<code>org.apache.commons.lang3.StringUtils</code>)</td>
<td>æä¾›äº†å¤§é‡å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚<code>isBlank()</code>ã€<code>join()</code>ã€<code>split()</code>ã€<code>contains()</code>ç­‰ã€‚éå¸¸ç¨³å®šã€åŠŸèƒ½å¼ºå¤§ã€‚</td>
</tr>
<tr>
<td>Hutool</td>
<td><code>StrUtil</code> (<code>cn.hutool.core.util.StrUtil</code>)</td>
<td>è½»é‡çº§å·¥å…·åŒ…ï¼ŒåŠŸèƒ½ç±»ä¼¼ï¼Œä½†æ›´åŠ é¢å‘å›½äººå¼€å‘ï¼ŒAPI å‘½åæ›´ç®€æ´æ¸…æ™°ï¼Œå¦‚ <code>isBlank()</code>ã€<code>format()</code>ã€<code>hide()</code>ç­‰ã€‚</td>
</tr>
<tr>
<td>Java è‡ªå¸¦</td>
<td><code>String</code> ç±»å’Œ <code>StringBuilder</code>, <code>StringBuffer</code></td>
<td>æä¾›åŸºç¡€å­—ç¬¦ä¸²æ“ä½œï¼Œå¦‚ <code>substring()</code>ã€<code>indexOf()</code>ã€<code>replace()</code> ç­‰ã€‚</td>
</tr>
</tbody></table>
<p><strong>æ¨èï¼š</strong>å¼€å‘ä¸­å¯ä»¥ç»“åˆä½¿ç”¨ <code>Apache StringUtils</code> æˆ– <code>Hutool StrUtil</code>ï¼Œæ¯”è‡ªå·±å†™å­—ç¬¦ä¸²åˆ¤æ–­é«˜æ•ˆä¸”å¯è¯»æ€§å¥½ã€‚</p>
<h2 id="âœ…-1-ç”¨æˆ·æ³¨å†Œæ ¡éªŒ-â€”-Apache-Commons-StringUtils"><a href="#âœ…-1-ç”¨æˆ·æ³¨å†Œæ ¡éªŒ-â€”-Apache-Commons-StringUtils" class="headerlink" title="âœ… 1. ç”¨æˆ·æ³¨å†Œæ ¡éªŒ â€” Apache Commons StringUtils"></a>âœ… <strong>1. ç”¨æˆ·æ³¨å†Œæ ¡éªŒ â€” Apache Commons <code>StringUtils</code></strong></h2><p><strong>ä¸šåŠ¡èƒŒæ™¯ï¼š</strong> ç”¨æˆ·æ³¨å†Œæ—¶ï¼Œéœ€è¦æ ¡éªŒç”¨æˆ·åå’Œé‚®ç®±ä¸èƒ½ä¸º null æˆ–ç©ºå­—ç¬¦ä¸²ã€‚</p>
<pre><code class="java">import org.apache.commons.lang3.StringUtils;

public class UserService &#123;
    public boolean isValidUser(String username, String email) &#123;
        return StringUtils.isNotBlank(username) &amp;&amp; StringUtils.isNotBlank(email);
    &#125;
&#125;
</code></pre>
<h3 id="ğŸ“Œ-ä¼˜åŠ¿è¯´æ˜ï¼š"><a href="#ğŸ“Œ-ä¼˜åŠ¿è¯´æ˜ï¼š" class="headerlink" title="ğŸ“Œ ä¼˜åŠ¿è¯´æ˜ï¼š"></a>ğŸ“Œ ä¼˜åŠ¿è¯´æ˜ï¼š</h3><ul>
<li><code>StringUtils.isNotBlank()</code> èƒ½åˆ¤æ–­ nullã€ç©ºå­—ç¬¦ä¸²ã€å…¨æ˜¯ç©ºæ ¼çš„å­—ç¬¦ä¸²ã€‚</li>
<li>æ›¿ä»£äº†ä¼ ç»Ÿçš„ <code>&quot;&quot;.equals(x) || x == null || x.trim().length() == 0</code>ï¼Œç®€æ´é«˜æ•ˆã€‚</li>
</ul>
<hr>
<h2 id="âœ…-2-æ˜µç§°è„±æ•å±•ç¤º-â€”-Hutool-StrUtil"><a href="#âœ…-2-æ˜µç§°è„±æ•å±•ç¤º-â€”-Hutool-StrUtil" class="headerlink" title="âœ… 2. æ˜µç§°è„±æ•å±•ç¤º â€” Hutool StrUtil"></a>âœ… <strong>2. æ˜µç§°è„±æ•å±•ç¤º â€” Hutool <code>StrUtil</code></strong></h2><p><strong>ä¸šåŠ¡èƒŒæ™¯ï¼š</strong> ç”¨æˆ·ä¸­å¿ƒé¡µé¢è¦å±•ç¤ºè„±æ•åçš„æ˜µç§°ï¼Œå¦‚ <code>å¼ ä¸‰ä¸°</code> â†’ <code>å¼ *ä¸°</code>ã€‚</p>
<pre><code class="java">import cn.hutool.core.util.StrUtil;

public class UserUtil &#123;
    public static String desensitizeName(String name) &#123;
        return StrUtil.hide(name, 1, name.length() - 1); // ä»ç¬¬2ä½åˆ°å€’æ•°ç¬¬1ä½éšè—
    &#125;
&#125;
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="java">System.out.println(desensitizeName(&quot;å¼ ä¸‰ä¸°&quot;)); // å¼ *ä¸°
</code></pre>
<h3 id="ğŸ“Œ-ä¼˜åŠ¿è¯´æ˜ï¼š-1"><a href="#ğŸ“Œ-ä¼˜åŠ¿è¯´æ˜ï¼š-1" class="headerlink" title="ğŸ“Œ ä¼˜åŠ¿è¯´æ˜ï¼š"></a>ğŸ“Œ ä¼˜åŠ¿è¯´æ˜ï¼š</h3><ul>
<li><code>StrUtil.hide()</code> éå¸¸é€‚åˆåšæ•°æ®è„±æ•å¤„ç†ï¼ˆèº«ä»½è¯ã€æ‰‹æœºå·ç­‰ï¼‰ã€‚</li>
<li>API ç›´è§‚æ˜“ç”¨ï¼Œæ— éœ€è‡ªå·±å†™ substring æ‹¼æ¥é€»è¾‘ã€‚</li>
</ul>
<hr>
<h2 id="âœ…-3-SQLæ‹¼æ¥æˆ–æ—¥å¿—æ‰“å°-â€”-Java-åŸç”Ÿ-StringBuilder"><a href="#âœ…-3-SQLæ‹¼æ¥æˆ–æ—¥å¿—æ‰“å°-â€”-Java-åŸç”Ÿ-StringBuilder" class="headerlink" title="âœ… 3. SQLæ‹¼æ¥æˆ–æ—¥å¿—æ‰“å° â€” Java åŸç”Ÿ StringBuilder"></a>âœ… <strong>3. SQLæ‹¼æ¥æˆ–æ—¥å¿—æ‰“å° â€” Java åŸç”Ÿ <code>StringBuilder</code></strong></h2><p><strong>ä¸šåŠ¡èƒŒæ™¯ï¼š</strong> æ‹¼æ¥ä¸€æ®µå¤æ‚ SQL æˆ–å¤šå­—æ®µæ—¥å¿—è¾“å‡ºã€‚</p>
<pre><code class="java">public class LogBuilder &#123;
    public static String buildLog(String userId, String action, long timestamp) &#123;
        StringBuilder sb = new StringBuilder();
        sb.append(&quot;ç”¨æˆ·ID: &quot;).append(userId)
          .append(&quot;, æ“ä½œ: &quot;).append(action)
          .append(&quot;, æ—¶é—´: &quot;).append(timestamp);
        return sb.toString();
    &#125;
&#125;
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="java">ç”¨æˆ·ID: 123456, æ“ä½œ: ç™»å½•, æ—¶é—´: 1721559065000
</code></pre>
<h3 id="ğŸ“Œ-ä¼˜åŠ¿è¯´æ˜ï¼š-2"><a href="#ğŸ“Œ-ä¼˜åŠ¿è¯´æ˜ï¼š-2" class="headerlink" title="ğŸ“Œ ä¼˜åŠ¿è¯´æ˜ï¼š"></a>ğŸ“Œ ä¼˜åŠ¿è¯´æ˜ï¼š</h3><ul>
<li><code>StringBuilder</code> é€‚åˆå¾ªç¯ä¸­æˆ–å¤§é‡å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ€§èƒ½æ¯” <code>+</code> æ›´ä¼˜ã€‚</li>
<li>é€šå¸¸ç”¨äºæ—¥å¿—ã€SQLã€é€šçŸ¥ä¿¡æ¯æ„å»ºç­‰åœºæ™¯ã€‚</li>
</ul>
</blockquote>
<h4 id="å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«"><a href="#å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«" class="headerlink" title="å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«"></a>å±€éƒ¨å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«</h4><p><strong>æˆå‘˜å˜é‡</strong>æ˜¯åœ¨jvmçš„<strong>å †</strong><br><strong>å±€éƒ¨å˜é‡</strong>æ˜¯åœ¨jvmçš„<strong>æ ˆ</strong><br>åŸºæœ¬æ•°æ®ç±»å‹çš„å¼•ç”¨ç±»å‹ ç±»åœ¨å †<br>åŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡åœ¨å † éé™æ€åœ¨å † é™æ€å˜é‡åœ¨æ–¹æ³•åŒº<br>å¼•ç”¨ç±»å‹ æ— è®ºé™æ€è¿˜æ˜¯éé™æ€æˆå‘˜å˜é‡éƒ½åœ¨å †åŒº</p>
<p>å±€éƒ¨å˜é‡æ˜¯åœ¨æ–¹æ³•æˆ–ä»£ç å—å†…éƒ¨å£°æ˜çš„å˜é‡ï¼Œå…¶ä½œç”¨åŸŸä»…é™äºå£°æ˜å®ƒçš„æ–¹æ³•æˆ–ä»£ç å—<br>å±€éƒ¨å˜é‡ä¸èƒ½è¢«staticä¿®é¥°<br>å±€éƒ¨å˜é‡å¿…é¡»è¢«åˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨</p>
<p>æˆå‘˜å˜é‡æ˜¯åœ¨ç±»å†…éƒ¨å£°æ˜çš„å˜é‡ï¼Œå…¶ä½œç”¨åŸŸæ˜¯æ•´ä¸ªç±»<br>æˆå‘˜å˜é‡å¯ä»¥è¢«staticä¿®é¥°<br>æˆå‘˜å˜é‡æœ‰é»˜è®¤å€¼</p>
<pre><code class="java">public class VariableDemo &#123;

    // æˆå‘˜å˜é‡
    int age = 18;              // éé™æ€æˆå‘˜å˜é‡ -&gt; å †ä¸­
    static String school = &quot;åŒ—å¤§&quot;; // é™æ€æˆå‘˜å˜é‡ -&gt; æ–¹æ³•åŒºä¸­

    public void printInfo() &#123;
        // å±€éƒ¨å˜é‡
        String name = &quot;å°æ˜&quot;;  // å±€éƒ¨å˜é‡ -&gt; æ ˆä¸­
        int age = 20;          // å±€éƒ¨å˜é‡ï¼Œå’Œæˆå‘˜å˜é‡é‡åï¼ˆå°±è¿‘åŸåˆ™ï¼‰

        System.out.println(&quot;å±€éƒ¨å˜é‡ nameï¼š&quot; + name); // å°æ˜
        System.out.println(&quot;å±€éƒ¨å˜é‡ ageï¼š&quot; + age);   // 20
        System.out.println(&quot;æˆå‘˜å˜é‡ ageï¼š&quot; + this.age); // 18ï¼ˆç”¨thisè®¿é—®æˆå‘˜å˜é‡ï¼‰
        System.out.println(&quot;é™æ€å˜é‡ schoolï¼š&quot; + school); // åŒ—å¤§
    &#125;

    public static void main(String[] args) &#123;
        VariableDemo v = new VariableDemo();
        v.printInfo();
    &#125;
&#125;
------------------------------------------------------------------------
JVM å†…å­˜ç»“æ„ï¼š

æ–¹æ³•åŒºï¼ˆå­˜æ”¾ç±»ä¿¡æ¯ã€é™æ€å˜é‡ç­‰ï¼‰
â””â”€â”€ VariableDemo.class
     â””â”€â”€ static school = &quot;åŒ—å¤§&quot;

å †å†…å­˜ï¼ˆå­˜æ”¾å¯¹è±¡å’Œéé™æ€æˆå‘˜å˜é‡ï¼‰
â””â”€â”€ v å¯¹è±¡
     â””â”€â”€ age = 18

æ ˆå†…å­˜ï¼ˆæ¯ä¸ªçº¿ç¨‹çš„æ ˆå¸§ï¼‰
â””â”€â”€ main() æ ˆå¸§
     â””â”€â”€ v å¼•ç”¨

â””â”€â”€ printInfo() æ ˆå¸§
     â”œâ”€â”€ name = &quot;å°æ˜&quot;
     â”œâ”€â”€ age = 20 ï¼ˆå±€éƒ¨å˜é‡ï¼‰
</code></pre>
<h4 id="ä½ ç¼–å†™å®Œä»£ç ï¼Œå†™å®Œè¿™ä¸ªåŠŸèƒ½åï¼Œä¼šè¿›è¡Œä»€ä¹ˆæ“ä½œå‘¢"><a href="#ä½ ç¼–å†™å®Œä»£ç ï¼Œå†™å®Œè¿™ä¸ªåŠŸèƒ½åï¼Œä¼šè¿›è¡Œä»€ä¹ˆæ“ä½œå‘¢" class="headerlink" title="ä½ ç¼–å†™å®Œä»£ç ï¼Œå†™å®Œè¿™ä¸ªåŠŸèƒ½åï¼Œä¼šè¿›è¡Œä»€ä¹ˆæ“ä½œå‘¢"></a>ä½ ç¼–å†™å®Œä»£ç ï¼Œå†™å®Œè¿™ä¸ªåŠŸèƒ½åï¼Œä¼šè¿›è¡Œä»€ä¹ˆæ“ä½œå‘¢</h4><p>è¿›è¡Œ<strong>ä»£ç å®¡æŸ¥</strong>ï¼Œæ£€æŸ¥ä»£ç æ˜¯å¦ç¬¦åˆç¼–ç è§„èŒƒå’Œè®¾è®¡è¦æ±‚ã€‚</p>
<ul>
<li>è¿›è¡Œ<strong>å•å…ƒæµ‹è¯•</strong>ï¼Œç¡®ä¿ä»£ç çš„åŠŸèƒ½æ­£ç¡®æ— è¯¯ã€‚</li>
<li>è¿›è¡Œ<strong>ä»£ç ä¼˜åŒ–</strong>ï¼Œæé«˜ä»£ç çš„æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚</li>
<li>ä¸å›¢é˜Ÿæˆå‘˜è¿›è¡Œä»£ç åˆå¹¶ï¼Œç¡®ä¿ä»£ç çš„é›†æˆã€‚</li>
<li>ç¼–å†™æ–‡æ¡£ï¼Œè®°å½•åŠŸèƒ½å®ç°å’Œä»£ç å˜æ›´ã€‚</li>
</ul>
<h4 id="ä¸Šä¸€å®¶å…¬å¸çš„è–ªèµ„æ˜¯å¤šå°‘ï¼ŸæœŸæœ›è–ªèµ„æ˜¯å¤šå°‘ï¼Ÿä¸Šä¸€å®¶è¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„ç¦åˆ©å—ï¼Ÿ"><a href="#ä¸Šä¸€å®¶å…¬å¸çš„è–ªèµ„æ˜¯å¤šå°‘ï¼ŸæœŸæœ›è–ªèµ„æ˜¯å¤šå°‘ï¼Ÿä¸Šä¸€å®¶è¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„ç¦åˆ©å—ï¼Ÿ" class="headerlink" title="ä¸Šä¸€å®¶å…¬å¸çš„è–ªèµ„æ˜¯å¤šå°‘ï¼ŸæœŸæœ›è–ªèµ„æ˜¯å¤šå°‘ï¼Ÿä¸Šä¸€å®¶è¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„ç¦åˆ©å—ï¼Ÿ"></a>ä¸Šä¸€å®¶å…¬å¸çš„è–ªèµ„æ˜¯å¤šå°‘ï¼ŸæœŸæœ›è–ªèµ„æ˜¯å¤šå°‘ï¼Ÿä¸Šä¸€å®¶è¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„ç¦åˆ©å—ï¼Ÿ</h4><p>æœŸæœ›è–ªèµ„ï¼š<br>äº†è§£è¿‡å¹¿ä¸œè¿™è¾¹çš„å¸‚åœº æˆ‘æƒ³æ¢å·¥ä½œæƒ³æ¶¨è–ª10~20%<br>èŠ‚å‡æ—¥ä¼šå‘æ”¾ç¤¼å“å’Œç¦åˆ©</p>
<h4 id="å¯ä»¥æ¥å—ä½ä»£ç å¹³å°å—ï¼Ÿ"><a href="#å¯ä»¥æ¥å—ä½ä»£ç å¹³å°å—ï¼Ÿ" class="headerlink" title="å¯ä»¥æ¥å—ä½ä»£ç å¹³å°å—ï¼Ÿ"></a>å¯ä»¥æ¥å—ä½ä»£ç å¹³å°å—ï¼Ÿ</h4><p>å¯ä»¥æ¥å—<br>ä½ä»£ç å¹³å°ï¼šç±»è‹¥ä¾</p>
<h4 id="å…·ä½“è¯´è¯´Javaé¢å‘å¯¹è±¡"><a href="#å…·ä½“è¯´è¯´Javaé¢å‘å¯¹è±¡" class="headerlink" title="å…·ä½“è¯´è¯´Javaé¢å‘å¯¹è±¡"></a>å…·ä½“è¯´è¯´Javaé¢å‘å¯¹è±¡</h4><p>Javaé¢å‘å¯¹è±¡æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œ<strong>å®ƒå°†ç°å®ä¸–ç•Œçš„äº‹ç‰©æŠ½è±¡æˆç¨‹åºä¸­çš„å¯¹è±¡</strong>ã€‚Javaé¢å‘å¯¹è±¡çš„ä¸»è¦ç‰¹å¾åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å°è£…</strong>ï¼šå°†å¯¹è±¡çš„<strong>å±æ€§</strong>å’Œ<strong>è¡Œä¸º</strong>å°è£…åœ¨ä¸€èµ·ï¼Œå¯¹å¤–åªæš´éœ²å¿…è¦çš„æ¥å£ï¼Œéšè—å†…éƒ¨å®ç°ç»†èŠ‚ã€‚</li>
<li><strong>ç»§æ‰¿</strong>ï¼šå…è®¸<strong>å­ç±»ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œè¡Œä¸º</strong>ï¼Œå®ç°ä»£ç çš„å¤ç”¨ã€‚</li>
<li><strong>å¤šæ€</strong>ï¼š<strong>åŒä¸€ä¸ªæ¥å£å¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„å®ç°</strong>ï¼Œé€šè¿‡å¯¹è±¡çš„ç±»å‹å’Œæ–¹æ³•çš„è°ƒç”¨ï¼Œå®ç°ä¸åŒçš„åŠŸèƒ½ã€‚</li>
</ul>
<h4 id="x3D-x3D-å’Œ-equals-çš„åŒºåˆ«"><a href="#x3D-x3D-å’Œ-equals-çš„åŒºåˆ«" class="headerlink" title="&#x3D;&#x3D; å’Œ equals çš„åŒºåˆ«"></a>&#x3D;&#x3D; å’Œ equals çš„åŒºåˆ«</h4><ul>
<li>&#x3D;&#x3D;ï¼šæ¯”è¾ƒ<strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>æ—¶ï¼Œæ¯”è¾ƒçš„æ˜¯<strong>å€¼</strong>ï¼›æ¯”è¾ƒ<strong>å¼•ç”¨æ•°æ®ç±»å‹</strong>æ—¶ï¼Œæ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„<strong>å†…å­˜åœ°å€</strong>ã€‚</li>
<li>equalsï¼šæ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œ<strong>é»˜è®¤æ¯”è¾ƒ</strong>çš„æ˜¯<strong>å¯¹è±¡çš„å†…å­˜åœ°å€</strong>ã€‚ä½†åœ¨å¾ˆå¤šç±»ä¸­ï¼ˆå¦‚Stringã€Integerç­‰ï¼‰ï¼Œequalsæ–¹æ³•è¢«é‡å†™ï¼Œç”¨äºæ¯”è¾ƒå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚<br>æ²¡é‡å†™ å°±æ˜¯ &#x3D;&#x3D; æ¯”è¾ƒå¯¹è±¡åœ°å€ã€‚é‡å†™è¿‡çš„è¯å°±æ¯”è¾ƒå¯¹è±¡çš„å€¼ã€‚</li>
</ul>
<h4 id="æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Œæ•´ä¸ªç³»ç»Ÿçš„æƒé™"><a href="#æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Œæ•´ä¸ªç³»ç»Ÿçš„æƒé™" class="headerlink" title="æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Œæ•´ä¸ªç³»ç»Ÿçš„æƒé™"></a>æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Œæ•´ä¸ªç³»ç»Ÿçš„æƒé™</h4><p>æœ‰è¿‡ SpringSecurity</p>
<h6 id="èƒ½å…·ä½“è¯´ä¸€ä¸‹æƒé™æ§åˆ¶æ€ä¹ˆåšï¼Ÿ"><a href="#èƒ½å…·ä½“è¯´ä¸€ä¸‹æƒé™æ§åˆ¶æ€ä¹ˆåšï¼Ÿ" class="headerlink" title="èƒ½å…·ä½“è¯´ä¸€ä¸‹æƒé™æ§åˆ¶æ€ä¹ˆåšï¼Ÿ"></a>èƒ½å…·ä½“è¯´ä¸€ä¸‹æƒé™æ§åˆ¶æ€ä¹ˆåšï¼Ÿ</h6><p>ä½¿ç”¨RBACæ¨¡å‹ ä¸æ˜¯æŠŠç”¨æˆ·å…³è”èµ„æº è€Œæ˜¯ä¸­é—´åˆ©ç”¨è§’è‰²é—´æ¥å…³è”<br><u>ç”¨æˆ·+è§’è‰²+èµ„æº+ç”¨æˆ·è§’è‰²ä¸­é—´è¡¨+è§’è‰²èµ„æºä¸­é—´è¡¨<del>å¤šå¯¹å¤š</del></u></p>
<h6 id="SpringSecurity-å…·ä½“æ€ä¹ˆå®ç°"><a href="#SpringSecurity-å…·ä½“æ€ä¹ˆå®ç°" class="headerlink" title="SpringSecurity å…·ä½“æ€ä¹ˆå®ç°"></a>SpringSecurity å…·ä½“æ€ä¹ˆå®ç°</h6><p>æˆ‘çš„é¡¹ç›®æ˜¯åŸºäºJWTçš„å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œåœ¨è‡ªå®šä¹‰è®¤è¯ç®¡ç†å™¨<code>AuthenticationManager</code>è®¤è¯æˆåŠŸåï¼Œç”ŸæˆJWTä»¤ç‰Œå¹¶è¿”å›ç»™å‰ç«¯ã€‚å‰ç«¯åœ¨éšåçš„è¯·æ±‚ä¸­æºå¸¦è¿™ä¸ªJWTä»¤ç‰Œã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>AccessDecisionManager</code>æ¥å®ç°æ¥å£çš„é‰´æƒé€»è¾‘ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªcheckæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæ ¡éªŒJWTä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚å¦‚æœæ ¡éªŒé€šè¿‡ï¼Œå°±å»æŸ¥è¯¢æ•°æ®åº“ä»¥ç¡®å®šç”¨æˆ·æ‹¥æœ‰å“ªäº›æƒé™ã€‚åœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œå…¶æƒé™ä¿¡æ¯å·²ç»è¢«ç¼“å­˜åˆ°Redisä¸­ã€‚åç»­çš„è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»Redisä¸­æ£€ç´¢ç”¨æˆ·çš„æƒé™ä¿¡æ¯ã€‚å¦‚æœè¯·æ±‚çš„æ¥å£æƒé™ä¸ç”¨æˆ·ç¼“å­˜ä¸­çš„æƒé™åŒ¹é…ï¼Œåˆ™æ”¾è¡Œï¼›å¦‚æœä¸åŒ¹é…ï¼Œåˆ™è¿”å›ä¸€ä¸ªå‹å¥½çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<blockquote>
<h4 id="âœ…-æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Ÿ"><a href="#âœ…-æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Ÿ" class="headerlink" title="âœ… æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Ÿ"></a>âœ… <strong>æœ‰æ²¡æœ‰åšè¿‡æƒé™æ§åˆ¶ï¼Ÿ</strong></h4><p>æœ‰ï¼Œåœ¨é¡¹ç›®ä¸­æˆ‘ç”¨çš„æ˜¯ <strong>Spring Security + JWT</strong> çš„æƒé™æ§åˆ¶æ–¹æ¡ˆï¼Œæ•´ä½“åŸºäº <strong>RBAC æ¨¡å‹</strong>ï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰ã€‚</p>
<h4 id="âœ…-æƒé™æ¨¡å‹è®¾è®¡ï¼ˆRBACï¼‰"><a href="#âœ…-æƒé™æ¨¡å‹è®¾è®¡ï¼ˆRBACï¼‰" class="headerlink" title="âœ… æƒé™æ¨¡å‹è®¾è®¡ï¼ˆRBACï¼‰"></a>âœ… <strong>æƒé™æ¨¡å‹è®¾è®¡ï¼ˆRBACï¼‰</strong></h4><p><strong>æ ¸å¿ƒæ€è·¯ï¼šé€šè¿‡â€œè§’è‰²â€æ¥é—´æ¥ç®¡ç†ç”¨æˆ·æƒé™</strong></p>
<table>
<thead>
<tr>
<th>å®ä½“</th>
<th>å…³ç³»è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>ç”¨æˆ·ï¼ˆUserï¼‰</td>
<td>å…³è”å¤šä¸ªè§’è‰²ï¼ˆRoleï¼‰</td>
</tr>
<tr>
<td>è§’è‰²ï¼ˆRoleï¼‰</td>
<td>å…³è”å¤šä¸ªæƒé™&#x2F;èœå•ï¼ˆPermissionï¼‰</td>
</tr>
<tr>
<td>æƒé™ï¼ˆPermissionï¼‰</td>
<td>æè¿°èµ„æºï¼šèœå•ã€æ¥å£ç­‰</td>
</tr>
</tbody></table>
<p>ä¸­é—´è¡¨è®¾è®¡ï¼š</p>
<ul>
<li>ç”¨æˆ·è§’è‰²è¡¨ï¼ˆuser_roleï¼‰â†’ å¤šå¯¹å¤š</li>
<li>è§’è‰²æƒé™è¡¨ï¼ˆrole_permissionï¼‰â†’ å¤šå¯¹å¤š</li>
</ul>
<h2 id="âœ…-SpringSecurity-æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"><a href="#âœ…-SpringSecurity-æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ" class="headerlink" title="âœ… SpringSecurity æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ"></a>âœ… <span style = "color:red"><strong>SpringSecurity æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</strong></span></h2><p>é¡¹ç›®æ˜¯ <strong>å‰åç«¯åˆ†ç¦»</strong>ï¼Œä½¿ç”¨çš„æ˜¯ <strong>JWT æ— çŠ¶æ€è®¤è¯</strong>ã€‚</p>
<h3 id="1ï¸âƒ£-ç”¨æˆ·ç™»å½•è®¤è¯ï¼ˆAuthenticationManagerï¼‰"><a href="#1ï¸âƒ£-ç”¨æˆ·ç™»å½•è®¤è¯ï¼ˆAuthenticationManagerï¼‰" class="headerlink" title="1ï¸âƒ£ ç”¨æˆ·ç™»å½•è®¤è¯ï¼ˆAuthenticationManagerï¼‰"></a>1ï¸âƒ£ ç”¨æˆ·ç™»å½•è®¤è¯ï¼ˆ<code>AuthenticationManager</code>ï¼‰</h3><ul>
<li>ç”¨æˆ·ç™»å½•æäº¤è´¦å·å¯†ç  â†’ è°ƒç”¨ SpringSecurity çš„è®¤è¯é€»è¾‘</li>
<li>è®¤è¯é€šè¿‡åï¼Œç”Ÿæˆ <strong>JWT Token</strong> è¿”å›ç»™å‰ç«¯<del>å‰ç«¯åœ¨éšåçš„è¯·æ±‚ä¸­æºå¸¦è¿™ä¸ªJWTä»¤ç‰Œ</del></li>
<li>åŒæ—¶æŠŠ <strong>ç”¨æˆ·ä¿¡æ¯ + æƒé™ä¿¡æ¯</strong> ç¼“å­˜åœ¨ Redis ä¸­</li>
</ul>
<h3 id="2ï¸âƒ£-ç”¨æˆ·è¯·æ±‚é‰´æƒï¼ˆæ‹¦æˆª-æ ¡éªŒï¼‰"><a href="#2ï¸âƒ£-ç”¨æˆ·è¯·æ±‚é‰´æƒï¼ˆæ‹¦æˆª-æ ¡éªŒï¼‰" class="headerlink" title="2ï¸âƒ£ ç”¨æˆ·è¯·æ±‚é‰´æƒï¼ˆæ‹¦æˆª + æ ¡éªŒï¼‰"></a>2ï¸âƒ£ ç”¨æˆ·è¯·æ±‚é‰´æƒï¼ˆæ‹¦æˆª + æ ¡éªŒï¼‰</h3><p>ç”¨æˆ·æ¯æ¬¡è®¿é—®æ¥å£éƒ½å¸¦ä¸Š JWTï¼š<del>ä½¿ç”¨<code>AccessDecisionManager</code>æ¥å®ç°æ¥å£çš„é‰´æƒé€»è¾‘ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªcheckæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæ ¡éªŒJWTä»¤ç‰Œçš„æœ‰æ•ˆæ€§</del></p>
<h4 id="æ ¸å¿ƒæµç¨‹ï¼š"><a href="#æ ¸å¿ƒæµç¨‹ï¼š" class="headerlink" title="æ ¸å¿ƒæµç¨‹ï¼š"></a>æ ¸å¿ƒæµç¨‹ï¼š</h4><pre><code class="java">è¯·æ±‚åˆ°æ¥ â†’ JWTè¿‡æ»¤å™¨æå–Token â†’ è§£æç”¨æˆ·ä¿¡æ¯ â†’ åŠ è½½æƒé™ â†’ æ¯”å¯¹æ˜¯å¦æœ‰æƒé™ â†’ æ”¾è¡Œ or æ‹¦æˆª
</code></pre>
<h4 id="å…·ä½“ç»†èŠ‚ï¼š"><a href="#å…·ä½“ç»†èŠ‚ï¼š" class="headerlink" title="å…·ä½“ç»†èŠ‚ï¼š"></a>å…·ä½“ç»†èŠ‚ï¼š</h4><ul>
<li>ä½¿ç”¨ <strong>è‡ªå®šä¹‰è¿‡æ»¤å™¨</strong> æ›¿æ¢ <code>UsernamePasswordAuthenticationFilter</code></li>
<li>Token ä¸­å–å‡ºç”¨æˆ·å â†’ å» Redis ä¸­æ‹¿æƒé™ä¿¡æ¯ï¼ˆé¿å…æ¯æ¬¡éƒ½æŸ¥åº“ï¼‰</li>
<li>ä½¿ç”¨ <strong><code>AccessDecisionManager</code></strong> å’Œ <strong><code>SecurityMetadataSource</code></strong> åˆ¤æ–­å½“å‰æ¥å£æ‰€éœ€æƒé™æ˜¯å¦è¢«ç”¨æˆ·æ‹¥æœ‰</li>
<li>æ ¡éªŒæˆåŠŸï¼šæ”¾è¡Œï¼›æ ¡éªŒå¤±è´¥ï¼šè¿”å› 403 è‡ªå®šä¹‰å“åº”ï¼ˆå¦‚â€œæ— æƒé™è®¿é—®â€ï¼‰</li>
</ul>
<h2 id="âœ…-ä¸ºä»€ä¹ˆä½¿ç”¨-Redis-ç¼“å­˜æƒé™ï¼Ÿ"><a href="#âœ…-ä¸ºä»€ä¹ˆä½¿ç”¨-Redis-ç¼“å­˜æƒé™ï¼Ÿ" class="headerlink" title="âœ… ä¸ºä»€ä¹ˆä½¿ç”¨ Redis ç¼“å­˜æƒé™ï¼Ÿ"></a>âœ… <strong>ä¸ºä»€ä¹ˆä½¿ç”¨ Redis ç¼“å­˜æƒé™ï¼Ÿ</strong></h2><ul>
<li>é¿å…æ¯æ¬¡è¯·æ±‚éƒ½å»æŸ¥æ•°æ®åº“ï¼Œæå‡æ€§èƒ½</li>
<li>å®ç°å•ç‚¹ç™»å½•ã€Tokenå¤±æ•ˆç®¡ç†ç­‰æ“ä½œæ›´æ–¹ä¾¿</li>
<li>æƒé™ä¿¡æ¯æ”¹åŠ¨ â†’ Redis ä¹ŸåŒæ­¥æ›´æ–°</li>
</ul>
<hr>
<h2 id="âœ…-å¦‚ä½•å®šä¹‰å“ªäº›æ¥å£éœ€è¦æƒé™ï¼Ÿ"><a href="#âœ…-å¦‚ä½•å®šä¹‰å“ªäº›æ¥å£éœ€è¦æƒé™ï¼Ÿ" class="headerlink" title="âœ… å¦‚ä½•å®šä¹‰å“ªäº›æ¥å£éœ€è¦æƒé™ï¼Ÿ"></a>âœ… <strong>å¦‚ä½•å®šä¹‰å“ªäº›æ¥å£éœ€è¦æƒé™ï¼Ÿ</strong></h2><ul>
<li>ä½¿ç”¨ <code>@PreAuthorize(&quot;hasAuthority(&#39;xxx&#39;)&quot;)</code></li>
<li>æˆ–è€…ç”¨è‡ªå®šä¹‰æƒé™æ³¨è§£ + AOP å®ç°</li>
</ul>
<hr>
<h2 id="âœ…-æ€»ç»“ä¸€å¥è¯å›ç­”"><a href="#âœ…-æ€»ç»“ä¸€å¥è¯å›ç­”" class="headerlink" title="âœ… æ€»ç»“ä¸€å¥è¯å›ç­”"></a>âœ… æ€»ç»“ä¸€å¥è¯å›ç­”</h2><p>æˆ‘ä½¿ç”¨çš„æ˜¯åŸºäº <strong>JWT + SpringSecurity</strong> çš„æƒé™æ§åˆ¶ï¼Œé‡‡ç”¨çš„æ˜¯ <strong>RBAC æ¨¡å‹</strong>ï¼Œé€šè¿‡ç”¨æˆ·è§’è‰²æƒé™çš„ç»‘å®šæ¥æ§åˆ¶èµ„æºè®¿é—®ã€‚æƒé™ä¿¡æ¯ç™»å½•æ—¶å°±ç¼“å­˜åˆ° Redisï¼Œæé«˜äº†æ€§èƒ½ï¼Œæ¥å£é‰´æƒç”¨çš„æ˜¯è‡ªå®šä¹‰çš„ <code>AccessDecisionManager</code> æ¥æ ¡éªŒ Token ä¸æƒé™æ˜¯å¦åŒ¹é…ï¼Œç¡®ä¿æ¥å£å®‰å…¨ã€‚</p>
</blockquote>
<blockquote>
<h3 id="âœ…-åœºæ™¯æè¿°ï¼šæƒé™ç²¾ç¡®åˆ°æŒ‰é’®çº§åˆ«"><a href="#âœ…-åœºæ™¯æè¿°ï¼šæƒé™ç²¾ç¡®åˆ°æŒ‰é’®çº§åˆ«" class="headerlink" title="âœ… åœºæ™¯æè¿°ï¼šæƒé™ç²¾ç¡®åˆ°æŒ‰é’®çº§åˆ«"></a>âœ… åœºæ™¯æè¿°ï¼š<span style = "color:red">æƒé™ç²¾ç¡®åˆ°æŒ‰é’®çº§åˆ«</span></h3><p>ä¸ä»…æ§åˆ¶ç”¨æˆ·èƒ½å¦è®¿é—®â€œæŸä¸ªèœå•â€ï¼Œè¿˜è¦æ§åˆ¶ï¼š</p>
<ul>
<li>æŸäº›ç”¨æˆ·èƒ½çœ‹åˆ°â€œç¼–è¾‘â€æŒ‰é’®</li>
<li>æŸäº›ç”¨æˆ·ä¸èƒ½çœ‹åˆ°â€œåˆ é™¤â€æŒ‰é’®</li>
<li>æŸäº›æŒ‰é’®ç‚¹å‡»ååå°è¦é‰´æƒï¼ˆå¦‚â€œå¯¼å‡ºâ€ã€â€œå®¡æ ¸â€ç­‰ï¼‰</li>
</ul>
<h2 id="ğŸ§©-ä¸€ã€æ•°æ®åº“è®¾è®¡ï¼ˆåŸºäº-RBAC-æ¨¡å‹ï¼‰"><a href="#ğŸ§©-ä¸€ã€æ•°æ®åº“è®¾è®¡ï¼ˆåŸºäº-RBAC-æ¨¡å‹ï¼‰" class="headerlink" title="ğŸ§© ä¸€ã€æ•°æ®åº“è®¾è®¡ï¼ˆåŸºäº RBAC æ¨¡å‹ï¼‰"></a>ğŸ§© ä¸€ã€æ•°æ®åº“è®¾è®¡ï¼ˆåŸºäº RBAC æ¨¡å‹ï¼‰</h2><h3 id="1ï¸âƒ£-è¡¨ç»“æ„è®¾è®¡ï¼ˆæ ¸å¿ƒäº”å¼ è¡¨ï¼‰"><a href="#1ï¸âƒ£-è¡¨ç»“æ„è®¾è®¡ï¼ˆæ ¸å¿ƒäº”å¼ è¡¨ï¼‰" class="headerlink" title="1ï¸âƒ£ è¡¨ç»“æ„è®¾è®¡ï¼ˆæ ¸å¿ƒäº”å¼ è¡¨ï¼‰"></a>1ï¸âƒ£ è¡¨ç»“æ„è®¾è®¡ï¼ˆæ ¸å¿ƒäº”å¼ è¡¨ï¼‰</h3><table>
<thead>
<tr>
<th>è¡¨å</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>user</code></td>
<td>ç”¨æˆ·è¡¨</td>
</tr>
<tr>
<td><code>role</code></td>
<td>è§’è‰²è¡¨</td>
</tr>
<tr>
<td><code>permission</code></td>
<td>æƒé™èµ„æºè¡¨ï¼ˆèœå•ã€æ¥å£ã€æŒ‰é’®ï¼‰</td>
</tr>
<tr>
<td><code>user_role</code></td>
<td>ç”¨æˆ·ä¸è§’è‰²çš„å¤šå¯¹å¤šå…³è”</td>
</tr>
<tr>
<td><code>role_permission</code></td>
<td>è§’è‰²ä¸æƒé™çš„å¤šå¯¹å¤šå…³è”</td>
</tr>
</tbody></table>
<h3 id="2ï¸âƒ£-permission-æƒé™è¡¨ç¤ºä¾‹ï¼ˆå…³é”®ï¼‰"><a href="#2ï¸âƒ£-permission-æƒé™è¡¨ç¤ºä¾‹ï¼ˆå…³é”®ï¼‰" class="headerlink" title="2ï¸âƒ£ permission æƒé™è¡¨ç¤ºä¾‹ï¼ˆå…³é”®ï¼‰"></a>2ï¸âƒ£ <code>permission</code> æƒé™è¡¨ç¤ºä¾‹ï¼ˆå…³é”®ï¼‰</h3><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>ä¸»é”®</td>
</tr>
<tr>
<td>name</td>
<td>æƒé™åç§°ï¼Œä¾‹å¦‚â€œåˆ é™¤æŒ‰é’®â€</td>
</tr>
<tr>
<td>type</td>
<td>ç±»å‹ï¼š<code>menu</code>ã€<code>button</code>ã€<code>api</code></td>
</tr>
<tr>
<td>perm_code</td>
<td>æƒé™æ ‡è¯†ï¼Œä¾‹å¦‚ï¼š<code>user:delete</code>ã€<code>user:edit</code></td>
</tr>
<tr>
<td>parent_id</td>
<td>ä¸Šçº§æƒé™ï¼ˆèœå•æ ‘ç»“æ„ï¼‰</td>
</tr>
<tr>
<td>url &#x2F; path</td>
<td>å‰ç«¯è·¯ç”±æˆ–æ¥å£è·¯å¾„</td>
</tr>
<tr>
<td>method</td>
<td>è¯·æ±‚æ–¹å¼ï¼š<code>GET/POST/DELETE</code>ï¼ˆæ¥å£ä¸“ç”¨ï¼‰</td>
</tr>
</tbody></table>
<p>ğŸš¨ <strong>é‡ç‚¹</strong>ï¼šæŒ‰é’®æƒé™æ˜¯å­˜æ”¾åœ¨ <code>permission</code> è¡¨é‡Œçš„ï¼Œåªæ˜¯ <code>type = button</code>ï¼Œå’Œèœå•&#x2F;æ¥å£å…±ç”¨ä¸€ä¸ªè¡¨ã€‚</p>
<h2 id="ğŸ”-äºŒã€åç«¯é€»è¾‘å¤„ç†æµç¨‹"><a href="#ğŸ”-äºŒã€åç«¯é€»è¾‘å¤„ç†æµç¨‹" class="headerlink" title="ğŸ” äºŒã€åç«¯é€»è¾‘å¤„ç†æµç¨‹"></a>ğŸ” äºŒã€åç«¯é€»è¾‘å¤„ç†æµç¨‹</h2><h3 id="1ï¸âƒ£-ç”¨æˆ·ç™»å½•æ—¶åŠ è½½æƒé™"><a href="#1ï¸âƒ£-ç”¨æˆ·ç™»å½•æ—¶åŠ è½½æƒé™" class="headerlink" title="1ï¸âƒ£ ç”¨æˆ·ç™»å½•æ—¶åŠ è½½æƒé™"></a>1ï¸âƒ£ ç”¨æˆ·ç™»å½•æ—¶åŠ è½½æƒé™</h3><pre><code class="java">@Override
public UserDetails loadUserByUsername(String username) &#123;
    // 1. æŸ¥è¯¢ç”¨æˆ·
    User user = userMapper.selectByUsername(username);

    // 2. æŸ¥è¯¢æƒé™ï¼ˆæŒ‰é’® + æ¥å£ + èœå•ï¼‰
    List&lt;String&gt; permissionCodes = permissionMapper.getUserPerms(user.getId());

    // 3. å­˜å…¥ UserDetails
    return new LoginUser(user, permissionCodes);
&#125;
</code></pre>
<p>âœ”ï¸ è¿™äº› <code>permissionCodes</code> ä¼šé€šè¿‡ JWT æˆ– Redis å­˜èµ·æ¥ï¼Œåç»­ç”¨æ¥é‰´æƒå’Œå‰ç«¯å±•ç¤ºã€‚</p>
<h3 id="2ï¸âƒ£-é‰´æƒæ§åˆ¶ï¼ˆç²¾ç¡®åˆ°æŒ‰é’®ï¼‰"><a href="#2ï¸âƒ£-é‰´æƒæ§åˆ¶ï¼ˆç²¾ç¡®åˆ°æŒ‰é’®ï¼‰" class="headerlink" title="2ï¸âƒ£ é‰´æƒæ§åˆ¶ï¼ˆç²¾ç¡®åˆ°æŒ‰é’®ï¼‰"></a>2ï¸âƒ£ é‰´æƒæ§åˆ¶ï¼ˆç²¾ç¡®åˆ°æŒ‰é’®ï¼‰</h3><p>ä½ éœ€è¦ï¼š</p>
<ul>
<li><strong>åç«¯æ ¡éªŒæ¥å£æƒé™</strong>ï¼ˆå¦‚è°ƒç”¨åˆ é™¤æ¥å£å¿…é¡»æ‹¥æœ‰ <code>user:delete</code> æƒé™ï¼‰</li>
<li><strong>å‰ç«¯å±•ç¤ºæŒ‰é’®</strong>è¦åˆ¤æ–­æ˜¯å¦æœ‰æƒé™</li>
</ul>
<h4 id="ğŸ§·-æ–¹æ³•ä¸€ï¼šæ¥å£æƒé™æ§åˆ¶ï¼ˆåç«¯ï¼‰"><a href="#ğŸ§·-æ–¹æ³•ä¸€ï¼šæ¥å£æƒé™æ§åˆ¶ï¼ˆåç«¯ï¼‰" class="headerlink" title="ğŸ§· æ–¹æ³•ä¸€ï¼šæ¥å£æƒé™æ§åˆ¶ï¼ˆåç«¯ï¼‰"></a>ğŸ§· æ–¹æ³•ä¸€ï¼šæ¥å£æƒé™æ§åˆ¶ï¼ˆåç«¯ï¼‰</h4><pre><code class="java">@PreAuthorize(&quot;hasAuthority(&#39;user:delete&#39;)&quot;) // â˜…â˜…â˜…â˜…
@DeleteMapping(&quot;/user/delete/&#123;id&#125;&quot;)
public void deleteUser(@PathVariable Long id) &#123;
    // ä¸šåŠ¡é€»è¾‘
&#125;
</code></pre>
<blockquote>
<p>âœ”ï¸ åªæœ‰æ‹¥æœ‰ <code>user:delete</code> æƒé™çš„ç”¨æˆ·æ‰èƒ½è°ƒç”¨è¿™ä¸ªæ¥å£ã€‚</p>
</blockquote>
<hr>
<h4 id="ğŸ§·-æ–¹æ³•äºŒï¼šæŒ‰é’®æƒé™æ§åˆ¶ï¼ˆå‰ç«¯ï¼‰"><a href="#ğŸ§·-æ–¹æ³•äºŒï¼šæŒ‰é’®æƒé™æ§åˆ¶ï¼ˆå‰ç«¯ï¼‰" class="headerlink" title="ğŸ§· æ–¹æ³•äºŒï¼šæŒ‰é’®æƒé™æ§åˆ¶ï¼ˆå‰ç«¯ï¼‰"></a>ğŸ§· æ–¹æ³•äºŒï¼šæŒ‰é’®æƒé™æ§åˆ¶ï¼ˆå‰ç«¯ï¼‰</h4><pre><code class="vue">&lt;!-- Vue ç¤ºä¾‹ --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;el-button v-if=&quot;hasPermission(&#39;user:edit&#39;)&quot;&gt;ç¼–è¾‘&lt;/el-button&gt;
    &lt;el-button v-if=&quot;hasPermission(&#39;user:delete&#39;)&quot;&gt;åˆ é™¤&lt;/el-button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="js">// æƒé™åˆ¤æ–­å‡½æ•°
export function hasPermission(code) &#123;
  const perms = JSON.parse(localStorage.getItem(&quot;userPerms&quot;)) || [];
  return perms.includes(code);
&#125;
</code></pre>
<h5 id="ğŸ› -ä¸‰ã€JWT-Redis-æƒé™ç¼“å­˜æ–¹æ¡ˆï¼ˆæé«˜æ€§èƒ½ï¼‰"><a href="#ğŸ› -ä¸‰ã€JWT-Redis-æƒé™ç¼“å­˜æ–¹æ¡ˆï¼ˆæé«˜æ€§èƒ½ï¼‰" class="headerlink" title="ğŸ›  ä¸‰ã€JWT + Redis æƒé™ç¼“å­˜æ–¹æ¡ˆï¼ˆæé«˜æ€§èƒ½ï¼‰"></a>ğŸ›  ä¸‰ã€JWT + Redis æƒé™ç¼“å­˜æ–¹æ¡ˆï¼ˆæé«˜æ€§èƒ½ï¼‰</h5><h5 id="ç™»å½•æˆåŠŸåï¼š"><a href="#ç™»å½•æˆåŠŸåï¼š" class="headerlink" title="ç™»å½•æˆåŠŸåï¼š"></a>ç™»å½•æˆåŠŸåï¼š</h5><pre><code class="java">// ç™»å½•æˆåŠŸåï¼š
String token = jwtUtil.generateToken(userId);

// Redisç¼“å­˜ç”¨æˆ·æƒé™
redis.set(&quot;login:&quot; + userId, JSON.stringify(LoginUserå¯¹è±¡)) // åŒ…æ‹¬ permissionCodes

// è¿”å›tokenç»™å‰ç«¯
</code></pre>
<h5 id="é‰´æƒè¿‡æ»¤å™¨ï¼š"><a href="#é‰´æƒè¿‡æ»¤å™¨ï¼š" class="headerlink" title="é‰´æƒè¿‡æ»¤å™¨ï¼š"></a>é‰´æƒè¿‡æ»¤å™¨ï¼š</h5><pre><code class="java">// Tokenè¿‡æ»¤å™¨ä»è¯·æ±‚å¤´è·å–token â†’ ä»Redisè¯»å–ç”¨æˆ·æƒé™ â†’ è®¾ç½®SecurityContext
</code></pre>
<hr>
<h5 id="ğŸ“-å››ã€æƒé™ç»“æ„å¦‚ä½•ä¼ ç»™å‰ç«¯ï¼Ÿ"><a href="#ğŸ“-å››ã€æƒé™ç»“æ„å¦‚ä½•ä¼ ç»™å‰ç«¯ï¼Ÿ" class="headerlink" title="ğŸ“ å››ã€æƒé™ç»“æ„å¦‚ä½•ä¼ ç»™å‰ç«¯ï¼Ÿ"></a>ğŸ“ å››ã€æƒé™ç»“æ„å¦‚ä½•ä¼ ç»™å‰ç«¯ï¼Ÿ</h5><h3 id="ç¤ºä¾‹ï¼š"><a href="#ç¤ºä¾‹ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h3><pre><code class="json">[
  &#123;
    &quot;menuName&quot;: &quot;ç”¨æˆ·ç®¡ç†&quot;,
    &quot;path&quot;: &quot;/user&quot;,
    &quot;children&quot;: [
      &#123;
        &quot;menuName&quot;: &quot;ç”¨æˆ·åˆ—è¡¨&quot;,
        &quot;path&quot;: &quot;/user/list&quot;,
        &quot;permissions&quot;: [&quot;user:add&quot;, &quot;user:delete&quot;, &quot;user:edit&quot;]
      &#125;
    ]
  &#125;
]
</code></pre>
<p>å‰ç«¯æ ¹æ®è¿™äº› <code>permissions</code> æ§åˆ¶æŒ‰é’®æ˜¾ç¤ºã€‚</p>
<hr>
<h2 id="âœ…-æ€»ç»“ä¸€å¥è¯å›ç­”ï¼š"><a href="#âœ…-æ€»ç»“ä¸€å¥è¯å›ç­”ï¼š" class="headerlink" title="âœ… æ€»ç»“ä¸€å¥è¯å›ç­”ï¼š"></a>âœ… æ€»ç»“ä¸€å¥è¯å›ç­”ï¼š</h2><p>åœ¨é¡¹ç›®ä¸­æˆ‘ä»¬å®ç°äº†<strong>ç²¾ç¡®åˆ°æŒ‰é’®çº§åˆ«çš„æƒé™æ§åˆ¶</strong>ã€‚ä½¿ç”¨ RBAC æ¨¡å‹ç»Ÿä¸€ç®¡ç†â€œèœå•ã€æ¥å£ã€æŒ‰é’®æƒé™â€ï¼Œåç«¯ç»Ÿä¸€æ ¡éªŒæƒé™ï¼ˆç”¨ Spring Security çš„ <code>@PreAuthorize</code>ï¼‰ï¼Œå‰ç«¯æ ¹æ®ç”¨æˆ·æƒé™ç åŠ¨æ€æ§åˆ¶æŒ‰é’®çš„æ˜¾ç¤ºï¼Œç”¨æˆ·æƒé™åœ¨ç™»å½•æ—¶å°±åŠ è½½å¹¶ç¼“å­˜åˆ° Redis + JWT ä¸­ï¼Œå®ç°äº†æ€§èƒ½ä¸å®‰å…¨çš„å¹³è¡¡ã€‚</p>
<h2 id="âœ…-çœŸå®é¡¹ç›®ä¸­å¸¸è§è¡¥å……ç‚¹ï¼ˆé¢è¯•å¿…é—®ï¼‰"><a href="#âœ…-çœŸå®é¡¹ç›®ä¸­å¸¸è§è¡¥å……ç‚¹ï¼ˆé¢è¯•å¿…é—®ï¼‰" class="headerlink" title="âœ… çœŸå®é¡¹ç›®ä¸­å¸¸è§è¡¥å……ç‚¹ï¼ˆé¢è¯•å¿…é—®ï¼‰"></a>âœ… çœŸå®é¡¹ç›®ä¸­å¸¸è§è¡¥å……ç‚¹ï¼ˆé¢è¯•å¿…é—®ï¼‰</h2><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>è§£ç­”</th>
</tr>
</thead>
<tbody><tr>
<td>å‰ç«¯æ€ä¹ˆçŸ¥é“è‡ªå·±æœ‰å“ªäº›æƒé™ï¼Ÿ</td>
<td>ç™»å½•åä»åç«¯è¿”å›æƒé™ç æ•°ç»„ï¼Œå¦‚ <code>[&quot;user:add&quot;, &quot;user:delete&quot;]</code>ï¼Œå­˜åœ¨ Vuex &#x2F; Pinia æˆ– localStorage ä¸­</td>
</tr>
<tr>
<td>æƒé™æ›´æ–°äº†æ€ä¹ˆåŠï¼Ÿ</td>
<td>æ›´æ–°ç”¨æˆ·è§’è‰²åï¼ŒåŒæ—¶åˆ·æ–° Redis ç¼“å­˜æˆ–è®¾ç½® token è¿‡æœŸæ—¶é—´è¾ƒçŸ­</td>
</tr>
<tr>
<td>ä¸€ä¸ªæŒ‰é’®éœ€è¦å¤šä¸ªæƒé™æ€ä¹ˆåŠï¼Ÿ</td>
<td><code>v-if=&quot;hasPermission(&#39;user:add&#39;) &amp;&amp; hasPermission(&#39;user:export&#39;)&quot;</code></td>
</tr>
</tbody></table>
<h4 id="æˆ‘æƒ³è¦ä½ è¯¦ç»†è®²ä¸€ä¸‹-æ•°æ®åº“çš„é‚£å¼ æƒé™è¡¨-å¸®æˆ‘æ¨¡æ‹Ÿä¸€äº›å­—æ®µå’Œæ•°æ®-å®ç°è¾¾åˆ°æŒ‰é’®çº§åˆ«"><a href="#æˆ‘æƒ³è¦ä½ è¯¦ç»†è®²ä¸€ä¸‹-æ•°æ®åº“çš„é‚£å¼ æƒé™è¡¨-å¸®æˆ‘æ¨¡æ‹Ÿä¸€äº›å­—æ®µå’Œæ•°æ®-å®ç°è¾¾åˆ°æŒ‰é’®çº§åˆ«" class="headerlink" title="æˆ‘æƒ³è¦ä½ è¯¦ç»†è®²ä¸€ä¸‹ æ•°æ®åº“çš„é‚£å¼ æƒé™è¡¨ å¸®æˆ‘æ¨¡æ‹Ÿä¸€äº›å­—æ®µå’Œæ•°æ® å®ç°è¾¾åˆ°æŒ‰é’®çº§åˆ«"></a><span style = "color:blue">æˆ‘æƒ³è¦ä½ è¯¦ç»†è®²ä¸€ä¸‹ æ•°æ®åº“çš„é‚£å¼ æƒé™è¡¨ å¸®æˆ‘æ¨¡æ‹Ÿä¸€äº›å­—æ®µå’Œæ•°æ® å®ç°è¾¾åˆ°æŒ‰é’®çº§åˆ«</span></h4><p>æˆ‘ä»¬å°±æ¥è¯¦ç»† <strong>æ¨¡æ‹Ÿä¸€å¼ å®Œæ•´çš„æƒé™è¡¨ï¼ˆ<code>permission</code>ï¼‰</strong>ï¼Œå¹¶ï¼š</p>
<ol>
<li>å®šä¹‰å®ƒçš„å­—æ®µå«ä¹‰</li>
<li>å¡«å…¥ä¸€äº›çœŸå®çš„ç¤ºä¾‹æ•°æ®ï¼ˆ<strong>ç²¾ç¡®åˆ°æŒ‰é’®çº§åˆ«</strong>ï¼‰</li>
<li>åˆ†æå¦‚ä½•å»ºç«‹èœå•æ ‘ã€æŒ‰é’®æƒé™å’Œæ¥å£æƒé™ä¹‹é—´çš„å…³ç³»</li>
<li>è¯´æ˜è¿™äº›æ•°æ®åœ¨å‰åç«¯ä¸­å¦‚ä½•ä½¿ç”¨</li>
</ol>
<h2 id="ğŸ§©-ä¸€ã€æƒé™è¡¨ï¼ˆpermissionï¼‰å­—æ®µè®¾è®¡"><a href="#ğŸ§©-ä¸€ã€æƒé™è¡¨ï¼ˆpermissionï¼‰å­—æ®µè®¾è®¡" class="headerlink" title="ğŸ§© ä¸€ã€æƒé™è¡¨ï¼ˆpermissionï¼‰å­—æ®µè®¾è®¡"></a>ğŸ§© ä¸€ã€æƒé™è¡¨ï¼ˆ<code>permission</code>ï¼‰å­—æ®µè®¾è®¡</h2><table>
<thead>
<tr>
<th>å­—æ®µå</th>
<th>ç±»å‹</th>
<th>ç¤ºä¾‹å€¼</th>
<th>å«ä¹‰è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>id</code></td>
<td>BIGINT</td>
<td><code>1001</code></td>
<td>æƒé™å”¯ä¸€æ ‡è¯†ï¼ˆé•¿æ•´å‹ï¼Œé€šå¸¸æ˜¯é›ªèŠ±IDï¼‰</td>
</tr>
<tr>
<td><code>name</code></td>
<td>VARCHAR</td>
<td><code>&quot;ç”¨æˆ·ç®¡ç†&quot;</code></td>
<td>æƒé™åç§°ï¼ˆèœå•&#x2F;æŒ‰é’®&#x2F;æ¥å£åç§°ï¼‰</td>
</tr>
<tr>
<td><code>type</code></td>
<td>VARCHAR</td>
<td><code>&quot;menu&quot;</code> &#x2F; <code>&quot;button&quot;</code> &#x2F; <code>&quot;api&quot;</code></td>
<td>æƒé™ç±»å‹ï¼Œæ”¯æŒèœå•ã€æŒ‰é’®ã€æ¥å£</td>
</tr>
<tr>
<td><code>parent_id</code></td>
<td>BIGINT</td>
<td><code>0</code> &#x2F; <code>1001</code> &#x2F; <code>1002</code></td>
<td>ä¸Šçº§IDï¼ˆ0 è¡¨ç¤ºé¡¶çº§ï¼‰</td>
</tr>
<tr>
<td><code>perm_code</code></td>
<td>VARCHAR</td>
<td><code>&quot;user:list&quot;</code> &#x2F; <code>&quot;user:delete&quot;</code></td>
<td>æƒé™æ ‡è¯†ï¼Œç”¨äºæ ¡éªŒ</td>
</tr>
<tr>
<td><code>url</code> &#x2F; <code>path</code></td>
<td>VARCHAR</td>
<td><code>&quot;/user/list&quot;</code> &#x2F; <code>&quot;/api/user/delete&quot;</code></td>
<td>å‰ç«¯è·¯ç”±æˆ–åå°æ¥å£åœ°å€</td>
</tr>
<tr>
<td><code>method</code></td>
<td>VARCHAR</td>
<td><code>&quot;GET&quot;</code> &#x2F; <code>&quot;POST&quot;</code> &#x2F; <code>&quot;DELETE&quot;</code></td>
<td>è¯·æ±‚æ–¹å¼ï¼ˆç”¨äºæ¥å£ï¼‰</td>
</tr>
<tr>
<td><code>sort</code></td>
<td>INT</td>
<td><code>1</code> &#x2F; <code>2</code> &#x2F; <code>3</code></td>
<td>æ’åºå­—æ®µ</td>
</tr>
<tr>
<td><code>status</code></td>
<td>TINYINT</td>
<td><code>1</code></td>
<td>å¯ç”¨çŠ¶æ€ï¼š1å¯ç”¨ã€0ç¦ç”¨</td>
</tr>
<tr>
<td><code>visible</code></td>
<td>TINYINT</td>
<td><code>1</code></td>
<td>æ˜¯å¦å‰ç«¯å¯è§ï¼ˆæŒ‰é’®ç”¨ï¼‰</td>
</tr>
</tbody></table>
<h2 id="ğŸ“Œ-äºŒã€æ¨¡æ‹ŸçœŸå®æƒé™è¡¨æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰"><a href="#ğŸ“Œ-äºŒã€æ¨¡æ‹ŸçœŸå®æƒé™è¡¨æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰" class="headerlink" title="ğŸ“Œ äºŒã€æ¨¡æ‹ŸçœŸå®æƒé™è¡¨æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰"></a>ğŸ“Œ äºŒã€æ¨¡æ‹ŸçœŸå®æƒé™è¡¨æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç³»ç»Ÿæ¨¡å—å«â€œç”¨æˆ·ç®¡ç†â€ï¼Œæœ‰ä¸€ä¸ªèœå•å’Œä¸‰ä¸ªæŒ‰é’®ï¼š</p>
<ul>
<li>ç”¨æˆ·ç®¡ç†ï¼ˆèœå•ï¼‰</li>
<li>æŸ¥è¯¢ç”¨æˆ·ï¼ˆæŒ‰é’®ï¼‰</li>
<li>ç¼–è¾‘ç”¨æˆ·ï¼ˆæŒ‰é’®ï¼‰</li>
<li>åˆ é™¤ç”¨æˆ·ï¼ˆæŒ‰é’®ï¼‰</li>
</ul>
<p>æˆ‘ä»¬å†åŠ ä¸Šä¸€ä¸ªæ¥å£æƒé™ä½œä¸ºåå°æ§åˆ¶ã€‚ã€è¿™é‡Œ<strong>id</strong>å’Œ<strong>parent_id</strong>å¾ˆé‡è¦ã€‘</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>type</th>
<th>parent_id</th>
<th>perm_code</th>
<th>path</th>
<th>method</th>
<th>visible</th>
<th>sort</th>
</tr>
</thead>
<tbody><tr>
<td>1000</td>
<td>ç”¨æˆ·ç®¡ç†</td>
<td><code>menu</code></td>
<td>0</td>
<td><code>user:root</code></td>
<td><code>/user</code></td>
<td>null</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1001</td>
<td>ç”¨æˆ·åˆ—è¡¨</td>
<td><code>menu</code></td>
<td>1000</td>
<td><code>user:list</code></td>
<td><code>/user/list</code></td>
<td>null</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1002</td>
<td>æŸ¥è¯¢æŒ‰é’®</td>
<td><code>button</code></td>
<td>1001</td>
<td><code>user:query</code></td>
<td>null</td>
<td>null</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1003</td>
<td>ç¼–è¾‘æŒ‰é’®</td>
<td><code>button</code></td>
<td>1001</td>
<td><code>user:edit</code></td>
<td>null</td>
<td>null</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>1004</td>
<td>åˆ é™¤æŒ‰é’®</td>
<td><code>button</code></td>
<td>1001</td>
<td><code>user:delete</code></td>
<td>null</td>
<td>null</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>1005</td>
<td>åˆ é™¤ç”¨æˆ·API</td>
<td><code>api</code></td>
<td>1001</td>
<td><code>user:delete</code></td>
<td><code>/api/user/delete</code></td>
<td>DELETE</td>
<td>0</td>
<td>4</td>
</tr>
</tbody></table>
<h2 id="ğŸ§ -ä¸‰ã€è¯´æ˜å’Œä½œç”¨åˆ†æ"><a href="#ğŸ§ -ä¸‰ã€è¯´æ˜å’Œä½œç”¨åˆ†æ" class="headerlink" title="ğŸ§  ä¸‰ã€è¯´æ˜å’Œä½œç”¨åˆ†æ"></a>ğŸ§  ä¸‰ã€è¯´æ˜å’Œä½œç”¨åˆ†æ</h2><h3 id="1ï¸âƒ£-type-menu"><a href="#1ï¸âƒ£-type-menu" class="headerlink" title="1ï¸âƒ£ type = menu"></a>1ï¸âƒ£ <code>type = menu</code></h3><ul>
<li>è¡¨ç¤ºæ˜¯<strong>é¡µé¢èœå•èŠ‚ç‚¹</strong></li>
<li>å‰ç«¯æ„å»ºèœå•æ ‘çš„ä¾æ®</li>
<li>æœ‰<code>path</code>å­—æ®µï¼Œç”¨äºå‰ç«¯è·¯ç”±åŒ¹é…</li>
</ul>
<h3 id="2ï¸âƒ£-type-button"><a href="#2ï¸âƒ£-type-button" class="headerlink" title="2ï¸âƒ£ type = button"></a>2ï¸âƒ£ <code>type = button</code></h3><ul>
<li>è¡¨ç¤ºæŒ‰é’®çº§åˆ«æƒé™</li>
<li><strong>å‰ç«¯åˆ¤æ–­æŒ‰é’®æ˜¾éš</strong>æ—¶ä½¿ç”¨ï¼š</li>
</ul>
<pre><code class="js">hasPermission(&#39;user:delete&#39;) ? æ˜¾ç¤ºåˆ é™¤æŒ‰é’® : ä¸æ˜¾ç¤º
</code></pre>
<h3 id="3ï¸âƒ£-type-api"><a href="#3ï¸âƒ£-type-api" class="headerlink" title="3ï¸âƒ£ type = api"></a>3ï¸âƒ£ <code>type = api</code></h3><ul>
<li>è¡¨ç¤ºåå°æ¥å£æƒé™</li>
<li>ç”± Spring Security + <code>@PreAuthorize(&quot;hasAuthority(&#39;user:delete&#39;)&quot;)</code> æ§åˆ¶æ¥å£æ˜¯å¦æ”¾è¡Œ</li>
</ul>
<h3 id="4ï¸âƒ£-perm-code"><a href="#4ï¸âƒ£-perm-code" class="headerlink" title="4ï¸âƒ£ perm_code"></a>4ï¸âƒ£ <code>perm_code</code></h3><ul>
<li>æ¯ä¸€ä¸ªæƒé™éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ <code>perm_code</code>ï¼Œå³æƒé™ç </li>
<li>æŒ‰é’®å’ŒAPI**å¯ä»¥å…±ç”¨ä¸€ä¸ª <code>perm_code</code>**ï¼Œä»£è¡¨å‰åç«¯æƒé™æ‰“é€š</li>
</ul>
<h2 id="ğŸ§¾-é™„ï¼šå®Œæ•´è¡¨ç»“æ„å»ºè¡¨SQL"><a href="#ğŸ§¾-é™„ï¼šå®Œæ•´è¡¨ç»“æ„å»ºè¡¨SQL" class="headerlink" title="ğŸ§¾ é™„ï¼šå®Œæ•´è¡¨ç»“æ„å»ºè¡¨SQL"></a>ğŸ§¾ é™„ï¼šå®Œæ•´è¡¨ç»“æ„å»ºè¡¨SQL</h2><pre><code class="sql">CREATE TABLE `permission` (
  `id` BIGINT PRIMARY KEY,
  `name` VARCHAR(100) NOT NULL,
  `type` VARCHAR(20) NOT NULL COMMENT &#39;menu, button, api&#39;,
  `parent_id` BIGINT DEFAULT 0,
  `perm_code` VARCHAR(100),
  `path` VARCHAR(200),
  `method` VARCHAR(10),
  `visible` TINYINT DEFAULT 1,
  `sort` INT DEFAULT 1,
  `status` TINYINT DEFAULT 1
);
</code></pre>
</blockquote>
<h4 id="çº¿ç¨‹æ± æœ‰å“ªäº›çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€æ˜¯æ€ä¹ˆè¿›è¡Œè½¬æ¢çš„"><a href="#çº¿ç¨‹æ± æœ‰å“ªäº›çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€æ˜¯æ€ä¹ˆè¿›è¡Œè½¬æ¢çš„" class="headerlink" title="çº¿ç¨‹æ± æœ‰å“ªäº›çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€æ˜¯æ€ä¹ˆè¿›è¡Œè½¬æ¢çš„"></a>çº¿ç¨‹æ± æœ‰å“ªäº›çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€æ˜¯æ€ä¹ˆè¿›è¡Œè½¬æ¢çš„</h4><p>çº¿ç¨‹æ± æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼š</p>
<ul>
<li>RUNNINGï¼šçº¿ç¨‹æ± æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥æ¥å—æ–°çš„ä»»åŠ¡å’Œå¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li>
<li>SHUTDOWNï¼šçº¿ç¨‹æ± ä¸å†æ¥å—æ–°çš„ä»»åŠ¡ï¼Œä½†ä¼šå¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li>
<li>STOPï¼šçº¿ç¨‹æ± ä¸å†æ¥å—æ–°çš„ä»»åŠ¡ï¼Œä¹Ÿä¸å¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¼šä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li>
<li>TIDYINGï¼šæ‰€æœ‰ä»»åŠ¡éƒ½å·²ç»ˆæ­¢ï¼Œçº¿ç¨‹æ± å³å°†å…³é—­ã€‚</li>
<li>TERMINATEDï¼šçº¿ç¨‹æ± å·²å…³é—­ã€‚</li>
</ul>
<p>çŠ¶æ€è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>RUNNING -&gt; SHUTDOWNï¼šè°ƒç”¨shutdown()æ–¹æ³•ã€‚</li>
<li>RUNNING -&gt; STOPï¼šè°ƒç”¨shutdownNow()æ–¹æ³•ã€‚</li>
<li>SHUTDOWN -&gt; TIDYINGï¼šå½“çº¿ç¨‹æ± å’Œä»»åŠ¡é˜Ÿåˆ—éƒ½ä¸ºç©ºæ—¶ã€‚</li>
<li>STOP -&gt; TIDYINGï¼šå½“çº¿ç¨‹æ± ä¸ºç©ºæ—¶ã€‚</li>
<li>TIDYING -&gt; TERMINATEDï¼šå½“terminated()é’©å­æ–¹æ³•æ‰§è¡Œå®Œæˆåã€‚</li>
</ul>
<h4 id="è¯´ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ"><a href="#è¯´ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ" class="headerlink" title="è¯´ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ"></a>è¯´ä¸€ä¸‹æ€ä¹ˆä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ</h4><ul>
<li><p>ç»§æ‰¿Threadç±»ï¼Œå¹¶é‡å†™run()æ–¹æ³•ã€‚</p>
</li>
<li><p>å®ç°Runnableæ¥å£ï¼Œå¹¶å°†å®ç°ç±»ä¼ é€’ç»™Threadå¯¹è±¡ã€‚ã€æ— è¿”å›å€¼ã€‘</p>
</li>
<li><p>å®ç°Callableæ¥å£ï¼Œå®ç°<code>call()</code>æ–¹æ³•ã€æœ‰è¿”å›å€¼ã€‘</p>
</li>
<li><p>ä½¿ç”¨Executoræ¡†æ¶ï¼Œå¦‚ExecutorServiceå’ŒThreadPoolExecutoræ¥ç®¡ç†çº¿ç¨‹æ± ã€‚</p>
</li>
</ul>
<h4 id="æ“ä½œç³»ç»Ÿä¸Šçš„çº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€-5-ï¼ŸJavaçº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€-6-ï¼Ÿ"><a href="#æ“ä½œç³»ç»Ÿä¸Šçš„çº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€-5-ï¼ŸJavaçº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€-6-ï¼Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿä¸Šçš„çº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€[5]ï¼ŸJavaçº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€[6]ï¼Ÿ"></a>æ“ä½œç³»ç»Ÿä¸Šçš„çº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€[5]ï¼ŸJavaçº¿ç¨‹æœ‰å¤šå°‘ç§çŠ¶æ€[6]ï¼Ÿ</h4><ul>
<li>æ–°å»ºï¼ˆNewï¼‰ï¼šåˆ›å»ºåå°šæœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºè¿™ä¸ªçŠ¶æ€ã€‚<code>new Thread</code></li>
<li>å¯è¿è¡Œï¼ˆRunnableï¼‰ï¼šåŒ…æ‹¬è¿è¡Œï¼ˆRunningï¼‰å’Œå°±ç»ªï¼ˆReadyï¼‰çŠ¶æ€ï¼Œçº¿ç¨‹æ­£åœ¨æ‰§è¡Œæˆ–ç­‰å¾…CPUè°ƒåº¦ã€‚</li>
<li>é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹å› ä¸ºç­‰å¾…æŸäº›èµ„æºæˆ–é”è€Œè¢«é˜»å¡ã€‚notifyå¯ä»¥å”¤é†’é˜»å¡çŠ¶æ€ ç¡çœ å®Œä¼šè‡ªåŠ¨å”¤é†’</li>
<li>ç­‰å¾…ï¼ˆWaitingï¼‰ï¼šçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œç‰¹å®šæ“ä½œï¼ˆå¦‚é€šçŸ¥ï¼‰ã€‚</li>
<li>è®¡æ—¶ç­‰å¾…ï¼ˆTimed Waitingï¼‰ï¼šçº¿ç¨‹åœ¨ä¸€å®šæ—¶é—´å†…ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹çš„é€šçŸ¥ã€‚</li>
<li>ç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šçº¿ç¨‹æ‰§è¡Œå®Œæˆæˆ–å› å¼‚å¸¸è€Œç»ˆæ­¢ã€‚</li>
</ul>
<h6 id="æ€ä¹ˆæŠŠçº¿ç¨‹æ€æ­»-ç»ˆæ­¢"><a href="#æ€ä¹ˆæŠŠçº¿ç¨‹æ€æ­»-ç»ˆæ­¢" class="headerlink" title="æ€ä¹ˆæŠŠçº¿ç¨‹æ€æ­» ç»ˆæ­¢"></a>æ€ä¹ˆæŠŠçº¿ç¨‹æ€æ­» ç»ˆæ­¢</h6><p><strong>stop</strong>()æ–¹æ³•[æš´åŠ›æ–¹æ³•]    <strong>interrupt</strong>()æ–¹æ³•[ä¼˜é›…å…³é—­çº¿ç¨‹]    æ­£å¸¸å›æ”¶</p>
<h4 id="ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«"><a href="#ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«" class="headerlink" title="ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«"></a>ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«</h4><p>ä¹è§‚é”ï¼š<strong>è¯»å¤šå†™å°‘</strong> çº¿ç¨‹æ‰§è¡Œæ—¶é—´ç›¸å·®è¾ƒå¤§  å¹¶å‘ä¸å¤ªæ¿€çƒˆ</p>
<p>æ‚²è§‚é”ï¼š<strong>å†™å¤šè¯»å°‘</strong> çº¿ç¨‹æ‰§è¡Œæ—¶é—´ç›¸å·®ä¸å¤§ ç«äº‰æ¿€çƒˆ å¹¶å‘é”å¤š</p>
<p>åŠ é”çš„æ—¶æœºä¸ä¸€æ ·ï¼Œ<br>æ‚²è§‚é”ï¼šæ²¡æ”¹æ•°æ®çš„æ—¶å€™å…ˆåŠ é” æ¯”è¾ƒæ˜æ˜¾åˆ©ç”¨åº•å±‚æ“ä½œç³»ç»Ÿapiå®ç°<br>ä¹è§‚é”ï¼šåœ¨æ”¹æ•°æ®çš„æ—¶å€™æ‰åŠ é” ä¾é åº•å±‚çš„ç¡¬ä»¶</p>
<p><strong>javaå±‚é¢</strong>ï¼š<code>synchronized  ReentrantLock</code></p>
<p><strong>æ•°æ®åº“å±‚é¢</strong>ï¼š<br>æ‚²è§‚é”ï¼šselect for updateæ˜¯mysqlçš„çš„å®ç°<br>ä¹è§‚é”ï¼šJUC Java Util Concurrentï¼‰æ˜¯Javaå¹¶å‘å·¥å…·åŒ…</p>
<blockquote>
<p><code>SELECT ... FOR UPDATE</code>ï¼šè¿™ä¸ªè¯­å¥åœ¨è¯»å–è®°å½•æ—¶ä¼šé”å®šè¿™äº›è®°å½•ï¼Œç›´åˆ°äº‹åŠ¡æäº¤æˆ–å›æ»šã€‚å…¶ä»–çš„äº‹åŠ¡ä¸èƒ½æ›´æ–°è¿™äº›é”å®šçš„è®°å½•ï¼Œè¿™æ˜¯æ‚²è§‚é”çš„ä¸€ä¸ªå…¸å‹å®ç°</p>
</blockquote>
<p>ä¹è§‚é”è¦è¯»å–ç›®å‰æ—§çš„å€¼å†å°†æ–°è®¾ç½®çš„å€¼ä»¥åŠæ—§çš„å€¼æ¯”è¾ƒ å¦‚æœç›¸åŒ å°±æŠŠæ–°çš„å€¼æ›´æ–° å¦‚æœä¸ç›¸åŒ å°±æŠŠæ—§çš„å€¼é‡æ–°æå– å› ä¸ºåœ¨è¿™æœŸé—´æœ‰äººè¯»å–äº†è¿™ä¸ªæ•°æ®è·Ÿæˆ‘ä¹‹å‰ä¸ä¸€æ ·(åº•å±‚api è¦è°ƒç”¨ä¸¤ä¸ª ä¸€ä¸ªæ—§çš„å€¼ ä¸€ä¸ªæ–°çš„å€¼)ã€‚ä¸€èˆ¬ä¹è§‚é”æ˜¯ç»“åˆè‡ªæ—‹ ç±»äºwhile(true)ç›´åˆ°è¯»åˆ°ä¸ºæ­¢ <code>è¦è®¾è®¡æ¬¡æ•°åå†æŠ¥é”™</code></p>
<p>è¦æ›´æ–°æ•°æ®åº“æŸä¸ªå€¼ æŠŠæ—§çš„å€¼è¯»å‡ºæ¥ æƒ³æ›´æ–°é“¶è¡Œé‡Œçš„ä½™é¢<br>è¿™æ˜¯<strong>å…¸å‹çš„ABAé—®é¢˜</strong>ï¼š<u>è¦ç”¨<strong>æ—¶é—´æˆ³</strong>æˆ–<strong>è‡ªå¢ç‰ˆæœ¬å·</strong>å»åš</u></p>
<blockquote>
<h2 id="ğŸ”’-å„ç§é”å¯¹æ¯”è¡¨æ ¼"><a href="#ğŸ”’-å„ç§é”å¯¹æ¯”è¡¨æ ¼" class="headerlink" title="ğŸ”’ å„ç§é”å¯¹æ¯”è¡¨æ ¼"></a>ğŸ”’ å„ç§é”å¯¹æ¯”è¡¨æ ¼</h2><table>
<thead>
<tr>
<th>é”ç±»å‹</th>
<th>é€‚ç”¨åœºæ™¯</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td>ä¹è§‚é”ï¼ˆversionï¼‰</td>
<td>å†²çªå°‘ã€æ€§èƒ½ä¼˜å…ˆ</td>
<td>æ— é˜»å¡ã€æ•ˆç‡é«˜</td>
<td>æœ‰å†²çªæ—¶éœ€é‡è¯•ï¼Œè‡ªæ—‹æˆæœ¬é«˜</td>
</tr>
<tr>
<td>æ‚²è§‚é”ï¼ˆfor updateï¼‰</td>
<td>å†²çªå¤šã€å®‰å…¨æ€§è¦æ±‚é«˜</td>
<td>å¼ºä¸€è‡´æ€§</td>
<td>å¹¶å‘æ€§èƒ½å·®ï¼Œå¯èƒ½å¯¼è‡´æ­»é”</td>
</tr>
<tr>
<td>åˆ†å¸ƒå¼é”ï¼ˆRedis&#x2F;Redissonï¼‰</td>
<td>å¤šæœåŠ¡&#x2F;å¾®æœåŠ¡åœºæ™¯</td>
<td>æ”¯æŒè·¨èŠ‚ç‚¹èµ„æºé”å®š</td>
<td>å®ç°å¤æ‚ï¼Œä¾èµ–ä¸­é—´ä»¶</td>
</tr>
<tr>
<td>æœ¬åœ°é”ï¼ˆsynchronized&#x2F;Lockï¼‰</td>
<td>å•æœåŠ¡åœºæ™¯</td>
<td>å®ç°ç®€å•</td>
<td>æ— æ³•è·¨JVMï¼Œåˆ†å¸ƒå¼æ— æ•ˆ</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="Streamæµçš„ä½¿ç”¨åŠå¸¸ç”¨API"><a href="#Streamæµçš„ä½¿ç”¨åŠå¸¸ç”¨API" class="headerlink" title="Streamæµçš„ä½¿ç”¨åŠå¸¸ç”¨API"></a>Streamæµçš„ä½¿ç”¨åŠå¸¸ç”¨API</h4><p>Streamæ˜¯Java 8ä¸­å¼•å…¥çš„ä¸€ç§æ–°ç‰¹æ€§ï¼Œç”¨äºç®€åŒ–æ•°æ®å¤„ç†å’Œæ“ä½œã€‚å®ƒå¯ä»¥ç”¨æ¥è§£å†³é›†åˆå¾ªç¯éå†å¤„ç†çš„é—®é¢˜ã€‚åœ¨æ­¤ä¹‹å‰ç”¨å¾ªç¯æ¥ä»£æ›¿</p>
<blockquote>
<h3 id="åŸºç¡€Streamæ“ä½œ"><a href="#åŸºç¡€Streamæ“ä½œ" class="headerlink" title="åŸºç¡€Streamæ“ä½œ"></a>åŸºç¡€Streamæ“ä½œ</h3><ul>
<li><code>stream()</code>: ä¸ºé›†åˆåˆ›å»ºä¸²è¡Œæµã€‚</li>
<li><code>parallelStream()</code>: ä¸ºé›†åˆåˆ›å»ºå¹¶è¡Œæµã€‚</li>
<li><code>forEach</code>: å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œã€‚</li>
<li><code>map</code>: å°†æ¯ä¸ªå…ƒç´ æ˜ å°„åˆ°å¯¹åº”çš„ç»“æœã€‚</li>
<li><code>filter</code>: è¿‡æ»¤å‡ºæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚</li>
<li><code>limit</code>: é™åˆ¶æµçš„å¤§å°ã€‚</li>
<li><code>skip</code>: è·³è¿‡æµä¸­çš„å‰nä¸ªå…ƒç´ ã€‚</li>
<li><code>sorted</code>: å¯¹æµè¿›è¡Œæ’åºã€‚</li>
</ul>
<h3 id="ç»ˆç«¯æ“ä½œ"><a href="#ç»ˆç«¯æ“ä½œ" class="headerlink" title="ç»ˆç«¯æ“ä½œ"></a>ç»ˆç«¯æ“ä½œ</h3><ul>
<li><code>collect</code>: å°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ï¼Œæ¯”å¦‚åˆ—è¡¨ã€é›†åˆæˆ–Mapã€‚</li>
<li><code>reduce</code>: é€šè¿‡ä¸€ä¸ªèµ·å§‹å€¼ï¼Œåå¤åˆ©ç”¨BinaryOperatoræ¥å¤„ç†å’Œç´¯ç§¯å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªå€¼ã€‚</li>
<li><code>count</code>: è¿”å›æµä¸­å…ƒç´ çš„æ•°é‡ã€‚</li>
<li><code>min</code> &#x2F; <code>max</code>: æ‰¾åˆ°æµä¸­çš„æœ€å°&#x2F;æœ€å¤§å€¼ã€‚</li>
<li><code>anyMatch</code>: æµä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå…ƒç´ åŒ¹é…ç»™å®šçš„è°“è¯ã€‚</li>
<li><code>allMatch</code>: æµä¸­çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚</li>
<li><code>noneMatch</code>: æµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ åŒ¹é…ç»™å®šçš„è°“è¯ã€‚</li>
<li><code>findFirst</code>: è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li><code>findAny</code>: è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ ã€‚</li>
</ul>
<h3 id="ğŸ§©-åœºæ™¯-1ï¼šç­›é€‰å‡ºä½™é¢å¤§äº1000çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆfilterï¼‰"><a href="#ğŸ§©-åœºæ™¯-1ï¼šç­›é€‰å‡ºä½™é¢å¤§äº1000çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆfilterï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 1ï¼šç­›é€‰å‡ºä½™é¢å¤§äº1000çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆfilterï¼‰"></a>ğŸ§© åœºæ™¯ 1ï¼šç­›é€‰å‡ºä½™é¢å¤§äº1000çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆ<code>filter</code>ï¼‰</h3><pre><code class="java">List&lt;User&gt; richUsers = userList.stream()
    .filter(user -&gt; user.getBalance().compareTo(BigDecimal.valueOf(1000)) &gt; 0)
    .collect(Collectors.toList());
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>filter</code> ç”¨æ¥â€œè¿‡æ»¤â€ï¼Œç•™ä¸‹æ»¡è¶³æ¡ä»¶çš„ç”¨æˆ·ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-2ï¼šè·å–æ‰€æœ‰ç”¨æˆ·åç»„æˆçš„æ–°åˆ—è¡¨ï¼ˆmapï¼‰"><a href="#ğŸ§©-åœºæ™¯-2ï¼šè·å–æ‰€æœ‰ç”¨æˆ·åç»„æˆçš„æ–°åˆ—è¡¨ï¼ˆmapï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 2ï¼šè·å–æ‰€æœ‰ç”¨æˆ·åç»„æˆçš„æ–°åˆ—è¡¨ï¼ˆmapï¼‰"></a>ğŸ§© åœºæ™¯ 2ï¼šè·å–æ‰€æœ‰ç”¨æˆ·åç»„æˆçš„æ–°åˆ—è¡¨ï¼ˆ<code>map</code>ï¼‰</h3><pre><code class="java">List&lt;String&gt; usernameList = userList.stream()
    .map(User::getUsername)
    .collect(Collectors.toList());
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>map</code> æ˜¯æ˜ å°„ï¼Œé€šå¸¸æ˜¯å°†å¯¹è±¡è½¬æ¢æˆæŸä¸ªå­—æ®µæˆ–æ–°ç»“æ„ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-3ï¼šå¯¹è®¢å•æŒ‰é‡‘é¢æ’åºï¼ˆsortedï¼‰"><a href="#ğŸ§©-åœºæ™¯-3ï¼šå¯¹è®¢å•æŒ‰é‡‘é¢æ’åºï¼ˆsortedï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 3ï¼šå¯¹è®¢å•æŒ‰é‡‘é¢æ’åºï¼ˆsortedï¼‰"></a>ğŸ§© åœºæ™¯ 3ï¼šå¯¹è®¢å•æŒ‰é‡‘é¢æ’åºï¼ˆ<code>sorted</code>ï¼‰</h3><pre><code class="java">List&lt;Order&gt; sortedOrders = orderList.stream()
    .sorted(Comparator.comparing(Order::getAmount))
    .collect(Collectors.toList());
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>sorted</code> ç”¨äºæ’åºï¼Œè‡ªå®šä¹‰æ’åºå­—æ®µã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-4ï¼šç»Ÿè®¡å¤šå°‘ä¸ªè®¢å•é‡‘é¢å¤§äº1000ï¼ˆfilter-countï¼‰"><a href="#ğŸ§©-åœºæ™¯-4ï¼šç»Ÿè®¡å¤šå°‘ä¸ªè®¢å•é‡‘é¢å¤§äº1000ï¼ˆfilter-countï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 4ï¼šç»Ÿè®¡å¤šå°‘ä¸ªè®¢å•é‡‘é¢å¤§äº1000ï¼ˆfilter + countï¼‰"></a>ğŸ§© åœºæ™¯ 4ï¼šç»Ÿè®¡å¤šå°‘ä¸ªè®¢å•é‡‘é¢å¤§äº1000ï¼ˆ<code>filter + count</code>ï¼‰</h3><pre><code class="java">long highValueOrderCount = orderList.stream()
    .filter(order -&gt; order.getAmount().compareTo(BigDecimal.valueOf(1000)) &gt; 0)
    .count();
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>count()</code> æ˜¯ç»ˆæ­¢æ“ä½œï¼Œç›´æ¥è¿”å›æ•°é‡ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-5ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ç”¨æˆ·æœªæ¿€æ´»ï¼ˆanyMatchï¼‰"><a href="#ğŸ§©-åœºæ™¯-5ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ç”¨æˆ·æœªæ¿€æ´»ï¼ˆanyMatchï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 5ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ç”¨æˆ·æœªæ¿€æ´»ï¼ˆanyMatchï¼‰"></a>ğŸ§© åœºæ™¯ 5ï¼šåˆ¤æ–­æ˜¯å¦æœ‰ç”¨æˆ·æœªæ¿€æ´»ï¼ˆ<code>anyMatch</code>ï¼‰</h3><pre><code class="java">boolean hasInactive = userList.stream()
    .anyMatch(user -&gt; !user.isActive());
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>anyMatch</code> æ£€æŸ¥<strong>æ˜¯å¦å­˜åœ¨</strong>ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-6ï¼šæ±‚æ‰€æœ‰è®¢å•çš„æ€»é‡‘é¢ï¼ˆmap-reduceï¼‰"><a href="#ğŸ§©-åœºæ™¯-6ï¼šæ±‚æ‰€æœ‰è®¢å•çš„æ€»é‡‘é¢ï¼ˆmap-reduceï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 6ï¼šæ±‚æ‰€æœ‰è®¢å•çš„æ€»é‡‘é¢ï¼ˆmap + reduceï¼‰"></a>ğŸ§© åœºæ™¯ 6ï¼šæ±‚æ‰€æœ‰è®¢å•çš„æ€»é‡‘é¢ï¼ˆ<code>map + reduce</code>ï¼‰</h3><pre><code class="java">BigDecimal totalAmount = orderList.stream()
    .map(Order::getAmount)
    .reduce(BigDecimal.ZERO, BigDecimal::add);
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>reduce</code> æ˜¯å½’çº¦ï¼ŒæŠŠå¤šä¸ªå€¼åˆæˆä¸€ä¸ªå€¼ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-7ï¼šè·³è¿‡å‰5æ¡ï¼Œå–å5æ¡ï¼ˆskip-limitï¼‰"><a href="#ğŸ§©-åœºæ™¯-7ï¼šè·³è¿‡å‰5æ¡ï¼Œå–å5æ¡ï¼ˆskip-limitï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 7ï¼šè·³è¿‡å‰5æ¡ï¼Œå–å5æ¡ï¼ˆskip + limitï¼‰"></a>ğŸ§© åœºæ™¯ 7ï¼šè·³è¿‡å‰5æ¡ï¼Œå–å5æ¡ï¼ˆ<code>skip + limit</code>ï¼‰</h3><pre><code class="java">List&lt;Order&gt; lastFive = orderList.stream()
    .skip(orderList.size() - 5)
    .limit(5)
    .collect(Collectors.toList());
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> ç”¨äºåˆ†é¡µã€æ»šåŠ¨åŠ è½½çš„å…¸å‹åœºæ™¯ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-8ï¼šåˆ†ç»„ç»Ÿè®¡â€”â€”æŒ‰ç”¨æˆ·IDåˆ†ç»„ä»–ä»¬çš„è®¢å•ï¼ˆcollect-Collectors-groupingBy-ï¼‰"><a href="#ğŸ§©-åœºæ™¯-8ï¼šåˆ†ç»„ç»Ÿè®¡â€”â€”æŒ‰ç”¨æˆ·IDåˆ†ç»„ä»–ä»¬çš„è®¢å•ï¼ˆcollect-Collectors-groupingBy-ï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 8ï¼šåˆ†ç»„ç»Ÿè®¡â€”â€”æŒ‰ç”¨æˆ·IDåˆ†ç»„ä»–ä»¬çš„è®¢å•ï¼ˆcollect(Collectors.groupingBy)ï¼‰"></a>ğŸ§© åœºæ™¯ 8ï¼šåˆ†ç»„ç»Ÿè®¡â€”â€”æŒ‰ç”¨æˆ·IDåˆ†ç»„ä»–ä»¬çš„è®¢å•ï¼ˆ<code>collect(Collectors.groupingBy)</code>ï¼‰</h3><pre><code class="java">Map&lt;Long, List&lt;Order&gt;&gt; ordersByUser = orderList.stream()
    .collect(Collectors.groupingBy(Order::getUserId));
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>groupingBy</code> æ˜¯åˆ†ç»„èšåˆæ“ä½œã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-9ï¼šæå–ç”¨æˆ·IDç»„æˆ-Set-å»é‡ï¼ˆmap-collect-Collectors-toSet-ï¼‰"><a href="#ğŸ§©-åœºæ™¯-9ï¼šæå–ç”¨æˆ·IDç»„æˆ-Set-å»é‡ï¼ˆmap-collect-Collectors-toSet-ï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 9ï¼šæå–ç”¨æˆ·IDç»„æˆ Set å»é‡ï¼ˆmap + collect(Collectors.toSet())ï¼‰"></a>ğŸ§© åœºæ™¯ 9ï¼šæå–ç”¨æˆ·IDç»„æˆ Set å»é‡ï¼ˆ<code>map + collect(Collectors.toSet())</code>ï¼‰</h3><pre><code class="java">Set&lt;Long&gt; userIds = userList.stream()
    .map(User::getId)
    .collect(Collectors.toSet());
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> åˆ©ç”¨ <code>Set</code> å®ç°è‡ªåŠ¨å»é‡ã€‚</p>
<hr>
<h3 id="ğŸ§©-åœºæ™¯-10ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªæœªå‘è´§è®¢å•ï¼ˆfilter-findFirstï¼‰"><a href="#ğŸ§©-åœºæ™¯-10ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªæœªå‘è´§è®¢å•ï¼ˆfilter-findFirstï¼‰" class="headerlink" title="ğŸ§© åœºæ™¯ 10ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªæœªå‘è´§è®¢å•ï¼ˆfilter + findFirstï¼‰"></a>ğŸ§© åœºæ™¯ 10ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªæœªå‘è´§è®¢å•ï¼ˆ<code>filter + findFirst</code>ï¼‰</h3><pre><code class="java">Optional&lt;Order&gt; firstUnshipped = orderList.stream()
    .filter(order -&gt; !order.isShipped())
    .findFirst();
</code></pre>
<p>âœ… <strong>é‡ç‚¹ç†è§£ï¼š</strong> <code>findFirst()</code> è¿”å›çš„æ˜¯ <code>Optional&lt;T&gt;</code>ï¼Œé¿å…ç©ºæŒ‡é’ˆã€‚</p>
<hr>
<h3 id="âœ…-æ€»ç»“è¡¨ï¼šå¸¸ç”¨-Stream-æ“ä½œä¸€å›¾è¯»æ‡‚"><a href="#âœ…-æ€»ç»“è¡¨ï¼šå¸¸ç”¨-Stream-æ“ä½œä¸€å›¾è¯»æ‡‚" class="headerlink" title="âœ… æ€»ç»“è¡¨ï¼šå¸¸ç”¨ Stream æ“ä½œä¸€å›¾è¯»æ‡‚"></a>âœ… æ€»ç»“è¡¨ï¼šå¸¸ç”¨ Stream æ“ä½œä¸€å›¾è¯»æ‡‚</h3><table>
<thead>
<tr>
<th>æ“ä½œæ–¹æ³•</th>
<th>åŠŸèƒ½è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>filter()</code></td>
<td>è¿‡æ»¤æ•°æ®</td>
<td><code>filter(u -&gt; u.age &gt; 18)</code></td>
</tr>
<tr>
<td><code>map()</code></td>
<td>æ˜ å°„è½¬æ¢</td>
<td><code>map(User::getId)</code></td>
</tr>
<tr>
<td><code>sorted()</code></td>
<td>æ’åº</td>
<td><code>sorted(Comparator.comparing())</code></td>
</tr>
<tr>
<td><code>limit()</code></td>
<td>é™åˆ¶è¿”å›ä¸ªæ•°</td>
<td><code>limit(10)</code></td>
</tr>
<tr>
<td><code>skip()</code></td>
<td>è·³è¿‡å‰é¢å‡ ä¸ª</td>
<td><code>skip(5)</code></td>
</tr>
<tr>
<td><code>collect()</code></td>
<td>æ”¶é›†ç»“æœ</td>
<td><code>collect(Collectors.toList())</code></td>
</tr>
<tr>
<td><code>count()</code></td>
<td>è®¡æ•°</td>
<td><code>.count()</code></td>
</tr>
<tr>
<td><code>anyMatch()</code></td>
<td>æ˜¯å¦æœ‰ä»»æ„ä¸€ä¸ªæ»¡è¶³</td>
<td><code>anyMatch(u -&gt; !u.active)</code></td>
</tr>
<tr>
<td><code>allMatch()</code></td>
<td>æ‰€æœ‰éƒ½æ»¡è¶³</td>
<td><code>allMatch(u -&gt; u.age &gt; 0)</code></td>
</tr>
<tr>
<td><code>reduce()</code></td>
<td>ç´¯ç§¯æ±‚å’Œç­‰</td>
<td><code>reduce(0, Integer::sum)</code></td>
</tr>
<tr>
<td><code>findFirst()</code></td>
<td>è¿”å›ç¬¬ä¸€ä¸ª</td>
<td><code>findFirst()</code></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="æ€»ç»“ä¸€ä¸‹lambdaquerywrapper-å’Œ-querywrapperçš„åŒºåˆ«-è¿˜æœ‰ä»–ä»¬å„è‡ªçš„çœŸå®åœºæ™¯"><a href="#æ€»ç»“ä¸€ä¸‹lambdaquerywrapper-å’Œ-querywrapperçš„åŒºåˆ«-è¿˜æœ‰ä»–ä»¬å„è‡ªçš„çœŸå®åœºæ™¯" class="headerlink" title="æ€»ç»“ä¸€ä¸‹lambdaquerywrapper å’Œ querywrapperçš„åŒºåˆ« è¿˜æœ‰ä»–ä»¬å„è‡ªçš„çœŸå®åœºæ™¯"></a><span style = "color:red">æ€»ç»“ä¸€ä¸‹lambdaquerywrapper å’Œ querywrapperçš„åŒºåˆ« è¿˜æœ‰ä»–ä»¬å„è‡ªçš„çœŸå®åœºæ™¯</span></h4><blockquote>
<h3 id="âœ…-ä¸€å¥è¯åŒºåˆ†ï¼š"><a href="#âœ…-ä¸€å¥è¯åŒºåˆ†ï¼š" class="headerlink" title="âœ… ä¸€å¥è¯åŒºåˆ†ï¼š"></a>âœ… ä¸€å¥è¯åŒºåˆ†ï¼š</h3><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>ç‰¹ç‚¹</th>
<th>ä½¿ç”¨æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td><code>QueryWrapper</code></td>
<td>é€šè¿‡ <strong>å­—æ®µåå­—ç¬¦ä¸²</strong> æ„é€ æ¡ä»¶</td>
<td><code>.eq(&quot;username&quot;, &quot;Tom&quot;)</code></td>
</tr>
<tr>
<td><code>LambdaQueryWrapper</code></td>
<td>é€šè¿‡ <strong>æ–¹æ³•å¼•ç”¨ï¼ˆå®‰å…¨ï¼‰</strong> æ„é€ æ¡ä»¶</td>
<td><code>.eq(User::getUsername, &quot;Tom&quot;)</code></td>
</tr>
</tbody></table>
<h2 id="âœ³ï¸-1-QueryWrapperï¼šå­—æ®µåå†™å­—ç¬¦ä¸²çš„æ–¹å¼"><a href="#âœ³ï¸-1-QueryWrapperï¼šå­—æ®µåå†™å­—ç¬¦ä¸²çš„æ–¹å¼" class="headerlink" title="âœ³ï¸ 1. QueryWrapperï¼šå­—æ®µåå†™å­—ç¬¦ä¸²çš„æ–¹å¼"></a>âœ³ï¸ 1. <code>QueryWrapper</code>ï¼šå­—æ®µåå†™å­—ç¬¦ä¸²çš„æ–¹å¼</h2><h3 id="âœ…-ç‰¹ç‚¹ï¼š"><a href="#âœ…-ç‰¹ç‚¹ï¼š" class="headerlink" title="âœ… ç‰¹ç‚¹ï¼š"></a>âœ… ç‰¹ç‚¹ï¼š</h3><ul>
<li>å­—æ®µåç”¨å­—ç¬¦ä¸²ä¼ å…¥ï¼Œå¦‚ <code>&quot;username&quot;</code>ã€‚</li>
<li>ä½¿ç”¨ç®€å•ã€çµæ´»ã€ç›´è§‚ã€‚</li>
<li><strong>ä½†å®¹æ˜“æ‹¼å†™é”™è¯¯ï¼Œä¸”ä¸æ”¯æŒå­—æ®µé‡æ„ï¼ˆå­—æ®µåå˜äº†ä¸ä¼šæŠ¥é”™ï¼‰</strong>ã€‚</li>
</ul>
<h3 id="âœ…-ç¤ºä¾‹ï¼š"><a href="#âœ…-ç¤ºä¾‹ï¼š" class="headerlink" title="âœ… ç¤ºä¾‹ï¼š"></a>âœ… ç¤ºä¾‹ï¼š</h3><pre><code class="java">QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;();
wrapper.eq(&quot;username&quot;, &quot;Tom&quot;)
       .ge(&quot;age&quot;, 18)
       .like(&quot;email&quot;, &quot;@gmail.com&quot;);

List&lt;User&gt; list = userMapper.selectList(wrapper);
</code></pre>
<h3 id="âœ…-é€‚ç”¨åœºæ™¯ï¼š"><a href="#âœ…-é€‚ç”¨åœºæ™¯ï¼š" class="headerlink" title="âœ… é€‚ç”¨åœºæ™¯ï¼š"></a>âœ… é€‚ç”¨åœºæ™¯ï¼š</h3><ul>
<li>å¿«é€Ÿå†™ Demoã€æµ‹è¯•ã€‚</li>
<li>å­—æ®µæ˜¯åŠ¨æ€ä¼ å…¥çš„ï¼ˆå¦‚ï¼šå‰ç«¯ä¼ å­—æ®µåï¼‰â€”â€”éœ€è¦ç”¨å­—ç¬¦ä¸²æ‹¼å­—æ®µåã€‚</li>
<li>è¡¨å­—æ®µä¸ä¼šé¢‘ç¹å˜åŠ¨ã€‚</li>
</ul>
<hr>
<h2 id="âœ³ï¸-2-LambdaQueryWrapperï¼šæ–¹æ³•å¼•ç”¨å¼ï¼Œæ›´å®‰å…¨ï¼"><a href="#âœ³ï¸-2-LambdaQueryWrapperï¼šæ–¹æ³•å¼•ç”¨å¼ï¼Œæ›´å®‰å…¨ï¼" class="headerlink" title="âœ³ï¸ 2. LambdaQueryWrapperï¼šæ–¹æ³•å¼•ç”¨å¼ï¼Œæ›´å®‰å…¨ï¼"></a>âœ³ï¸ 2. <code>LambdaQueryWrapper</code>ï¼šæ–¹æ³•å¼•ç”¨å¼ï¼Œæ›´å®‰å…¨ï¼</h2><h3 id="âœ…-ç‰¹ç‚¹ï¼š-1"><a href="#âœ…-ç‰¹ç‚¹ï¼š-1" class="headerlink" title="âœ… ç‰¹ç‚¹ï¼š"></a>âœ… ç‰¹ç‚¹ï¼š</h3><ul>
<li>ä½¿ç”¨ <strong>æ–¹æ³•å¼•ç”¨</strong>ï¼ˆå¦‚ <code>User::getUsername</code>ï¼‰ï¼Œå¯ä»¥é¿å…æ‹¼å†™é”™è¯¯ã€‚</li>
<li>ç¼–è¯‘æ—¶æ£€æŸ¥å­—æ®µåï¼Œé‡å‘½åå­—æ®µ IDE å¯è‡ªåŠ¨ä¿®æ”¹å¼•ç”¨ã€‚</li>
<li>æ›´åŠ  <strong>ç±»å‹å®‰å…¨ã€å¯ç»´æŠ¤</strong>ã€‚</li>
</ul>
<h3 id="âœ…-ç¤ºä¾‹ï¼š-1"><a href="#âœ…-ç¤ºä¾‹ï¼š-1" class="headerlink" title="âœ… ç¤ºä¾‹ï¼š"></a>âœ… ç¤ºä¾‹ï¼š</h3><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.eq(User::getUsername, &quot;Tom&quot;)
       .ge(User::getAge, 18)
       .like(User::getEmail, &quot;@gmail.com&quot;);

List&lt;User&gt; list = userMapper.selectList(wrapper);
</code></pre>
<h3 id="âœ…-é€‚ç”¨åœºæ™¯ï¼š-1"><a href="#âœ…-é€‚ç”¨åœºæ™¯ï¼š-1" class="headerlink" title="âœ… é€‚ç”¨åœºæ™¯ï¼š"></a>âœ… é€‚ç”¨åœºæ™¯ï¼š</h3><ul>
<li>å®é™…é¡¹ç›®å¼€å‘ä¸­æ¨èä¼˜å…ˆä½¿ç”¨ã€‚</li>
<li>å­—æ®µä¼šå˜ï¼Œæ€•å¿˜æ”¹åœ°æ–¹ã€‚</li>
<li>è¿½æ±‚ä»£ç è§„èŒƒã€å¯è¯»æ€§å’Œå®‰å…¨æ€§ã€‚</li>
</ul>
<h2 id="ğŸ”-åœºæ™¯å¯¹æ¯”æ€»ç»“ï¼š"><a href="#ğŸ”-åœºæ™¯å¯¹æ¯”æ€»ç»“ï¼š" class="headerlink" title="ğŸ” åœºæ™¯å¯¹æ¯”æ€»ç»“ï¼š"></a>ğŸ” åœºæ™¯å¯¹æ¯”æ€»ç»“ï¼š</h2><table>
<thead>
<tr>
<th>éœ€æ±‚&#x2F;åœºæ™¯</th>
<th>æ¨èä½¿ç”¨</th>
<th>åŸå› </th>
</tr>
</thead>
<tbody><tr>
<td>å­—æ®µåæ˜¯å‰ç«¯ä¼ è¿‡æ¥çš„å­—ç¬¦ä¸²</td>
<td><code>QueryWrapper</code></td>
<td>å­—æ®µååªèƒ½åŠ¨æ€æ‹¼æ¥</td>
</tr>
<tr>
<td>æ™®é€šæŸ¥è¯¢ï¼ˆå†™æ­»å­—æ®µåï¼‰</td>
<td><code>LambdaQueryWrapper</code></td>
<td>ç¼–è¯‘å™¨æ ¡éªŒå­—æ®µåï¼Œé˜²æ­¢æ‹¼å†™é”™è¯¯</td>
</tr>
<tr>
<td>æƒ³å¿«é€Ÿæµ‹è¯•æˆ–å†™ Demo</td>
<td><code>QueryWrapper</code></td>
<td>ç®€æ´æ–¹ä¾¿</td>
</tr>
<tr>
<td>è¡¨ç»“æ„å˜åŠ¨é¢‘ç¹ã€é‡æ„é¢‘ç¹</td>
<td><code>LambdaQueryWrapper</code></td>
<td>å­—æ®µå¼•ç”¨ä¼šè¢« IDE è¯†åˆ«</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="LambdaQueryWrapperçœŸå®åœºæ™¯"><a href="#LambdaQueryWrapperçœŸå®åœºæ™¯" class="headerlink" title="LambdaQueryWrapperçœŸå®åœºæ™¯"></a><span style = "color:red"><code>LambdaQueryWrapper</code>çœŸå®åœºæ™¯</span></h4><blockquote>
<h2 id="âœ…-åœºæ™¯ä¸€ï¼šç²¾ç¡®æŸ¥è¯¢ï¼šæŸ¥æŸä¸ªç”¨æˆ·æ˜¯å¦å­˜åœ¨"><a href="#âœ…-åœºæ™¯ä¸€ï¼šç²¾ç¡®æŸ¥è¯¢ï¼šæŸ¥æŸä¸ªç”¨æˆ·æ˜¯å¦å­˜åœ¨" class="headerlink" title="âœ… åœºæ™¯ä¸€ï¼šç²¾ç¡®æŸ¥è¯¢ï¼šæŸ¥æŸä¸ªç”¨æˆ·æ˜¯å¦å­˜åœ¨"></a>âœ… åœºæ™¯ä¸€ï¼š<strong>ç²¾ç¡®æŸ¥è¯¢ï¼šæŸ¥æŸä¸ªç”¨æˆ·æ˜¯å¦å­˜åœ¨</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.eq(User::getUsername, &quot;admin&quot;);

User user = userMapper.selectOne(wrapper);
</code></pre>
<blockquote>
<p>è¯´æ˜ï¼šåˆ¤æ–­ç”¨æˆ·åä¸º admin çš„ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚<code>eq</code> è¡¨ç¤ºç­‰äºã€‚</p>
</blockquote>
<hr>
<h2 id="âœ…-åœºæ™¯äºŒï¼šèŒƒå›´æŸ¥è¯¢ï¼šæŸ¥å¹´é¾„åœ¨-18-30-å²ä¹‹é—´çš„ç”¨æˆ·"><a href="#âœ…-åœºæ™¯äºŒï¼šèŒƒå›´æŸ¥è¯¢ï¼šæŸ¥å¹´é¾„åœ¨-18-30-å²ä¹‹é—´çš„ç”¨æˆ·" class="headerlink" title="âœ… åœºæ™¯äºŒï¼šèŒƒå›´æŸ¥è¯¢ï¼šæŸ¥å¹´é¾„åœ¨ 18~30 å²ä¹‹é—´çš„ç”¨æˆ·"></a>âœ… åœºæ™¯äºŒï¼š<strong>èŒƒå›´æŸ¥è¯¢ï¼šæŸ¥å¹´é¾„åœ¨ 18~30 å²ä¹‹é—´çš„ç”¨æˆ·</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.between(User::getAge, 18, 30);

List&lt;User&gt; users = userMapper.selectList(wrapper);
</code></pre>
<blockquote>
<p>è¯´æ˜ï¼š<code>between</code> ç­‰ä»·äº <code>age &gt;= 18 AND age &lt;= 30</code></p>
</blockquote>
<hr>
<h2 id="âœ…-åœºæ™¯ä¸‰ï¼šæ¨¡ç³ŠæŸ¥è¯¢ï¼šæŸ¥é‚®ç®±åŒ…å«â€œ-gmailâ€çš„ç”¨æˆ·"><a href="#âœ…-åœºæ™¯ä¸‰ï¼šæ¨¡ç³ŠæŸ¥è¯¢ï¼šæŸ¥é‚®ç®±åŒ…å«â€œ-gmailâ€çš„ç”¨æˆ·" class="headerlink" title="âœ… åœºæ™¯ä¸‰ï¼šæ¨¡ç³ŠæŸ¥è¯¢ï¼šæŸ¥é‚®ç®±åŒ…å«â€œ@gmailâ€çš„ç”¨æˆ·"></a>âœ… åœºæ™¯ä¸‰ï¼š<strong>æ¨¡ç³ŠæŸ¥è¯¢ï¼šæŸ¥é‚®ç®±åŒ…å«â€œ@gmailâ€çš„ç”¨æˆ·</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.like(User::getEmail, &quot;@gmail&quot;);

List&lt;User&gt; users = userMapper.selectList(wrapper);
</code></pre>
<blockquote>
<pre><code>like` ç›¸å½“äº SQL ä¸­çš„ `LIKE &#39;%xxx%&#39;
</code></pre>
</blockquote>
<hr>
<h2 id="âœ…-åœºæ™¯å››ï¼šå¤šæ¡ä»¶æŸ¥è¯¢ï¼šæŸ¥-username-ä¸º-tomï¼Œä¸”çŠ¶æ€ä¸ºå¯ç”¨"><a href="#âœ…-åœºæ™¯å››ï¼šå¤šæ¡ä»¶æŸ¥è¯¢ï¼šæŸ¥-username-ä¸º-tomï¼Œä¸”çŠ¶æ€ä¸ºå¯ç”¨" class="headerlink" title="âœ… åœºæ™¯å››ï¼šå¤šæ¡ä»¶æŸ¥è¯¢ï¼šæŸ¥ username ä¸º tomï¼Œä¸”çŠ¶æ€ä¸ºå¯ç”¨"></a>âœ… åœºæ™¯å››ï¼š<strong>å¤šæ¡ä»¶æŸ¥è¯¢ï¼šæŸ¥ username ä¸º tomï¼Œä¸”çŠ¶æ€ä¸ºå¯ç”¨</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.eq(User::getUsername, &quot;tom&quot;)
       .eq(User::getStatus, 1); // 1 ä»£è¡¨å¯ç”¨

List&lt;User&gt; users = userMapper.selectList(wrapper);
</code></pre>
<hr>
<h2 id="âœ…-åœºæ™¯äº”ï¼šåŠ¨æ€æŸ¥è¯¢ï¼šæŸäº›å‚æ•°å¯ä¸ºç©ºï¼Œä¸ä¼ å°±ä¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶"><a href="#âœ…-åœºæ™¯äº”ï¼šåŠ¨æ€æŸ¥è¯¢ï¼šæŸäº›å‚æ•°å¯ä¸ºç©ºï¼Œä¸ä¼ å°±ä¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶" class="headerlink" title="âœ… åœºæ™¯äº”ï¼šåŠ¨æ€æŸ¥è¯¢ï¼šæŸäº›å‚æ•°å¯ä¸ºç©ºï¼Œä¸ä¼ å°±ä¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶"></a>âœ… åœºæ™¯äº”ï¼š<strong>åŠ¨æ€æŸ¥è¯¢ï¼šæŸäº›å‚æ•°å¯ä¸ºç©ºï¼Œä¸ä¼ å°±ä¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶</strong></h2><pre><code class="java">String username = &quot;tom&quot;;
Integer age = null;

LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.eq(StringUtils.isNotBlank(username), User::getUsername, username)
       .eq(age != null, User::getAge, age);

List&lt;User&gt; users = userMapper.selectList(wrapper);
</code></pre>
<blockquote>
<p>â­ åŠ¨æ€æ¡ä»¶æ‹¼æ¥æ˜¯ MyBatis-Plus çš„ä¸€å¤§ç‰¹è‰²ï¼š<strong>æ¡ä»¶ä¸º true æ‰æ‹¼å…¥ SQL</strong></p>
</blockquote>
<hr>
<h2 id="âœ…-åœºæ™¯å…­ï¼šæ’åºæŸ¥è¯¢ï¼šæŒ‰æ³¨å†Œæ—¶é—´å€’åº"><a href="#âœ…-åœºæ™¯å…­ï¼šæ’åºæŸ¥è¯¢ï¼šæŒ‰æ³¨å†Œæ—¶é—´å€’åº" class="headerlink" title="âœ… åœºæ™¯å…­ï¼šæ’åºæŸ¥è¯¢ï¼šæŒ‰æ³¨å†Œæ—¶é—´å€’åº"></a>âœ… åœºæ™¯å…­ï¼š<strong>æ’åºæŸ¥è¯¢ï¼šæŒ‰æ³¨å†Œæ—¶é—´å€’åº</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.orderByDesc(User::getCreateTime);

List&lt;User&gt; users = userMapper.selectList(wrapper);
</code></pre>
<hr>
<h2 id="âœ…-åœºæ™¯ä¸ƒï¼šåˆ†é¡µæŸ¥è¯¢-æ¡ä»¶ç­›é€‰"><a href="#âœ…-åœºæ™¯ä¸ƒï¼šåˆ†é¡µæŸ¥è¯¢-æ¡ä»¶ç­›é€‰" class="headerlink" title="âœ… åœºæ™¯ä¸ƒï¼šåˆ†é¡µæŸ¥è¯¢ + æ¡ä»¶ç­›é€‰"></a>âœ… åœºæ™¯ä¸ƒï¼š<strong>åˆ†é¡µæŸ¥è¯¢ + æ¡ä»¶ç­›é€‰</strong></h2><pre><code class="java">Page&lt;User&gt; page = new Page&lt;&gt;(1, 10); // ç¬¬1é¡µï¼Œæ¯é¡µ10æ¡

LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.like(User::getUsername, &quot;å¼ &quot;)
       .ge(User::getAge, 18);

IPage&lt;User&gt; userPage = userMapper.selectPage(page, wrapper);
</code></pre>
<blockquote>
<p><code>selectPage</code> è¿”å›åˆ†é¡µå¯¹è±¡ <code>IPage</code>ï¼ŒåŒ…å«æ€»æ¡æ•°ã€æ€»é¡µæ•°ã€å½“å‰é¡µæ•°æ®ã€‚</p>
</blockquote>
<hr>
<h2 id="âœ…-åœºæ™¯å…«ï¼šç»Ÿè®¡æŸçŠ¶æ€ä¸‹çš„ç”¨æˆ·æ•°é‡"><a href="#âœ…-åœºæ™¯å…«ï¼šç»Ÿè®¡æŸçŠ¶æ€ä¸‹çš„ç”¨æˆ·æ•°é‡" class="headerlink" title="âœ… åœºæ™¯å…«ï¼šç»Ÿè®¡æŸçŠ¶æ€ä¸‹çš„ç”¨æˆ·æ•°é‡"></a>âœ… åœºæ™¯å…«ï¼š<strong>ç»Ÿè®¡æŸçŠ¶æ€ä¸‹çš„ç”¨æˆ·æ•°é‡</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.eq(User::getStatus, 1);

Long count = userMapper.selectCount(wrapper);
</code></pre>
<hr>
<h2 id="âœ…-åœºæ™¯ä¹ï¼šåªæŸ¥æŒ‡å®šåˆ—ï¼šæŸ¥æ‰€æœ‰ç”¨æˆ·åå’Œé‚®ç®±"><a href="#âœ…-åœºæ™¯ä¹ï¼šåªæŸ¥æŒ‡å®šåˆ—ï¼šæŸ¥æ‰€æœ‰ç”¨æˆ·åå’Œé‚®ç®±" class="headerlink" title="âœ… åœºæ™¯ä¹ï¼šåªæŸ¥æŒ‡å®šåˆ—ï¼šæŸ¥æ‰€æœ‰ç”¨æˆ·åå’Œé‚®ç®±"></a>âœ… åœºæ™¯ä¹ï¼š<strong>åªæŸ¥æŒ‡å®šåˆ—ï¼šæŸ¥æ‰€æœ‰ç”¨æˆ·åå’Œé‚®ç®±</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.select(User::getUsername, User::getEmail);

List&lt;User&gt; users = userMapper.selectList(wrapper);
</code></pre>
<hr>
<h2 id="âœ…-åœºæ™¯åï¼šåˆ é™¤æŸä¸ªå¹´é¾„æ®µçš„ç”¨æˆ·ï¼ˆæ…ç”¨ï¼ï¼‰"><a href="#âœ…-åœºæ™¯åï¼šåˆ é™¤æŸä¸ªå¹´é¾„æ®µçš„ç”¨æˆ·ï¼ˆæ…ç”¨ï¼ï¼‰" class="headerlink" title="âœ… åœºæ™¯åï¼šåˆ é™¤æŸä¸ªå¹´é¾„æ®µçš„ç”¨æˆ·ï¼ˆæ…ç”¨ï¼ï¼‰"></a>âœ… åœºæ™¯åï¼š<strong>åˆ é™¤æŸä¸ªå¹´é¾„æ®µçš„ç”¨æˆ·ï¼ˆæ…ç”¨ï¼ï¼‰</strong></h2><pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();
wrapper.lt(User::getAge, 10); // å¹´é¾„å°äº10å²

userMapper.delete(wrapper);
</code></pre>
<h2 id="ğŸ§ -æ€»ç»“ä½ å¯ä»¥è®°ä½å‡ ä¸ªå…³é”®è¯ï¼š"><a href="#ğŸ§ -æ€»ç»“ä½ å¯ä»¥è®°ä½å‡ ä¸ªå…³é”®è¯ï¼š" class="headerlink" title="ğŸ§  æ€»ç»“ä½ å¯ä»¥è®°ä½å‡ ä¸ªå…³é”®è¯ï¼š"></a>ğŸ§  æ€»ç»“ä½ å¯ä»¥è®°ä½å‡ ä¸ªå…³é”®è¯ï¼š</h2><table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td><code>eq</code> &#x2F; <code>ne</code></td>
<td>ç­‰äº &#x2F; ä¸ç­‰äº</td>
</tr>
<tr>
<td><code>like</code> &#x2F; <code>notLike</code></td>
<td>æ¨¡ç³ŠåŒ¹é…</td>
</tr>
<tr>
<td><code>gt</code> &#x2F; <code>ge</code></td>
<td>å¤§äº &#x2F; å¤§äºç­‰äº</td>
</tr>
<tr>
<td><code>lt</code> &#x2F; <code>le</code></td>
<td>å°äº &#x2F; å°äºç­‰äº</td>
</tr>
<tr>
<td><code>between</code></td>
<td>èŒƒå›´æŸ¥è¯¢</td>
</tr>
<tr>
<td><code>in</code> &#x2F; <code>notIn</code></td>
<td>é›†åˆæŸ¥è¯¢</td>
</tr>
<tr>
<td><code>isNull</code> &#x2F; <code>isNotNull</code></td>
<td>åˆ¤ç©º</td>
</tr>
<tr>
<td><code>orderByAsc</code> &#x2F; <code>orderByDesc</code></td>
<td>æ’åº</td>
</tr>
<tr>
<td><code>select</code></td>
<td>æŒ‡å®šè¿”å›å­—æ®µ</td>
</tr>
<tr>
<td><code>last</code></td>
<td>æ‹¼æ¥SQLç‰‡æ®µï¼Œæ¯”å¦‚åˆ†é¡µçš„ <code>limit</code></td>
</tr>
</tbody></table>
<h2 id="æŒ‘æˆ˜é«˜çº§å¤æ‚åœºæ™¯"><a href="#æŒ‘æˆ˜é«˜çº§å¤æ‚åœºæ™¯" class="headerlink" title="æŒ‘æˆ˜é«˜çº§å¤æ‚åœºæ™¯"></a><span style = "color:blue">æŒ‘æˆ˜é«˜çº§å¤æ‚åœºæ™¯</span></h2><h2 id="ğŸ§©-åœºæ™¯è®¾å®šï¼šåå°ç”¨æˆ·ç»¼åˆç­›é€‰"><a href="#ğŸ§©-åœºæ™¯è®¾å®šï¼šåå°ç”¨æˆ·ç»¼åˆç­›é€‰" class="headerlink" title="ğŸ§© åœºæ™¯è®¾å®šï¼šåå°ç”¨æˆ·ç»¼åˆç­›é€‰"></a>ğŸ§© åœºæ™¯è®¾å®šï¼šåå°ç”¨æˆ·ç»¼åˆç­›é€‰</h2><p>ä½ æ˜¯æŸåå°ç³»ç»Ÿå¼€å‘äººå‘˜ï¼Œé¢†å¯¼æå‡ºäº†ä¸€ä¸ªç”¨æˆ·ç»¼åˆæŸ¥è¯¢éœ€æ±‚ï¼š</p>
<blockquote>
<p>â€œæˆ‘è¦ä½ æŸ¥å‡ºæ‰€æœ‰<strong>çŠ¶æ€æ­£å¸¸</strong>çš„ç”¨æˆ·ï¼ˆstatus&#x3D;1ï¼‰ï¼Œè¦æ±‚ä»–ä»¬çš„ï¼š</p>
<ul>
<li>æ˜µç§°ä¸­åŒ…å«â€è¶…â€</li>
<li>å¹´é¾„åœ¨ 20 åˆ° 30 å²ä¹‹é—´</li>
<li>æ³¨å†Œæ—¶é—´è¦å¤§äºæŸä¸ªæ—¶é—´ç‚¹ï¼ˆæ¯”å¦‚ 2023-01-01ï¼‰</li>
<li>é‚®ç®±ä¸èƒ½ä¸º null</li>
<li>å¹¶ä¸”ç”¨æˆ·ç±»å‹ä¸èƒ½æ˜¯ admin</li>
<li>ç”¨æˆ·IDå¿…é¡»åœ¨æŸä¸€æ‰¹å¯¼å…¥çš„ id é›†åˆä¸­</li>
<li>æœ€åæŒ‰ç…§æ³¨å†Œæ—¶é—´é™åºã€å¹´é¾„å‡åºæ’åº</li>
<li>è¿”å›åˆ†é¡µæ•°æ®ï¼Œæ¯é¡µ10æ¡ï¼ŒåªæŸ¥ <code>id</code>, <code>nickname</code>, <code>email</code>, <code>createTime</code> å­—æ®µã€‚â€</li>
</ul>
</blockquote>
<pre><code class="java">LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();

wrapper
    .eq(User::getStatus, 1)                         // çŠ¶æ€æ­£å¸¸
    .like(User::getNickname, &quot;è¶…&quot;)                  // æ˜µç§°æ¨¡ç³ŠåŒ¹é…
    .between(User::getAge, 20, 30)                  // å¹´é¾„åœ¨20~30ä¹‹é—´
    .gt(User::getCreateTime, LocalDate.of(2023, 1, 1)) // æ³¨å†Œæ—¶é—´å¤§äº2023-01-01
    .isNotNull(User::getEmail)                     // é‚®ç®±ä¸ä¸ºnull
    .ne(User::getUserType, &quot;admin&quot;)                // ç±»å‹ä¸èƒ½æ˜¯admin
    .in(User::getId, idList)                       // idå¿…é¡»åœ¨ç»™å®šé›†åˆä¸­
    .orderByDesc(User::getCreateTime)              // æ³¨å†Œæ—¶é—´é™åº
    .orderByAsc(User::getAge)                      // å¹´é¾„å‡åº
    .select(User::getId, User::getNickname, User::getEmail, User::getCreateTime); // åªæŸ¥è¿™å‡ ä¸ªå­—æ®µ
</code></pre>
<h3 id="âœ…-é…åˆåˆ†é¡µä½¿ç”¨ï¼š"><a href="#âœ…-é…åˆåˆ†é¡µä½¿ç”¨ï¼š" class="headerlink" title="âœ… é…åˆåˆ†é¡µä½¿ç”¨ï¼š"></a>âœ… é…åˆåˆ†é¡µä½¿ç”¨ï¼š</h3><pre><code class="java">Page&lt;User&gt; page = new Page&lt;&gt;(1, 10); // ç¬¬1é¡µï¼Œæ¯é¡µ10æ¡
IPage&lt;User&gt; result = userMapper.selectPage(page, wrapper);
</code></pre>
<h2 id="ğŸ§©-å˜ç§è€ƒç‚¹ï¼šåŠ¨æ€æ¡ä»¶æ‹¼æ¥"><a href="#ğŸ§©-å˜ç§è€ƒç‚¹ï¼šåŠ¨æ€æ¡ä»¶æ‹¼æ¥" class="headerlink" title="ğŸ§© å˜ç§è€ƒç‚¹ï¼šåŠ¨æ€æ¡ä»¶æ‹¼æ¥"></a>ğŸ§© å˜ç§è€ƒç‚¹ï¼šåŠ¨æ€æ¡ä»¶æ‹¼æ¥</h2><p>æ¯”å¦‚æ˜µç§°å¯èƒ½ä¸ºç©ºï¼ŒidListå¯èƒ½ä¸ºç©ºï¼Œæˆ‘ä»¬åŠ ä¸ŠåŠ¨æ€åˆ¤æ–­ï¼š</p>
<pre><code class="java">wrapper
    .eq(User::getStatus, 1)
    .like(StringUtils.isNotBlank(nickname), User::getNickname, nickname)
    .between(minAge != null &amp;&amp; maxAge != null, User::getAge, minAge, maxAge)
    .in(CollectionUtil.isNotEmpty(idList), User::getId, idList);
</code></pre>
<p><strong>LambdaQueryWrapper æ˜¯æœ€é€‚åˆåœ¨çœŸå®ä¸šåŠ¡ä¸­æ„å»ºåŠ¨æ€ã€å¤æ‚ã€ç±»å‹å®‰å…¨ SQL çš„åˆ©å™¨</strong>ï¼Œé…åˆ Streamã€åˆ†é¡µã€åŠ¨æ€å‚æ•°ã€æ¡ä»¶æ‹¼æ¥ï¼Œå‡ ä¹èƒ½æ»¡è¶³æ‰€æœ‰åå° CRUD éœ€æ±‚ã€‚</p>
</blockquote>
<h4 id="é¡¹ç›®ä¸­å…·ä½“ç”¨åˆ°å“ªäº›è®¾è®¡æ¨¡å¼"><a href="#é¡¹ç›®ä¸­å…·ä½“ç”¨åˆ°å“ªäº›è®¾è®¡æ¨¡å¼" class="headerlink" title="é¡¹ç›®ä¸­å…·ä½“ç”¨åˆ°å“ªäº›è®¾è®¡æ¨¡å¼"></a>é¡¹ç›®ä¸­å…·ä½“ç”¨åˆ°å“ªäº›<span style = "color:red">è®¾è®¡æ¨¡å¼</span></h4><p><del><strong>å•ä¾‹æ¨¡å¼</strong>ï¼šç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ç®¡ç†å™¨ã€‚</del>[<u>SpringåŸæœ¬è®¾è®¡å¥½çš„</u>]<br><strong><u>å·¥å‚æ¨¡å¼</u><strong>ï¼šåˆ›å»ºå¯¹è±¡æ—¶æ— éœ€æŒ‡å®šå…·ä½“çš„ç±»ï¼Œä¾‹å¦‚æ—¥å¿—å·¥å‚ã€‚<br><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>ï¼šå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œ</strong>æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡</strong>éƒ½å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œä¾‹å¦‚äº‹ä»¶ç›‘å¬ã€‚<br>**<u>ç­–ç•¥æ¨¡å¼</u>**ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥äº’æ¢ï¼Œä¾‹å¦‚æ”¯ä»˜ç­–ç•¥ã€‚<br><strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong>ï¼šåœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘æœ‰ä¸€äº›å…·æœ‰ç›¸åŒæ“ä½œæ­¥éª¤ä½†å…·ä½“å®ç°ä¸åŒçš„ç®—æ³•ï¼Œæˆ‘ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ¥å®šä¹‰è¿™äº›æ­¥éª¤çš„éª¨æ¶ï¼Œå°†å…·ä½“çš„æ­¥éª¤å®ç°ç•™ç»™å­ç±»ã€‚ä»»é“¾æ¨¡å¼çš„ç›®çš„æ˜¯å°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ï¼Œä»è€Œä½¿å¾—å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚<br><strong>è´£ä»»é“¾æ¨¡å¼</strong>ï¼šå®ƒå…è®¸å°†è¯·æ±‚æ²¿ç€å¤„ç†è€…é“¾è¿›è¡Œå‘é€ã€‚æ”¶åˆ°è¯·æ±‚åï¼Œæ¯ä¸ªå¤„ç†è€…éƒ½æœ‰æœºä¼šå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œæˆ–è€…å°†å…¶ä¼ é€’ç»™é“¾ä¸Šçš„ä¸‹ä¸€ä¸ªå¤„ç†è€…ã€‚è¿™æ ·ï¼Œè¯·æ±‚å°±èƒ½åœ¨ä¸€ç³»åˆ—å¤„ç†è€…ä¸­ä¼ é€’ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¤„ç†è€…å¯¹å…¶è¿›è¡Œå¤„ç†ä¸ºæ­¢ã€‚    </p>
<p>1.<u>é€’å½’æ–¹å¼</u> ï¼šåœ¨é€’å½’æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªå¤„ç†è€…å†…éƒ¨è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†è€…çš„å¤„ç†æ–¹æ³•ã€‚å¦‚æœå½“å‰å¤„ç†è€…æ— æ³•å¤„ç†è¯·æ±‚ï¼Œå®ƒä¼šç›´æ¥è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†è€…çš„å¤„ç†æ–¹æ³•ã€‚è¿™ç§æ–¹å¼é€šå¸¸æ˜¯é€šè¿‡<strong>é€’å½’è°ƒç”¨</strong>æ¥å®ç°çš„<br>2.<u>è¿­ä»£æ¨¡å¼</u>ï¼šåœ¨è¿­ä»£æ¨¡å¼ä¸­ï¼Œå¤„ç†è€…é“¾è¢«æ„å»ºä¸ºä¸€ä¸ªçº¿æ€§ç»“æ„ï¼Œæ¯ä¸ªå¤„ç†è€…éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå¤„ç†è€…çš„å¼•ç”¨ã€‚è¯·æ±‚ä»é“¾çš„ç¬¬ä¸€ä¸ªå¤„ç†è€…å¼€å§‹ï¼Œä¾æ¬¡ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†è€…ï¼Œç›´åˆ°æ‰¾åˆ°èƒ½å¤Ÿå¤„ç†è¯¥è¯·æ±‚çš„å¤„ç†è€…ä¸ºæ­¢ã€‚è¿™ç§æ–¹å¼é€šå¸¸æ˜¯é€šè¿‡å¾ªç¯è¿­ä»£æ¥å®ç°çš„<br><strong>ä»£ç†æ¨¡å¼</strong>ï¼šä¸ºäº†æ§åˆ¶å¯¹è¿œç¨‹æœåŠ¡çš„è®¿é—®ï¼Œæˆ‘ä½¿ç”¨äº†ä»£ç†æ¨¡å¼ã€‚ä»£ç†è´Ÿè´£å¤„ç†æ‰€æœ‰ä¸æœåŠ¡å¯¹è±¡çš„äº¤äº’ï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿›è¡Œå»¶è¿ŸåŠ è½½ã€‚</p>
<p>åœ¨æˆ‘çš„é¡¹ç›®ä¸­ç»“åˆ<strong>å·¥å‚æ¨¡å¼</strong>å’Œ<strong>ç­–ç•¥æ¨¡å¼</strong>æ¥è®¾è®¡ç™»å½•æ¥å£æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç™»å½•éªŒè¯çš„é€»è¾‘æŠ½è±¡ä¸ºä¸€ä¸ªç­–ç•¥æ¥å£ï¼Œå¹¶ä¸ºæ¯ç§ç™»å½•æ–¹å¼ï¼ˆå¦‚ï¼šç”¨æˆ·åå¯†ç ç™»å½•ã€æ‰‹æœºéªŒè¯ç ç™»å½•ã€ç¤¾äº¤è´¦å·ç™»å½•ç­‰ï¼‰å®ç°å…·ä½“çš„ç­–ç•¥ç±»ã€‚å·¥å‚ç±»åˆ™è´Ÿè´£åˆ›å»ºå¹¶ç®¡ç†è¿™äº›ç­–ç•¥å¯¹è±¡</p>
<blockquote>
<h3 id="ğŸ§ -ä¸€å¥è¯ç†è§£æ¯ä¸ªæ¨¡å¼ï¼ˆå…ˆè®°å…³é”®è¯ï¼‰"><a href="#ğŸ§ -ä¸€å¥è¯ç†è§£æ¯ä¸ªæ¨¡å¼ï¼ˆå…ˆè®°å…³é”®è¯ï¼‰" class="headerlink" title="ğŸ§  ä¸€å¥è¯ç†è§£æ¯ä¸ªæ¨¡å¼ï¼ˆå…ˆè®°å…³é”®è¯ï¼‰"></a>ğŸ§  ä¸€å¥è¯ç†è§£æ¯ä¸ªæ¨¡å¼ï¼ˆå…ˆè®°å…³é”®è¯ï¼‰</h3><table>
<thead>
<tr>
<th>æ¨¡å¼å</th>
<th>æ ¸å¿ƒå…³é”®è¯</th>
<th>å¸¸ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å•ä¾‹æ¨¡å¼</strong></td>
<td>åªåˆ›å»ºä¸€æ¬¡ï¼Œå…¨å±€å”¯ä¸€</td>
<td>Spring ä¸­çš„ Beanã€é…ç½®ç±»</td>
</tr>
<tr>
<td><strong>å·¥å‚æ¨¡å¼</strong></td>
<td>åˆ›å»ºå¯¹è±¡ä¸å…³å¿ƒå…·ä½“ç±»</td>
<td>æ—¥å¿—ã€æ”¯ä»˜ã€è§£æå™¨ã€ç™»å½•ç±»å‹ç­‰</td>
</tr>
<tr>
<td><strong>ç­–ç•¥æ¨¡å¼</strong></td>
<td>å¤šç§è¡Œä¸ºè‡ªç”±åˆ‡æ¢ï¼Œé¢å‘æ¥å£</td>
<td>ç™»å½•æ–¹å¼ã€æ”¯ä»˜æ–¹å¼ã€ç®—æ³•åˆ‡æ¢</td>
</tr>
<tr>
<td><strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong></td>
<td>å…¬å…±æµç¨‹å›ºå®šï¼Œæ­¥éª¤ä¸ªåˆ«å®ç°</td>
<td>é’©å­å‡½æ•°ã€æŠ½è±¡ç±»è°ƒç”¨å­ç±»æµç¨‹</td>
</tr>
<tr>
<td><strong>è´£ä»»é“¾æ¨¡å¼</strong></td>
<td>å¤šä¸ªå¤„ç†å™¨æŒ‰é¡ºåºå¤„ç†è¯·æ±‚</td>
<td>å‚æ•°æ ¡éªŒé“¾ã€æ—¥å¿—é“¾ã€æƒé™æ ¡éªŒé“¾</td>
</tr>
<tr>
<td><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong></td>
<td>ä¸€å˜å¤šå˜ï¼Œé€šçŸ¥æœºåˆ¶</td>
<td>äº‹ä»¶æ€»çº¿ã€æ¶ˆæ¯è®¢é˜…ã€MQç›‘å¬</td>
</tr>
<tr>
<td><strong>ä»£ç†æ¨¡å¼</strong></td>
<td>ä¸­é—´äººæ§åˆ¶è®¿é—®&#x2F;å¢å¼º</td>
<td>RPCè¿œç¨‹è°ƒç”¨ã€æƒé™æ§åˆ¶ã€ç¼“å­˜ç­‰</td>
</tr>
</tbody></table>
<h3 id="ğŸ“¦-å®æˆ˜åˆ†ç±»-é¡¹ç›®åº”ç”¨"><a href="#ğŸ“¦-å®æˆ˜åˆ†ç±»-é¡¹ç›®åº”ç”¨" class="headerlink" title="ğŸ“¦ å®æˆ˜åˆ†ç±» + é¡¹ç›®åº”ç”¨"></a>ğŸ“¦ å®æˆ˜åˆ†ç±» + é¡¹ç›®åº”ç”¨</h3><h4 id="1ï¸âƒ£-è¡Œä¸ºå‹æ¨¡å¼"><a href="#1ï¸âƒ£-è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="1ï¸âƒ£ è¡Œä¸ºå‹æ¨¡å¼"></a>1ï¸âƒ£ <strong>è¡Œä¸ºå‹æ¨¡å¼</strong></h4><h5 id="âœ…-ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ã€æœ€å¸¸è€ƒğŸ”¥ã€‘"><a href="#âœ…-ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ã€æœ€å¸¸è€ƒğŸ”¥ã€‘" class="headerlink" title="âœ… ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ã€æœ€å¸¸è€ƒğŸ”¥ã€‘"></a>âœ… ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ã€æœ€å¸¸è€ƒğŸ”¥ã€‘</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šè¡Œä¸ºå¯åˆ‡æ¢</li>
<li><strong>åœºæ™¯</strong>ï¼šå¤šä¸ªç™»å½•æ–¹å¼ï¼ˆæ‰‹æœºå· &#x2F; å¯†ç  &#x2F; ç¬¬ä¸‰æ–¹ç™»å½•ï¼‰</li>
<li><strong>æ€ä¹ˆç”¨</strong>ï¼š<ul>
<li>å®šä¹‰ç»Ÿä¸€æ¥å£ <code>LoginStrategy</code></li>
<li>ç¼–å†™ä¸åŒç­–ç•¥ç±» <code>PhoneLoginStrategy</code>ã€<code>PwdLoginStrategy</code></li>
<li>ç”¨å·¥å‚æˆ–Mapå°è£…ï¼Œæ¥æ”¶ä¸€ä¸ªç™»å½•ç±»å‹å‚æ•°è°ƒç”¨ <code>.doLogin()</code></li>
</ul>
</li>
</ul>
<h5 id="âœ…-è´£ä»»é“¾æ¨¡å¼ï¼ˆChain-of-Responsibilityï¼‰"><a href="#âœ…-è´£ä»»é“¾æ¨¡å¼ï¼ˆChain-of-Responsibilityï¼‰" class="headerlink" title="âœ… è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰"></a>âœ… è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šå¤šä¸ªå¤„ç†å™¨ä¸€ä¸ªæ¥ä¸€ä¸ªå¤„ç†</li>
<li><strong>åœºæ™¯</strong>ï¼šè¡¨å•å‚æ•°æ ¡éªŒã€ä¸‹å•æµç¨‹ã€å®¡æ‰¹æµç¨‹</li>
<li><strong>é€’å½’ or è¿­ä»£å®ç°</strong>ï¼š<ul>
<li>è¿­ä»£ï¼šList + forå¾ªç¯</li>
<li>é€’å½’ï¼šä¸€ä¸ª Handler å†…éƒ¨ <code>next.handle(request)</code></li>
</ul>
</li>
</ul>
<h5 id="âœ…-æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate-Methodï¼‰"><a href="#âœ…-æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate-Methodï¼‰" class="headerlink" title="âœ… æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Methodï¼‰"></a>âœ… æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Methodï¼‰</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šçˆ¶ç±»å®šä¹‰ç®—æ³•æ¡†æ¶ï¼Œå­ç±»å®ç°æ­¥éª¤</li>
<li><strong>åœºæ™¯</strong>ï¼šæ”¯ä»˜æµç¨‹ã€é€šçŸ¥å‘é€ï¼ˆçŸ­ä¿¡&#x2F;å¾®ä¿¡ï¼‰</li>
<li><strong>æ€ä¹ˆç”¨</strong>ï¼š<ul>
<li>æŠ½è±¡ç±»å®šä¹‰ <code>checkParams</code>ã€<code>buildRequest</code>ã€<code>send</code></li>
<li>å­ç±»å®ç°è¿™äº›æ­¥éª¤</li>
</ul>
</li>
</ul>
<h5 id="âœ…-è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰"><a href="#âœ…-è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰" class="headerlink" title="âœ… è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰"></a>âœ… è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šä¸€ä¸ªå˜åŒ–é€šçŸ¥å¤šä¸ªè®¢é˜…è€…</li>
<li><strong>åœºæ™¯</strong>ï¼šMQæ¶ˆè´¹åè§¦å‘å¤šä¸ªäº‹ä»¶ã€å‘å¸ƒæ–‡ç« åé€šçŸ¥å…³æ³¨è€…</li>
<li><strong>æ€ä¹ˆç”¨</strong>ï¼š<ul>
<li>Spring çš„ <code>@EventListener</code></li>
<li>Guava EventBus &#x2F; Disruptor</li>
</ul>
</li>
</ul>
<hr>
<h4 id="2ï¸âƒ£-åˆ›å»ºå‹æ¨¡å¼"><a href="#2ï¸âƒ£-åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="2ï¸âƒ£ åˆ›å»ºå‹æ¨¡å¼"></a>2ï¸âƒ£ <strong>åˆ›å»ºå‹æ¨¡å¼</strong></h4><h5 id="âœ…-å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰"><a href="#âœ…-å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰" class="headerlink" title="âœ… å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰"></a>âœ… å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåˆ›å»ºå¯¹è±¡è§£è€¦</li>
<li><strong>åœºæ™¯</strong>ï¼šåˆ›å»ºä¸åŒç±»å‹çš„ç­–ç•¥ç±»ã€æ„å»ºä¸åŒæŠ¥æ–‡ä½“</li>
<li><strong>æ€ä¹ˆç”¨</strong>ï¼š<ul>
<li>å®šä¹‰å·¥å‚ç±»ï¼Œæ ¹æ®å‚æ•° new ä¸åŒç±»æˆ–ä» map ä¸­ get</li>
</ul>
</li>
</ul>
<h5 id="âœ…-å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰"><a href="#âœ…-å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰" class="headerlink" title="âœ… å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰"></a>âœ… å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåªåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒèŠ‚çœèµ„æº</li>
<li><strong>åœºæ™¯</strong>ï¼šé…ç½®ç±»ã€å·¥å…·ç±»ã€ç¼“å­˜ç±»ã€Spring é»˜è®¤å°±æ˜¯å•ä¾‹</li>
</ul>
<hr>
<h4 id="3ï¸âƒ£-ç»“æ„å‹æ¨¡å¼"><a href="#3ï¸âƒ£-ç»“æ„å‹æ¨¡å¼" class="headerlink" title="3ï¸âƒ£ ç»“æ„å‹æ¨¡å¼"></a>3ï¸âƒ£ <strong>ç»“æ„å‹æ¨¡å¼</strong></h4><h5 id="âœ…-ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰"><a href="#âœ…-ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰" class="headerlink" title="âœ… ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰"></a>âœ… ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰</h5><ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šç»™ç›®æ ‡å¯¹è±¡åŠ ä¸€å±‚æ§åˆ¶</li>
<li><strong>åœºæ™¯</strong>ï¼šæƒé™æ§åˆ¶ã€RPCè¿œç¨‹è°ƒç”¨ã€é™æµã€ç¼“å­˜</li>
<li><strong>æ€ä¹ˆç”¨</strong>ï¼š<ul>
<li>JDKåŠ¨æ€ä»£ç†ã€CGLIB</li>
<li>Spring AOPå°±æ˜¯ä»£ç†æ¨¡å¼ï¼ˆåŠ æ—¥å¿—ã€æƒé™ç­‰ï¼‰</li>
</ul>
</li>
</ul>
<h5 id="è¡Œä¸ºæœ‰ç­–ç•¥ï¼Œæµç¨‹é è´£ä»»ï¼›éª¨æ¶å®šæ¨¡æ¿ï¼Œé€šçŸ¥ç”¨è§‚å¯Ÿï¼›å¯¹è±¡å»ºå·¥å‚ï¼Œä¸­é—´é ä»£ç†ï¼Œå”¯ä¸€å•å®ä¾‹ã€‚"><a href="#è¡Œä¸ºæœ‰ç­–ç•¥ï¼Œæµç¨‹é è´£ä»»ï¼›éª¨æ¶å®šæ¨¡æ¿ï¼Œé€šçŸ¥ç”¨è§‚å¯Ÿï¼›å¯¹è±¡å»ºå·¥å‚ï¼Œä¸­é—´é ä»£ç†ï¼Œå”¯ä¸€å•å®ä¾‹ã€‚" class="headerlink" title="è¡Œä¸ºæœ‰ç­–ç•¥ï¼Œæµç¨‹é è´£ä»»ï¼›éª¨æ¶å®šæ¨¡æ¿ï¼Œé€šçŸ¥ç”¨è§‚å¯Ÿï¼›å¯¹è±¡å»ºå·¥å‚ï¼Œä¸­é—´é ä»£ç†ï¼Œå”¯ä¸€å•å®ä¾‹ã€‚"></a><span style = "color:blue">è¡Œä¸ºæœ‰ç­–ç•¥ï¼Œæµç¨‹é è´£ä»»ï¼›éª¨æ¶å®šæ¨¡æ¿ï¼Œé€šçŸ¥ç”¨è§‚å¯Ÿï¼›å¯¹è±¡å»ºå·¥å‚ï¼Œä¸­é—´é ä»£ç†ï¼Œå”¯ä¸€å•å®ä¾‹ã€‚</span></h5></blockquote>
<h6 id="æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ"><a href="#æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ" class="headerlink" title="æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ"></a>æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ</h6><blockquote>
<h3 id="1-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨"><a href="#1-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨" class="headerlink" title="1. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨"></a>1. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨</h3><p>è¿™ç§æ–¹å¼åœ¨ç±»åŠ è½½æ—¶ä¸åˆå§‹åŒ–ã€‚åœ¨éœ€è¦çš„æ—¶å€™æ‰åˆ›å»ºå¯¹è±¡ï¼ŒèŠ‚çº¦èµ„æºã€‚</p>
<pre><code>public class Singleton &#123;
    private static Singleton instance;
    private Singleton() &#123;&#125;

    public static Singleton getInstance() &#123;
        if (instance == null) &#123;
            instance = new Singleton();
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<h3 id="2-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨"><a href="#2-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨" class="headerlink" title="2. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨"></a>2. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨</h3><p>é€šè¿‡åŒæ­¥æ–¹æ³•ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</p>
<pre><code>public class Singleton &#123;
    private static Singleton instance;
    private Singleton() &#123;&#125;

    public static synchronized Singleton getInstance() &#123;
        if (instance == null) &#123;
            instance = new Singleton();
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<h3 id="3-é¥¿æ±‰å¼"><a href="#3-é¥¿æ±‰å¼" class="headerlink" title="3. é¥¿æ±‰å¼"></a>3. é¥¿æ±‰å¼</h3><p>ç±»åŠ è½½æ—¶å°±å®Œæˆäº†åˆå§‹åŒ–ï¼Œä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§ã€‚å®¹æ˜“æµªè´¹èµ„æº</p>
<pre><code>public class Singleton &#123;
    private static Singleton instance = new Singleton();
    private Singleton() &#123;&#125;

    public static Singleton getInstance() &#123;
        return instance;
    &#125;
&#125;
</code></pre>
<h3 id="4-åŒé‡æ ¡éªŒé”"><a href="#4-åŒé‡æ ¡éªŒé”" class="headerlink" title="4. åŒé‡æ ¡éªŒé”"></a>4. åŒé‡æ ¡éªŒé”</h3><p>çº¿ç¨‹å®‰å…¨ä¸”åœ¨å®ä¾‹åŸŸéœ€è¦å»¶è¿ŸåŠ è½½æ—¶æé«˜æ€§èƒ½ã€‚</p>
<pre><code>public class Singleton &#123;
    private volatile static Singleton singleton;
    private Singleton() &#123;&#125;

    public static Singleton getInstance() &#123;
        if (singleton == null) &#123;
            synchronized (Singleton.class) &#123;
                if (singleton == null) &#123;
                    singleton = new Singleton();
                &#125;
            &#125;
        &#125;
        return singleton;
    &#125;
&#125;
</code></pre>
<h3 id="5-é™æ€å†…éƒ¨ç±»"><a href="#5-é™æ€å†…éƒ¨ç±»" class="headerlink" title="5. é™æ€å†…éƒ¨ç±»"></a>5. é™æ€å†…éƒ¨ç±»</h3><p>è¿™ç§æ–¹å¼æ—¢å®ç°äº†æ‡’åŠ è½½ï¼Œåˆä¿è¯äº†çº¿æ€§å®‰å…¨ã€‚</p>
<pre><code>public class Singleton &#123;
    private static class SingletonHolder &#123;
        private static final Singleton INSTANCE = new Singleton();
    &#125;
    private Singleton() &#123;&#125;

    public static final Singleton getInstance() &#123;
        return SingletonHolder.INSTANCE;
    &#125;
&#125;
</code></pre>
<h3 id="6-æšä¸¾"><a href="#6-æšä¸¾" class="headerlink" title="6. æšä¸¾"></a>6. æšä¸¾</h3><p>å®ç°å•ä¾‹çš„æœ€ä½³æ–¹æ³•ï¼Œå®ƒä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜è‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œé˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p>
<pre><code class="java">public enum Singleton &#123;
    INSTANCE;
    public void whateverMethod() &#123;
    &#125;
&#125;
</code></pre>
</blockquote>
<h4 id="MySQLæ”¯æŒå››ç§éš”ç¦»çº§åˆ«"><a href="#MySQLæ”¯æŒå››ç§éš”ç¦»çº§åˆ«" class="headerlink" title="MySQLæ”¯æŒå››ç§éš”ç¦»çº§åˆ«"></a><span style = "color:red"><u>MySQLæ”¯æŒå››ç§éš”ç¦»çº§åˆ«</u></span></h4><ul>
<li><p><u>ç¬¬ä¸€ä¸ª</u>æ˜¯<strong>è¯»æœªæäº¤</strong>(readuncomm itted)å®ƒè§£å†³ä¸äº†åˆšæ‰æå‡ºçš„æ‰€æœ‰é—®é¢˜ï¼Œä¸€èˆ¬é¡¹ç›®ä¸­ä¹Ÿä¸ç”¨è¿™ä¸ªã€‚å­˜åœ¨è„è¯»é—®é¢˜  å¯è§£å†³ä¸å¯é‡å¤è¯» å¹»è¯»<br><code>**ä¸å¯è§£å†³è„è¯»**ï¼šè¯»æœªæäº¤å…è®¸ä¸€ä¸ªäº‹åŠ¡è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡å°šæœªæäº¤çš„æ•°æ®å˜æ›´ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡çš„æœªæäº¤æ•°æ®ï¼Œç„¶åé‚£ä¸ªäº‹åŠ¡å›æ»šï¼Œåˆ™ç¬¬ä¸€ä¸ªäº‹åŠ¡è¯»å–çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„ï¼ˆè„æ•°æ®ï¼‰</code></p>
</li>
<li><p><u>ç¬¬äºŒä¸ª</u>æ˜¯<strong>è¯»å·²æäº¤</strong>(readcomm ited)å®ƒèƒ½è§£å†³è„è¯»çš„é—®é¢˜çš„ï¼Œä½†æ˜¯è§£å†³ä¸äº†ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ã€‚<br><code>**è§£å†³è„ç‹¬**ï¼šè¯»å·²æäº¤ç¡®ä¿ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å·²ç»æäº¤çš„æ•°æ®å˜æ›´ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡æ­£åœ¨ä¿®æ”¹æŸäº›æ•°æ®ï¼Œé‚£ä¹ˆåœ¨å®ƒæäº¤ä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½è¯»å–è¿™äº›æ•°æ®ã€‚è¿™æ ·å°±å¯ä»¥é¿å…è„è¯»ã€‚</code><br><code>**ä¸å¯è§£å†³ä¸å¯é‡å¤è¯»**ï¼šä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æŸäº›æ•°æ®åï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†è¿™äº›æ•°æ®å¹¶æäº¤ï¼Œå¯¼è‡´ç¬¬ä¸€ä¸ªäº‹åŠ¡å†æ¬¡è¯»å–æ—¶å¾—åˆ°ä¸åŒçš„ç»“æœ</code><br><code>**ä¸å¯è§£å†³å¹»è¯»**ï¼šä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®åï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ’å…¥äº†ä¸€äº›æ–°æ•°æ®å¹¶æäº¤ï¼Œå¯¼è‡´ç¬¬ä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢æ—¶çœ‹åˆ°äº†æ–°æ’å…¥çš„æ•°æ®</code></p>
</li>
<li><p><u>ç¬¬ä¸‰ä¸ª</u>æ˜¯<strong>å¯é‡å¤è¯»</strong>(repeatable read)å®ƒèƒ½è§£å†³è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†æ˜¯è§£å†³ä¸äº†å¹»è¯»[è§£å†³äº†ä¸€éƒ¨åˆ†]ï¼Œè¿™ä¸ªä¹Ÿæ˜¯mysqlé»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚</p>
</li>
<li><p><u>ç¬¬å››ä¸ª</u>æ˜¯<strong>ä¸²è¡ŒåŒ–</strong>(serializable)å®ƒå¯ä»¥è§£å†³åˆšæ‰æå‡ºæ¥çš„æ‰€æœ‰é—®é¢˜ï¼Œä½†æ˜¯ç”±äºè®©æ˜¯äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œçš„ï¼Œæ€§èƒ½æ¯”è¾ƒä½ã€‚<br>ä¸²è¡ŒåŒ–é‡Œçš„è¯»ä¹Ÿè¦åŠ é” è¡¨é”ï¼šæ•´ä¸ªè¡¨ä¸Šé”            è¡Œé”ï¼šåªå¯¹ä¸€è¡ŒåŠ é”<br><code>ä¸²è¡ŒåŒ–æ˜¯æœ€ä¸¥æ ¼çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚å®ƒé€šè¿‡å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œæ¥é¿å…ä¸Šè¿°æ‰€æœ‰é—®é¢˜ã€‚åœ¨ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šé”å®šæ¶‰åŠçš„æ‰€æœ‰æ•°æ®è¡Œæˆ–è¡¨ï¼Œç›´åˆ°äº‹åŠ¡å®Œæˆã€‚è¿™ç¡®ä¿äº†äº‹åŠ¡å®Œå…¨éš”ç¦»ï¼Œä½†æ˜¯ä¼šæ˜¾è‘—é™ä½ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½</code></p>
</li>
</ul>
<h6 id="ä»€ä¹ˆæ—¶å€™ä¸Šè¡Œé”-x2F-è¡¨é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ—¶å€™ä¸Šè¡Œé”-x2F-è¡¨é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä¸Šè¡Œé”&#x2F;è¡¨é”ï¼Ÿ"></a>ä»€ä¹ˆæ—¶å€™ä¸Šè¡Œé”&#x2F;è¡¨é”ï¼Ÿ</h6><p><code>INSERT</code>ä¸å¸¦æŸ¥è¯¢ç­›é€‰æ¡ä»¶  <strong>ä¸Šè¡Œé”</strong><del>åº•å±‚æ˜¯ç´¢å¼•ï¼Œb+æ ‘åº•å±‚å¶å­</del></p>
<blockquote>
<ul>
<li><strong>è¡Œé”</strong>ï¼šé€šå¸¸æƒ…å†µä¸‹ï¼Œæ’å…¥æ“ä½œä¼šé”å®šæ’å…¥è¡Œæ‰€åœ¨çš„ç´¢å¼•é¡¹ï¼Œä»¥é˜²æ­¢å…¶ä»–äº‹åŠ¡åŒæ—¶ä¿®æ”¹åŒä¸€è¡Œã€‚è¿™æ˜¯å› ä¸ºæ•°æ®åº“é€šå¸¸ä½¿ç”¨B+æ ‘æ¥ç»´æŠ¤ç´¢å¼•ï¼Œ<strong>æ’å…¥æ“ä½œéœ€è¦åœ¨B+æ ‘ä¸­æ‰¾åˆ°æ­£ç¡®çš„ä½ç½®æ¥æ’å…¥æ–°çš„ç´¢å¼•é¡¹</strong>ã€‚å¦‚æœæ’å…¥æ“ä½œæ¶‰åŠåˆ°å”¯ä¸€ç´¢å¼•ï¼Œæ•°æ®åº“è¿˜ä¼šæ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„é”®å€¼ï¼Œè¿™ä¹Ÿä¼šè§¦å‘è¡Œé”ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šå³ä½¿æ’å…¥æ“ä½œæ²¡æœ‰æŸ¥è¯¢ç­›é€‰æ¡ä»¶ï¼Œå®ƒä»ç„¶å¯èƒ½æ¶‰åŠåˆ°è¡Œé”ï¼Œå› ä¸ºæ•°æ®åº“éœ€è¦ä¿è¯æ–°æ’å…¥çš„æ•°æ®ä¸ä¼šä¸ç°æœ‰æ•°æ®å†²çªã€‚</li>
</ul>
</blockquote>
<p><code>UPDATE</code>çœ‹whereåé¢çš„æ¡ä»¶ <strong>å¸¦ç´¢å¼•</strong>åŠ è¡Œé”<del>æ„å»ºb+æ ‘</del> <strong>ä¸å¸¦ç´¢å¼•</strong>çš„åŠ è¡¨é”<br>è¡¨é”çš„é€Ÿåº¦æ¯”è¡Œé”é€Ÿåº¦å¿«</p>
<blockquote>
<h6 id="å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š"><a href="#å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š" class="headerlink" title="å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š"></a>å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š</h6><ul>
<li><strong>è¡Œé”</strong>ï¼šå¦‚æœæ›´æ–°æ“ä½œçš„æ¡ä»¶æ˜¯ç´¢å¼•åˆ—ï¼Œæ•°æ®åº“èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°éœ€è¦æ›´æ–°çš„è¡Œï¼Œå› æ­¤åªä¼šé”å®šé‚£äº›ç‰¹å®šçš„è¡Œã€‚è¡Œé”å¯ä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘é”å®šçš„æ•°æ®é‡ï¼Œä»è€Œæé«˜å¹¶å‘æ€§èƒ½ã€‚</li>
<li><strong>åŸç†</strong>ï¼šæ•°æ®åº“ä½¿ç”¨B+æ ‘ç´¢å¼•æ¥å¿«é€ŸæŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œç„¶åå¯¹è¿™äº›è¡ŒåŠ é”ã€‚</li>
</ul>
<h6 id="ä¸å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š"><a href="#ä¸å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š" class="headerlink" title="ä¸å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š"></a>ä¸å¸¦ç´¢å¼•çš„æ¡ä»¶ï¼š</h6><ul>
<li><strong>è¡¨é”</strong>ï¼šå¦‚æœæ›´æ–°æ“ä½œçš„æ¡ä»¶ä¸æ˜¯ç´¢å¼•åˆ—ï¼Œæ•°æ®åº“å¯èƒ½éœ€è¦æ‰«ææ•´ä¸ªè¡¨æ¥æ‰¾åˆ°éœ€è¦æ›´æ–°çš„è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†ç®€åŒ–é”å®šé€»è¾‘å¹¶é˜²æ­¢åœ¨æ‰«æè¿‡ç¨‹ä¸­æ•°æ®è¢«ä¿®æ”¹ï¼Œæ•°æ®åº“å¯èƒ½ä¼šé€‰æ‹©é”å®šæ•´ä¸ªè¡¨ã€‚</li>
<li><strong>åŸç†</strong>ï¼šç”±äºæ²¡æœ‰ç´¢å¼•å¯ä»¥åˆ©ç”¨ï¼Œæ•°æ®åº“å¿…é¡»æ£€æŸ¥æ¯ä¸€è¡Œæ¥ç¡®å®šæ˜¯å¦æ»¡è¶³æ›´æ–°æ¡ä»¶ï¼Œå› æ­¤ä½¿ç”¨è¡¨é”å¯ä»¥é¿å…å¤æ‚çš„é”å®šç®¡ç†ã€‚</li>
</ul>
</blockquote>
<p>MVCCåº•å±‚æ˜¯å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ ä½†åº•å±‚å¹¶ä¸æ€ä¹ˆäº†è§£</p>
<blockquote>
<h3 id="ğŸ§©-äºŒã€é”çš„åˆ¤æ–­ä¾æ®"><a href="#ğŸ§©-äºŒã€é”çš„åˆ¤æ–­ä¾æ®" class="headerlink" title="ğŸ§© äºŒã€é”çš„åˆ¤æ–­ä¾æ®"></a>ğŸ§© äºŒã€é”çš„åˆ¤æ–­ä¾æ®</h3><table>
<thead>
<tr>
<th>æ“ä½œç±»å‹</th>
<th>æ˜¯å¦ä½¿ç”¨ç´¢å¼•ï¼Ÿ</th>
<th>é”ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>INSERT</code></td>
<td>å’Œæ˜¯å¦å†²çªæœ‰å…³</td>
<td>è¡Œé”æˆ–è¡¨é”</td>
<td>INSERTé»˜è®¤åŠ <strong>æ„å‘æ’ä»–é” + è¡Œé”</strong>ï¼Œå”¯ä¸€ç´¢å¼•å†²çªæ—¶åŠ é”æ›´å¤æ‚</td>
</tr>
<tr>
<td><strong><code>UPDATE</code></strong></td>
<td><strong><code>WHERE</code>ä½¿ç”¨äº†ç´¢å¼•</strong></td>
<td><strong>è¡Œé”ï¼ˆæ¨èï¼‰</strong></td>
<td>å‘½ä¸­ç´¢å¼•èŒƒå›´ â†’ è¡Œé”ï¼›å¯å¹¶å‘æ›´æ–°ä¸åŒæ•°æ®è¡Œ</td>
</tr>
<tr>
<td><code>UPDATE</code></td>
<td><code>WHERE</code>æ²¡ç”¨ç´¢å¼•</td>
<td>è¡¨é”ï¼ˆä¸æ¨èï¼‰</td>
<td>æ‰«æå…¨è¡¨æ‰¾ç›®æ ‡ â†’ è¡¨é”ï¼›é˜»å¡æ€§å¤§</td>
</tr>
<tr>
<td><code>DELETE</code></td>
<td>å’Œ UPDATE ç±»ä¼¼</td>
<td>åŒä¸Š</td>
<td>åˆ é™¤ç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œå’Œæ›´æ–°é€»è¾‘ä¸€æ ·</td>
</tr>
<tr>
<td><code>SELECT</code></td>
<td>æ™®é€šæŸ¥è¯¢</td>
<td>æ— é”ï¼ˆMVCCï¼‰</td>
<td>è¯»ä¸åŠ é”ï¼Œé å¿«ç…§ç‰ˆæœ¬</td>
</tr>
<tr>
<td><code>SELECT ... for update</code></td>
<td>ä½¿ç”¨ç´¢å¼•ï¼Ÿ</td>
<td>è¡Œé”æˆ–è¡¨é”</td>
<td>å¼ºåˆ¶åŠ é”ï¼Œä¾èµ–ç´¢å¼•åˆ¤æ–­è¡Œé”&#x2F;è¡¨é”</td>
</tr>
</tbody></table>
<h3 id="ABA-é—®é¢˜ï¼ˆä¹è§‚é”å»¶ç”³ï¼‰"><a href="#ABA-é—®é¢˜ï¼ˆä¹è§‚é”å»¶ç”³ï¼‰" class="headerlink" title="ABA é—®é¢˜ï¼ˆä¹è§‚é”å»¶ç”³ï¼‰"></a>ABA é—®é¢˜ï¼ˆä¹è§‚é”å»¶ç”³ï¼‰</h3><p>ä½ å‰é¢è¯´å¾—å¯¹ï¼Œåœ¨<strong>å¹¶å‘é«˜åœºæ™¯</strong>ä¸­ï¼Œå³ä½¿æ•°æ®å€¼ä¸€æ ·ä¹Ÿä¸èƒ½è®¤ä¸ºæ²¡å˜ï¼Œè¿™å°±æ˜¯<strong>ABAé—®é¢˜</strong>ï¼š</p>
<ul>
<li>Açº¿ç¨‹è¯»äº†ç‰ˆæœ¬ä¸º1çš„æ•°æ®ï¼Œå‡†å¤‡æ›´æ–°</li>
<li>Bçº¿ç¨‹å°†æ•°æ®ä»Aæ”¹ä¸ºBï¼Œåˆæ”¹å›Aï¼Œç‰ˆæœ¬å·å˜äº†</li>
<li>Açº¿ç¨‹å†æ›´æ–°æ—¶å‘ç°ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œé¿å…äº†è¯¯æ“ä½œï¼</li>
</ul>
<p>è§£å†³æ–¹å¼å°±æ˜¯ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>version</code> å­—æ®µ + ä¹è§‚é”æ›´æ–° <code>WHERE version = ?</code></li>
<li>å¦‚æœæ›´æ–°å¤±è´¥ï¼Œé‡è¯•æˆ–æç¤ºå¤±è´¥ï¼ˆå¯åŠ é‡è¯•æ¬¡æ•°ï¼‰</li>
</ul>
<p>åœ¨MySQLä¸­æ˜¯å¦åŠ è¡Œé”è¿˜æ˜¯è¡¨é”ï¼Œå–å†³äºæ˜¯å¦å‘½ä¸­äº†ç´¢å¼•ã€‚</p>
<ul>
<li>å¯¹äº <code>UPDATE</code> &#x2F; <code>DELETE</code> ç­‰ DML è¯­å¥ï¼Œå¦‚æœ <code>WHERE</code> æ¡ä»¶å‘½ä¸­ç´¢å¼•ï¼ŒInnoDB ä¼šåŠ <strong>è¡Œé”</strong>ï¼›</li>
<li>å¦‚æœæœªå‘½ä¸­ç´¢å¼•ï¼Œåˆ™ä¼šåŠ <strong>è¡¨é”</strong>ï¼Œä»¥ä¿è¯æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚<br> æ’å…¥ <code>INSERT</code> ä¸€èˆ¬æ˜¯å¯¹ B+ æ ‘é¡µåŠ æ„å‘é”å’Œæ’å…¥ä½ç½®åŠ é”ï¼Œå¦‚æœæ¶‰åŠå”¯ä¸€ç´¢å¼•æ ¡éªŒä¹Ÿä¼šåŠ é”ã€‚<br> å¯¹äºå¹¶å‘æ§åˆ¶ï¼ŒMySQLé‡‡ç”¨MVCCæœºåˆ¶æ¥å®ç°éé˜»å¡è¯»å†™ï¼Œåœ¨è¯»æ—¶ä¸åŠ é”è€Œæ˜¯ä½¿ç”¨å¿«ç…§ç‰ˆæœ¬ã€‚<br> å¦‚æœä¸šåŠ¡æ¶‰åŠä¹è§‚é”é˜²æ­¢å¹¶å‘æ›´æ–°é”™è¯¯ï¼Œè¿˜å¯ä»¥é€šè¿‡ç‰ˆæœ¬å·æ§åˆ¶æ¥é¿å…ABAé—®é¢˜ã€‚</li>
</ul>
</blockquote>
<h4 id="æ·±æ‹·è´å’Œæµ…æ‹·è´çš„åŒºåˆ«ï¼Ÿ"><a href="#æ·±æ‹·è´å’Œæµ…æ‹·è´çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="æ·±æ‹·è´å’Œæµ…æ‹·è´çš„åŒºåˆ«ï¼Ÿ"></a>æ·±æ‹·è´å’Œæµ…æ‹·è´çš„åŒºåˆ«ï¼Ÿ</h4><p><strong>æµ…æ‹·è´</strong>ï¼šåªå¤åˆ¶å¯¹è±¡çš„<strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>å’Œ<strong>å¼•ç”¨ç±»å‹åœ°å€</strong>ï¼Œä¸å¤åˆ¶å¼•ç”¨ç±»å‹æŒ‡å‘çš„å¯¹è±¡ã€‚å¦‚æœåŸå¯¹è±¡å’Œæµ…æ‹·è´å¯¹è±¡ä¸­çš„ä¸€ä¸ªæ”¹å˜äº†å¼•ç”¨ç±»å‹ï¼Œå¦ä¸€ä¸ªä¹Ÿä¼šå—åˆ°å½±å“ã€‚æ—§å¯¹è±¡æ”¹å˜æ–°å¯¹è±¡ä¹Ÿä¼šæ”¹å˜ã€‚<br><strong>æ·±æ‹·è´</strong>ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨ç±»å‹æŒ‡å‘çš„å¯¹è±¡ã€‚åŸå¯¹è±¡å’Œæ·±æ‹·è´å¯¹è±¡ä¹‹é—´ä¸ä¼šç›¸äº’å½±å“ã€‚æ—§å¯¹è±¡æ”¹å˜æ–°å¯¹è±¡ä¸ä¼šæ”¹å˜<br>  Javaæ˜¯å€¼ä¼ é€’ </p>
<h6 id="å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿæ•°ç»„ä¸éœ€è¦é‡å†™ã€ä½“ç°äº†åŸå‹è®¾è®¡æ¨¡å¼ã€‘"><a href="#å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿæ•°ç»„ä¸éœ€è¦é‡å†™ã€ä½“ç°äº†åŸå‹è®¾è®¡æ¨¡å¼ã€‘" class="headerlink" title="å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿæ•°ç»„ä¸éœ€è¦é‡å†™ã€ä½“ç°äº†åŸå‹è®¾è®¡æ¨¡å¼ã€‘"></a>å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿ<del>æ•°ç»„ä¸éœ€è¦é‡å†™</del>ã€ä½“ç°äº†<code>åŸå‹è®¾è®¡æ¨¡å¼</code>ã€‘</h6><ul>
<li><p>å®ç°<strong>Cloneableæ¥å£</strong>å¹¶é‡å†™<strong>clone</strong>æ–¹æ³• ä¼šè°ƒç”¨æ„é€ æ–¹æ³•</p>
<p>è¿™æ˜¯æœ€å¸¸è§çš„å®ç°æ·±æ‹·è´çš„æ–¹æ³•ã€‚é¦–å…ˆï¼Œä½ çš„ç±»éœ€è¦å®ç°<code>Cloneable</code>æ¥å£ï¼Œç„¶åé‡å†™<code>clone()</code>æ–¹æ³•<del>æ„é€ æ–°å¯¹è±¡çš„è¿‡ç¨‹</del>ï¼Œå¹¶åœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨<code>super.clone()</code>ï¼ŒåŒæ—¶é€’å½’åœ°å…‹éš†æ‰€æœ‰å¼•ç”¨ç±»å‹çš„å­—æ®µã€‚[å¦‚æœé‡Œé¢æœ‰å¤šå±‚åµŒå¥—å¤æ‚å¯¹è±¡ åœ¨æ¯å±‚éƒ½è¦å®ç°Cloneableæ¥å£ä¸€ç›´é‡å†™åˆ°åŸºæœ¬æ•°æ®ç±»å‹çš„æ—¶å€™æ‰åœæ­¢]</p>
</li>
</ul>
<pre><code class="java">public class Person implements Cloneable &#123;
    private int age;
    private Address address;

    // æ„é€ å™¨ã€getterã€setter çœç•¥

    @Override
    protected Object clone() throws CloneNotSupportedException &#123;
        Person cloned = (Person) super.clone();
        // å‡è®¾Addressä¹Ÿå®ç°äº†Cloneableæ¥å£
        cloned.address = (Address) this.address.clone(); 
        return cloned;
    &#125;
&#125;

public class Address implements Cloneable &#123;
    private String street;
    private String city;

    // æ„é€ å™¨ã€getterã€setter çœç•¥

    @Override
    protected Object clone() throws CloneNotSupportedException &#123;
        return super.clone();
    &#125;
&#125;
</code></pre>
<ul>
<li>é€šè¿‡<strong>åºåˆ—åŒ–</strong><del>å¯¹è±¡è½¬äºŒè¿›åˆ¶</del>å’Œ<strong>ååºåˆ—åŒ–</strong><del>äºŒè¿›åˆ¶è½¬å¯¹è±¡</del>ã€‚è¿™ç§æ–¹å¼ä¸éœ€è¦å®ç°<code>Cloneable</code>æ¥å£ï¼Œä½†ä½ çš„ç±»éœ€è¦å®ç°<code>Serializable</code>æ¥å£ã€‚ååºåˆ—åŒ–ä¸ä¼šè°ƒç”¨æ„é€ æ–¹æ³•</li>
</ul>
<blockquote>
<table>
<thead>
<tr>
<th>ç»´åº¦</th>
<th>æµ…æ‹·è´</th>
<th>æ·±æ‹·è´</th>
</tr>
</thead>
<tbody><tr>
<td>åŸºæœ¬æ•°æ®ç±»å‹</td>
<td>å¤åˆ¶å€¼</td>
<td>å¤åˆ¶å€¼</td>
</tr>
<tr>
<td>å¼•ç”¨ç±»å‹</td>
<td>å¤åˆ¶<strong>å¼•ç”¨åœ°å€</strong>ï¼ŒæŒ‡å‘åŒä¸€å¯¹è±¡</td>
<td>å¤åˆ¶<strong>å¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡</strong>ï¼Œ<strong>å¼€è¾Ÿæ–°å†…å­˜ç©ºé—´</strong></td>
</tr>
<tr>
<td>æ˜¯å¦å½±å“åŸå¯¹è±¡</td>
<td>ä¼šå½±å“ï¼ˆå…±äº«å¼•ç”¨ï¼‰</td>
<td>ä¸ä¼šå½±å“ï¼ˆå„è‡ªç‹¬ç«‹ï¼‰</td>
</tr>
<tr>
<td>æ€§èƒ½</td>
<td>å¿«ï¼Œå¼€é”€å°</td>
<td>æ…¢ï¼Œé€’å½’å¤åˆ¶æ‰€æœ‰å¯¹è±¡</td>
</tr>
<tr>
<td>ä½¿ç”¨åœºæ™¯</td>
<td>æ•°æ®ä¸å˜æˆ–åªè¯»åœºæ™¯</td>
<td>æ•°æ®å®Œå…¨éš”ç¦»ã€éœ€è¦ç‹¬ç«‹å‰¯æœ¬åœºæ™¯</td>
</tr>
</tbody></table>
<p>åœ¨Javaä¸­ï¼Œæµ…æ‹·è´ä»…å¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹å€¼å’Œå¼•ç”¨ç±»å‹åœ°å€ï¼Œå› æ­¤å¤šä¸ªå¯¹è±¡å¯èƒ½å…±äº«åŒä¸€å¼•ç”¨ï¼Œä¸€æ–¹ä¿®æ”¹ä¼šå½±å“å¦ä¸€æ–¹ï¼›è€Œæ·±æ‹·è´åˆ™ä¼šé€’å½’å¤åˆ¶æ‰€æœ‰å¼•ç”¨å¯¹è±¡ï¼Œå®Œå…¨éš”ç¦»å‰¯æœ¬ã€‚</p>
<p>é€šå¸¸æµ…æ‹·è´ä½¿ç”¨ <code>super.clone()</code> å³å¯ï¼Œè€Œæ·±æ‹·è´éœ€è¦å®ç° <code>Cloneable</code> æ¥å£ + æ‰‹åŠ¨å¯¹æ¯ä¸€ä¸ªå¼•ç”¨ç±»å‹é€’å½’å…‹éš†ï¼Œæˆ–ä½¿ç”¨åºåˆ—åŒ–æ–¹æ¡ˆæ›´ä¸ºç®€æ´ã€‚æ·±æ‹·è´ä½“ç°äº†åŸå‹è®¾è®¡æ¨¡å¼çš„æ€æƒ³ï¼Œé€‚åˆäºéœ€è¦ä¿ç•™å¯¹è±¡å¿«ç…§ã€æ’¤é”€åŠŸèƒ½ã€ç¼“å­˜éš”ç¦»ç­‰åœºæ™¯ã€‚</p>
</blockquote>
<h4 id="å¼€å¯çº¿ç¨‹çš„æ—¶å€™ä¸ºä»€ä¹ˆç”¨çš„æ˜¯thread-startæ–¹æ³•ï¼š"><a href="#å¼€å¯çº¿ç¨‹çš„æ—¶å€™ä¸ºä»€ä¹ˆç”¨çš„æ˜¯thread-startæ–¹æ³•ï¼š" class="headerlink" title="å¼€å¯çº¿ç¨‹çš„æ—¶å€™ä¸ºä»€ä¹ˆç”¨çš„æ˜¯thread.startæ–¹æ³•ï¼š"></a>å¼€å¯çº¿ç¨‹çš„æ—¶å€™ä¸ºä»€ä¹ˆç”¨çš„æ˜¯thread.startæ–¹æ³•ï¼š</h4><p>thread.start()æ–¹æ³•ç”¨äº<strong>å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹</strong>ï¼Œå¹¶æ‰§è¡Œ<strong>è¯¥çº¿ç¨‹</strong>çš„run()æ–¹æ³•ã€‚è°ƒç”¨start()æ–¹æ³•åï¼Œçº¿ç¨‹ä¼šè¢«æ”¾å…¥çº¿ç¨‹è°ƒåº¦é˜Ÿåˆ—ï¼Œç­‰å¾…CPUè°ƒåº¦æ‰§è¡Œã€‚</p>
<p>ç›´æ¥è°ƒç”¨run()æ–¹æ³•ï¼Œå¹¶<strong>ä¸ä¼šå¯åŠ¨</strong>ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œrun()æ–¹æ³•ï¼Œè¿™ä¸ç¬¦åˆå¤šçº¿ç¨‹ç¼–ç¨‹çš„ç›®çš„ã€‚ä½¿ç”¨start()æ–¹æ³•å¯ä»¥ç¡®ä¿çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œæé«˜ç¨‹åºçš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚</p>
<p>javaæ²¡æƒé™å¼€å¯ä¸€ä¸ªçº¿ç¨‹ è¦è°ƒç”¨åº•å±‚çš„æ“ä½œç³»ç»Ÿ åœ¨JVMçš„åº•å±‚å®ç°ä¸­ï¼Œä¼šæœ‰ç›¸åº”çš„æœ¬åœ°ï¼ˆCæˆ–C++ï¼‰æ–¹æ³•æ¥å¤„ç†çº¿ç¨‹çš„åˆ›å»ºå’Œç®¡ç†</p>
<h4 id="ä½ åœ¨ä½ ä»¬é¡¹ç›®ä¸­ä½¿ç”¨è¿‡å¤šçº¿ç¨‹å—"><a href="#ä½ åœ¨ä½ ä»¬é¡¹ç›®ä¸­ä½¿ç”¨è¿‡å¤šçº¿ç¨‹å—" class="headerlink" title="ä½ åœ¨ä½ ä»¬é¡¹ç›®ä¸­ä½¿ç”¨è¿‡å¤šçº¿ç¨‹å—?"></a>ä½ åœ¨ä½ ä»¬é¡¹ç›®ä¸­ä½¿ç”¨è¿‡å¤šçº¿ç¨‹å—?</h4><p>æ˜¯çš„ï¼Œåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ç¡®å®ä½¿ç”¨è¿‡å¤šçº¿ç¨‹ã€‚ ã€ç»“åˆé¡¹ç›®å»è¯´ã€‘<br>åœ¨å¤„ç†å¤§é‡æ•°æ®è®¡ç®—æˆ–æ‰§è¡Œè€—æ—¶çš„IOæ“ä½œæ—¶ï¼Œæˆ‘ä¼šä½¿ç”¨Javaçš„çº¿ç¨‹æ± ï¼ˆå¦‚ExecutorServiceï¼‰æ¥å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼Œä»¥æé«˜ç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œååé‡<br><img src="C:\Users\Pluminary\AppData\Roaming\Typora\typora-user-images\image-20250107153246645.png" alt="image-20250107153246645"></p>
<blockquote>
<h6 id="æˆ‘ä»¬å°†ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ä¸€ä¸ªåœ¨çº¿ç”µå­å•†åŠ¡å¹³å°çš„åå°è®¢å•å¤„ç†ç³»ç»Ÿ"><a href="#æˆ‘ä»¬å°†ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ä¸€ä¸ªåœ¨çº¿ç”µå­å•†åŠ¡å¹³å°çš„åå°è®¢å•å¤„ç†ç³»ç»Ÿ" class="headerlink" title="æˆ‘ä»¬å°†ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ä¸€ä¸ªåœ¨çº¿ç”µå­å•†åŠ¡å¹³å°çš„åå°è®¢å•å¤„ç†ç³»ç»Ÿ"></a>æˆ‘ä»¬å°†ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ä¸€ä¸ªåœ¨çº¿ç”µå­å•†åŠ¡å¹³å°çš„åå°è®¢å•å¤„ç†ç³»ç»Ÿ</h6><h5 id="é¡¹ç›®éœ€æ±‚"><a href="#é¡¹ç›®éœ€æ±‚" class="headerlink" title="é¡¹ç›®éœ€æ±‚"></a>é¡¹ç›®éœ€æ±‚</h5><p>è¯¥ç³»ç»Ÿéœ€è¦å¤„ç†å¤§é‡çš„è®¢å•ï¼ŒåŒ…æ‹¬è®¢å•éªŒè¯ã€åº“å­˜æ£€æŸ¥ã€æ”¯ä»˜å¤„ç†å’Œè®¢å•çŠ¶æ€æ›´æ–°ã€‚ä¸ºäº†æé«˜å¤„ç†æ•ˆç‡ï¼Œæˆ‘ä»¬å†³å®šä½¿ç”¨å¤šçº¿ç¨‹æ¥å¹¶è¡Œå¤„ç†è®¢å•ã€‚</p>
<pre><code class="java">import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
import java.util.Random;

public class OrderProcessingSystem &#123;

    public static void main(String[] args) &#123;
        // åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± 
        int numberOfProcessors = Runtime.getRuntime().availableProcessors();
        ExecutorService executor = Executors.newFixedThreadPool(numberOfProcessors);

        // æ¨¡æ‹Ÿè®¢å•é˜Ÿåˆ—
        Random random = new Random();
        for (int orderId = 1; orderId &lt;= 100; orderId++) &#123;
            int finalOrderId = orderId;
            executor.submit(() -&gt; &#123;
                processOrder(finalOrderId, random.nextInt(1000));
            &#125;);
        &#125;

        // å…³é—­çº¿ç¨‹æ± 
        executor.shutdown();
        try &#123;
            if (!executor.awaitTermination(60, TimeUnit.SECONDS)) &#123;
                executor.shutdownNow();
            &#125;
        &#125; catch (InterruptedException e) &#123;
            executor.shutdownNow();
            Thread.currentThread().interrupt();
        &#125;
    &#125;

    private static void processOrder(int orderId, int orderAmount) &#123;
        System.out.println(&quot;Processing order ID: &quot; + orderId + &quot; - Thread: &quot; + Thread.currentThread().getName());
        
        // æ¨¡æ‹Ÿè®¢å•éªŒè¯
        validateOrder(orderId);
        
        // æ¨¡æ‹Ÿåº“å­˜æ£€æŸ¥
        checkInventory(orderId);
        
        // æ¨¡æ‹Ÿæ”¯ä»˜å¤„ç†
        processPayment(orderId, orderAmount);
        
        // æ›´æ–°è®¢å•çŠ¶æ€
        updateOrderStatus(orderId, &quot;Completed&quot;);
    &#125;

    private static void validateOrder(int orderId) &#123;
        // æ¨¡æ‹Ÿè®¢å•éªŒè¯é€»è¾‘
        try &#123;
            Thread.sleep(100);
        &#125; catch (InterruptedException e) &#123;
            Thread.currentThread().interrupt();
        &#125;
        System.out.println(&quot;Order ID &quot; + orderId + &quot; validated.&quot;);
    &#125;

    private static void checkInventory(int orderId) &#123;
        // æ¨¡æ‹Ÿåº“å­˜æ£€æŸ¥é€»è¾‘
        try &#123;
            Thread.sleep(200);
        &#125; catch (InterruptedException e) &#123;
            Thread.currentThread().interrupt();
        &#125;
        System.out.println(&quot;Inventory checked for Order ID &quot; + orderId + &quot;.&quot;);
    &#125;

    private static void processPayment(int orderId, int orderAmount) &#123;
        // æ¨¡æ‹Ÿæ”¯ä»˜å¤„ç†é€»è¾‘
        try &#123;
            Thread.sleep(300);
        &#125; catch (InterruptedException e) &#123;
            Thread.currentThread().interrupt();
        &#125;
        System.out.println(&quot;Payment processed for Order ID &quot; + orderId + &quot; - Amount: &quot; + orderAmount);
    &#125;

    private static void updateOrderStatus(int orderId, String status) &#123;
        // æ¨¡æ‹Ÿè®¢å•çŠ¶æ€æ›´æ–°é€»è¾‘
        System.out.println(&quot;Order ID &quot; + orderId + &quot; status updated to &quot; + status + &quot;.&quot;);
    &#125;
&#125;
</code></pre>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œå…¶å¤§å°ç­‰äºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ã€‚ç„¶åï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ä¸€ä¸ªåŒ…å«100ä¸ªè®¢å•çš„é˜Ÿåˆ—ï¼Œå¹¶ä¸ºæ¯ä¸ªè®¢å•æäº¤äº†ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± ä¸­ã€‚æ¯ä¸ªä»»åŠ¡ä»£è¡¨è®¢å•å¤„ç†çš„æ•´ä¸ªæµç¨‹ï¼ŒåŒ…æ‹¬éªŒè¯ã€åº“å­˜æ£€æŸ¥ã€æ”¯ä»˜å¤„ç†å’ŒçŠ¶æ€æ›´æ–°ã€‚<strong>æ¯ä¸ªæ­¥éª¤éƒ½é€šè¿‡ä¼‘çœ æ¥æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</strong>ã€‚æœ€åï¼Œæˆ‘ä»¬å…³é—­çº¿ç¨‹æ± å¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚</p>
</blockquote>
<h4 id="sleepå’Œwaitçš„åŒºåˆ«"><a href="#sleepå’Œwaitçš„åŒºåˆ«" class="headerlink" title="sleepå’Œwaitçš„åŒºåˆ«"></a>sleepå’Œwaitçš„åŒºåˆ«</h4><p><strong>sleep</strong>æ˜¯Threadç±»çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒä½¿å½“å‰çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šçš„æ—¶é—´ï¼Œä½†ä¸ä¼šé‡Šæ”¾é”èµ„æºã€‚<br><strong>wait</strong>æ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒä½¿å½“å‰çº¿ç¨‹<strong>æš‚åœæ‰§è¡Œ</strong>å¹¶<strong>é‡Šæ”¾å½“å‰å¯¹è±¡ä¸Šçš„é”</strong>ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡çš„<code>notify()</code>æˆ–<code>notifyAll()</code>æ–¹æ³•ï¼Œæˆ–è€…è¿‡äº†æŒ‡å®šçš„ç­‰å¾…æ—¶é—´ã€‚</p>
<p>sleepæ˜¯çº¿ç¨‹å†…çš„é™æ€æ–¹æ³• éœ€è¦æŒ‡å®šç¡çœ çš„æ—¶é—´ æˆ–è€…è‡ªåŠ¨è‡ªå·±å”¤é†’ ä¸ä¼šé‡Šæ”¾é”<br>waitæ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³• å¯ä»¥æŒ‡å®šç¡çœ æ—¶é—´ ä¸æŒ‡å®šå°±ç­‰äºæ— é™æœŸ è¦é‡Šæ”¾é”<br>waitä¸€å®šè¦æ­é…<code>synchronized</code>ï¼Œä¸”éƒ½ä¸ºåŒä¸€ä¸ªå¯¹è±¡ synchronizedé”ä½äº†wait<del>ä¸‡ç‰©å¯¹è±¡çš†ä¸ºé”</del><br>å¯ä»¥è¢«å”¤é†’<code>notify()</code>æˆ–<code>notifyAll()</code>æ–¹æ³•   åŒºåˆ«ï¼šnotifyæ˜¯éšæœºå”¤é†’ä¸€ä¸ª notifyallä¼šå”¤é†’å…¨éƒ¨</p>
<p>æ™®é€šæ–¹æ³•ä¸Š é”çš„æ˜¯this<br>é™æ€æ–¹æ³•ä¸Š é”çš„æ˜¯å½“å‰ç±»çš„classå¯¹è±¡</p>
<h4 id="ConcurrentHashMap-å’Œ-HashTableçš„åŒºåˆ«"><a href="#ConcurrentHashMap-å’Œ-HashTableçš„åŒºåˆ«" class="headerlink" title="ConcurrentHashMap å’Œ HashTableçš„åŒºåˆ«"></a>ConcurrentHashMap å’Œ HashTableçš„åŒºåˆ«</h4><h6 id="æ˜¯å¦æ”¯æŒä¼ å…¥NULL"><a href="#æ˜¯å¦æ”¯æŒä¼ å…¥NULL" class="headerlink" title="æ˜¯å¦æ”¯æŒä¼ å…¥NULL"></a>æ˜¯å¦æ”¯æŒä¼ å…¥NULL</h6><p>HashMapå¯ä»¥æ”¯æŒä¸ºnull<br>è‹¥å°è¯•å°† <code>null</code> ä½œä¸ºé”®æˆ–å€¼æ”¾å…¥ <code>ConcurrentHashMap</code> å°†ä¼šæŠ›å‡º <code>NullPointerException</code><br>ConcurrentHashMap ä¸èƒ½æ”¯æŒå­˜null</p>
<h6 id="åº•å±‚å®ç°"><a href="#åº•å±‚å®ç°" class="headerlink" title="åº•å±‚å®ç°"></a>åº•å±‚å®ç°</h6><p>ConcurrentHashMap 1.8ä¹‹å‰æ˜¯åˆ†æ®µé”æ¥å®ç° é»˜è®¤æ˜¯16ä¸ªHashTable<br>1.8ä¹‹åæ— é™æ¥è¿‘å•ä¸ªçš„HashMap  åº•å±‚ç”¨CAS+synchronized<br>HashTableé€šè¿‡åŠ <code>synchronized</code>é”æ¥æ§åˆ¶çº¿ç¨‹å®‰å…¨ </p>
<p>ConcurrentHashMap è¯»ä¸è¦åŠ é” [è¯»å†™çš„è¯»ä¹Ÿä¸ä¼šåŠ é”] ä¼šèµ°æœ€ç»ˆä¸€è‡´æ€§<br>HashTable è¯»è¦åŠ é” [è¯»è¯»éƒ½åŠ é”]</p>
<h4 id="ä¸ºä»€ä¹ˆè¦ç”¨Redis"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨Redis" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨Redis"></a>ä¸ºä»€ä¹ˆè¦ç”¨Redis</h4><p><strong>é«˜æ€§èƒ½</strong>ï¼šRedisæ˜¯<strong>åŸºäºå†…å­˜</strong>çš„æ•°æ®ç»“æ„å­˜å‚¨ï¼Œå¯ä»¥æä¾›é«˜é€Ÿçš„æ•°æ®è¯»å†™æ“ä½œã€‚<br><strong>æ•°æ®ç»“æ„ä¸°å¯Œ</strong>ï¼šRedisæ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼Œå¦‚å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€é›†åˆã€æ•£åˆ—è¡¨ã€æœ‰åºé›†åˆç­‰ï¼Œéå¸¸é€‚åˆå„ç§åœºæ™¯ã€‚<br><strong>æŒä¹…åŒ–</strong>ï¼šRedisæ”¯æŒ<strong>æ•°æ®æŒä¹…åŒ–</strong>ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®<strong>ä¿å­˜åˆ°ç£ç›˜</strong>ä¸­ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚<br><strong>åˆ†å¸ƒå¼</strong>ï¼šRedisæ”¯æŒ<strong>ä¸»ä»å¤åˆ¶</strong>ã€<strong>å“¨å…µ</strong>å’Œ<strong>é›†ç¾¤æ¨¡å¼</strong>ï¼Œå¯ä»¥è½»æ¾å®ç°åˆ†å¸ƒå¼ç¼“å­˜ã€‚</p>
<h4 id="Redisä¸­ç¼“å­˜äº†å“ªäº›æ•°æ®"><a href="#Redisä¸­ç¼“å­˜äº†å“ªäº›æ•°æ®" class="headerlink" title="Redisä¸­ç¼“å­˜äº†å“ªäº›æ•°æ®"></a>Redisä¸­ç¼“å­˜äº†å“ªäº›æ•°æ®</h4><h6 id="å¯ä»¥å­˜å‚¨ä¸€ä¸‹ç±»å‹çš„æ•°æ®"><a href="#å¯ä»¥å­˜å‚¨ä¸€ä¸‹ç±»å‹çš„æ•°æ®" class="headerlink" title="å¯ä»¥å­˜å‚¨ä¸€ä¸‹ç±»å‹çš„æ•°æ®"></a>å¯ä»¥å­˜å‚¨ä¸€ä¸‹ç±»å‹çš„æ•°æ®</h6><blockquote>
<ol>
<li><strong>ä¼šè¯ç¼“å­˜ï¼ˆSession Storeï¼‰</strong>ï¼šç”¨æˆ·ä¼šè¯ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€ç”¨æˆ·åå¥½è®¾ç½®ç­‰ã€‚</li>
<li><strong>é¡µé¢ç¼“å­˜</strong>ï¼šåŠ¨æ€ç”Ÿæˆçš„ç½‘é¡µå†…å®¹ï¼Œä»¥å‡å°‘æ•°æ®åº“çš„è¯»å–æ¬¡æ•°ã€‚</li>
<li><strong>å¯¹è±¡ç¼“å­˜</strong>ï¼šä¾‹å¦‚ï¼Œç”¨æˆ·ä¿¡æ¯ã€å•†å“è¯¦æƒ…ç­‰ï¼Œå‡å°‘æ•°æ®åº“è®¿é—®ã€‚</li>
<li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šç”¨ä½œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚</li>
<li><strong>æ’è¡Œæ¦œæˆ–è®¡æ•°å™¨</strong>ï¼šå¦‚ç”¨æˆ·ç‚¹èµæ•°ã€è§†é¢‘æ’­æ”¾æ¬¡æ•°ç­‰ã€‚</li>
<li><strong>åœ°ç†ç©ºé—´æ•°æ®</strong>ï¼šç”¨äºå®ç°åŸºäºåœ°ç†ä½ç½®çš„æŸ¥è¯¢ã€‚</li>
<li><strong>åˆ†å¸ƒå¼é”</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åè°ƒä¸åŒæœåŠ¡æˆ–èŠ‚ç‚¹çš„æ“ä½œ</li>
</ol>
</blockquote>
<h6 id="å…³äºæ‚¨æåˆ°çš„æ›¿ä»£JWTçš„æ–¹æ¡ˆï¼Œå³ä½¿ç”¨Redisæ¥ç®¡ç†ç™»å½•çŠ¶æ€è€Œä¸æ˜¯ä½¿ç”¨JWTï¼Œè¿™é‡Œæœ‰ä¸€äº›è¯¦ç»†è¯´æ˜ï¼š"><a href="#å…³äºæ‚¨æåˆ°çš„æ›¿ä»£JWTçš„æ–¹æ¡ˆï¼Œå³ä½¿ç”¨Redisæ¥ç®¡ç†ç™»å½•çŠ¶æ€è€Œä¸æ˜¯ä½¿ç”¨JWTï¼Œè¿™é‡Œæœ‰ä¸€äº›è¯¦ç»†è¯´æ˜ï¼š" class="headerlink" title="å…³äºæ‚¨æåˆ°çš„æ›¿ä»£JWTçš„æ–¹æ¡ˆï¼Œå³ä½¿ç”¨Redisæ¥ç®¡ç†ç™»å½•çŠ¶æ€è€Œä¸æ˜¯ä½¿ç”¨JWTï¼Œè¿™é‡Œæœ‰ä¸€äº›è¯¦ç»†è¯´æ˜ï¼š"></a>å…³äºæ‚¨æåˆ°çš„æ›¿ä»£JWTçš„æ–¹æ¡ˆï¼Œå³ä½¿ç”¨Redisæ¥ç®¡ç†ç™»å½•çŠ¶æ€è€Œä¸æ˜¯ä½¿ç”¨JWTï¼Œè¿™é‡Œæœ‰ä¸€äº›è¯¦ç»†è¯´æ˜ï¼š</h6><p>è‹¥æ”¾ç™»å½•çš„ä¿¡æ¯åˆ°Redisçš„æ—¶å€™ ä¸å†ç”¨JWTäº†<br>Sessionåœ¨é›†ç¾¤é‡Œé¢ä¸èƒ½ç”¨äº†<br>æ›¿ä»£æ–¹æ¡ˆï¼š<span style = "color:red"><strong>ç”¨Redis ä¸ç”¨JWT</strong></span><br>JWTæ˜¯æ— çŠ¶æ€ æ— éœ€é›†ä¸­å­˜å‚¨</p>
<p>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼ŒRedisä¸­ç¼“å­˜äº†ä»¥ä¸‹ç±»å‹çš„æ•°æ®ï¼š<br>ä¼šè¯ä¿¡æ¯ï¼šå¦‚ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€è´­ç‰©è½¦å†…å®¹ç­‰ã€‚<br><strong>çƒ­ç‚¹æ•°æ®</strong>ï¼šå¦‚çƒ­é—¨å•†å“ä¿¡æ¯ã€æ¨èå†…å®¹ç­‰ã€‚<br><strong>è®¡æ•°å™¨</strong>ï¼šå¦‚ç”¨æˆ·è®¿é—®æ¬¡æ•°ã€ç‚¹èµæ•°ã€è¯„è®ºæ•°ç­‰ã€‚<br>ç¼“å­˜æ•°æ®åº“æŸ¥è¯¢ç»“æœï¼šå‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°ï¼Œæé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦ã€‚</p>
<blockquote>
<h3 id="JWTï¼ˆJSON-Web-Tokensï¼‰"><a href="#JWTï¼ˆJSON-Web-Tokensï¼‰" class="headerlink" title="JWTï¼ˆJSON Web Tokensï¼‰"></a>JWTï¼ˆJSON Web Tokensï¼‰</h3><p>JWTæ˜¯ä¸€ç§åœ¨å„æ–¹ä¹‹é—´ä¼ é€’å®‰å…¨å¯é ä¿¡æ¯çš„ç®€æ´çš„ã€URLå®‰å…¨çš„è¡¨è¾¾æ–¹å¼ã€‚å…¶ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ— çŠ¶æ€</strong>ï¼šæœåŠ¡å™¨ä¸å­˜å‚¨ä»»ä½•ä¼šè¯ä¿¡æ¯ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½æºå¸¦åŒ…å«æ‰€æœ‰å¿…è¦ä¿¡æ¯çš„JWTã€‚</li>
<li><strong>è‡ªåŒ…å«</strong>ï¼šJWTä¸­åŒ…å«äº†ç”¨æˆ·çš„æ‰€æœ‰å£°æ˜ï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„æ•°æ®åº“æŸ¥è¯¢ã€‚</li>
<li><strong>è·¨åŸŸè®¤è¯</strong>ï¼šç‰¹åˆ«é€‚ç”¨äºå•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ã€‚</li>
</ul>
<h3 id="JWTçš„å±€é™æ€§"><a href="#JWTçš„å±€é™æ€§" class="headerlink" title="JWTçš„å±€é™æ€§"></a>JWTçš„å±€é™æ€§</h3><ul>
<li><strong>æ— æ³•å¤±æ•ˆ</strong>ï¼šä¸€æ—¦ç­¾å‘äº†JWTï¼Œåœ¨å®ƒè¿‡æœŸä¹‹å‰ï¼Œå®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œæ— æ³•æå‰å¤±æ•ˆã€‚</li>
<li><strong>ç»­ç­¾é—®é¢˜</strong>ï¼šJWTè¿‡æœŸåéœ€è¦é‡æ–°ç­¾å‘ï¼Œå¤„ç†èµ·æ¥ç›¸å¯¹å¤æ‚ã€‚</li>
<li><strong>æºå¸¦ä¿¡æ¯é‡å¤§</strong>ï¼šæ¯ä¸ªè¯·æ±‚éƒ½æºå¸¦JWTï¼Œå¦‚æœJWTä¸­åŒ…å«çš„ä¿¡æ¯è¾ƒå¤šï¼Œä¼šå¢åŠ è¯·æ±‚çš„å¤§å°ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨Redisæ›¿ä»£JWT"><a href="#ä½¿ç”¨Redisæ›¿ä»£JWT" class="headerlink" title="ä½¿ç”¨Redisæ›¿ä»£JWT"></a>ä½¿ç”¨Redisæ›¿ä»£JWT</h3><p>ä½¿ç”¨Redisä½œä¸ºä¼šè¯å­˜å‚¨ï¼Œå¯ä»¥è§£å†³JWTçš„ä¸€äº›é—®é¢˜ï¼š</p>
<ol>
<li><strong>ä¸­å¿ƒåŒ–æ§åˆ¶</strong>ï¼šé€šè¿‡Redisï¼ŒæœåŠ¡å™¨å¯ä»¥é›†ä¸­ç®¡ç†ä¼šè¯ä¿¡æ¯ï¼Œå¯ä»¥éšæ—¶ä½¿ä¼šè¯å¤±æ•ˆã€‚</li>
<li><strong>çµæ´»çš„è¿‡æœŸç­–ç•¥</strong>ï¼šå¯ä»¥è®¾ç½®æ›´ç»†ç²’åº¦çš„è¿‡æœŸæ—¶é—´ï¼Œå¹¶åœ¨éœ€è¦æ—¶åˆ·æ–°ä¼šè¯ã€‚</li>
<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šå¯¹äºéœ€è¦é¢‘ç¹æ›´æ”¹ç”¨æˆ·çŠ¶æ€çš„åº”ç”¨ï¼Œä½¿ç”¨Rediså¯ä»¥æ›´æ–¹ä¾¿åœ°ç®¡ç†ã€‚</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šè™½ç„¶Rediså­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼Œä½†å¯ä»¥ç»“åˆHTTPSå’Œåˆé€‚çš„åŠ å¯†ç­–ç•¥æ¥ä¿è¯ä¼ è¾“è¿‡ç¨‹çš„å®‰å…¨</li>
</ol>
<h3 id="å®ç°æ–¹æ¡ˆ"><a href="#å®ç°æ–¹æ¡ˆ" class="headerlink" title="å®ç°æ–¹æ¡ˆ"></a>å®ç°æ–¹æ¡ˆ</h3><ol>
<li><strong>ç”¨æˆ·ç™»å½•</strong>ï¼šç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ä¼šè¯æ ‡è¯†ï¼ˆå¦‚UUIDï¼‰ï¼Œå¹¶å°†å…¶ä½œä¸ºkeyå­˜å‚¨åœ¨Redisä¸­ï¼Œvalueå¯ä»¥æ˜¯ç”¨æˆ·IDæˆ–è€…å…¶ä»–å¿…è¦ä¿¡æ¯ï¼Œå¹¶è®¾ç½®é€‚å½“çš„è¿‡æœŸæ—¶é—´ã€‚</li>
<li><strong>è¯·æ±‚éªŒè¯</strong>ï¼šç”¨æˆ·æ¯æ¬¡è¯·æ±‚æ—¶ï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ä¼šè¯æ ‡è¯†ï¼ŒæœåŠ¡å™¨ç«¯é€šè¿‡è¿™ä¸ªæ ‡è¯†åœ¨Redisä¸­æŸ¥æ‰¾ä¼šè¯ä¿¡æ¯ï¼Œè¿›è¡ŒéªŒè¯ã€‚</li>
<li><strong>ä¼šè¯è¿‡æœŸæˆ–å¤±æ•ˆ</strong>ï¼šå½“ç”¨æˆ·ç™»å‡ºæˆ–ä¼šè¯è¿‡æœŸæ—¶ï¼Œä»Redisä¸­åˆ é™¤å¯¹åº”çš„ä¼šè¯ä¿¡æ¯ã€‚</li>
</ol>
<h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><ul>
<li><strong>æ•°æ®æŒä¹…æ€§</strong>ï¼šRedisçš„æ•°æ®æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œéœ€è¦è€ƒè™‘æŒä¹…åŒ–ç­–ç•¥ä»¥é˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚</li>
<li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šåœ¨é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œéœ€è¦é…ç½®Redisçš„é«˜å¯ç”¨æ–¹æ¡ˆï¼Œå¦‚å“¨å…µï¼ˆSentinelï¼‰æˆ–é›†ç¾¤æ¨¡å¼ã€‚</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šç¡®ä¿Redisçš„å®‰å…¨æ€§ï¼Œé˜²æ­¢æœªæˆæƒè®¿é—®ã€‚</li>
</ul>
</blockquote>
<h4 id="æ£€æµ‹æ•°æ®å­˜åœ¨Redisä¸­ï¼Œæœ‰è¿‡æœŸæ—¶é—´å—-è¿‡æœŸæ—¶é—´æ˜¯å¤šå°‘-ä»…å‚è€ƒ"><a href="#æ£€æµ‹æ•°æ®å­˜åœ¨Redisä¸­ï¼Œæœ‰è¿‡æœŸæ—¶é—´å—-è¿‡æœŸæ—¶é—´æ˜¯å¤šå°‘-ä»…å‚è€ƒ" class="headerlink" title="æ£€æµ‹æ•°æ®å­˜åœ¨Redisä¸­ï¼Œæœ‰è¿‡æœŸæ—¶é—´å—? è¿‡æœŸæ—¶é—´æ˜¯å¤šå°‘?ä»…å‚è€ƒ"></a>æ£€æµ‹æ•°æ®å­˜åœ¨Redisä¸­ï¼Œæœ‰è¿‡æœŸæ—¶é—´å—? è¿‡æœŸæ—¶é—´æ˜¯å¤šå°‘?<del>ä»…å‚è€ƒ</del></h4><p>æ˜¯çš„ï¼Œæˆ‘ä»¬åœ¨Redisä¸­ç¼“å­˜çš„æ•°æ®é€šå¸¸ä¼šè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä»¥é¿å…è¿‡æ—¶çš„æ•°æ®å ç”¨å†…å­˜ã€‚å…·ä½“çš„è¿‡æœŸæ—¶é—´å–å†³äºæ•°æ®çš„ç±»å‹å’Œä¸šåŠ¡éœ€æ±‚ã€‚å¯¹äºä¼šè¯ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œå¦‚30åˆ†é’Ÿæˆ–1å°æ—¶ï¼›è€Œå¯¹äºçƒ­ç‚¹æ•°æ®ï¼Œå¯èƒ½ä¼šè®¾ç½®è¾ƒé•¿çš„è¿‡æœŸæ—¶é—´ï¼Œå¦‚å‡ å°æ—¶æˆ–ä¸€å¤©ã€‚å…·ä½“çš„è¿‡æœŸæ—¶é—´éœ€è¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯å’Œæ•°æ®è®¿é—®æ¨¡å¼æ¥å†³å®šã€‚</p>
<pre><code class="java">   // ç”¨æˆ·ç™»å½•ï¼Œåˆ›å»ºä¼šè¯
    public String loginUser(String userId) &#123;
        String sessionId = UUID.randomUUID().toString();
        String sessionData = createSessionData(userId);
        jedis.setex(sessionId, 1800, sessionData); // è®¾ç½®ä¼šè¯è¿‡æœŸæ—¶é—´ä¸º30åˆ†é’Ÿ
        return sessionId;
    &#125;
</code></pre>
<h4 id="å¾®æœåŠ¡ä¹‹é—´å¦‚ä½•è°ƒç”¨ï¼Ÿ"><a href="#å¾®æœåŠ¡ä¹‹é—´å¦‚ä½•è°ƒç”¨ï¼Ÿ" class="headerlink" title="å¾®æœåŠ¡ä¹‹é—´å¦‚ä½•è°ƒç”¨ï¼Ÿ"></a>å¾®æœåŠ¡ä¹‹é—´å¦‚ä½•è°ƒç”¨ï¼Ÿ</h4><p>é€šè¿‡æ³¨å†Œä¸­å¿ƒå»åè°ƒçš„<br>é¦–å…ˆæ˜¯æœ‰ä¸‰ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œ<strong>æœåŠ¡æ¶ˆè´¹è€…</strong>ï¼Œ<strong>æ³¨å†Œä¸­å¿ƒ</strong>ï¼Œ<strong>æœåŠ¡æä¾›è€…</strong>åœ¨ç¬¬ä¸€æ¬¡ä¼šæŠŠè‡ªå·±çš„ä¿¡æ¯æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸­ï¼Œæ¯”å¦‚ipç«¯å£ï¼ŒæœåŠ¡åŠŸèƒ½ç­‰æ¶ˆè´¹è€…éœ€è¦åˆ°æ³¨å†Œä¸­å¿ƒæ¥å¯»æ‰¾æœåŠ¡è¿›è¡Œæ¶ˆè´¹ï¼Œ<strong>åœ¨æœåŠ¡æ¶ˆè´¹è€…ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™ä¼šæ‹‰å–æœåŠ¡æä¾›è€…çš„ä¿¡æ¯ï¼Œæ³¨å†Œä¸­å¿ƒä¼šæŠŠæä¾›è€…çš„å®ä¾‹åˆ—è¡¨ç»™åˆ°æ¶ˆè´¹è€…ä¾›æ¶ˆè´¹è€…é€‰æ‹©ï¼Œä½¿ç”¨è´Ÿè½½å‡è¡¡æ¥é€‰æ‹©æœåŠ¡</strong>ï¼Œé»˜è®¤ä¸ºè½®è¯¢ï¼Œè¿˜æœ‰åŠ æƒè½®è¯¢ï¼Œéšæœºã€‚<strong>åŒæ—¶æœåŠ¡æ¶ˆè´¹è€…è¿˜ä¼šå®šæ—¶å»æ³¨å†Œä¸­å¿ƒæ‹‰å–æœåŠ¡æä¾›è€…çš„ä¿¡æ¯</strong></p>
<h6 id="å¦‚æœæˆ‘ä»¬çš„æœåŠ¡æŒ‚æ‰äº†æ€ä¹ˆåŠ"><a href="#å¦‚æœæˆ‘ä»¬çš„æœåŠ¡æŒ‚æ‰äº†æ€ä¹ˆåŠ" class="headerlink" title="å¦‚æœæˆ‘ä»¬çš„æœåŠ¡æŒ‚æ‰äº†æ€ä¹ˆåŠ?"></a>å¦‚æœæˆ‘ä»¬çš„æœåŠ¡æŒ‚æ‰äº†æ€ä¹ˆåŠ?</h6><p>æœåŠ¡æä¾›è€…ä¼šæ¯éš”ä¸€æ®µæ—¶é—´å»å‘æ³¨å†Œä¸­å¿ƒæŠ¥å‘Šè‡ªå·±çš„çŠ¶æ€[å‘é€å¿ƒè·³ping 30s&#x2F;æ¬¡ å…±90s]ï¼Œå¦‚æœæ²¡æœ‰å‘æ³¨å†Œä¸­å¿ƒæŠ¥å‘ŠçŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æ³¨å†Œä¸­å¿ƒä¼šè®¤ä¸ºæœåŠ¡æä¾›è€…å·²ç»å®•æœºï¼ŒåŒæ—¶ä¼šæ¨é€åˆ°æˆ‘ä»¬çš„æœåŠ¡æ¶ˆè´¹è€…ï¼Œè¿™ä¸ªæœåŠ¡æä¾›è€…å·²ç»å®•æœº</p>
<h4 id="å¾®æœåŠ¡çš„äº”å¤§ç»„ä»¶"><a href="#å¾®æœåŠ¡çš„äº”å¤§ç»„ä»¶" class="headerlink" title="å¾®æœåŠ¡çš„äº”å¤§ç»„ä»¶"></a>å¾®æœåŠ¡çš„äº”å¤§ç»„ä»¶</h4><ol>
<li><strong>æœåŠ¡æ³¨å†Œä¸å‘ç°</strong>ï¼šå¦‚Eureka<del>å·²è¿‡æ—¶</del>ã€<strong>Nacos</strong>ã€Consulï¼Œç”¨äºæœåŠ¡çš„æ³¨å†Œå’Œå‘ç°ã€‚</li>
<li><strong>é…ç½®ç®¡ç†</strong>ï¼šå¦‚Spring Cloud Configã€<strong>OpenFeign</strong> ç”¨äºé›†ä¸­ç®¡ç†æœåŠ¡çš„é…ç½®ã€‚</li>
</ol>
<p><code>Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼ˆWebæœåŠ¡å®¢æˆ·ç«¯å°±æ˜¯Httpå®¢æˆ·ç«¯ï¼‰ï¼Œè®©ç¼–å†™WebæœåŠ¡å®¢æˆ·ç«¯å˜å¾—éå¸¸å®¹æ˜“ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶åœ¨æ¥å£ä¸Šæ·»åŠ æ³¨è§£å³å¯ã€‚</code></p>
<p><span style = "color:red"><code>OpenFeignæ˜¯Spring Cloud åœ¨Feignçš„åŸºç¡€ä¸Šæ”¯æŒäº†SpringMVCçš„æ³¨è§£ï¼Œå¦‚@RequesMappingç­‰ç­‰ã€‚OpenFeignçš„@FeignClientå¯ä»¥è§£æSpringMVCçš„@RequestMappingæ³¨è§£ä¸‹çš„æ¥å£ï¼Œå¹¶é€šè¿‡ã€åŠ¨æ€ä»£ç†ã€‘çš„æ–¹å¼äº§ç”Ÿå®ç°ç±»ï¼Œå®ç°ç±»ä¸­åšè´Ÿè½½å‡è¡¡å¹¶è°ƒç”¨å…¶ä»–æœåŠ¡ã€‚</code></span></p>
<pre><code class="java">@FeignClient(name = &quot;feignTestService&quot;, url = &quot;http://localhost/8001&quot;)
public interface FeignTestService &#123;
&#125;

@Component
@FeignClient(url = &quot;http://localhost/8001&quot;)
public interface PaymentFeignService&#123;
&#125;
</code></pre>
<blockquote>
<pre><code class="java">äºŒã€OpenFeignä½¿ç”¨
2.1.OpenFeign å¸¸è§„è¿œç¨‹è°ƒç”¨
æ‰€è°“å¸¸è§„è¿œç¨‹è°ƒç”¨ï¼ŒæŒ‡çš„æ˜¯å¯¹æ¥ç¬¬ä¸‰æ–¹æ¥å£ï¼Œå’Œç¬¬ä¸‰æ–¹å¹¶ä¸æ˜¯å¾®æœåŠ¡æ¨¡å—å…³ç³»ï¼Œæ‰€ä»¥è‚¯å®šä¸å¯èƒ½é€šè¿‡æ³¨å†Œä¸­å¿ƒæ¥è°ƒç”¨æœåŠ¡ã€‚

ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥OpenFeignçš„ä¾èµ–

ç¬¬äºŒæ­¥ï¼šå¯åŠ¨ç±»éœ€è¦æ·»åŠ  ã€@EnableFeignClientsã€‘
    
ç¬¬ä¸‰æ­¥ï¼šæä¾›è€…çš„æ¥å£
@RestController
@RequestMapping(&quot;/test&quot;)
public class FeignTestController &#123;

    @GetMapping(&quot;/selectPaymentList&quot;)
    public CommonResult&lt;Payment&gt; selectPaymentList(@RequestParam int pageIndex, @RequestParam int pageSize) &#123;
        System.out.println(pageIndex);
        System.out.println(pageSize);
        Payment payment = new Payment();
        payment.setSerial(&quot;222222222&quot;);
        return new CommonResult(200, &quot;æŸ¥è¯¢æˆåŠŸ, æœåŠ¡ç«¯å£ï¼š&quot; + payment);
    &#125;

    @GetMapping(value = &quot;/selectPaymentListByQuery&quot;)
    public CommonResult&lt;Payment&gt; selectPaymentListByQuery(Payment payment) &#123;
        System.out.println(payment);
        return new CommonResult(200, &quot;æŸ¥è¯¢æˆåŠŸ, æœåŠ¡ç«¯å£ï¼š&quot; + null);
    &#125;

    @PostMapping(value = &quot;/create&quot;, consumes = &quot;application/json&quot;)
    public CommonResult&lt;Payment&gt; create(@RequestBody Payment payment) &#123;
        System.out.println(payment);
        return new CommonResult(200, &quot;æŸ¥è¯¢æˆåŠŸ, æœåŠ¡ç«¯å£ï¼š&quot; + null);
    &#125;

    @GetMapping(&quot;/getPaymentById/&#123;id&#125;&quot;)
    public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) String id) &#123;
        System.out.println(id);
        return new CommonResult(200, &quot;æŸ¥è¯¢æˆåŠŸ, æœåŠ¡ç«¯å£ï¼š&quot; + null);
    &#125;
    
ç¬¬å››æ­¥ï¼šæ¶ˆè´¹è€…è°ƒç”¨æä¾›è€…æ¥å£
@FeignClient(name = &quot;feignTestService&quot;, url = &quot;http://localhost/8001&quot;)
public interface FeignTestService &#123;

    @GetMapping(value = &quot;/payment/selectPaymentList&quot;)
    CommonResult&lt;Payment&gt; selectPaymentList(@RequestParam int pageIndex, @RequestParam int pageSize);

    @GetMapping(value = &quot;/payment/selectPaymentListByQuery&quot;)
    CommonResult&lt;Payment&gt; selectPaymentListByQuery(@SpringQueryMap Payment payment);

    @PostMapping(value = &quot;/payment/create&quot;, consumes = &quot;application/json&quot;)
    CommonResult&lt;Payment&gt; create(@RequestBody Payment payment);

    @GetMapping(&quot;/payment/getPaymentById/&#123;id&#125;&quot;)
    CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) String id);
&#125;
</code></pre>
</blockquote>
<ol>
<li><strong>æœåŠ¡ç½‘å…³</strong>ï¼šå¦‚Zuulã€Spring Cloud <strong>Gateway</strong>ï¼Œä½œä¸ºç³»ç»Ÿçš„å”¯ä¸€å…¥å£ï¼Œå¤„ç†å¤–éƒ¨è¯·æ±‚çš„è·¯ç”±å’Œè¿‡æ»¤ã€‚</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šå¦‚<strong>Ribbon</strong>ï¼Œç”¨äºåœ¨å¤šä¸ªæœåŠ¡å®ä¾‹ä¹‹é—´åˆ†é…è¯·æ±‚ã€‚</li>
<li><strong>æ–­è·¯å™¨</strong>ï¼šå¦‚<strong>Hystrix</strong>ï¼Œç”¨äºæœåŠ¡ç†”æ–­ï¼Œé˜²æ­¢ç³»ç»Ÿé›ªå´©</li>
</ol>
<h4 id="å¯¹äºæœåŠ¡æ³¨å†Œè¿™å—æœ‰ä»€ä¹ˆäº†è§£ï¼Ÿ"><a href="#å¯¹äºæœåŠ¡æ³¨å†Œè¿™å—æœ‰ä»€ä¹ˆäº†è§£ï¼Ÿ" class="headerlink" title="å¯¹äºæœåŠ¡æ³¨å†Œè¿™å—æœ‰ä»€ä¹ˆäº†è§£ï¼Ÿ"></a>å¯¹äºæœåŠ¡æ³¨å†Œè¿™å—æœ‰ä»€ä¹ˆäº†è§£ï¼Ÿ</h4><ul>
<li><strong>æœåŠ¡æ³¨å†Œä¸­å¿ƒ</strong>ï¼šæœåŠ¡å®ä¾‹åœ¨å¯åŠ¨æ—¶å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„åœ°å€å’Œç«¯å£ä¿¡æ¯ã€‚æ£€æŸ¥ å¿ƒè·³ å¦‚æœæœªæŸ¥è¯¢å°±å‰”é™¤ï¼ŒåŒæ—¶ä¹Ÿæœ‰æ³¨å†Œä¸­å¿ƒä¸»åŠ¨å‘èµ·è¯·æ±‚ã€‚</li>
<li><strong>å¥åº·æ£€æŸ¥</strong>ï¼šæœåŠ¡æ³¨å†Œä¸­å¿ƒé€šå¸¸ä¼šå®šæœŸå¯¹å·²æ³¨å†Œçš„æœåŠ¡è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œä»¥ç¡®ä¿æœåŠ¡çš„å¯ç”¨æ€§ã€‚</li>
<li><strong>æœåŠ¡å‘ç°</strong>ï¼šæœåŠ¡æ¶ˆè´¹è€…é€šè¿‡æœåŠ¡æ³¨å†Œä¸­å¿ƒæŸ¥æ‰¾å¯ç”¨çš„æœåŠ¡å®ä¾‹ï¼Œä»¥è¿›è¡ŒæœåŠ¡è°ƒç”¨ã€‚</li>
<li><strong>æœåŠ¡å»æ³¨å†Œ</strong>ï¼šå½“æœåŠ¡å®ä¾‹å…³é—­æˆ–å‡ºç°æ•…éšœæ—¶ï¼Œå®ƒéœ€è¦ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨é”€ï¼Œä»¥é¿å…è°ƒç”¨ä¸å¯ç”¨çš„æœåŠ¡ã€‚</li>
</ul>
<h4 id="ä½ èƒ½è¯´ä¸€ä¸‹å°ç¨‹åºçš„ç™»å½•æµç¨‹å—"><a href="#ä½ èƒ½è¯´ä¸€ä¸‹å°ç¨‹åºçš„ç™»å½•æµç¨‹å—" class="headerlink" title="ä½ èƒ½è¯´ä¸€ä¸‹å°ç¨‹åºçš„ç™»å½•æµç¨‹å—?"></a>ä½ èƒ½è¯´ä¸€ä¸‹å°ç¨‹åºçš„ç™»å½•æµç¨‹å—?</h4><p>è°ƒç”¨å¾®ä¿¡apiï¼Œæ ¹æ®codeè·å–openidï¼›æ ¹æ®openidæŸ¥è¯¢ç”¨æˆ·ä¸ºç©ºå°±æ–°å¢ï¼›è°ƒç”¨å¾®ä¿¡api <code>WechatService + WechatServiceImpl</code>(openId+phoneCode) è·å–ç”¨æˆ·ç»‘å®šçš„æ‰‹æœºå·ï¼›ä¿å­˜æˆ–ä¿®æ”¹è¯¥ç”¨æˆ·ï¼›å°†ç”¨æˆ·idå­˜å…¥tokenè¿”å›(JWTç”Ÿæˆtoken)</p>
<h4 id="æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆ›å»ºå•ä¾‹ï¼Ÿ"><a href="#æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆ›å»ºå•ä¾‹ï¼Ÿ" class="headerlink" title="æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆ›å»ºå•ä¾‹ï¼Ÿ"></a>æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆ›å»ºå•ä¾‹ï¼Ÿ</h4><ol>
<li><strong>é¥¿æ±‰å¼</strong>ï¼šåœ¨<strong>ç±»åŠ è½½</strong>æ—¶å°±ç«‹å³åˆå§‹åŒ–å¹¶åˆ›å»ºå•ä¾‹å¯¹è±¡ã€‚</li>
<li><strong>æ‡’æ±‰å¼</strong>ï¼šåœ¨<strong>ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶</strong>åˆå§‹åŒ–å•ä¾‹å¯¹è±¡ï¼Œé€šå¸¸éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li>
<li><strong>åŒé‡æ ¡éªŒé”</strong>ï¼šåœ¨æ‡’æ±‰å¼çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡åŒé‡æ ¡éªŒé”ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</li>
<li><strong>é™æ€å†…éƒ¨ç±»</strong>ï¼šåˆ©ç”¨é™æ€å†…éƒ¨ç±»çš„åŠ è½½æœºåˆ¶æ¥ç¡®ä¿å•ä¾‹å¯¹è±¡çš„å”¯ä¸€æ€§ã€‚</li>
<li><strong>æšä¸¾</strong>ï¼šåˆ©ç”¨æšä¸¾çš„ç‰¹æ€§ï¼Œä¿è¯å•ä¾‹å¯¹è±¡çš„å”¯ä¸€æ€§å’Œçº¿ç¨‹å®‰å…¨ã€ä¸å¯ç”¨åå°„ã€‘</li>
</ol>
<h6 id="å¹¶å‘æƒ…å†µä¸‹ä¸¥æ ¼æ§åˆ¶å•ä¾‹ï¼Ÿvolatileâ†’ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº"><a href="#å¹¶å‘æƒ…å†µä¸‹ä¸¥æ ¼æ§åˆ¶å•ä¾‹ï¼Ÿvolatileâ†’ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº" class="headerlink" title="å¹¶å‘æƒ…å†µä¸‹ä¸¥æ ¼æ§åˆ¶å•ä¾‹ï¼Ÿvolatileâ†’ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº"></a>å¹¶å‘æƒ…å†µä¸‹ä¸¥æ ¼æ§åˆ¶å•ä¾‹ï¼Ÿ<del>volatileâ†’ç¦æ­¢è¿›è¡ŒæŒ‡ä»¤é‡æ’åº</del></h6><p><strong>åŒé‡æ ¡éªŒé”</strong>ï¼šåœ¨æ‡’æ±‰å¼çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡åŒé‡æ ¡éªŒé”ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</p>
<blockquote>
<h6 id="æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ-1"><a href="#æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ-1" class="headerlink" title="æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ"></a>æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå“ªäº›æ–¹å¼åˆ›å»ºå•ä¾‹æ¨¡å¼ï¼Ÿ</h6><blockquote>
<h3 id="1-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨-1"><a href="#1-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨-1" class="headerlink" title="1. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨"></a>1. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨</h3><p>è¿™ç§æ–¹å¼åœ¨ç±»åŠ è½½æ—¶ä¸åˆå§‹åŒ–ã€‚åœ¨éœ€è¦çš„æ—¶å€™æ‰åˆ›å»ºå¯¹è±¡ï¼ŒèŠ‚çº¦èµ„æºã€‚</p>
<pre><code class="java">public class Singleton &#123;
    private static Singleton instance;
    private Singleton() &#123;&#125;

    public static Singleton getInstance() &#123;
        if (instance == null) &#123;
            instance = new Singleton();
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<h3 id="2-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨-1"><a href="#2-æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨-1" class="headerlink" title="2. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨"></a>2. æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨</h3><p>é€šè¿‡åŒæ­¥æ–¹æ³•ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</p>
<pre><code class="java">public class Singleton &#123;
    private static Singleton instance;
    private Singleton() &#123;&#125;

    public static synchronized Singleton getInstance() &#123;
        if (instance == null) &#123;
            instance = new Singleton();
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<h3 id="3-é¥¿æ±‰å¼-1"><a href="#3-é¥¿æ±‰å¼-1" class="headerlink" title="3. é¥¿æ±‰å¼"></a>3. é¥¿æ±‰å¼</h3><p>ç±»åŠ è½½æ—¶å°±å®Œæˆäº†åˆå§‹åŒ–ï¼Œä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§ã€‚</p>
<pre><code class="java">public class Singleton &#123;
    private static Singleton instance = new Singleton();
    private Singleton() &#123;&#125;

    public static Singleton getInstance() &#123;
        return instance;
    &#125;
&#125;
</code></pre>
<h3 id="4-åŒé‡æ ¡éªŒé”-1"><a href="#4-åŒé‡æ ¡éªŒé”-1" class="headerlink" title="4. åŒé‡æ ¡éªŒé”"></a>4. åŒé‡æ ¡éªŒé”</h3><p>çº¿ç¨‹å®‰å…¨ä¸”åœ¨å®ä¾‹åŸŸéœ€è¦å»¶è¿ŸåŠ è½½æ—¶æé«˜æ€§èƒ½ã€‚</p>
<pre><code class="java">public class Singleton &#123;
    private volatile static Singleton singleton;
    private Singleton() &#123;&#125;

    public static Singleton getInstance() &#123;
        if (singleton == null) &#123;
            synchronized (Singleton.class) &#123;
                if (singleton == null) &#123;
                    singleton = new Singleton();
                &#125;
            &#125;
        &#125;
        return singleton;
    &#125;
&#125;
</code></pre>
<h3 id="5-é™æ€å†…éƒ¨ç±»-1"><a href="#5-é™æ€å†…éƒ¨ç±»-1" class="headerlink" title="5. é™æ€å†…éƒ¨ç±»"></a>5. é™æ€å†…éƒ¨ç±»</h3><p>è¿™ç§æ–¹å¼æ—¢å®ç°äº†æ‡’åŠ è½½ï¼Œåˆä¿è¯äº†çº¿æ€§å®‰å…¨ã€‚</p>
<pre><code class="java">public class Singleton &#123;
    private static class SingletonHolder &#123;
        private static final Singleton INSTANCE = new Singleton();
    &#125;
    private Singleton() &#123;&#125;

    public static final Singleton getInstance() &#123;
        return SingletonHolder.INSTANCE;
    &#125;
&#125;
</code></pre>
<h3 id="6-æšä¸¾-1"><a href="#6-æšä¸¾-1" class="headerlink" title="6. æšä¸¾"></a>6. æšä¸¾</h3><p>å®ç°å•ä¾‹çš„æœ€ä½³æ–¹æ³•ï¼Œå®ƒä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜è‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œé˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p>
<pre><code class="java">public enum Singleton &#123;
    INSTANCE;
    public void whateverMethod() &#123;
    &#125;
&#125;
</code></pre>
</blockquote>
</blockquote>
<h4 id="å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«ï¼Ÿ"><a href="#å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«ï¼Ÿ"></a>å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«ï¼Ÿ</h4><ul>
<li><p><strong>å…¬å¹³é”</strong>ï¼šå¤šä¸ªçº¿ç¨‹æŒ‰ç…§å®ƒä»¬è¯·æ±‚<strong>é”çš„é¡ºåº</strong>æ¥è·å–é”ï¼Œ<strong>å…ˆæ¥å…ˆå¾—</strong>ã€‚è¿™ç§æ–¹å¼ä¸ä¼šäº§ç”Ÿé¥¥é¥¿ç°è±¡ï¼Œä½†å¯èƒ½ä¼š<strong>é™ä½ååé‡</strong>ï¼Œå› ä¸ºéœ€è¦é¢å¤–çš„å¼€é”€æ¥ç»´æŠ¤ç­‰å¾…é˜Ÿåˆ—çš„é¡ºåºã€‚ã€åƒµå°¸çº¿ç¨‹ã€‘<u>å¯¹èµ„æºé¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚</u></p>
<blockquote>
<h6 id="ä¸ºä»€ä¹ˆä¼šé™ä½ååé‡ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šé™ä½ååé‡ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šé™ä½ååé‡ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šé™ä½ååé‡ï¼Ÿ</h6><ol>
<li><strong>ç»´æŠ¤ç­‰å¾…é˜Ÿåˆ—</strong>ï¼šå…¬å¹³é”ä¸ºäº†ä¿è¯æŒ‰ç…§è¯·æ±‚é”çš„é¡ºåºæ¥è·å–é”ï¼Œå¿…é¡»ç»´æŠ¤ä¸€ä¸ªæœ‰åºçš„ç­‰å¾…é˜Ÿåˆ—ã€‚è¿™æ„å‘³ç€æ¯æ¬¡æœ‰çº¿ç¨‹è¯·æ±‚é”æˆ–è€…é‡Šæ”¾é”æ—¶ï¼Œéƒ½éœ€è¦è¿›è¡Œé¢å¤–çš„æ“ä½œæ¥ç®¡ç†è¿™ä¸ªé˜Ÿåˆ—ï¼Œè¿™ä¼šå¢åŠ å¼€é”€ã€‚</li>
<li><strong>ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€</strong>ï¼šå½“é”è¢«é‡Šæ”¾æ—¶ï¼Œå…¬å¹³é”éœ€è¦å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯æœ‰æˆæœ¬çš„ï¼Œå› ä¸ºå®ƒæ¶‰åŠåˆ°ä¿å­˜å’Œæ¢å¤çº¿ç¨‹çš„çŠ¶æ€ã€‚</li>
<li><strong>å‡å°‘å¹¶å‘æœºä¼š</strong>ï¼šç”±äºå…¬å¹³é”è¦æ±‚å…ˆæ¥å…ˆå¾—ï¼Œå³ä½¿é”è¢«é‡Šæ”¾åè¯·æ±‚é”çš„çº¿ç¨‹å³ä½¿å¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼Œä¹Ÿå¿…é¡»ç­‰å¾…å‰é¢çš„çº¿ç¨‹å…ˆæ‰§è¡Œã€‚è¿™å¯èƒ½ä¼šå‡å°‘å¹¶å‘æ‰§è¡Œçš„æœºä¼šï¼Œä»è€Œé™ä½ååé‡ã€‚</li>
<li><strong>å¢åŠ å»¶è¿Ÿ</strong>ï¼šå…¬å¹³é”å¯èƒ½ä¼šå¢åŠ çº¿ç¨‹è·å–é”çš„å¹³å‡ç­‰å¾…æ—¶é—´ï¼Œå› ä¸ºæ¯ä¸ªçº¿ç¨‹éƒ½å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªçº¿ç¨‹å®Œæˆã€‚è¿™ç§å»¶è¿Ÿå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿæ•´ä½“æ€§èƒ½ä¸‹é™ã€‚</li>
</ol>
</blockquote>
</li>
<li><p><strong>éå…¬å¹³é”</strong>ï¼šçº¿ç¨‹è·å–é”çš„é¡ºåºä¸ä¸€å®šæ˜¯æŒ‰ç…§è¯·æ±‚é”çš„é¡ºåºï¼Œå…è®¸çº¿ç¨‹â€œæ’é˜Ÿâ€ã€‚è¿™ç§æ–¹å¼å¯èƒ½ä¼šæé«˜ååé‡ï¼Œä½†å¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹é•¿æ—¶é—´æ— æ³•è·å–é”ï¼Œäº§ç”Ÿé¥¥é¥¿ç°è±¡ã€‚ã€ä¸ºä»€ä¹ˆæ€§èƒ½é«˜ï¼Ÿä¸ç”¨æ²‰ç¡å’Œé˜»å¡ é¿å…æ¥å›åˆ‡æ¢ã€‘<u>å¯¹æ€§èƒ½è¦æ±‚é«˜</u></p>
</li>
</ul>
<h6 id="ReentrantLock-çœ‹ä¼ å‚-å…¬å¹³-x2F-éå…¬å¹³éƒ½æ”¯æŒ"><a href="#ReentrantLock-çœ‹ä¼ å‚-å…¬å¹³-x2F-éå…¬å¹³éƒ½æ”¯æŒ" class="headerlink" title="ReentrantLock çœ‹ä¼ å‚ å…¬å¹³&#x2F;éå…¬å¹³éƒ½æ”¯æŒ"></a>ReentrantLock çœ‹ä¼ å‚ <u>å…¬å¹³&#x2F;éå…¬å¹³</u>éƒ½æ”¯æŒ</h6><pre><code class="java">ReentrantLock æ˜¯Javaæä¾›çš„æ˜¾å¼é”ï¼Œå®ƒå…è®¸ä½ é€šè¿‡æ„é€ å‡½æ•°å‚æ•°æ¥é€‰æ‹©æ˜¯ä½¿ç”¨å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ï¼š

å…¬å¹³é”ï¼ˆFair Lockï¼‰ï¼šé€šè¿‡ä¼ é€’trueç»™ReentrantLockçš„æ„é€ å‡½æ•°æ¥åˆ›å»ºã€‚è¿™ç¡®ä¿äº†é”çš„è·å–æ˜¯æŒ‰ç…§çº¿ç¨‹è¯·æ±‚é”çš„é¡ºåºè¿›è¡Œçš„ï¼Œé˜²æ­¢é¥¥é¥¿ç°è±¡ã€‚
ReentrantLock fairLock = new ReentrantLock(true);

éå…¬å¹³é”ï¼ˆNon-Fair Lockï¼‰ï¼šé€šè¿‡ä¼ é€’falseæˆ–è€…ä¸ä¼ é€’å‚æ•°ï¼ˆé»˜è®¤å€¼ï¼‰ç»™ReentrantLockçš„æ„é€ å‡½æ•°æ¥åˆ›å»ºã€‚è¿™ç§æ–¹å¼å…è®¸çº¿ç¨‹â€œæ’é˜Ÿâ€ï¼Œå¯èƒ½ä¼šæé«˜ååé‡ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´æŸäº›çº¿ç¨‹é•¿æ—¶é—´æ— æ³•è·å–é”ã€‚
ReentrantLock nonFairLock = new ReentrantLock(false); // æˆ–è€…
ReentrantLock nonFairLock = new ReentrantLock(); // é»˜è®¤æ˜¯éå…¬å¹³é”
</code></pre>
<h6 id="Synchronized-å…¬å¹³é”"><a href="#Synchronized-å…¬å¹³é”" class="headerlink" title="Synchronized å…¬å¹³é”"></a>Synchronized å…¬å¹³é”</h6><pre><code class="java">ä»Java 6å¼€å§‹ï¼Œsynchronizedçš„å®ç°å¾—åˆ°äº†æ”¹è¿›ï¼Œå®ƒè¯•å›¾å®ç°ä¸€ç§åå‘é”å’Œè½»é‡çº§é”çš„ç­–ç•¥ï¼Œä»¥æé«˜æ€§èƒ½ã€‚
ä»¥ä¸‹æ˜¯å…³äºsynchronizedçš„ä¸€äº›å…³é”®ç‚¹ï¼š

åå‘æ€§ï¼šsynchronizedåœ¨é”ç«äº‰ä¸æ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œä¼šå°è¯•åå‘ç¬¬ä¸€ä¸ªè·å–é”çš„çº¿ç¨‹ï¼Œè¿™æœ‰åŠ©äºå‡å°‘ä¸å¿…è¦çš„åŒæ­¥å¼€é”€ã€‚
è½»é‡çº§é”ï¼šå½“æ²¡æœ‰ç«äº‰æ—¶ï¼Œsynchronizedä¼šä½¿ç”¨è½»é‡çº§é”ï¼Œè¿™æ¯”ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„é‡é‡çº§é”è¦å¿«å¾—å¤šã€‚
é‡é‡çº§é”ï¼šå½“å­˜åœ¨ç«äº‰æ—¶ï¼Œsynchronizedä¼šå‡çº§ä¸ºé‡é‡çº§é”ï¼Œè¿™æ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦ã€‚

synchronizedä¸ä¼šä¸¥æ ¼åœ°ä¿è¯å…¬å¹³æ€§ï¼Œå› ä¸ºå®ƒå…è®¸é”çš„â€œé‡å…¥â€å’Œåå‘æ€§ï¼Œè¿™æ„å‘³ç€å®ƒæ›´å€¾å‘äºéå…¬å¹³é”çš„è¡Œä¸ºã€‚ç„¶è€Œï¼Œåœ¨é”ç«äº‰æ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œsynchronizedä¼šå°½é‡ä¿æŒä¸€å®šçš„å…¬å¹³æ€§ï¼Œå› ä¸ºå®ƒä¼šæŒ‰ç…§çº¿ç¨‹åœ¨ç›‘è§†å™¨é˜Ÿåˆ—ä¸­çš„é¡ºåºæ¥è·å–é”ã€‚

æ€»çš„æ¥è¯´ï¼Œsynchronizedä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å…¬å¹³é”ï¼Œä½†å®ƒçš„å®ç°ç»†èŠ‚å’Œè°ƒåº¦ç­–ç•¥å¯èƒ½ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¡¨ç°å‡ºå…¬å¹³é”çš„ç‰¹æ€§ã€‚ä¸ReentrantLockç›¸æ¯”ï¼Œsynchronizedçš„é”è·å–æœºåˆ¶æ›´ä¸ºå¤æ‚ï¼Œå¹¶ä¸”å®ƒæ˜¯ç”±JVMå†…éƒ¨å®ç°çš„ï¼Œå› æ­¤å…·ä½“çš„è°ƒåº¦ç»†èŠ‚å¯¹å¼€å‘è€…æ¥è¯´æ˜¯é€æ˜çš„ã€‚
</code></pre>
<h4 id="SpringMVCçš„å·¥ä½œåŸç†"><a href="#SpringMVCçš„å·¥ä½œåŸç†" class="headerlink" title="SpringMVCçš„å·¥ä½œåŸç†"></a>SpringMVCçš„å·¥ä½œåŸç†</h4><ul>
<li><p>å‰ç«¯çš„HTTPè¯·æ±‚åˆ°è¾¾æ—¶é¦–å…ˆè¢«<strong>DispatcherServlet</strong>æ¥æ”¶</p>
</li>
<li><p>DispatcherServletæ ¹æ®è¯·æ±‚ä¿¡æ¯<del>è·¯å¾„</del>æŸ¥æ‰¾åˆé€‚çš„<strong>HandlerMapping</strong>æ¥ç¡®å®šå“ªä¸ª<strong>Controller</strong>åº”è¯¥å¤„ç†è¯¥è¯·æ±‚ã€‚</p>
</li>
<li><p>æ‰¾åˆ°åˆé€‚çš„Controlleråï¼ŒDispatcherServletå°†è¯·æ±‚è½¬å‘ç»™å®ƒå¤„ç†ã€‚</p>
</li>
<li><p>Controllerå¤„ç†å®Œè¯·æ±‚åè¿”å›ä¸€ä¸ª<strong>ModelAndView</strong>å¯¹è±¡ç»™DispatcherServletã€‚</p>
</li>
<li><p>DispatcherServletå†é€šè¿‡<strong>ViewResolver</strong>è§£æModelAndViewä¸­çš„è§†å›¾é€»è¾‘åï¼Œæ‰¾åˆ°å¯¹åº”çš„è§†å›¾ã€‚</p>
</li>
<li><p>æœ€åï¼ŒDispatcherServletå°†æ¨¡å‹æ•°æ®æ¸²æŸ“åˆ°è§†å›¾ä¸Šå¹¶å“åº”ç»™å®¢æˆ·ç«¯ã€‚</p>
</li>
</ul>
<p><img src="C:\Users\Pluminary\AppData\Roaming\Typora\typora-user-images\image-20250206094925513.png" alt="image-20250206094925513"></p>
<h4 id="OpenFeignçš„åº•å±‚åŸç†"><a href="#OpenFeignçš„åº•å±‚åŸç†" class="headerlink" title="OpenFeignçš„åº•å±‚åŸç†"></a>OpenFeignçš„åº•å±‚åŸç†</h4><p>OpenFeign å®ç°äº†ç®€æ´ã€å£°æ˜å¼çš„ HTTP è¯·æ±‚è°ƒç”¨ï¼Œå¹¶ä¸”ä¸ Spring Cloud é›†æˆåèƒ½æä¾›æ›´å¤šçš„åŠŸèƒ½å¦‚è´Ÿè½½å‡è¡¡ç­‰</p>
<p><strong>åŠ¨æ€ä»£ç†</strong>ï¼š OpenFeign ä½¿ç”¨ Java **<u>åŠ¨æ€ä»£ç†æŠ€æœ¯</u>**ï¼ŒåŸºäºæ¥å£åˆ›å»ºä»£ç†ç±»ï¼Œä»£ç†ç±»ä¼šè‡ªåŠ¨å‘èµ· HTTP è¯·æ±‚ã€‚ä½ å®šä¹‰çš„æ¥å£æ–¹æ³•ä¼šæ˜ å°„åˆ° HTTP è¯·æ±‚ä¸Šï¼ŒOpenFeign ä¼šæ ¹æ®æ³¨è§£ï¼ˆå¦‚ <code>@RequestMapping</code>, <code>@GetMapping</code> ç­‰ï¼‰æ¥æ„å»ºè¯·æ±‚ã€‚</p>
<p><strong>æ³¨è§£è§£æ</strong>ï¼š OpenFeign ä¼šè§£ææ¥å£æ–¹æ³•ä¸Šçš„æ³¨è§£ï¼Œæ„é€  HTTP è¯·æ±‚çš„ URLã€è¯·æ±‚æ–¹æ³•ç±»å‹ï¼ˆGETã€POST ç­‰ï¼‰ï¼Œä»¥åŠè¯·æ±‚ä½“å’Œè¯·æ±‚å¤´ç­‰ä¿¡æ¯ã€‚</p>
<p><strong>è¯·æ±‚æ‹¦æˆªå’Œå¤„ç†</strong>ï¼š åœ¨è¯·æ±‚å‘èµ·ä¹‹å‰ï¼ŒOpenFeign å…è®¸é€šè¿‡æ‹¦æˆªå™¨ï¼ˆ<code>RequestInterceptor</code>ï¼‰æ¥ä¿®æ”¹è¯·æ±‚ï¼Œæ¯”å¦‚è®¾ç½®è¯·æ±‚å¤´ã€å‚æ•°ç­‰ã€‚</p>
<p><strong>è´Ÿè½½å‡è¡¡ä¸å®¹é”™</strong>ï¼š å¦‚æœä¸ Spring Cloud ä¸€èµ·ä½¿ç”¨ï¼ŒOpenFeign ä¼šé›†æˆ Ribbonï¼ˆè´Ÿè½½å‡è¡¡ï¼‰å’Œ Hystrixï¼ˆå®¹é”™ï¼‰ï¼Œä½¿å¾—æœåŠ¡è°ƒç”¨æ›´åŠ å¥å£®å’Œå¯é ã€‚</p>
<p><strong>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong>ï¼š OpenFeign ä¼šåˆ©ç”¨ Jackson ç­‰åº“è¿›è¡Œè¯·æ±‚å’Œå“åº”çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå°† Java å¯¹è±¡ä¸ HTTP è¯·æ±‚&#x2F;å“åº”å†…å®¹ç›¸äº’è½¬æ¢</p>
<p>åœ¨ä½¿ç”¨OpenFeignæ—¶ï¼Œå¼€å‘è€…åªéœ€è¦å®šä¹‰æ¥å£å¹¶æ·»åŠ ç›¸åº”çš„æ³¨è§£ï¼ŒOpenFeignä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆå®ç°ç±»æ¥æ‰§è¡ŒHTTPè¯·æ±‚ã€‚</p>
<h4 id="å¯¹Volatileçš„ç†è§£"><a href="#å¯¹Volatileçš„ç†è§£" class="headerlink" title="å¯¹Volatileçš„ç†è§£"></a>å¯¹Volatileçš„ç†è§£</h4><p><code>volatile</code> æ˜¯Javaè¯­è¨€ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œç”¨äºä¿®é¥°å˜é‡ï¼Œä»¥ç¡®ä¿è¯¥å˜é‡çš„è¯»å†™æ“ä½œå¯¹æ‰€æœ‰çº¿ç¨‹ç«‹å³å¯è§ï¼Œå¹¶ä¸”é˜²æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚</p>
<p>ç¡®ä¿äº†ä¸åŒçº¿ç¨‹å¯¹è¿™ä¸ªå˜é‡è¿›è¡Œè¯»å†™æ“ä½œæ—¶çš„å¯è§æ€§ã€‚<br>æ˜¯javaçš„å…³é”®å­—æ˜¯ä¿®é¥°å…±äº«çš„å˜é‡ï¼Œä¸èƒ½ä¿®é¥°å±€éƒ¨å˜é‡ã€‚<br>ä¿®é¥°æ™®é€šæˆ–é™æ€æˆå‘˜å˜é‡ï¼Œä¸»è¦ç”¨æ¥ä¿è¯<strong>å¯è§æ€§</strong>å’Œ<strong>æœ‰åºæ€§</strong>ã€‚</p>
<blockquote>
<h3 id="å¯è§æ€§ï¼ˆVisibilityï¼‰"><a href="#å¯è§æ€§ï¼ˆVisibilityï¼‰" class="headerlink" title="å¯è§æ€§ï¼ˆVisibilityï¼‰"></a>å¯è§æ€§ï¼ˆVisibilityï¼‰</h3><p>åœ¨ä¸€ä¸ªå¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œæ¯ä¸ªçº¿ç¨‹å¯èƒ½ä¼šå°†å…±äº«å˜é‡ç¼“å­˜åˆ°è‡ªå·±çš„CPUç¼“å­˜ä¸­ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œè€Œè¿™ä¸ªæ–°å€¼æ²¡æœ‰åŠæ—¶å†™å›ä¸»å†…å­˜ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹å¯èƒ½ä¼šè¯»å–åˆ°æ—§å€¼ã€‚ä½¿ç”¨<code>volatile</code>å…³é”®å­—å¯ä»¥ç¡®ä¿ï¼š</p>
<ul>
<li>æ¯æ¬¡è¯»å†™å˜é‡éƒ½æ˜¯ç›´æ¥æ“ä½œä¸»å†…å­˜ã€‚</li>
<li>å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ª<code>volatile</code>å˜é‡æ—¶ï¼Œæ–°å€¼ä¼šç«‹å³è¢«å†™å…¥ä¸»å†…å­˜ã€‚</li>
<li>å…¶ä»–çº¿ç¨‹è¯»å–<code>volatile</code>å˜é‡æ—¶ï¼Œä¼šä»ä¸»å†…å­˜ä¸­è¯»å–æœ€æ–°å€¼ã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œ<code>volatile</code>å°±ä¿è¯äº†ä¸åŒçº¿ç¨‹ä¹‹é—´å…±äº«å˜é‡çš„å¯è§æ€§ã€‚</p>
<h3 id="æœ‰åºæ€§ï¼ˆOrderingï¼‰"><a href="#æœ‰åºæ€§ï¼ˆOrderingï¼‰" class="headerlink" title="æœ‰åºæ€§ï¼ˆOrderingï¼‰"></a>æœ‰åºæ€§ï¼ˆOrderingï¼‰</h3><p>åœ¨æ²¡æœ‰<code>volatile</code>ä¿®é¥°çš„å˜é‡ä¸Šï¼ŒJavaç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯èƒ½ä¼šè¿›è¡ŒæŒ‡ä»¤é‡æ’åºï¼Œä»¥æé«˜ç¨‹åºè¿è¡Œçš„æ•ˆç‡ã€‚æŒ‡ä»¤é‡æ’åºå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºçš„æ‰§è¡Œé¡ºåºä¸ä»£ç çš„ç¼–å†™é¡ºåºä¸ä¸€è‡´ã€‚ä½¿ç”¨<code>volatile</code>å¯ä»¥é˜²æ­¢ä»¥ä¸‹ä¸¤ç§ç±»å‹çš„é‡æ’åºï¼š</p>
<ul>
<li><strong>å†™æ“ä½œçš„é‡æ’åº</strong>ï¼š<code>volatile</code>å˜é‡çš„å†™æ“ä½œä¸å…è®¸ä¸å®ƒä¹‹å‰çš„æ“ä½œé‡æ’åºã€‚</li>
<li><strong>è¯»æ“ä½œçš„é‡æ’åº</strong>ï¼š<code>volatile</code>å˜é‡çš„è¯»æ“ä½œä¸å…è®¸ä¸å®ƒä¹‹åçš„æ“ä½œé‡æ’åºã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œ<code>volatile</code>å°±æä¾›äº†ä¸€å®šçš„æœ‰åºæ€§ä¿è¯ã€‚</p>
</blockquote>
<h4 id="Spring-Securityçš„å®ç°"><a href="#Spring-Securityçš„å®ç°" class="headerlink" title="Spring Securityçš„å®ç°"></a>Spring Securityçš„å®ç°</h4><p>æˆ‘çš„é¡¹ç›®æ˜¯åŸºäºJWTçš„å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œåœ¨è‡ªå®šä¹‰è®¤è¯ç®¡ç†å™¨<code>AuthenticationManager</code>è®¤è¯æˆåŠŸåï¼Œç”ŸæˆJWTä»¤ç‰Œå¹¶è¿”å›ç»™å‰ç«¯ã€‚å‰ç«¯åœ¨éšåçš„è¯·æ±‚ä¸­æºå¸¦è¿™ä¸ªJWTä»¤ç‰Œã€‚è¿™æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>AccessDecisionManager</code>æ¥å®ç°æ¥å£çš„é‰´æƒé€»è¾‘ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªcheckæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæ ¡éªŒJWTä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚å¦‚æœæ ¡éªŒé€šè¿‡ï¼Œå°±å»æŸ¥è¯¢æ•°æ®åº“ä»¥ç¡®å®šç”¨æˆ·æ‹¥æœ‰å“ªäº›æƒé™ã€‚åœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œå…¶æƒé™ä¿¡æ¯å·²ç»è¢«ç¼“å­˜åˆ°Redisä¸­ã€‚åç»­çš„è¯·æ±‚ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»Redisä¸­æ£€ç´¢ç”¨æˆ·çš„æƒé™ä¿¡æ¯ã€‚å¦‚æœè¯·æ±‚çš„æ¥å£æƒé™ä¸ç”¨æˆ·ç¼“å­˜ä¸­çš„æƒé™åŒ¹é…ï¼Œåˆ™æ”¾è¡Œï¼›å¦‚æœä¸åŒ¹é…ï¼Œåˆ™è¿”å›ä¸€ä¸ªå‹å¥½çš„é”™è¯¯ä¿¡æ¯</p>
<h4 id="ä»€ä¹ˆæ˜¯AQS"><a href="#ä»€ä¹ˆæ˜¯AQS" class="headerlink" title="ä»€ä¹ˆæ˜¯AQS"></a>ä»€ä¹ˆæ˜¯AQS</h4><p>æ˜¯å¤šçº¿ç¨‹ä¸­çš„<del>æŠ½è±¡</del>é˜Ÿåˆ—åŒæ­¥å™¨ã€‚æ˜¯ä¸€ç§é”æœºåˆ¶ï¼Œå®ƒæ˜¯åšä¸ºä¸€ä¸ª<strong>åŸºç¡€æ¡†æ¶</strong>ä½¿ç”¨çš„ï¼Œæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ã€‚<br>åƒReentrantLockéƒ½æ˜¯åŸºäºAQSå®ç°çš„</p>
<blockquote>
<p>åœ¨Javaçš„å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œ<code>AbstractQueuedSynchronizer</code>ï¼ˆç®€ç§°AQSï¼‰æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç±»ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¡†æ¶ï¼Œç”¨äºå®ç°ä¾èµ–äºå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰ç­‰å¾…é˜Ÿåˆ—çš„é˜»å¡é”å’Œå…¶ä»–åŒæ­¥å™¨ï¼ˆä¾‹å¦‚ä¿¡å·é‡ã€äº‹ä»¶ç­‰ï¼‰ã€‚AQS æœ¬èº«æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œ<strong>å®ƒå†…éƒ¨å®šä¹‰äº†<u>è·å–èµ„æºï¼ˆé”ï¼‰</u>å’Œ<u>é‡Šæ”¾èµ„æºï¼ˆé”ï¼‰</u>çš„åŸºæœ¬æ–¹æ³•</strong>ï¼Œä»¥åŠ<strong>ç®¡ç†åŒæ­¥çŠ¶æ€</strong>å’Œ<strong>é˜Ÿåˆ—</strong>çš„æœºåˆ¶ã€‚</p>
<p>å½“è¯´â€œReentrantLockæ˜¯åŸºäºAQSå®ç°çš„â€ï¼Œæ„å‘³ç€<code>ReentrantLock</code>è¿™ä¸ªå…·ä½“é”çš„å®ç°ç±»ï¼Œæ˜¯<strong>ç»§æ‰¿å¹¶åˆ©ç”¨äº†AQSæä¾›çš„æ¨¡æ¿æ–¹æ³•</strong>æ¥æ„å»ºå…¶åŠŸèƒ½çš„ã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li><strong>ç»§æ‰¿</strong>ï¼š<code>ReentrantLock</code>å†…éƒ¨æœ‰ä¸€ä¸ªå†…éƒ¨ç±»å«åš<code>Sync</code>ï¼Œè¿™ä¸ª<code>Sync</code>ç±»ç›´æ¥ç»§æ‰¿è‡ª<code>AbstractQueuedSynchronizer</code>ã€‚</li>
<li><strong>å®ç°</strong>ï¼š<code>Sync</code>ç±»ï¼ˆåŠå…¶å­ç±»ï¼‰ä¼šæ ¹æ®éœ€è¦é‡å†™AQSçš„ä¸€äº›æ–¹æ³•ï¼Œå¦‚<code>tryAcquire</code>å’Œ<code>tryRelease</code>ï¼Œè¿™äº›æ–¹æ³•ç”¨äºå®šä¹‰è·å–é”å’Œé‡Šæ”¾é”çš„å…·ä½“è¡Œä¸ºã€‚</li>
<li><strong>åˆ©ç”¨æ¨¡æ¿æ–¹æ³•</strong>ï¼šAQSæä¾›äº†ä¸€ç³»åˆ—çš„æ¨¡æ¿æ–¹æ³•ï¼ˆå¦‚<code>acquire</code>ã€<code>release</code>ç­‰ï¼‰ï¼Œè¿™äº›æ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨å‰é¢æåˆ°çš„å¯é‡å†™æ–¹æ³•ï¼ˆå¦‚<code>tryAcquire</code>ã€<code>tryRelease</code>ï¼‰ï¼Œä»è€Œå…è®¸<code>ReentrantLock</code>æŒ‰ç…§ç‰¹å®šçš„é€»è¾‘æ¥ç®¡ç†é”çš„çŠ¶æ€ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œ<u>â€œåŸºäºAQSå®ç°â€çš„è¡¨è¿°å¼ºè°ƒäº†<code>ReentrantLock</code>å¹¶ä¸æ˜¯ä»å¤´å¼€å§‹æ„å»ºé”çš„æ‰€æœ‰ç»†èŠ‚ï¼Œè€Œæ˜¯ç«™åœ¨AQSè¿™ä¸ªå¼ºå¤§çš„åŸºç¡€æ¡†æ¶ä¹‹ä¸Š</u>ï¼Œé€šè¿‡å®ç°ç‰¹å®šçš„ç­–ç•¥æ¥å®Œæˆé”çš„å…·ä½“åŠŸèƒ½ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å‡å°‘äº†ä»£ç é‡ï¼Œæé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§ï¼Œå¹¶ä¸”ç”±äºAQSç»è¿‡äº†ä¸¥æ ¼çš„æµ‹è¯•ï¼ŒåŸºäºå®ƒå®ç°çš„é”ä¹Ÿæ›´åŠ å¯é ã€‚</p>
</blockquote>
<p>å®šä¹‰äº†ä¸€ä¸ªå¹¶å‘æƒ…å†µä¸‹ä¸€äº›æŠ½è±¡çš„èµ„æº èµ„æºèƒ½å¦<strong>å…±äº«&#x2F;ç‹¬äº«</strong> å®šä¹‰äº†<strong>å…¬å¹³&#x2F;éå…¬å¹³</strong><br>å¦‚æœæ˜¯éå…¬å¹³é”å¦‚æœæ¥äº†ä¸ªæ–°çš„çº¿ç¨‹æ¥æŠ¢çº¿ç¨‹ ä¹Ÿæ˜¯ä¼šå»æŠ¢ä¸€æ¬¡<br>AQSæˆä¸ºäº†JUCå¾ˆå¤šç±»éƒ½å»ç»§æ‰¿çš„ å®ƒ<strong>æŠ½è±¡äº†å¾ˆå¤šå¹¶å‘çš„å±æ€§å’Œè¡Œä¸º</strong>ï¼Œè®©å­ç±»å»ç»§æ‰¿å®ƒæ‰©å±•è‡ªå·±</p>
<h4 id="Synchronizedçš„é”å‡çº§"><a href="#Synchronizedçš„é”å‡çº§" class="headerlink" title="Synchronizedçš„é”å‡çº§"></a>Synchronizedçš„é”å‡çº§</h4><ul>
<li>Monitorå®ç°çš„é”å±äº<strong>é‡é‡çº§é”</strong>ï¼Œé‡Œé¢æ¶‰åŠåˆ°äº†ç”¨æˆ·æ€<del>æƒé™ä½</del>å’Œå†…æ ¸æ€<del>æƒé™é«˜</del>çš„åˆ‡æ¢ã€è¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæˆæœ¬è¾ƒé«˜ï¼Œæ€§èƒ½æ¯”è¾ƒä½</li>
<li>åœ¨JDK1.6å¼•å…¥äº†ä¸¤ç§æ–°å‹é”æœºåˆ¶ï¼š<strong>åå‘é”å’Œè½»é‡çº§é”</strong>ï¼Œå®ƒä»¬çš„å¼•å…¥æ˜¯ä¸ºäº†è§£å†³åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰æˆ–åŸºæœ¬æ²¡æœ‰ç«äº‰çš„åœºæ™¯ä¸‹ä½¿ç”¨ä¼ ç»Ÿé”æœºåˆ¶å¸¦æ¥çš„æ€§èƒ½å¼€é”€é—®é¢˜</li>
</ul>
<p><u>ä¸€æ®µå¾ˆé•¿çš„æ—¶é—´å†…éƒ½åªè¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨é”</u> <strong>åå‘é”</strong><br><u>æœ‰çº¿ç¨‹äº¤æ›¿æˆ–çº¿ç¨‹åŠ é”çš„æ—¶é—´æ˜¯é”™å¼€çš„</u> <strong>è½»é‡çº§é”</strong><br><u>æœ‰å¾ˆå¤šçº¿ç¨‹æ¥æŠ¢</u> <strong>é‡é‡çº§é”</strong></p>
<blockquote>
<h6 id="åå‘é”"><a href="#åå‘é”" class="headerlink" title="åå‘é”"></a>åå‘é”</h6><p>åå‘é”æ˜¯ä¸€ç§ä¼˜åŒ–é”çš„æœºåˆ¶ï¼Œå®ƒçš„è®¾è®¡åˆè¡·æ˜¯ï¼šå¦‚æœä¸€ä¸ªé”åœ¨å¤§å¤šæ•°æ—¶é—´é‡Œåªè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦è¿›è¡Œçº¿ç¨‹é—´çš„åŒæ­¥æ“ä½œï¼Œå› ä¸ºä¸å­˜åœ¨é”ç«äº‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJVMä¼šä¸ºè¿™ä¸ªé”èµ‹äºˆä¸€ä¸ªâ€œåå‘â€ï¼Œå³åå‘äºç¬¬ä¸€ä¸ªè·å–å®ƒçš„çº¿ç¨‹ã€‚åœ¨åç»­çš„é”æ“ä½œä¸­ï¼Œå¦‚æœè¯¥çº¿ç¨‹å†æ¬¡è¯·æ±‚è¿™ä¸ªé”ï¼Œå°±ä¸éœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚åå‘é”é€‚ç”¨äºåªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—çš„åœºæ™¯ã€‚</p>
<h6 id="è½»é‡çº§é”"><a href="#è½»é‡çº§é”" class="headerlink" title="è½»é‡çº§é”"></a>è½»é‡çº§é”</h6><p>è½»é‡çº§é”æ˜¯å¦ä¸€ç§é”çš„ä¼˜åŒ–ï¼Œå®ƒé€‚ç”¨äºé”ç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆï¼Œä¸”é”æŒæœ‰çš„æ—¶é—´çŸ­çš„åœºæ™¯ã€‚å½“çº¿ç¨‹äº¤æ›¿è®¿é—®åŒæ­¥å—æ—¶ï¼Œä½¿ç”¨è½»é‡çº§é”å¯ä»¥å‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚è½»é‡çº§é”æ˜¯é€šè¿‡åœ¨å¯¹è±¡å¤´ä¸­çš„ä¸€äº›æ ‡è®°ä½æ¥å®ç°çš„ï¼Œå½“é”å¤„äºè½»é‡çº§é”çŠ¶æ€æ—¶ï¼Œçº¿ç¨‹é€šè¿‡CASæ“ä½œæ¥å°è¯•è·å–é”ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™ç›´æ¥è¿›å…¥åŒæ­¥å—æ‰§è¡Œï¼Œä»è€Œé¿å…äº†ä½¿ç”¨æ“ä½œç³»ç»Ÿçº§åˆ«çš„é‡é‡çº§é”æœºåˆ¶ã€‚</p>
<h6 id="é‡é‡çº§é”"><a href="#é‡é‡çº§é”" class="headerlink" title="é‡é‡çº§é”"></a>é‡é‡çº§é”</h6><p>é‡é‡çº§é”æ˜¯JVMä¸­æœ€ä¼ ç»Ÿçš„é”å®ç°ï¼Œä¹Ÿæ˜¯æ€§èƒ½å¼€é”€æœ€å¤§çš„é”ã€‚å½“æœ‰å¾ˆå¤šçº¿ç¨‹åŒæ—¶ç«äº‰åŒä¸€ä¸ªé”æ—¶ï¼ŒJVMä¼šä½¿ç”¨é‡é‡çº§é”æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚é‡é‡çº§é”ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„äº’æ–¥é‡ï¼ˆmutexï¼‰ï¼Œä¼šå¯¼è‡´çº¿ç¨‹çŠ¶æ€åœ¨ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€ä¹‹é—´è½¬æ¢ï¼Œè¿™ç§è½¬æ¢æ˜¯éå¸¸è€—æ—¶çš„ã€‚å› æ­¤ï¼Œå½“é”ç«äº‰éå¸¸æ¿€çƒˆæ—¶ï¼Œä½¿ç”¨é‡é‡çº§é”å¯ä»¥ä¿è¯å…¬å¹³æ€§å’Œçº¿ç¨‹å®‰å…¨ï¼Œä½†ä¼šå¸¦æ¥è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ã€‚</p>
<blockquote>
<p>åœ¨å¤„ç†å¤šçº¿ç¨‹åŒæ—¶ç«äº‰åŒä¸€ä¸ªé”çš„æƒ…å†µæ—¶ï¼Œå¹¶ä¸ä¸€å®šæ€»æ˜¯éœ€è¦ä½¿ç”¨é‡é‡çº§é”ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¼˜åŒ–å’Œç­–ç•¥ï¼Œå¯ä»¥å¸®åŠ©æ‚¨æ›´å¥½åœ°å¤„ç†å¹¶å‘åœºæ™¯ï¼š</p>
<ol>
<li><strong>æœ€å°åŒ–åŒæ­¥èŒƒå›´</strong>ï¼š<ul>
<li>ä»…å¯¹å¿…è¦çš„ä»£ç å—è¿›è¡ŒåŒæ­¥ï¼Œå‡å°‘é”çš„ç«äº‰ã€‚</li>
<li>ä½¿ç”¨ç»†ç²’åº¦é”ï¼Œæ¯”å¦‚å¯¹ä¸åŒçš„æ•°æ®ç»“æ„ä½¿ç”¨ä¸åŒçš„é”ï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªå¯¹è±¡åŠ é”ã€‚</li>
</ul>
</li>
<li><strong>ä½¿ç”¨å¹¶å‘å·¥å…·ç±»</strong>ï¼š<ul>
<li>Javaæä¾›äº†è®¸å¤šå¹¶å‘å·¥å…·ç±»ï¼Œå¦‚<code>java.util.concurrent</code>åŒ…ä¸­çš„<code>ReentrantLock</code>ã€<code>ReadWriteLock</code>ã€<code>Semaphore</code>ã€<code>CountDownLatch</code>ã€<code>ConcurrentHashMap</code>ç­‰ï¼Œå®ƒä»¬æä¾›äº†æ¯”synchronizedæ›´ä¸°å¯Œçš„åŠŸèƒ½ã€‚</li>
</ul>
</li>
<li><strong>é”åˆ†ç¦»</strong>ï¼š<ul>
<li>å¯¹äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨è¯»å†™é”ï¼ˆ<code>ReadWriteLock</code>ï¼‰ï¼Œå®ƒå…è®¸å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œè€Œå†™çº¿ç¨‹åˆ™äº’æ–¥ã€‚</li>
</ul>
</li>
<li><strong>é”ä¼˜åŒ–</strong>ï¼š<ul>
<li>åœ¨é”ç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è½»é‡çº§é”æˆ–åå‘é”ï¼Œè¿™äº›é”çš„å¼€é”€æ¯”é‡é‡çº§é”å°ã€‚</li>
</ul>
</li>
<li><strong>æ— é”ç¼–ç¨‹</strong>ï¼š<ul>
<li>ä½¿ç”¨åŸå­ç±»ï¼ˆå¦‚<code>AtomicInteger</code>ã€<code>AtomicReference</code>ï¼‰å’Œçº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›ç±»é€šè¿‡CASæ“ä½œå®ç°äº†æ— é”çš„çº¿ç¨‹å®‰å…¨ã€‚</li>
</ul>
</li>
<li><strong>çº¿ç¨‹æ± </strong>ï¼š<ul>
<li>ä½¿ç”¨çº¿ç¨‹æ± æ¥ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¸¦æ¥çš„å¼€é”€ã€‚</li>
</ul>
</li>
<li><strong>é¿å…æ­»é”</strong>ï¼š<ul>
<li>è®¾è®¡ä»£ç æ—¶æ³¨æ„é”çš„é¡ºåºï¼Œé¿å…å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼Œå‡å°‘æ­»é”çš„å‘ç”Ÿã€‚</li>
</ul>
</li>
<li><strong>æ€§èƒ½æµ‹è¯•</strong>ï¼š<ul>
<li>å¯¹å¹¶å‘ä»£ç è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œäº†è§£ä¸åŒé”ç­–ç•¥å¯¹æ€§èƒ½çš„å½±å“ï¼Œå¹¶æ ¹æ®æµ‹è¯•ç»“æœé€‰æ‹©åˆé€‚çš„é”ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
</blockquote>
<p>javaè¯­è¨€æ˜¯é«˜çº§è¯­è¨€å¦‚æœæƒ³è°ƒç”¨åº•å±‚çš„æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶è¦é€šè¿‡æ“ä½œç³»ç»Ÿçš„APIå»æ“ä½œã€‚ä»¥å‰è€çš„JDKç‰ˆæœ¬ æ•°æ®æ˜¯åœ¨æ“ä½œç³»ç»Ÿæ‰¾çš„æ•°æ®<del>é”</del>ï¼ŒMonitorçš„æ ‡å¿—0 å’Œ 1ï¼Œåº•å±‚ä½¿ç”¨çš„Monitorå®ç°ï¼Œé‡Œé¢æ¶‰åŠåˆ°äº†ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢ã€è¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæˆæœ¬è¾ƒé«˜ï¼Œæ€§èƒ½æ¯”è¾ƒä½ ã€‚<br>å¼•å…¥æ–°å‹é”åï¼Œjavaé‡Œæ˜¯<strong>ç”¨å¯¹è±¡å¤´æ‰¾ä¸ªåœ°æ–¹å­˜ä¸€æŠŠé”</strong>ï¼Œè¿™æ ·å°±ä¸æ¶‰åŠåˆ°è°ƒç”¨æ“ä½œç³»ç»Ÿåº•å±‚ã€‚ä¸€å¼€å§‹newäº†ä¸ªå¯¹è±¡ æ­¤æ—¶æ˜¯æ— é”çŠ¶æ€ã€‚æ¥ä¸‹æ¥æ¥äººæ‹¿é”ï¼Œé•¿æœŸä¸€ä¸ªäººæ‹¿åˆ°é‚£ä¸ªé” æ­¤æ—¶æ˜¯<strong>åå‘é”</strong><del>ç«äº‰ä¸æ¿€çƒˆ</del>ã€‚åé¢å¤šçº¿ç¨‹ä¸€èµ·æ¥ <u>äº¤æ›¿æŠ¢é”</u> æ­¤æ—¶æ˜¯<strong>è½»é‡çº§é”</strong>ã€‚éšç€å¹¶å‘è¶Šæ¥è¶Šé«˜ æ­¤æ—¶åœ¨ä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ°é”åå¾ˆå¤šçº¿ç¨‹æ¥æŠ¢é” çº¿ç¨‹å…ˆå°è¯•è‡ªå·±å…ˆè·å–å‡ æ¬¡(<strong>è‡ªæ—‹é”</strong>64æ¬¡æœªæ‹¿åˆ°é”å°±ä¼šå‡çº§ä¸ºé‡é‡çº§é”) è¿™æ—¶å°±æ¶‰åŠåˆ°æ“ä½œç³»ç»Ÿçš„åº•å±‚å¯¹è±¡æ¶‰åŠåˆ°äº†ç”¨æˆ·æ€<del>æƒé™ä½</del>å’Œå†…æ ¸æ€<del>æƒé™é«˜</del>çš„åˆ‡æ¢ã€è¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæˆæœ¬è¾ƒé«˜ï¼Œæ€§èƒ½æ¯”è¾ƒä½ã€‚é”ä¸å¯é€†<del>å¯èƒ½æ–°ç‰ˆæœ¬å¯ä»¥é™çº§</del></p>
<h4 id="Dockerfile-å¸¸ç”¨å‘½ä»¤"><a href="#Dockerfile-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Dockerfile å¸¸ç”¨å‘½ä»¤"></a>Dockerfile å¸¸ç”¨å‘½ä»¤</h4><ul>
<li><code>FROM</code>: æŒ‡å®šåŸºç¡€é•œåƒã€‚</li>
<li><code>ENV</code>: è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</li>
<li><code>RUN</code>: æ‰§è¡Œå‘½ä»¤å¹¶åˆ›å»ºæ–°çš„é•œåƒå±‚ã€‚</li>
<li><code>COPY</code>: å°†æ–‡ä»¶ä»å®¿ä¸»æœºå¤åˆ¶åˆ°å®¹å™¨ä¸­ã€‚</li>
<li><code>EXPOSE</code>: å£°æ˜å®¹å™¨è¿è¡Œæ—¶å°†ç›‘å¬çš„ç«¯å£ã€‚</li>
<li><code>ENTRYPOINT</code>: é…ç½®å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œçš„å‘½ä»¤ã€‚</li>
</ul>
<h4 id="å¸¸ç”¨çš„-Docker-å‘½ä»¤"><a href="#å¸¸ç”¨çš„-Docker-å‘½ä»¤" class="headerlink" title="å¸¸ç”¨çš„ Docker å‘½ä»¤"></a>å¸¸ç”¨çš„ Docker å‘½ä»¤</h4><ul>
<li><code>docker run</code>: åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤ã€‚</li>
<li><code>docker pull</code>: ä»ä»“åº“ä¸­æ‹‰å–æˆ–è€…æ›´æ–°ä¸€ä¸ªé•œåƒã€‚</li>
<li><code>docker push</code>ï¼šæ¨é€é•œåƒåˆ°æœåŠ¡</li>
<li><code>docker build</code>: ä» Dockerfile æ„å»ºä¸€ä¸ªé•œåƒã€‚</li>
<li><code>docker images</code>: åˆ—å‡ºæœ¬åœ°é•œåƒã€‚</li>
<li><code>docker ps</code>: åˆ—å‡ºè¿è¡Œä¸­çš„å®¹å™¨ã€‚</li>
<li><code>docker stop</code>: åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ã€‚</li>
<li><code>docker start</code>: å¯åŠ¨ä¸€ä¸ªåœæ­¢çš„å®¹å™¨ã€‚</li>
<li><code>docker rm</code>: åˆ é™¤ä¸€ä¸ªå®¹å™¨ã€‚</li>
<li><code>docker rmi</code>: åˆ é™¤ä¸€ä¸ªé•œåƒã€‚</li>
<li><code>docker exec</code>: åœ¨è¿è¡Œä¸­çš„å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ã€‚</li>
<li><code>docker logs</code>: è·å–å®¹å™¨çš„æ—¥å¿—ã€‚</li>
</ul>
<pre><code class="java">- docker volume createï¼šåˆ›å»ºæ•°æ®å·
- docker volume lsï¼šæŸ¥çœ‹æ‰€æœ‰æ•°æ®å·
- docker volume inspectï¼šæŸ¥çœ‹æ•°æ®å·è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…³è”çš„å®¿ä¸»æœºç›®å½•ä½ç½®
- docker volume rmï¼šåˆ é™¤æŒ‡å®šæ•°æ®å·
</code></pre>
<p>Docker Compose å¸¸ç”¨å‘½ä»¤</p>
<ul>
<li><code>docker-compose up</code>: å¯åŠ¨æ‰€æœ‰æœåŠ¡çš„å®¹å™¨ã€‚</li>
<li><code>docker-compose down</code>: åœæ­¢å¹¶åˆ é™¤å®¹å™¨ã€ç½‘ç»œã€å·å’Œé•œåƒã€‚</li>
<li><code>docker-compose ps</code>: åˆ—å‡ºé¡¹ç›®ä¸­æ‰€æœ‰çš„å®¹å™¨ã€‚</li>
<li><code>docker-compose exec</code>: è¿›å…¥æŒ‡å®šçš„å®¹å™¨ã€‚</li>
<li><code>docker-compose build</code>: æ„å»ºæˆ–é‡å»ºæœåŠ¡ã€‚</li>
<li><code>docker-compose logs</code>: æŸ¥çœ‹æœåŠ¡çš„æ—¥å¿—è¾“å‡ºã€‚</li>
<li><code>docker-compose stop</code>: åœæ­¢è¿è¡Œçš„å®¹å™¨ã€‚</li>
</ul>
<h4 id="synchronized-å’Œ-ReentrantLock-çš„åŒºåˆ«"><a href="#synchronized-å’Œ-ReentrantLock-çš„åŒºåˆ«" class="headerlink" title="synchronized å’Œ ReentrantLock çš„åŒºåˆ«"></a>synchronized å’Œ ReentrantLock çš„åŒºåˆ«</h4><ul>
<li><code>synchronized</code> æ˜¯Javaçš„ä¸€ä¸ªå…³é”®å­—<del>ç”¨äºæ–¹æ³•å’Œä»£ç å—ä¸­</del>ï¼Œè€Œ <code>ReentrantLock</code> æ˜¯JUCåŒ…çš„ä¸€ä¸ªç±»ã€‚</li>
<li><code>synchronized</code> å¯ä»¥<strong>è‡ªåŠ¨</strong>åŠ é”å’Œè§£é”ï¼Œè€Œ <code>ReentrantLock</code> éœ€è¦<strong>æ‰‹åŠ¨</strong>åŠ é”å’Œè§£é”ã€‚</li>
<li><code>synchronized</code> çš„é”æ˜¯éå…¬å¹³çš„ï¼Œè€Œ <code>ReentrantLock</code> é»˜è®¤ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†å¯ä»¥è®¾ç½®ä¸ºå…¬å¹³é”ã€‚</li>
</ul>
<h4 id="ä½ ä»¬å…¬å¸æ˜¯æ€ä¹ˆéƒ¨ç½²é¡¹ç›®çš„"><a href="#ä½ ä»¬å…¬å¸æ˜¯æ€ä¹ˆéƒ¨ç½²é¡¹ç›®çš„" class="headerlink" title="ä½ ä»¬å…¬å¸æ˜¯æ€ä¹ˆéƒ¨ç½²é¡¹ç›®çš„"></a>ä½ ä»¬å…¬å¸æ˜¯æ€ä¹ˆéƒ¨ç½²é¡¹ç›®çš„</h4><p>æ˜¯é€šè¿‡docker + jenkins<br>æµ‹è¯•ç¯å¢ƒæˆ‘ä»¬å‚ä¸ ç”Ÿäº§ç¯å¢ƒç»„é•¿éƒ¨ç½²</p>
<h4 id="varchar-ä¸-char-åŒºåˆ«"><a href="#varchar-ä¸-char-åŒºåˆ«" class="headerlink" title="varchar ä¸ char åŒºåˆ«"></a>varchar ä¸ char åŒºåˆ«</h4><ul>
<li><code>varchar</code> æ˜¯å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œè€Œ <code>char</code> æ˜¯å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ã€‚</li>
<li><code>varchar</code> çš„æ€§èƒ½é€šå¸¸æ¯” <code>char</code> å·®ï¼Œå› ä¸ºéœ€è¦å¤„ç†é¢å¤–çš„é•¿åº¦ä¿¡æ¯ã€‚</li>
<li>å½“æ•°æ®é•¿åº¦å˜åŒ–å¾ˆå¤§æ—¶ï¼Œæ¨èä½¿ç”¨ <code>varchar</code>ï¼›å½“æ•°æ®é•¿åº¦å‡ ä¹å›ºå®šæ—¶ï¼Œä½¿ç”¨ <code>char</code> å¯èƒ½æ›´åˆé€‚ã€‚</li>
</ul>
<h4 id="Redisçš„æŒä¹…åŒ–æœ‰å“ªå‡ ç§-å®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"><a href="#Redisçš„æŒä¹…åŒ–æœ‰å“ªå‡ ç§-å®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="Redisçš„æŒä¹…åŒ–æœ‰å“ªå‡ ç§? å®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?"></a>Redisçš„æŒä¹…åŒ–æœ‰å“ªå‡ ç§? å®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?</h4><p>å®Œæ•´æ€§ å¤§å° æ•°æ®æ¢å¤é€Ÿåº¦ å»ºè®®</p>
<p><strong>RedisæŒä¹…åŒ–</strong>ï¼šRDBå…¨ç§°Redis Database Backup file(Redisæ•°æ®å¤‡ä»½æ–‡ä»¶)ï¼Œä¹Ÿè¢«å«åšRedisæ•°æ®å¿«ç…§ï¼Œç®€å•æ¥è¯´å°±æ˜¯<u>æŠŠå†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½è®°å½•åˆ°ç£ç›˜ä¸­</u>ã€‚å½“Rediså®ä¾‹æ•…éšœé‡å¯åï¼Œä»ç£ç›˜è¯»å–å¿«ç…§æ–‡ä»¶ï¼Œæ•°æ®æ¢å¤ã€‚</p>
<pre><code class="mysql">[root@localhost ~]# redis-cli
127.0.0.1:6379&gt; save          #ç”±Redisä¸»è¿›ç¨‹æ¥æ‰§è¡ŒRDBï¼Œä¼šé˜»å¡æ‰€æœ‰å‘½ä»¤
ok

127.0.0.1:6379&gt; bgsave        #å¼€å¯å­è¿›ç¨‹æ‰§è¡ŒRDBï¼Œé¿å…ä¸»è¿›ç¨‹å—åˆ°å½±å“
Background saving started
</code></pre>
<p>Rediså†…éƒ¨æœ‰è§¦å‘RDBçš„æœºåˆ¶ï¼Œå¯ä»¥åœ¨redis.confæ–‡ä»¶ä¸­æ‰¾åˆ°ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="java">// 900ç§’å†…ï¼Œå¦‚æœè‡³å°‘æœ‰1ä¸ªkeyè¢«ä¿®æ”¹ï¼Œåˆ™æ‰§è¡Œbgsave
save 900 1
save 300 10
save 60 10000
</code></pre>
<p>&#x3D;&#x3D;<strong>RDBçš„æ‰§è¡ŒåŸç†ï¼Ÿ</strong>&#x3D;&#x3D;<del>æ•°æ®å®Œæ•´æ€§é«˜ç”¨RDB</del></p>
<p><strong><u>bgsaveå¼€å§‹æ—¶ä¼šforkä¸»è¿›ç¨‹å¾—åˆ°å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹å…±äº«ä¸»è¿›ç¨‹çš„å†…å­˜æ•°æ®ï¼Œå®Œæˆforkåè¯»å–å†…å­˜æ•°æ®å¹¶å†™å…¥RDBæ–‡ä»¶</u></strong></p>
<blockquote>
<p>åœ¨LInuxä¸­ä¸»è¿›ç¨‹å¹¶æ— æ³•ç›´æ¥è¯»å–ç‰©ç†å†…å­˜ï¼Œå®ƒåªèƒ½é€šè¿‡è™šæ‹Ÿå†…å­˜å»è¯»ã€‚å› æ­¤æœ‰<strong>é¡µè¡¨</strong>(è®°å½•è™šæ‹Ÿåœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³»)å»æ‰§è¡Œæ“ä½œ åŒæ—¶ ä¸»è¿›ç¨‹ä¹Ÿä¼šfork(å¤åˆ¶é¡µè¡¨) æˆä¸ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹(æºå¸¦é¡µè¡¨) â†’ å†™æ–°RDBæ–‡ä»¶æ›¿æ¢æ—§çš„RDBæ–‡ä»¶ â†’ ç£ç›˜</p>
</blockquote>
<p>forké‡‡ç”¨çš„æ˜¯<code>copy-on-write</code>æŠ€æœ¯ï¼š</p>
<ul>
<li>å½“ä¸»è¿›ç¨‹æ‰§è¡Œ<strong>è¯»æ“ä½œ</strong>æ—¶ï¼Œè®¿é—®å…±äº«å†…å­˜</li>
<li>å½“ä¸»è¿›ç¨‹æ‰§è¡Œ<strong>å†™æ“ä½œ</strong>æ—¶ï¼Œåˆ™ä¼šæ‹·è´ä¸€ä»½æ•°æ®ï¼Œæ‰§è¡Œå†™æ“ä½œ</li>
</ul>
<p>ä¼˜ç‚¹ï¼šäºŒè¿›åˆ¶æ•°æ®é‡å¯å Redisæ— éœ€è¿‡å¤šè§£æ ç›´æ¥æ¢å¤</p>
<p>&#x3D;&#x3D;<strong>AOF</strong>&#x3D;&#x3D;<del>å¯¹æ•°æ®ä¸æ•æ„Ÿè¦æ±‚ä¸é«˜</del></p>
<p>AOFå…¨ç§°ä¸ºAppend Only File(è¿½åŠ æ–‡ä»¶)<del>åº•å±‚ç¡¬ç›˜é¡ºåºè¯»å†™</del>ã€‚Rediså¤„ç†çš„æ¯ä¸ªå†™å‘½ä»¤éƒ½ä¼šè®°å½•åœ¨AOFï¼Œå¯ä»¥çœ‹ä½œæ˜¯å‘½ä»¤æ—¥å¿—æ–‡ä»¶<br><u>AOFé»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶æ¥å¼€å¯AOF</u>ï¼š</p>
<pre><code class="mysql"># æ˜¯å¦å¼€å¯AOFåŠŸèƒ½ï¼Œé»˜è®¤æ˜¯no
appendonly yes
# AOFæ–‡ä»¶çš„åç§°
appendfilename &quot;appendonly.aof&quot;
</code></pre>
<p>AOFçš„å‘½ä»¤è®°å½•çš„é¢‘ç‡ä¹Ÿå¯ä»¥é€šè¿‡redis.confæ–‡ä»¶æ¥é…</p>
<pre><code class="mysql"># è¡¨ç¤ºæ¯æ‰§è¡Œä¸€æ¬¡å†™å‘½ä»¤ï¼Œç«‹å³è®°å½•åˆ°AOFæ–‡ä»¶
appendfsync always
# å†™å‘½ä»¤æ‰§è¡Œå®Œæ¯•å…ˆæ”¾å…¥AOFç¼“å†²åŒºï¼Œç„¶åè¡¨ç¤ºæ¯éš”ä¸€ç§’å°†ç¼“å†²åŒºæ•°æ®å†™åˆ°AOFæ–‡ä»¶ï¼Œæ˜¯é»˜è®¤æ–¹æ¡ˆ
appendfsync everysec
# å†™å‘½ä»¤æ‰§è¡Œå®Œå…ˆæ”¾å…¥AOFç¼“å†²åŒºï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šä½•æ—¶å°†ç¼“å†²åŒºå†…å®¹å†™å›ç£ç›˜
appendfsync no
</code></pre>
<table>
<thead>
<tr>
<th align="center">é…ç½®é¡¹</th>
<th align="center">åˆ·ç›˜æ—¶æœº</th>
<th align="center">ä¼˜ç‚¹</th>
<th align="center">ç¼ºç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Always</td>
<td align="center">åŒæ­¥åˆ·ç›˜</td>
<td align="center">å¯é æ€§é«˜ï¼Œå‡ ä¹ä¸ä¸¢æ•°æ®</td>
<td align="center">æ€§èƒ½å½±å“å¤§</td>
</tr>
<tr>
<td align="center"><u>everysec</u></td>
<td align="center"><u>æ¯ç§’åˆ·ç›˜</u></td>
<td align="center"><u>æ€§èƒ½é€‚ä¸­</u></td>
<td align="center"><u>æœ€å¤šä¸¢å¤±1ç§’æ•°æ®</u></td>
</tr>
<tr>
<td align="center">no</td>
<td align="center">æ“ä½œç³»ç»Ÿæ§åˆ¶</td>
<td align="center">æ€§èƒ½æœ€å¥½</td>
<td align="center">å¯é æ€§è¾ƒå·®ï¼Œå¯èƒ½ä¸¢å¤±å¤§é‡æ•°æ®</td>
</tr>
</tbody></table>
<p>å› ä¸ºæ˜¯è®°å½•å‘½ä»¤ï¼ŒAOFæ–‡ä»¶ä¼šæ¯”RDBæ–‡ä»¶å¤§çš„å¤šã€‚è€Œä¸”AOFä¼šè®°å½•å¯¹åŒä¸€ä¸ªkeyçš„å¤šæ¬¡å†™æ“ä½œï¼Œä½†<strong>åªæœ‰æœ€åä¸€æ¬¡å†™æ“ä½œæ‰æœ‰æ„ä¹‰</strong>ã€‚<u>é€šè¿‡æ‰§è¡Œ<code>bgrewriteaof</code>å‘½ä»¤ï¼Œå¯ä»¥è®©AOFæ–‡ä»¶æ‰§è¡Œé‡è¯»åŠŸèƒ½ï¼Œç”¨æœ€å°‘çš„å‘½ä»¤è¾¾åˆ°ç›¸åŒæ•ˆ</u>æœ</p>
<p>Redisä¼šåœ¨å‡ºå‘é˜ˆå€¼æ—¶è‡ªåŠ¨é‡å†™AOFæ–‡ä»¶ã€‚é˜ˆå€¼ä¹Ÿå¯ä»¥åœ¨redis.confä¸­é…ç½®</p>
<pre><code class="mysql"># AOFæ–‡ä»¶æ¯”ä¸Šæ¬¡æ–‡ä»¶ å¢å¤šè¶…è¿‡å¤šå°‘ç™¾åˆ†æ¯”åˆ™è§¦å‘é‡å†™
auto-aof-rewrite-percentage 100
# AOFæ–‡ä»¶ä½“ç§¯æœ€å°å¤šå¤§ä»¥ä¸Šæ‰è§¦å‘é‡å†™
auto-aof-rewrite-min-size 64mb
</code></pre>
<p><strong>â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜… RDBä¸AOFå¯¹æ¯” â˜…â˜…â˜…â˜…â˜…â˜…â˜…â˜…</strong></p>
<p>RDBå’ŒAOFå„æœ‰ä¼˜ç¼ºç‚¹ï¼Œå¦‚æœå¯¹æ•°æ®å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜ï¼Œåœ¨å®é™…å¼€å‘ä¸­å¾€å¾€ä¼šç»“åˆä¸¤è€…æ¥ä½¿ç”¨<br>RDBæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåœ¨ä¿å­˜æ—¶ä½“ç§¯è¾ƒå°æ¢å¤è¾ƒå¿«ï¼Œä½†ä¹Ÿæœ‰å¯èƒ½ä¸¢å¤±æ•°æ®ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨é¡¹ç›®ä¸­ä½¿ç”¨AOFæ¥æ¢å¤æ•°æ®ï¼Œè™½ç„¶æ…¢ä½†ä¸¢å¤±æ•°æ®é£é™©å°ï¼Œåœ¨AOFæ–‡ä»¶ä¸­å¯ä»¥è®¾ç½®åˆ·ç›˜ç­–ç•¥(æ¯ç§’æ‰¹é‡å†™å…¥ä¸€æ¬¡å‘½ä»¤)</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">RDB</th>
<th align="center">AOF</th>
</tr>
</thead>
<tbody><tr>
<td align="center">æŒä¹…åŒ–æ–¹å¼</td>
<td align="center">å®šæ—¶å¯¹æ•´ä¸ªå†…å­˜åšå¿«ç…§å“¦</td>
<td align="center">è®°å½•æ¯ä¸€æ¬¡æ‰§è¡Œçš„å‘½ä»¤</td>
</tr>
<tr>
<td align="center">æ•°æ®å®Œæ•´æ€§</td>
<td align="center">ä¸å®Œæ•´ï¼Œä¸¤æ¬¡å¤‡ä»½ä¹‹é—´ä¼šä¸¢å¤±</td>
<td align="center">ç›¸å¯¹å®Œæ•´ï¼Œå–å†³äºåˆ·ç›˜ç­–ç•¥</td>
</tr>
<tr>
<td align="center">æ–‡ä»¶å¤§å°</td>
<td align="center">ä¼šæœ‰å‹ç¼©ï¼Œæ–‡ä»¶ä½“ç§¯å°</td>
<td align="center">è®°å½•å‘½ä»¤ï¼Œæ–‡ä»¶ä½“ç§¯å¤§</td>
</tr>
<tr>
<td align="center">å®•æœºæ¢å¤é€Ÿåº¦</td>
<td align="center">å¾ˆå¿«</td>
<td align="center">æ…¢</td>
</tr>
<tr>
<td align="center">æ•°æ®æ¢å¤ä¼˜å…ˆçº§</td>
<td align="center">ä½ï¼Œå› ä¸ºæ•°æ®å®Œæ•´æ€§ä¸å¦‚AOF</td>
<td align="center">é«˜ï¼Œå› ä¸ºæ•°æ®å®Œæ•´æ€§æ›´é«˜</td>
</tr>
<tr>
<td align="center">ç³»ç»Ÿèµ„æºå ç”¨</td>
<td align="center">é«˜ï¼Œå¤§é‡CPUå’Œå†…å­˜æ¶ˆè€—</td>
<td align="center">ä½ï¼Œä¸»è¦æ˜¯ç£ç›˜IOèµ„æº<br />ä½†AOFé‡å†™æ—¶ä¼šå ç”¨å¤§é‡CPUå’Œå†…å­˜èµ„æº</td>
</tr>
<tr>
<td align="center">ä½¿ç”¨åœºæ™¯</td>
<td align="center">å¯ä»¥å®¹å¿æ•°åˆ†é’Ÿçš„æ•°æ®ä¸¢å¤±ï¼Œè¿½æ±‚æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦</td>
<td align="center">å¯¹æ•°æ®å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜å¸¸è§</td>
</tr>
</tbody></table>
<h4 id="é¡¹ç›®ä¸­æ˜¯æ€ä¹ˆä½¿ç”¨redisçš„"><a href="#é¡¹ç›®ä¸­æ˜¯æ€ä¹ˆä½¿ç”¨redisçš„" class="headerlink" title="é¡¹ç›®ä¸­æ˜¯æ€ä¹ˆä½¿ç”¨redisçš„"></a>é¡¹ç›®ä¸­æ˜¯æ€ä¹ˆä½¿ç”¨redisçš„</h4><p>éœ€è¦ç»“åˆé¡¹ç›®ä¸­çš„ä¸šåŠ¡è¿›è¡Œå›ç­”ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼é”çš„ä½¿ç”¨åœºæ™¯ï¼š<br>é›†ç¾¤æƒ…å†µä¸‹çš„å®šæ—¶ä»»åŠ¡ã€æŠ¢å•ã€å¹‚ç­‰æ€§åœºæ™¯<br>å¦‚æœä½¿ç”¨äº’æ–¥é”çš„è¯ é‚£ä¹ˆåœ¨é›†ç¾¤é¡¹ç›®æœ‰å¤šä¸ªæœåŠ¡å™¨å°±ä¼šå‡ºç°é—®é¢˜</p>
<p>ç”¨Hashç±»å‹  å¤§Keyæ˜¯Id  å°keyæ˜¯å•†å“id valueæ˜¯å•†å“æ•°é‡<br>æ•°æ®é‡ç‚¹å‡»é‡ ç”¨Stringç±»å‹<br>ç”¨Setç±»å‹ Zsetåšæ’è¡Œæ¦œ</p>
<h4 id="ä½ çš„é¡¹ç›®ä¸­å“ªé‡Œä½¿ç”¨åˆ°åˆ†å¸ƒå¼é”"><a href="#ä½ çš„é¡¹ç›®ä¸­å“ªé‡Œä½¿ç”¨åˆ°åˆ†å¸ƒå¼é”" class="headerlink" title="ä½ çš„é¡¹ç›®ä¸­å“ªé‡Œä½¿ç”¨åˆ°åˆ†å¸ƒå¼é”?"></a>ä½ çš„é¡¹ç›®ä¸­å“ªé‡Œä½¿ç”¨åˆ°åˆ†å¸ƒå¼é”?</h4><p>&#x3D;&#x3D;<strong>Redisåˆ†å¸ƒå¼é”</strong>&#x3D;&#x3D;</p>
<p>Rediså®ç°åˆ†å¸ƒå¼é”ä¸»è¦åˆ©ç”¨Redisçš„<strong>setnx</strong>å‘½ä»¤ï¼Œsetnxæ˜¯**<u>SET if not exists</u>**(å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™SET)çš„ç®€å†™</p>
<ul>
<li><p><strong>è·å–é”</strong></p>
<blockquote>
<p>æ·»åŠ é”ï¼ŒNXæ˜¯äº’æ–¥ã€EXæ˜¯è®¾ç½®è¶…æ—¶æ—¶é—´<br><strong>SET lock value NX EX 10</strong></p>
</blockquote>
</li>
<li><p><strong>é‡Šæ”¾é”</strong></p>
<blockquote>
<p>é‡Šæ”¾é”ï¼Œåˆ é™¤å³å¯<br><strong>DEL key</strong></p>
</blockquote>
</li>
</ul>
<h4 id="ä½ å¯ä»¥è¯´ä¸€ä¸‹redisçš„åˆ†å¸ƒå¼é”çš„åŸç†å—"><a href="#ä½ å¯ä»¥è¯´ä¸€ä¸‹redisçš„åˆ†å¸ƒå¼é”çš„åŸç†å—" class="headerlink" title="ä½ å¯ä»¥è¯´ä¸€ä¸‹redisçš„åˆ†å¸ƒå¼é”çš„åŸç†å—"></a>ä½ å¯ä»¥è¯´ä¸€ä¸‹redisçš„åˆ†å¸ƒå¼é”çš„åŸç†å—</h4><h4 id="æˆ‘åœ¨é¡¹ç›®ä¸­æ˜¯é›†æˆäº†redisson-åº•å±‚åŸºäºLuaè„šæœ¬-å…·æœ‰åŸå­æ€§"><a href="#æˆ‘åœ¨é¡¹ç›®ä¸­æ˜¯é›†æˆäº†redisson-åº•å±‚åŸºäºLuaè„šæœ¬-å…·æœ‰åŸå­æ€§" class="headerlink" title="æˆ‘åœ¨é¡¹ç›®ä¸­æ˜¯é›†æˆäº†redisson(åº•å±‚åŸºäºLuaè„šæœ¬[å…·æœ‰åŸå­æ€§])"></a><del>æˆ‘åœ¨é¡¹ç›®ä¸­æ˜¯é›†æˆäº†redisson(åº•å±‚åŸºäºLuaè„šæœ¬[å…·æœ‰åŸå­æ€§])</del></h4><p>&#x3D;&#x3D;<strong>redissonå®ç°åˆ†å¸ƒå¼é” - æ‰§è¡Œæµç¨‹</strong>&#x3D;&#x3D;</p>
<blockquote>
<p>åŠ é” â†“â†’ åŠ é”æˆåŠŸ â†’ <strong>Watch dog(çœ‹é—¨ç‹—)<del>æ¯éš”(releaseTime&#x2F;3çš„æ—¶é—´åšä¸€æ¬¡ç»­æœŸ)</del></strong> â†’ Redis<br>â†“        æ“ä½œredis â†’ Redis<br>â†“â†’â†’ é‡Šæ”¾é”â†‘ â†’ é€šçŸ¥çœ‹é—¨ç‹—æ— éœ€ç»§ç»­ç›‘å¬ â†’ Redis</p>
</blockquote>
<blockquote>
<p>åŠ é”  â†’ â†’ â†’ æ˜¯å¦åŠ é”æˆåŠŸï¼Ÿâ†’â†’â†’   â†“<br>â†‘â†â†whileå¾ªç¯ä¸æ–­å°è¯•è·å–é”â†â†â†â†“</p>
</blockquote>
<pre><code class="java">public void redisLock() throws InterruptedException&#123;
    RLock lock = redissonClient.getLock(&quot;heimalock&quot;);
 // boolean isLock = lock.tryLock(10, 30, TimeUnit.SECONDS);
// å¦‚æœä¸è®¾ç½®ä¸­é—´çš„è¿‡æœŸæ—¶é—´30 æ‰ä¼šè§¦å‘çœ‹é—¨ç‹—
// åŠ é”ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ç­‰æ“ä½œéƒ½æ˜¯åŸºäºluaè„šæœ¬å®Œæˆçš„[è°ƒç”¨rediså‘½ä»¤æ¥ä¿è¯å¤šæ¡å‘½ä»¤çš„åŸå­æ€§]
    boolean isLock = lock.tryLock(10, TimeUnit.SECONDS);
    if(isLock)&#123;
        try&#123;
            sout(&quot;æ‰§è¡Œä¸šåŠ¡&quot;);
        &#125; finally&#123;
            lock.unlock();
        &#125;
    &#125;
&#125;
</code></pre>
<p>&#x3D;&#x3D;<strong>redissonå®ç°åˆ†å¸ƒå¼é” - å¯é‡å…¥</strong>&#x3D;&#x3D;</p>
<blockquote>
<p>rediså®ç°åˆ†å¸ƒå¼é”æ˜¯ä¸å¯é‡å…¥çš„ ä½†æ˜¯ redissonå®ç°åˆ†å¸ƒå¼é”æ˜¯å¯ä»¥é‡å…¥çš„<br>å¯é‡å…¥åŸç†ï¼šå®ƒä¿©æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å”¯ä¸€çš„çº¿ç¨‹id æ ¹æ®çº¿ç¨‹idå”¯ä¸€æ ‡è¯†åšåˆ¤æ–­ åˆ¤æ–­ä¹‹å‰è·å–é”æ˜¯ä¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹<br><strong>åˆ©ç”¨hashç»“æ„</strong>è®°å½•<strong>çº¿ç¨‹id</strong>å’Œ<strong>é‡å…¥æ¬¡æ•°</strong></p>
<table>
<thead>
<tr>
<th align="center">KEY</th>
<th align="center">VALUE</th>
<th align="center">VALUE</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="center">field</td>
<td align="center">value</td>
</tr>
<tr>
<td align="center">heimalock</td>
<td align="center">thread1</td>
<td align="center">0</td>
</tr>
</tbody></table>
</blockquote>
<pre><code class="java">public void add1()&#123;
  RLock lock = redissonClient.getLock(&quot;heimalock&quot;);
  boolean isLock = lock.tryLock();
// æ‰§è¡Œä¸šåŠ¡
  add2();
// é‡Šæ”¾é”
  lock.unlock();
&#125;
public void add2()&#123;
  RLock lock = redissonClient.getLock(&quot;heimalock&quot;);
  boolean isLock = lock.tryLock();
// æ‰§è¡Œä¸šåŠ¡
// é‡Šæ”¾é” é”æ¬¡æ•°-1ä¸å®Œå…¨é‡Šæ”¾
  lock.unlock();
&#125;
</code></pre>
<p>&#x3D;&#x3D;<strong>redissonå®ç°åˆ†å¸ƒå¼é” - ä¸»ä»ä¸€è‡´æ€§</strong>&#x3D;&#x3D;</p>
<p>Redis Masterä¸»èŠ‚ç‚¹ï¼šä¸»è¦è´Ÿè´£<strong>å†™æ“ä½œ</strong>(å¢åˆ æ”¹) <del>åªèƒ½å†™</del><br>Redis Slaveä»èŠ‚ç‚¹ï¼šä¸»è¦è´Ÿè´£<strong>è¯»æ“ä½œ</strong><del>åªèƒ½è¯»</del></p>
<blockquote>
<p>å½“RedisMasterä¸»èŠ‚ç‚¹çªç„¶å®•æœºå Javaåº”ç”¨ä¼šå»æ ¼å¤–è·å–é” è¿™æ—¶ä¸¤ä¸ªçº¿ç¨‹å°±åŒæ—¶æŒæœ‰ä¸€æŠŠé” å®¹æ˜“å‡ºç°è„æ•°æ®<br>æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p>
</blockquote>
<ul>
<li><strong>RedLock(çº¢é”)<strong>ï¼šä¸èƒ½åªåœ¨ä¸€ä¸ªrediså®ä¾‹ä¸Šåˆ›å»ºé”ï¼Œåº”è¯¥æ˜¯åœ¨å¤šä¸ªrediså®ä¾‹ä¸Šåˆ›å»ºé”</strong>(n&#x2F;2+1)<strong>ï¼Œé¿å…åœ¨ä¸€ä¸ªrediså®ä¾‹ã€å®ç°å¤æ‚ã€æ€§èƒ½å·®ã€è¿ç»´ç¹çã€‘æ€ä¹ˆè§£å†³ï¼Ÿâ†’ <strong>CPæ€æƒ³</strong>ï¼š</strong>zookeeper</strong></li>
</ul>
<h4 id="rediså’Œmysqlæ€ä¹ˆä¿è¯æ•°æ®ä¸€è‡´æ€§"><a href="#rediså’Œmysqlæ€ä¹ˆä¿è¯æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="rediså’Œmysqlæ€ä¹ˆä¿è¯æ•°æ®ä¸€è‡´æ€§"></a>rediså’Œmysqlæ€ä¹ˆä¿è¯æ•°æ®ä¸€è‡´æ€§</h4><p><strong>å†™</strong>å…ˆæ’å…¥æ•°æ®åº“<br><u><strong>æ›´æ–°</strong>å…ˆæ›´æ–°æ•°æ®åº“ æ›´æ–°æ•°æ®åº“æˆåŠŸä½†redisä¸æˆåŠŸ å½±å“ä¸å¤§ å› ä¸ºåé¢ä¼šæœ‰è¿‡æœŸåˆ é™¤ æœ€ç»ˆä¼šä¸€è‡´ï¼Œæ›´æ–°mysqlåç¼“å­˜å¯ä»¥åˆ é™¤ä¹Ÿå¯ä»¥ä¿®æ”¹</u><br><u>æ›´æ–°å®Œæ•°æ®åº“ç›´æ¥åˆ é™¤ç¼“å­˜äº†  æœ‰è¿‡æœŸæ—¶é—´å…œåº• æœ€ç»ˆä¼šä¿æŒä¸€è‡´ æˆ‘ä»¬é¡¹ç›®ä¸­å¯¹æ•°æ®æ•æ„Ÿæ€§ä¸€è‡´æ€§ä¸é«˜ æˆ‘ä»¬è¿½æ±‚å®æ—¶æ€§</u><br><u>å¦‚æœæ˜¯æœ€ç»ˆä¿æŒä¸€è‡´æ€§çš„å°±MQ æˆ‘ä»¬å¯¹å®æ—¶æ€§ä¸é«˜ å¯¹æ•°æ®æ•æ„Ÿæ€§ ä¸€è‡´æ€§é«˜</u><br><strong>åˆ é™¤</strong>é—®é¢˜ä¸å¤§ å“ªé‡Œéƒ½è¡Œï¼<br>è¯»å¤šå†™å°‘çš„å¯ä»¥ä¸Šç¼“å­˜<br>mysqlä¿å­˜è´­ç‰©è½¦è¡¨ ä½†æ˜¯å†é¡µé¢æ“ä½œçš„æ—¶å€™ åªæ“ä½œredis ç”¨<strong>mq</strong>ç»™åˆ°æ¶ˆè´¹è€…ä¿®æ”¹æˆ–<strong>å®šæ—¶ä»»åŠ¡</strong> æ›´æ–°æ•°æ®åˆ°mysqlï¼ŒMQé—®é¢˜ï¼šæˆ‘ä»¬å¯¹æ•°æ®å®æ—¶æ€§è¦æ±‚ä¸é«˜ åªéœ€è¦ä¿å­˜æœ€ç»ˆä¸€è‡´æ€§å°±è¡Œ<br><strong>ä½ å¦‚æœåªå†™redis ä¸‡ä¸€ä¸¢äº†æ•°æ®æ€ä¹ˆåŠ</strong>ï¼Ÿ<br>è´­ç‰©è½¦ä¸¢ç‚¹è®¢å•æ— å½±å“ æ•°æ®å®‰å…¨æ€§è¦æ±‚ä¸å¤ªé«˜ mysqlå°½é‡ä¸è¦æè´­ç‰©è½¦çš„è¡¨ éƒ½åœ¨redisçš„è¡¨ ä¸¢å°±ä¸¢äº†å‘—ã€‚æˆ–è€…å¼‚æ­¥åŒæ­¥&#x2F;å®šæ—¶ä»»åŠ¡<br>å®æ—¶æ€§è¦æ±‚ å®‰å…¨æ€§è¦æ±‚ â†’ MySQL<br>ç”µå•†ä¸€èˆ¬æ•°æ®åº“å’Œmysqléƒ½è¦å­˜ â†’ è¯»å¤šå†™å°‘</p>
<p><strong>ä¸€å®šã€ä¸€å®šã€ä¸€å®šè¦è®¾ç½®å‰æï¼Œä»‹ç»è‡ªå·±çš„ä¸šåŠ¡èƒŒæ™¯</strong> (ä¸€è‡´æ€§è¦æ±‚é«˜ï¼Ÿå…è®¸å»¶è¿Ÿä¸€è‡´ï¼Ÿ)</p>
<blockquote>
<p>â‘  ä»‹ç»è‡ªå·±ç®€å†ä¸Šçš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬å½“æ—¶æ˜¯æŠŠæ–‡ç« çš„çƒ­ç‚¹æ•°æ®å­˜å…¥åˆ°äº†ç¼“å­˜ä¸­ï¼Œè™½ç„¶æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œä½†æ˜¯å®æ—¶è¦æ±‚æ€§å¹¶æ²¡æœ‰é‚£ä¹ˆé«˜ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯<strong>å¼‚æ­¥çš„æ–¹æ¡ˆåŒæ­¥çš„æ•°æ®</strong></p>
<p>â‘¡ æˆ‘ä»¬å½“æ—¶æ˜¯æŠŠæŠ¢å·çš„åº“å­˜å­˜å…¥åˆ°äº†ç¼“å­˜ä¸­ï¼Œè¿™ä¸ªéœ€è¦å®æ—¶çš„è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å½“æ—¶é‡‡ç”¨çš„æ˜¯<strong>redissionæä¾›çš„è¯»å†™é”</strong>æ¥ä¿è¯æ•°æ®çš„åŒæ­¥</p>
</blockquote>
<p><strong>åŒå†™ä¸€è‡´æ€§ï¼š</strong>å½“ä¿®æ”¹äº†æ•°æ®åº“çš„æ•°æ®ä¹Ÿè¦åŒæ—¶æ›´æ–°ç¼“å­˜çš„æ•°æ®ï¼Œç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®è¦ä¿æŒä¸€è‡´</p>
<ul>
<li><p>è¯»æ“ä½œï¼šç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›ï¼›ç¼“å­˜æœªå‘½ä¸­æŸ¥è¯¢æ•°æ®åº“ï¼Œå†™å…¥ç¼“å­˜ï¼Œè®¾å®šè¶…æ—¶æ—¶é—´</p>
</li>
<li><p>å†™æ“ä½œï¼š<strong>å»¶è¿ŸåŒåˆ </strong> [å› ä¸ºæ— è®º<strong>å…ˆåˆ é™¤ç¼“å­˜</strong>è¿˜æ˜¯<strong>å…ˆåˆ é™¤æ•°æ®åº“</strong>éƒ½å¯èƒ½ä¼šå‡ºæ•°æ®ä¸ä¸€è‡´é—®é¢˜ <strong>æœ‰è„æ•°æ®</strong>]</p>
</li>
<li><p>&#x3D;&#x3D;<strong>åŸºäºredissonäº’æ–¥é”</strong>ï¼š&#x3D;&#x3D;[æ”¾å…¥ç¼“å­˜ä¸­çš„æ•°æ® è¯»å¤šå†™å°‘] ã€å¼ºä¸€è‡´æ€§ä¸šåŠ¡ æ€§èƒ½ä½ã€‘<del>æœ‰è¿‡æœŸæ—¶é—´å…œåº•</del></p>
<ul>
<li><strong>å…±äº«é”</strong>ï¼šè¯»é”readLockï¼ŒåŠ é”ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥<strong>å…±äº«è¯»æ“ä½œ</strong>ï¼Œä½†**<u>ä¸å…è®¸å†™æ“ä½œ</u>**</li>
<li><strong>æ’ä»–é”</strong>ï¼šç‹¬å é”writeLockä¹Ÿå«ï¼ŒåŠ é”ä¹‹åï¼Œé˜»å¡å…¶ä»–çº¿ç¨‹è¯»å†™æ“ä½œ(åªå…è®¸ä¸€ä¸ªç”¨æˆ·æˆ–è¿›ç¨‹ç‹¬å åœ°å¯¹æ•°æ®è¿›è¡Œè¯»å–å’Œå†™å…¥æ“ä½œ)<del>æ’ä»–é”ç¡®ä¿äº†å†™æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§</del></li>
<li>è¯»æ•°æ®çš„æ—¶å€™æ·»åŠ <u>å…±äº«é”(</u>è¯»ä¸äº’æ–¥ã€å†™äº’æ–¥)  </li>
<li>å†™æ•°æ®çš„æ—¶å€™æ·»åŠ <u>æ’ä»–é”</u>(é˜»å¡å…¶ä»–çº¿ç¨‹çš„è¯»å†™ å› ä¸ºè¯»å¤šå†™å°‘)</li>
</ul>
<blockquote>
<p>redissionClient.getReadWriteLock(â€œxxxxâ€);</p>
</blockquote>
</li>
<li><p>&#x3D;&#x3D;<strong>å¼‚æ­¥é€šçŸ¥ï¼š</strong>&#x3D;&#x3D;<u>å¼‚æ­¥é€šçŸ¥ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§</u>(éœ€è¦ä¿è¯MQçš„å¯é æ€§)<del>éœ€è¦åœ¨Redisä¸­æ›´æ–°æ•°æ®çš„åŒæ—¶ï¼Œé€šçŸ¥å¦ä¸€ä¸ªæœåŠ¡è¿›è¡ŒæŸäº›æ“ä½œã€‚</del></p>
<ul>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul>
<li><strong>ç¼“å­˜ä¸æ•°æ®åº“åŒå†™</strong>ï¼š å½“åº”ç”¨éœ€è¦åŒæ—¶æ›´æ–°Redisç¼“å­˜å’Œæ•°æ®åº“æ—¶ï¼Œå¯ä»¥å…ˆå°†æ•°æ®å†™å…¥Redisï¼Œç„¶åé€šè¿‡å¼‚æ­¥é€šçŸ¥æœºåˆ¶è§¦å‘æ•°æ®åº“çš„æ›´æ–°æ“ä½œã€‚</li>
<li><strong>è·¨åœ°åŸŸæ•°æ®å¤åˆ¶</strong>ï¼š åœ¨è·¨åœ°åŸŸéƒ¨ç½²çš„æœåŠ¡ä¸­ï¼Œä¸ºäº†å®ç°æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªåœ°åŸŸå†™å…¥æ•°æ®åï¼Œé€šè¿‡å¼‚æ­¥é€šçŸ¥æœºåˆ¶åœ¨å¦ä¸€ä¸ªåœ°åŸŸè¿›è¡Œæ•°æ®å¤åˆ¶ã€‚</li>
<li><strong>ç³»ç»Ÿé—´æ•°æ®åŒæ­¥</strong>ï¼š åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸åŒçš„æœåŠ¡å¯èƒ½æœ‰è‡ªå·±çš„æ•°æ®å­˜å‚¨ã€‚å½“ä¸€ä¸ªæœåŠ¡æ›´æ–°äº†æ•°æ®åï¼Œå¯ä»¥é€šè¿‡å¼‚æ­¥é€šçŸ¥æœºåˆ¶å‘ŠçŸ¥å…¶ä»–ç›¸å…³æœåŠ¡è¿›è¡Œæ•°æ®åŒæ­¥ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p>&#x3D;&#x3D;<strong>åŸºäºCanalçš„å¼‚æ­¥é€šçŸ¥</strong>&#x3D;&#x3D;ï¼šç›‘å¬mysqlçš„binlog<br>å¯ä»¥è§£æbinlogæ–‡ä»¶ å¯ä»¥å­˜æ”¾mysqlé‡Œé¢çš„æ•°æ® çœ‹æœ€è¿‘æœ‰æ— å¢åˆ æ”¹æŸ¥ è½¬æ¢æˆrediså‘½ä»¤ å†ç»™redisé‡Œé¢</p>
<ul>
<li>ä½¿ç”¨MQä¸­é—´ä»¶ï¼Œæ›´æ–°æ•°æ®ä¹‹åï¼Œé€šçŸ¥ç¼“å­˜åˆ é™¤</li>
<li>åˆ©ç”¨canalä¸­é—´ä»¶ï¼Œä¸éœ€è¦ä¿®æ”¹ä¸šåŠ¡ä»£ç ï¼Œä¼ªè£…ä¸ºmysqlsçš„ä¸€ä¸ªä»èŠ‚ç‚¹ï¼Œcanalé€šè¿‡è¯»å–binlogæ•°æ®æ›´æ–°ç¼“å­˜</li>
</ul>
</li>
</ul>
<h4 id="synchronizedå¯ä»¥ä½œç”¨åœ¨å“ªäº›åœ°æ–¹-ä½œç”¨åŸŸ-ï¼Œåˆ†åˆ«é”çš„æ˜¯ä»€ä¹ˆ"><a href="#synchronizedå¯ä»¥ä½œç”¨åœ¨å“ªäº›åœ°æ–¹-ä½œç”¨åŸŸ-ï¼Œåˆ†åˆ«é”çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="synchronizedå¯ä»¥ä½œç”¨åœ¨å“ªäº›åœ°æ–¹(ä½œç”¨åŸŸ)ï¼Œåˆ†åˆ«é”çš„æ˜¯ä»€ä¹ˆ"></a>synchronizedå¯ä»¥ä½œç”¨åœ¨å“ªäº›åœ°æ–¹(ä½œç”¨åŸŸ)ï¼Œåˆ†åˆ«é”çš„æ˜¯ä»€ä¹ˆ</h4><p>åœ¨Javaä¸­ï¼Œ<code>synchronized</code>å…³é”®å­—å¯ä»¥ç”¨æ¥å®ç°çº¿ç¨‹åŒæ­¥ï¼Œå®ƒå¯ä»¥ä½œç”¨åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œå¹¶ä¸”é”å®šçš„å¯¹è±¡ä¹Ÿä¸åŒï¼š</p>
<ol>
<li><p><strong>å®ä¾‹æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ä½œç”¨åœ¨å®ä¾‹æ–¹æ³•ä¸Šæ—¶ï¼Œé”çš„æ˜¯è°ƒç”¨è¯¥æ–¹æ³•çš„<strong>å¯¹è±¡å®ä¾‹</strong>ï¼ˆå³**<u>thiså¯¹è±¡</u>**ï¼‰ã€‚</li>
<li>ä»»ä½•çº¿ç¨‹æƒ³è¦æ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œéƒ½å¿…é¡»è·å¾—è¯¥å¯¹è±¡å®ä¾‹çš„é”ã€‚</li>
</ul>
<pre><code>public synchronized void synchronizedMethod() &#123;
    // æ–¹æ³•ä½“
&#125;
</code></pre>
</li>
<li><p><strong>é™æ€æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ä½œç”¨åœ¨é™æ€æ–¹æ³•ä¸Šæ—¶ï¼Œé”çš„æ˜¯ç±»çš„<strong>Classå¯¹è±¡</strong>ã€‚</li>
<li>ç”±äºé™æ€æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œè€Œä¸æ˜¯å±äºä»»ä½•ç‰¹å®šå®ä¾‹ï¼Œæ‰€ä»¥æ‰€æœ‰çº¿ç¨‹è¦æƒ³æ‰§è¡Œè¿™ä¸ªé™æ€åŒæ­¥æ–¹æ³•ï¼Œéƒ½å¿…é¡»è·å¾—è¯¥ç±»çš„Classå¯¹è±¡çš„é”ã€‚</li>
</ul>
<pre><code>public static synchronized void synchronizedStaticMethod() &#123;
    // æ–¹æ³•ä½“
&#125;
</code></pre>
</li>
<li><p><strong>ä»£ç å—</strong>ï¼š</p>
<ul>
<li>ä½œç”¨åœ¨ä»£ç å—ä¸Šæ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ª<strong>é”å¯¹è±¡<del>æ‹¬å·é‡Œçš„å¯¹è±¡</del><strong>ï¼Œå¯ä»¥æ˜¯</strong>ä»»ä½•å¯¹è±¡</strong>ã€‚</li>
<li>å½“è¿›å…¥è¿™ä¸ªä»£ç å—æ—¶ï¼Œçº¿ç¨‹å¿…é¡»è·å¾—æŒ‡å®šé”å¯¹è±¡çš„é”ã€‚</li>
</ul>
<pre><code>public void synchronizedBlock() &#123;
    synchronized(this) &#123; // é”å®šå½“å‰å¯¹è±¡å®ä¾‹
        // ä»£ç å—
    &#125;
&#125;

public void synchronizedBlockWithObject() &#123;
    Object lock = new Object();
    synchronized(lock) &#123; // é”å®šæŒ‡å®šçš„å¯¹è±¡
        // ä»£ç å—
    &#125;
&#125;
</code></pre>
</li>
</ol>
<p><span style = "color:red"><strong>ä»€ä¹ˆæƒ…å†µä¸‹ç´¢å¼•ä¼šå¤±æ•ˆï¼Ÿ</strong></span></p>
<blockquote>
<ul>
<li>è¿åæœ€å·¦å‰ç¼€æ³•åˆ™</li>
<li>èŒƒå›´æŸ¥è¯¢å³è¾¹çš„åˆ—ï¼Œä¸èƒ½ä½¿ç”¨ç´¢å¼•</li>
<li>ä¸è¦åœ¨ç´¢å¼•åˆ—ä¸Šè¿›è¡Œ<strong>è¿ç®—æ“ä½œ</strong>ï¼Œç´¢å¼•å°†å¤±æ•ˆ</li>
<li>å­—ç¬¦ä¸²ä¸åŠ å•å¼•å·ï¼Œé€ æˆç´¢å¼•å¤±æ•ˆã€‚(ç±»å‹è½¬æ¢)</li>
<li>ä»¥%å¼€å¤´çš„Likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œç´¢å¼•å¤±æ•ˆ<br>[ä¸å½±å“æ­£å¸¸æŸ¥è¯¢ä¸šåŠ¡ ä½†æœªè¿ç”¨è¶…å¤§åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ– ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ]</li>
</ul>
</blockquote>
<p><span style = "color:red"><strong>ç´¢å¼•åˆ›å»ºåŸåˆ™æœ‰å“ªäº›ï¼Ÿ</strong></span><del>ç´¢å¼•å¾ˆå¤šå°±ä¼šæœ‰å¾ˆå¤šB+æ ‘</del></p>
<blockquote>
<p>â‘  <strong>æ•°æ®é‡è¾ƒå¤§ï¼Œä¸”æŸ¥è¯¢æ¯”è¾ƒé¢‘ç¹çš„è¡¨</strong><br>â‘¡ <strong>å¸¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€æ’åºã€åˆ†ç»„çš„å­—æ®µ</strong> [whereã€group byã€order by]<br>â‘¢ å­—æ®µå†…å®¹åŒºåˆ†åº¦é«˜<br>â‘£ å†…å®¹è¾ƒé•¿ï¼Œä½¿ç”¨å‰ç¼€ç´¢å¼•<br>â‘¤ <strong>å°½é‡è”åˆç´¢å¼•</strong><del>å¯¹å­˜å‚¨èŠ‚çœç©ºé—´</del></p>
<pre><code class="java">å¦‚æœæˆ‘ä»¬ç»å¸¸æ ¹æ®å®¢æˆ·IDå’Œè®¢å•æ—¥æœŸæ¥æŸ¥è¯¢è®¢å•ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ customer_id å’Œ order_date ä¸Šåˆ›å»ºä¸€ä¸ªè”åˆç´¢å¼•ã€‚
CREATE INDEX idx_customer_date ON orders (customer_id, order_date);

è¿™ä¸ªè”åˆç´¢å¼• idx_customer_date æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š

ç´¢å¼•é¡ºåºï¼šé¦–å…ˆæ ¹æ® customer_id æ’åºï¼Œç„¶ååœ¨æ¯ä¸ª customer_id çš„åŸºç¡€ä¸Šæ ¹æ® order_date æ’åºã€‚
æŸ¥è¯¢ä¼˜åŒ–ï¼šä»¥ä¸‹æŸ¥è¯¢å¯ä»¥åˆ©ç”¨è¿™ä¸ªè”åˆç´¢å¼•ï¼š
SELECT * FROM orders WHERE customer_id = ? AND order_date = ?;
SELECT * FROM orders WHERE customer_id = ?;
</code></pre>
<p>â‘¥ <strong>è¦æ§åˆ¶ç´¢å¼•çš„æ•°é‡</strong><br>â‘¦ å¦‚æœç´¢å¼•åˆ—ä¸èƒ½å­˜å‚¨NULLå€¼ï¼Œè¯·åœ¨åˆ›å»ºè¡¨æ—¶ä½¿ç”¨NOT NULLçº¦æŸå®ƒ<br>å¤§å­—æ®µä¸å»ºè®®å»ºç«‹ç´¢å¼•æ˜¯å› ä¸ºB+æ ‘ä¸€ä¸ªå¶å­èŠ‚ç‚¹&#x2F;ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ å·®ä¸å¤š16k ä¸€ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ª[é¡µ] å¤šçš„è¯ä¼šæ›´å¤šå±‚<br>å°½é‡ä¸ç”¨æ€§åˆ«å»åˆ›å»ºç´¢å¼•</p>
</blockquote>
<blockquote>
<ul>
<li>å…ˆé™ˆè¿°è‡ªå·±å†å®é™…å·¥ä½œä¸­æ˜¯æ€ä¹ˆç”¨çš„</li>
<li>ä¸»é”®ç´¢å¼•</li>
<li>å”¯ä¸€ç´¢å¼•</li>
<li>æ ¹æ®ä¸šåŠ¡åˆ›å»ºçš„ç´¢å¼•(å¤åˆç´¢å¼•)</li>
</ul>
</blockquote>
<p><span style = "color:red"><strong>ç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„äº†è§£è¿‡å—ï¼Ÿ</strong></span></p>
<blockquote>
<p>MySQLçš„InnoDBå¼•æ“é‡‡ç”¨çš„B+æ ‘çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨ç´¢å¼•</p>
<ul>
<li>é˜¶æ•°æ›´å¤šï¼Œè·¯å¾„æ›´çŸ­</li>
<li>ç£ç›˜è¯»å†™ä»£ä»·B+æ ‘æ›´ä½ï¼Œéå¶å­èŠ‚ç‚¹åªå­˜å‚¨æŒ‡é’ˆï¼Œå¶å­é˜¶æ®µå­˜å‚¨æ•°æ®</li>
<li>B+æ ‘ä¾¿äºæ‰«åº“å’ŒåŒºé—´æŸ¥è¯¢ï¼Œå¶å­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨</li>
</ul>
</blockquote>
<p>**<u>MySQLé»˜è®¤ä½¿ç”¨çš„ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„æ˜¯B+æ ‘</u>**ã€‚å†èŠB+æ ‘ä¹‹å‰ï¼Œå…ˆæ¥èŠèŠäºŒå‰æ ‘å’ŒBæ ‘</p>
<p>&#x3D;&#x3D;<strong>B Tree</strong>(<strong>çŸ®èƒ–æ ‘</strong>)&#x3D;&#x3D;ï¼ŒBæ ‘æ˜¯ä¸€ç§å¤šå‰è·¯è¡¡æŸ¥æ‰¾æ ‘ï¼Œç›¸å¯¹äºäºŒå‰æ ‘ï¼ŒBæ ‘æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªåˆ†æ”¯ï¼Œå³å¤šå‰ã€‚ä»¥ä¸€é¢—æœ€å¤§åº¦æ•°(max-degree)ä¸º5(5é˜¶)çš„b-treeä¸ºä¾‹ï¼Œé‚£è¿™ä¸ªBæ ‘æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå­˜å‚¨4ä¸ªkey</p>
<p>&#x3D;&#x3D;<strong>B+Tree</strong>&#x3D;&#x3D; æ˜¯å†BTreeåŸºç¡€ä¸Šçš„ä¸€ç§ä¼˜åŒ–ï¼Œä½¿å…¶æ›´é€‚åˆå®ç°å¤–å­˜å‚¨ç´¢å¼•ç»“æ„ï¼ŒInnoDBå­˜å‚¨å¼•æ“å°±æ˜¯B+Treeå®ç°å…¶ç´¢å¼•ç»“æ„</p>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/264cd6bd9cf733e6fe23dd38f6959fe688dec2d9/B%20Tree%20%E5%92%8C%20B+Tree.png"></p>
<p><strong>Bæ ‘ä¸B+æ ‘å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li>ç£ç›˜è¯»å†™ä»£ä»·B+æ ‘æ›´ä½</li>
<li>æŸ¥è¯¢æ•ˆç‡B+æ ‘æ›´åŠ ç¨³å®š</li>
<li>B+æ ‘ä¾¿äºæ‰«åº“å’ŒåŒºé—´æŸ¥è¯¢</li>
</ul>
<blockquote>
<p><strong>Bæ ‘</strong>è¦æ‰¾12 é¦–å…ˆæ‰¾38 å·¦é¢å° å†å»ç¼©å°èŒƒå›´16å’Œ29 æ‰¾åˆ°12 â†’ ä½†æ˜¯æˆ‘ä»¬åªæƒ³è¦12çš„æ•°æ® Bæ ‘ä¼šé¢å¤–çš„æŠŠ38,16,29çš„æ•°æ®å…¨æŸ¥ä¸€éæœ€åæ‰åˆ°12çš„æ•°æ®</p>
<p><strong>B+æ ‘</strong>æ˜¯åœ¨å¶å­èŠ‚ç‚¹æ‰ä¼šå­˜å‚¨æ•°æ®ï¼Œåœ¨éå¶å­èŠ‚ç‚¹å…¨æ˜¯æŒ‡é’ˆï¼Œè¿™æ ·å°±æ²¡æœ‰å…¶ä»–ä¹±ä¸ƒå…«ç³Ÿçš„æ•°æ®å½±å“ ã€‚ä¸”æŸ¥æ‰¾è·¯å¾„æ˜¯å·®ä¸å¤šçš„ï¼Œæ•ˆç‡è¾ƒç¨³å®š</p>
<p><strong>ä¾¿äºæ‰«åº“</strong>ï¼šæ¯”å¦‚æˆ‘ä»¬è¦æŸ¥è¯¢6-34åŒºé—´çš„æ•°æ®ï¼Œå…ˆå»æ ¹èŠ‚ç‚¹æ‰«æä¸€æ¬¡38 â†’ 16-29 â†’ ç”±äºå¶å­èŠ‚ç‚¹ä¹‹é—´æœ‰åŒå‘æŒ‡é’ˆï¼Œå°±å¯ä»¥ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ•°æ®éƒ½ç»™æ‹¿åˆ°[æ— éœ€å†å»æ ¹èŠ‚ç‚¹æ‰¾ä¸€æ¬¡]</p>
</blockquote>
<h4 id="mysqlåº•å±‚ä¸ºä»€ä¹ˆç”¨B-æ ‘åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾-æ ‘è¶ŠçŸ®ç»è¿‡ç£ç›˜IOæ¬¡æ•°è¶Šå°‘-å®ƒæ˜¯ç¨³å®šçš„æ¯æ¬¡éƒ½æŸ¥åˆ°æœ€åº•å±‚"><a href="#mysqlåº•å±‚ä¸ºä»€ä¹ˆç”¨B-æ ‘åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾-æ ‘è¶ŠçŸ®ç»è¿‡ç£ç›˜IOæ¬¡æ•°è¶Šå°‘-å®ƒæ˜¯ç¨³å®šçš„æ¯æ¬¡éƒ½æŸ¥åˆ°æœ€åº•å±‚" class="headerlink" title="mysqlåº•å±‚ä¸ºä»€ä¹ˆç”¨B+æ ‘åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾,æ ‘è¶ŠçŸ®ç»è¿‡ç£ç›˜IOæ¬¡æ•°è¶Šå°‘,å®ƒæ˜¯ç¨³å®šçš„æ¯æ¬¡éƒ½æŸ¥åˆ°æœ€åº•å±‚"></a>mysqlåº•å±‚ä¸ºä»€ä¹ˆç”¨B+æ ‘<del>åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾,æ ‘è¶ŠçŸ®ç»è¿‡ç£ç›˜IOæ¬¡æ•°è¶Šå°‘,å®ƒæ˜¯ç¨³å®šçš„æ¯æ¬¡éƒ½æŸ¥åˆ°æœ€åº•å±‚</del></h4><p><del><strong>äºŒå‰æ ‘</strong> O(logn) å®¹æ˜“é€€åŒ–æˆé“¾è¡¨ æ‰€ä»¥ä¸ç”¨å®ƒ</del><br><del><strong>å¹³è¡¡äºŒå‰æ ‘</strong> å…¨éƒ¨å€¾æ–œ</del><br><del><strong>çº¢é»‘æ ‘</strong> ä¸€ä¸ªèŠ‚ç‚¹åªèƒ½å­˜ä¸€ä¸ªæ•°æ®</del><br>Bæ ‘èƒ½ä¸èƒ½é™¤äº†å¶å­èŠ‚ç‚¹å…¶ä»–ä¸å­˜æ•°æ®å‘¢ï¼Ÿ</p>
<blockquote>
<p>ä½ å¯ä»¥è®¾è®¡ä¸€ç§å˜ä½“çš„Bæ ‘ï¼Œå…¶ä¸­åªæœ‰å¶å­èŠ‚ç‚¹å­˜å‚¨æ•°æ®ï¼Œè€Œæ‰€æœ‰å…¶ä»–éå¶å­èŠ‚ç‚¹ä»…ä½œä¸ºå¯¼èˆªèŠ‚ç‚¹ï¼Œä¸å­˜å‚¨å®é™…çš„æ•°æ®ã€‚è¿™ç§ç»“æ„åœ¨æ¦‚å¿µä¸Šç±»ä¼¼äºBæ ‘çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œé€šå¸¸è¢«ç§°ä¸ºBæ ‘ç´¢å¼•ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­éå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯é”®å€¼ï¼Œè€Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯å®é™…çš„æ•°æ®è®°å½•æˆ–è€…æ˜¯æŒ‡å‘æ•°æ®è®°å½•çš„æŒ‡é’ˆ</p>
</blockquote>
<p>B+æ ‘ç¬¬ä¸‰å±‚2000å¤šä¸‡æ¡æ•°æ®ï¼Œå°½é‡ä¸è¦æŠŠæ•°æ®è¾¾åˆ°2000å¤šä¸‡<br>B+æ ‘å¶å­èŠ‚ç‚¹åŠ äº†åŒå‘é“¾è¡¨ è®©æˆ‘ä»¬æŸ¥è¯¢æ›´åŠ ç¨³å®š èŒƒå›´æŸ¥è¯¢ä¼šæ›´å¿«</p>
<h6 id="mysqlç´¢å¼•åº•å±‚ä¸ä¸€å®šåªæœ‰B-æ ‘ï¼Œä¹Ÿå¯èƒ½æ˜¯Hash-åœ¨ç²¾å‡†æŸ¥è¯¢æ€§èƒ½æ¯”å®ƒé«˜"><a href="#mysqlç´¢å¼•åº•å±‚ä¸ä¸€å®šåªæœ‰B-æ ‘ï¼Œä¹Ÿå¯èƒ½æ˜¯Hash-åœ¨ç²¾å‡†æŸ¥è¯¢æ€§èƒ½æ¯”å®ƒé«˜" class="headerlink" title="mysqlç´¢å¼•åº•å±‚ä¸ä¸€å®šåªæœ‰B+æ ‘ï¼Œä¹Ÿå¯èƒ½æ˜¯Hash åœ¨ç²¾å‡†æŸ¥è¯¢æ€§èƒ½æ¯”å®ƒé«˜"></a>mysqlç´¢å¼•åº•å±‚ä¸ä¸€å®šåªæœ‰B+æ ‘ï¼Œä¹Ÿå¯èƒ½æ˜¯Hash åœ¨ç²¾å‡†æŸ¥è¯¢æ€§èƒ½æ¯”å®ƒé«˜</h6><p><strong>Râ€”Tree</strong>ï¼šåœ°ç†ä½ç½®æœç´¢</p>
<h6 id="è”åˆç´¢å¼•"><a href="#è”åˆç´¢å¼•" class="headerlink" title="è”åˆç´¢å¼•"></a>è”åˆç´¢å¼•</h6><p><code>where b= AND c= AND a= </code> è¿™æ ·èµ°ç´¢å¼•éƒ½èƒ½èµ° åº•å±‚è‡ªå·±æ’åº<br>ä¸ºä»€ä¹ˆè”åˆç´¢å¼•è¦éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ã€é‡Œé¢çš„b+æ ‘ å…ˆæŒ‰ç…§aæ’åº å†b å› ä¸ºè¦äºŒåˆ†æŸ¥æ‰¾ ä¸æ’åºæ€ä¹ˆæ‰¾ï¼Ÿã€‘</p>
<p><span style = "color:red"><strong>åœ¨MySQLä¸­ï¼Œå¦‚ä½•å®šä½æ…¢æŸ¥è¯¢ï¼Ÿ</strong></span><del>æŸ¥è¯¢å‰ç”¨explainæŸ¥è¯¢æ˜¯å¦èµ°äº†ç´¢å¼•ç­‰é—®é¢˜</del></p>
<h6 id="explainæŸ¥è¯¢åçš„åˆ—ï¼š"><a href="#explainæŸ¥è¯¢åçš„åˆ—ï¼š" class="headerlink" title="explainæŸ¥è¯¢åçš„åˆ—ï¼š"></a>explainæŸ¥è¯¢åçš„åˆ—ï¼š</h6><pre><code class="java">idï¼šæŸ¥è¯¢ä¸­SELECTè¯­å¥çš„åºåˆ—å·ï¼Œå¦‚æœè¯¥è¡Œå¼•ç”¨å…¶ä»–è¡Œçš„å¹¶é›†ç»“æœï¼Œåˆ™è¯¥å€¼å¯ä»¥ä¸ºç©ºã€‚
select_typeï¼šè¡¨ç¤ºæŸ¥è¯¢çš„ç±»å‹ï¼Œå¸¸è§çš„ç±»å‹æœ‰ï¼š
SIMPLEï¼šç®€å•çš„SELECTæŸ¥è¯¢ï¼Œä¸ä½¿ç”¨UNIONæˆ–å­æŸ¥è¯¢ã€‚
PRIMARYï¼šæœ€å¤–å±‚çš„SELECTæŸ¥è¯¢ã€‚
UNIONï¼šåœ¨UNIONä¸­çš„ç¬¬äºŒä¸ªæˆ–éšåçš„SELECTæŸ¥è¯¢ã€‚
DEPENDENT UNIONï¼šåœ¨UNIONä¸­çš„ç¬¬äºŒä¸ªæˆ–éšåçš„SELECTæŸ¥è¯¢ï¼Œå–å†³äºå¤–å±‚æŸ¥è¯¢ã€‚
UNION RESULTï¼šUNIONçš„ç»“æœã€‚
SUBQUERYï¼šå­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªSELECTã€‚
DEPENDENT SUBQUERYï¼šå­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªSELECTï¼Œå–å†³äºå¤–å±‚æŸ¥è¯¢ã€‚
tableï¼šæŸ¥è¯¢çš„æ˜¯å“ªä¸ªè¡¨ã€‚
typeï¼šè¿™æ˜¯ä½ æåˆ°çš„ä¸€ä¸ªéå¸¸é‡è¦çš„åˆ—ï¼Œå®ƒè¡¨ç¤ºMySQLåœ¨è¡¨ä¸­æ‰¾åˆ°æ‰€éœ€è¡Œçš„æ–¹å¼ï¼Œä¹Ÿç§°ä¸ºâ€œè®¿é—®ç±»å‹â€ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„è®¿é—®ç±»å‹ï¼Œä»æœ€å¥½åˆ°æœ€å·®æ’åºï¼š
systemï¼šè¡¨åªæœ‰ä¸€è¡Œï¼ˆç³»ç»Ÿè¡¨ï¼‰ã€‚
constï¼šè¡¨æœ€å¤šæœ‰ä¸€ä¸ªåŒ¹é…è¡Œï¼Œå®ƒå°†åœ¨æŸ¥è¯¢å¼€å§‹æ—¶è¢«è¯»å–ã€‚å› ä¸ºä»…æœ‰ä¸€è¡Œï¼Œæ‰€ä»¥ä¼˜åŒ–å™¨çš„å…¶ä½™éƒ¨åˆ†å¯ä»¥å°†è¿™ä¸€è¡Œè§†ä¸ºå¸¸é‡ã€‚
eq_refï¼šå¯¹äºæ¯ä¸ªæ¥è‡ªäºå‰é¢çš„è¡¨çš„è¡Œç»„åˆï¼Œä»è¯¥è¡¨ä¸­è¯»å–ä¸€è¡Œã€‚è¿™é€šå¸¸æ˜¯æœ€å¥½çš„è”æ¥ç±»å‹ï¼Œé™¤äº†constç±»å‹ã€‚
refï¼šå¯¹äºæ¯ä¸ªæ¥è‡ªäºå‰é¢çš„è¡¨çš„è¡Œç»„åˆï¼Œæ‰€æœ‰æœ‰åŒ¹é…ç´¢å¼•å€¼çš„è¡Œå°†ä»è¿™å¼ è¡¨ä¸­è¯»å–ã€‚
fulltextï¼šä½¿ç”¨å…¨æ–‡ç´¢å¼•æ‰§è¡ŒæŸ¥è¯¢ã€‚
ref_or_nullï¼šä¸refç±»ä¼¼ï¼Œä½†æ˜¯MySQLä¼šé¢å¤–æœç´¢åŒ…å«NULLå€¼çš„è¡Œã€‚
index_mergeï¼šè¡¨ç¤ºæŸ¥è¯¢ä½¿ç”¨äº†ä¸¤ä¸ªæˆ–æ›´å¤šçš„ç´¢å¼•ã€‚
unique_subqueryï¼šç”¨äºINå­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢è¿”å›ä¸é‡å¤çš„å€¼é›†ã€‚
index_subqueryï¼šç”¨äºINå­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢è¿”å›ä¸é‡å¤çš„å€¼é›†ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•ã€‚
rangeï¼šä½¿ç”¨ç´¢å¼•æ¥æ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œã€‚
indexï¼šå…¨ç´¢å¼•æ‰«æï¼ˆæ¯”ALLå¿«ï¼Œå› ä¸ºç´¢å¼•é€šå¸¸æ¯”æ•°æ®è¡Œå°ï¼‰ã€‚
ALLï¼šå…¨è¡¨æ‰«æï¼Œè¿™æ˜¯æœ€å·®çš„ä¸€ç§ç±»å‹ï¼Œå› ä¸ºMySQLå¿…é¡»æ£€æŸ¥æ¯ä¸€è¡Œä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œã€‚
possible_keysï¼šæŒ‡å‡ºMySQLèƒ½ä½¿ç”¨å“ªäº›ç´¢å¼•æ¥ä¼˜åŒ–æŸ¥è¯¢ã€‚
keyï¼šMySQLå®é™…å†³å®šä½¿ç”¨çš„ç´¢å¼•ã€‚
key_lenï¼šä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚è¶ŠçŸ­è¶Šå¥½ã€‚
refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚
rowsï¼šMySQLè®¤ä¸ºå¿…é¡»æ£€æŸ¥çš„ç”¨æ¥è¿”å›è¯·æ±‚æ•°æ®çš„è¡Œæ•°ã€‚
filteredï¼šæ˜¾ç¤ºäº†é€šè¿‡æ¡ä»¶è¿‡æ»¤å‡ºçš„è¡Œæ•°çš„ç™¾åˆ†æ¯”ä¼°è®¡ã€‚
Extraï¼šåŒ…å«MySQLè§£ææŸ¥è¯¢çš„é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚æ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•ï¼Œæ˜¯å¦æ’åºäº†ç»“æœï¼Œæ˜¯å¦ä½¿ç”¨äº†ä¸´æ—¶è¡¨ç­‰
</code></pre>
<blockquote>
<p>1.ä»‹ç»ä¸€ä¸‹å½“æ—¶äº§ç”Ÿé—®é¢˜çš„åœºæ™¯(æˆ‘ä»¬å½“æ—¶çš„ä¸€ä¸ªæ¥å£æµ‹è¯•çš„æ—¶å€™éå¸¸çš„æ…¢ï¼Œå‹æµ‹çš„ç»“æœå¤§æ¦‚5ç§’é’Ÿ)<br>2.æˆ‘ä»¬ç³»ç»Ÿä¸­å½“æ—¶é‡‡ç”¨äº†è¿ç»´å·¥å…·(<strong>Skywalking</strong>)ï¼Œå¯ä»¥ç›‘æµ‹å‡ºå“ªä¸ªæ¥å£ï¼Œæœ€ç»ˆå› ä¸ºæ˜¯sqlçš„é—®é¢˜<br>3.åœ¨mysqlä¸­å¼€å¯äº†æ…¢æ—¥å¿—æŸ¥è¯¢ï¼Œæˆ‘ä»¬è®¾ç½®çš„å€¼å°±æ˜¯2ç§’ï¼Œä¸€æ—¦sqlæ‰§è¡Œè¶…è¿‡2ç§’å°±ä¼šè®°å½•åˆ°æ—¥å¿—ä¸­(è°ƒè¯•é˜¶æ®µ)</p>
</blockquote>
<blockquote>
<p>äº§ç”ŸåŸå› ï¼š</p>
<ul>
<li>èšåˆæŸ¥è¯¢</li>
<li>å¤šè¡¨æŸ¥è¯¢</li>
<li>è¡¨æ•°æ®é‡è¿‡å¤§æŸ¥è¯¢</li>
<li>æ·±åº¦åˆ†é¡µæŸ¥è¯¢</li>
</ul>
</blockquote>
<p><strong>æ–¹æ¡ˆä¸€ï¼š</strong>&#x3D;&#x3D;<strong>å¼€æºå·¥å…·</strong>&#x3D;&#x3D;[è°ƒè¯•é˜¶æ®µæ‰ä¼šå¼€å¯  ç”Ÿäº§é˜¶æ®µä¸ä¼šå¼€å¯]</p>
<ul>
<li>è°ƒè¯•å·¥å…·Arthas</li>
<li>è¿ç»´å·¥å…·ï¼šPrometheusã€SKywalking(æ¥å£è®¿é—®æ—¶é—´)</li>
</ul>
<p><strong>æ–¹æ¡ˆäºŒï¼š</strong>&#x3D;&#x3D;<strong>MySQLè‡ªå¸¦æ…¢æ—¥å¿—</strong>&#x3D;&#x3D;</p>
<p>æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šå‚æ•°(long_query_time, å•ä½ï¼šç§’ï¼Œé»˜è®¤10ç§’)çš„æ‰€æœ‰SQLè¯­å¥çš„æ—¥å¿—ï¼Œå¦‚æœè¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦åœ¨MySQLçš„é…ç½®æ–‡ä»¶(&#x2F;etc&#x2F;my.cnf)ä¸­é…ç½®ä¿¡æ¯ï¼š</p>
<pre><code class="mysql"># å¼€å¯MySQLæ…¢æ—¥å¿—æŸ¥è¯¢å¼€å…³
slow_query_log = 1
# è®¾ç½®æ…¢æ—¥å¿—çš„æ—¶é—´ä¸º2ç§’ï¼ŒSQLè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡2ç§’ï¼Œå°±ä¼šè¢«è§†ä¸ºæ…¢æŸ¥è¯¢ï¼Œè®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—
long_query_time = 2
</code></pre>
<p><span style = "color:red"><strong>ä»€ä¹ˆæ˜¯èšç°‡ç´¢å¼•ï¼Ÿä»€ä¹ˆæ˜¯éèšç°‡ç´¢å¼•(äºŒçº§ç´¢å¼•)ï¼Ÿä»€ä¹ˆæ˜¯å›è¡¨ï¼Ÿ</strong></span></p>
<blockquote>
<ul>
<li><strong>èšç°‡ç´¢å¼•(èšé›†ç´¢å¼•)<strong>ï¼šæ•°æ®ä¸ç´¢å¼•æ”¾åˆ°ä¸€å—ï¼ŒB+æ ‘çš„å¶å­èŠ‚ç‚¹ä¿å­˜äº†æ•´è¡Œæ•°æ®ï¼Œ</strong>æœ‰ä¸”åªæœ‰ä¸€ä¸ª</strong>ã€idå­˜æ”¾çš„b+æ ‘ã€‘</li>
<li>**éèšç°‡ç´¢å¼•(äºŒçº§ç´¢å¼•)**ï¼šæ•°æ®ä¸ç´¢å¼•åˆ†å¼€å­˜å‚¨ï¼ŒB+æ ‘çš„å¶å­èŠ‚ç‚¹ä¿å­˜å¯¹åº”çš„ä¸»é”®ï¼Œå¯ä»¥æœ‰å¤šä¸ªã€å¶å­å°±æ˜¯idçš„å­—æ®µã€‘</li>
<li><strong>å›è¡¨æŸ¥è¯¢</strong>ï¼šé€šè¿‡äºŒçº§ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„ä¸»é”®å€¼ï¼Œåˆ°èšé›†ç´¢å¼•ä¸­æŸ¥æ‰¾æ­£è¡Œæ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å›è¡¨</li>
</ul>
<p>æ€ä¹ˆé¿å…å›è¡¨ â†’ ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼<br>éœ€è¦name ç›´æ¥ select name è€Œä¸ç”¨ select *<br>è¦æŒ‰éœ€æ¥æŸ¥æ‰¾</p>
</blockquote>
<pre><code class="java">é™¤äº†InnoDBï¼ŒMySQLæ•°æ®åº“è¿˜æ”¯æŒå¤šç§å…¶ä»–å­˜å‚¨å¼•æ“ï¼Œå…¶ä¸­æœ€è‘—åçš„æ˜¯MyISAMã€‚ä»¥ä¸‹æ˜¯InnoDBå’ŒMyISAMä¸¤ä¸ªå­˜å‚¨å¼•æ“çš„ä¸»è¦åŒºåˆ«ï¼š

äº‹åŠ¡æ”¯æŒï¼š
InnoDBï¼šæ”¯æŒäº‹åŠ¡ï¼Œå®ƒéµå¾ªACIDåŸåˆ™ï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ï¼‰ã€‚å¦‚æœäº‹åŠ¡ä¸­çš„æŸä¸ªæ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å¯ä»¥å›æ»šåˆ°å¼€å§‹çŠ¶æ€ã€‚
MyISAMï¼šä¸æ”¯æŒäº‹åŠ¡ï¼Œè¿™æ„å‘³ç€ä½ æ— æ³•å›æ»šæ“ä½œï¼Œè¿™å¯¹äºæ•°æ®å®Œæ•´æ€§å’Œæ¢å¤å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚
    
é”å®šæœºåˆ¶ï¼š
InnoDBï¼šä½¿ç”¨è¡Œçº§é”å®šï¼Œåªé”å®šéœ€è¦çš„ç‰¹å®šè¡Œï¼Œè¿™å¯ä»¥å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚
MyISAMï¼šä½¿ç”¨è¡¨çº§é”å®šï¼Œæ¯æ¬¡æ“ä½œéƒ½ä¼šé”å®šæ•´ä¸ªè¡¨ï¼Œè¿™åœ¨å¹¶å‘æ“ä½œè¾ƒå¤šæ—¶å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚
    
å´©æºƒæ¢å¤ï¼š
InnoDBï¼šå…·æœ‰è‡ªåŠ¨å´©æºƒæ¢å¤åŠŸèƒ½ï¼Œå³ä½¿æ•°æ®åº“å´©æºƒï¼Œä¹Ÿä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œå› ä¸ºå®ƒå°†äº‹åŠ¡æ—¥å¿—å†™å…¥ç£ç›˜ã€‚
MyISAMï¼šåœ¨å´©æºƒåæ¢å¤è¾ƒä¸ºå›°éš¾ï¼Œå¯èƒ½ä¼šä¸¢å¤±æ•°æ®ï¼Œå› ä¸ºå®ƒä¸è®°å½•äº‹åŠ¡æ—¥å¿—ã€‚
    
å…¨æ–‡æœç´¢ï¼š
InnoDBï¼ˆMySQL 5.6åŠä»¥åç‰ˆæœ¬ï¼‰ï¼šæ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œä½†åŠŸèƒ½ä¸Šä¸å¦‚MyISAMçš„å…¨æ–‡æœç´¢å¼ºå¤§ã€‚
MyISAMï¼šæä¾›äº†æ›´å¼ºå¤§çš„å…¨æ–‡æœç´¢åŠŸèƒ½ï¼Œä½†åœ¨MySQL 5.6ä¹‹å‰ï¼Œè¿™æ˜¯MyISAMç›¸å¯¹äºInnoDBçš„ä¸»è¦ä¼˜åŠ¿ã€‚
    
å­˜å‚¨é™åˆ¶ï¼š
InnoDBï¼šè¡¨çš„å¤§å°ç†è®ºä¸Šå—é™äºæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶å¤§å°é™åˆ¶ï¼Œé€šå¸¸å¯ä»¥å¤„ç†æ›´å¤§çš„æ•°æ®é‡ã€‚
MyISAMï¼šè¡¨çš„å¤§å°å—é™äºæœ€å¤§æ–‡ä»¶å¤§å°ï¼Œé€šå¸¸æ˜¯2GBåˆ°4GBï¼Œè¿™å–å†³äºæ–‡ä»¶ç³»ç»Ÿçš„é™åˆ¶ã€‚
    
å¤–é”®æ”¯æŒï¼š
InnoDBï¼šæ”¯æŒå¤–é”®çº¦æŸï¼Œè¿™æœ‰åŠ©äºä¿æŒæ•°æ®çš„å¼•ç”¨å®Œæ•´æ€§ã€‚
MyISAMï¼šä¸æ”¯æŒå¤–é”®çº¦æŸã€‚
    
å­˜å‚¨ç©ºé—´ï¼š
InnoDBï¼šé€šå¸¸éœ€è¦æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œå› ä¸ºå®ƒå­˜å‚¨äº†é¢å¤–çš„ä¿¡æ¯æ¥æ”¯æŒäº‹åŠ¡å’Œè¡Œçº§é”å®šã€‚
MyISAMï¼šé€šå¸¸å ç”¨æ›´å°‘çš„å­˜å‚¨ç©ºé—´ï¼Œå› ä¸ºå®ƒä¸éœ€è¦å­˜å‚¨è¿™äº›é¢å¤–çš„ä¿¡æ¯
</code></pre>
<table>
<thead>
<tr>
<th align="left">åˆ†ç±»</th>
<th align="left">å«ä¹‰</th>
<th align="left">ç‰¹ç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">&#x3D;&#x3D;<strong>èšé›†ç´¢å¼•</strong>(Clustered Index)&#x3D;&#x3D;</td>
<td align="left">å°†æ•°æ®å­˜å‚¨ä¸ç´¢å¼•æ”¾åˆ°äº†ä¸€å—ï¼Œç´¢å¼•ç»“æ„çš„å¶å­èŠ‚ç‚¹ä¿å­˜äº†è¡Œæ•°æ®</td>
<td align="left">å¿…é¡»æœ‰, è€Œä¸”åªæœ‰ä¸€ä¸ª</td>
</tr>
<tr>
<td align="left">&#x3D;&#x3D;<strong>äºŒçº§ç´¢å¼•</strong>(Secondary Index)&#x3D;&#x3D;</td>
<td align="left">å°†æ•°æ®ä¸ç´¢å¼•åˆ†å¼€å­˜å‚¨ï¼Œç´¢å¼•ç»“æ„çš„å¶å­èŠ‚ç‚¹å…³è”çš„æ˜¯å¯¹åº”çš„ä¸»é”®</td>
<td align="left">å¯ä»¥å­˜åœ¨å¤šä¸ª</td>
</tr>
</tbody></table>
<p><strong>èšé›†ç´¢å¼•é€‰å–è§„åˆ™ï¼š</strong></p>
<ul>
<li>å¦‚æœå­˜åœ¨ä¸»é”®ï¼Œä¸»é”®ç´¢å¼•å°±æ˜¯èšé›†ç´¢å¼•</li>
<li>å¦‚æœä¸å­˜åœ¨ä¸»é”®ï¼Œå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªå”¯ä¸€ (UNIQUE) ç´¢å¼•ä½œä¸ºèšé›†ç´¢å¼•</li>
<li>å¦‚æœè¡¨æ²¡æœ‰ä¸»é”®ï¼Œæˆ–æ²¡æœ‰åˆé€‚çš„å”¯ä¸€ç´¢å¼•ï¼Œåˆ™InnoDBä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªrowidä½œä¸ºéšè—çš„èšé›†ç´¢å¼•</li>
</ul>
<p><img src="https://github.com/P-luminary/images/blob/master/%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%20%E5%92%8C%20%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95.jpg?raw=true"></p>
<p>&#x3D;&#x3D;<strong>å›è¡¨æŸ¥è¯¢</strong>&#x3D;&#x3D;</p>
<p><code>select * from user where name = &#39;Arm&#39;;</code></p>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/25accb51fee1e0b8d57deebf6bfe38e3868b32bf/%E5%9B%9E%E8%A1%A8%E6%9F%A5%E8%AF%A2.png"></p>
<h4 id="MySQLçš„æ—¥å¿—æ–‡ä»¶æœ‰å“ªäº›ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆ"><a href="#MySQLçš„æ—¥å¿—æ–‡ä»¶æœ‰å“ªäº›ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆ" class="headerlink" title="MySQLçš„æ—¥å¿—æ–‡ä»¶æœ‰å“ªäº›ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆ"></a>MySQLçš„æ—¥å¿—æ–‡ä»¶æœ‰å“ªäº›ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆ</h4><p><strong>MySQLçš„æ—¥å¿—æ–‡ä»¶æœ‰å“ªäº›ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>MySQLä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ—¥å¿—æ–‡ä»¶ï¼š</p>
<ul>
<li>é”™è¯¯æ—¥å¿—ï¼ˆError Logï¼‰ï¼šè®°å½•MySQLæœåŠ¡çš„å¯åŠ¨ã€è¿è¡Œæˆ–åœæ­¢è¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯ã€‚</li>
<li>æŸ¥è¯¢æ—¥å¿—ï¼ˆGeneral Query Logï¼‰ï¼šè®°å½•æ‰€æœ‰MySQLæ‰§è¡Œçš„SQLå‘½ä»¤ï¼Œæ— è®ºè¿™äº›å‘½ä»¤æ˜¯å¦æ­£ç¡®æ‰§è¡Œã€‚</li>
<li>æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆSlow Query Logï¼‰ï¼šè®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šé˜ˆå€¼çš„æŸ¥è¯¢è¯­å¥ã€‚</li>
<li><strong><u>äºŒè¿›åˆ¶æ—¥å¿—</u>ï¼ˆBinary Logï¼‰</strong>ï¼š<u>è®°å½•æ‰€æœ‰æ›´æ”¹æ•°æ®çš„SQLè¯­å¥ï¼Œç”¨äºä¸»ä»å¤åˆ¶å’Œæ•°æ®æ¢å¤ã€‚</u>äº‹åŠ¡çš„æäº¤ å’Œ ä¸»ä»å¤åˆ¶</li>
<li><strong><u>äº‹åŠ¡æ—¥å¿—&#x2F;é‡åšæ—¥å¿—</u>ï¼ˆInnoDB Redo Logï¼‰</strong>ï¼š<u>è®°å½•InnoDBå­˜å‚¨å¼•æ“çš„äº‹åŠ¡æ“ä½œï¼Œç”¨äºå´©æºƒæ¢å¤ã€‚</u></li>
<li><strong><u>å›æ»šæ—¥å¿—&#x2F;æ’¤é”€æ—¥å¿—</u>ï¼ˆInnoDB Undo Logï¼‰</strong>ï¼š<u>ç”¨äºäº‹åŠ¡å›æ»šï¼Œä¿è¯äº‹åŠ¡çš„åŸå­æ€§ã€‚</u></li>
</ul>
<blockquote>
<p><span style = "color:red"><strong>undo log å’Œ redo logçš„åŒºåˆ«ï¼Ÿ</strong></span></p>
<blockquote>
<p><strong>redo log</strong>ï¼šè®°å½•çš„æ˜¯æ•°æ®é¡µçš„ç‰©ç†å˜åŒ–ï¼ŒæœåŠ¡å®•æœºå¯ç”¨æ¥åŒæ­¥æ•°æ®<br><strong>undo log</strong>ï¼šè®°å½•çš„æ˜¯é€»è¾‘æ—¥å¿—ï¼Œå½“äº‹åŠ¡å›æ»šæ—¶ï¼Œé€šè¿‡é€†æ“ä½œæ¢å¤åŸæ¥çš„æ•°æ®<br><strong>redo log</strong> ä¿è¯äº†äº‹åŠ¡çš„æŒä¹…æ€§ï¼Œundo logä¿è¯äº†äº‹åŠ¡çš„åŸå­æ€§å’Œä¸€è‡´æ€§</p>
</blockquote>
<ul>
<li><strong>ç¼“å†²æ± </strong>(buffer pool)ï¼šä¸»å†…å­˜ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼Œé‡Œé¢å¯ä»¥ç¼“å­˜ç£ç›˜ä¸Šç»å¸¸æ“ä½œçš„çœŸå®æ•°æ®ï¼Œåœ¨æ‰§è¡Œå¢åˆ æ”¹æŸ»æ“ä½œæ—¶ï¼Œå…ˆæ“ä½œç¼“å†²æ± ä¸­çš„æ•°æ®(è‹¥ç¼“å†²æ± æ²¡æœ‰æ•°æ®ï¼Œåˆ™ä»ç£ç›˜åŠ è½½å¹¶ç¼“å­˜)ï¼Œä»¥ä¸€å®šé¢‘ç‡åˆ·æ–°åˆ°ç£ç›˜ï¼Œä»è€Œå‡å°‘ç£ç›˜IOï¼ŒåŠ å¿«å¤„ç†é€Ÿåº¦</li>
<li><strong>æ•°æ®é¡µ</strong>(page)ï¼šæ˜¯InnoD8 å­˜å‚¨å¼•æ“ç£ç›˜ç®¡ç†çš„æœ€å°å•å…ƒï¼Œæ¯ä¸ªé¡µçš„å¤§å°é»˜è®¤ä¸º 16KBã€‚é¡µä¸­å­˜å‚¨çš„æ˜¯è¡Œæ•°æ®</li>
</ul>
<p>&#x3D;&#x3D;<strong>redo log</strong>&#x3D;&#x3D;</p>
<p>é‡åšæ—¥å¿—ï¼Œè®°å½•çš„æ˜¯äº‹åŠ¡æäº¤æ—¶æ•°æ®é¡µçš„ç‰©ç†ä¿®æ”¹ï¼Œæ˜¯<strong>ç”¨æ¥å®ç°äº‹åŠ¡çš„æŒä¹…æ€§</strong><br>è¯¥æ—¥å¿—æ–‡ä»¶ç”±ä¸¤éƒ¨åˆ†ç»„å†²ï¼š<strong>é‡åšæ—¥å¿—ç¼“å†²(redo log buffer)</strong> ä»¥åŠ **é‡åšæ—¥å¿—æ–‡ä»¶(redo log file)**ï¼Œå‰è€…æ˜¯åœ¨å†…å­˜ä¸­ï¼Œåè€…æ˜¯åœ¨ç£ç›˜ä¸­ã€‚å½“äº‹åŠ¡æäº¤ä¹‹åä¼šæŠŠæ‰€æœ‰ä¿®æ”¹ä¿¡æ¯éƒ½ä¿å­˜åˆ°è¯¥æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç”¨äºåœ¨åˆ·æ–°è„é¡µåˆ°ç£ç›˜ï¼Œå‘ç”Ÿé”™è¯¯æ—¶ï¼Œè¿›è¡Œæ•°æ®æ¢å¤ä½¿ç”¨ã€‚</p>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/f3e54069fe783271a5892cf6d0bf49247f2b0f4a/undo%20log%20%E5%92%8C%20redo%20log%E5%8C%BA%E5%88%AB.jpg"></p>
<p>&#x3D;&#x3D;<strong>undo log</strong>&#x3D;&#x3D;</p>
<p>å›æ»šæ—¥å¿—ï¼Œç”¨äºè®°å½•æ•°æ®è¢«ä¿®æ”¹å‰çš„ä¿¡æ¯ï¼Œä½œç”¨åŒ…å«ä¸¤ä¸ªï¼š<strong>æä¾›å›æ»š</strong>å’Œ <strong>MVCC</strong>(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)ã€‚undolog å’Œ redologè®°å½•ç‰©ç†æ—¥å¿—ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯<strong>é€»è¾‘æ—¥å¿—</strong></p>
<ul>
<li>å¯ä»¥è®¤ä¸ºå½“deleteä¸€æ¡è®°å½•æ—¶ï¼Œundo logä¸­ä¼šè®°å½•ä¸€æ¡å¯¹åº”çš„insertè®°å½•ï¼Œåä¹‹äº¦ç„¶</li>
<li>å½“updateä¸€æ¡è®°å½•æ—¶ï¼Œå®ƒè®°å½•ä¸€æ¡å¯¹åº”ç›¸åçš„updateè®°å½•ã€‚å½“æ‰§è¡Œrolbackæ—¶ï¼Œå°±å¯ä»¥ä»undologä¸­çš„é€»è¾‘è®°å½•è¯»å–åˆ°ç›¸åº”çš„å†…å®¹å¹¶è¿›è¡Œå›æ»šã€‚</li>
</ul>
<p><strong>undo logå¯ä»¥å®ç°äº‹åŠ¡çš„ä¸€è‡´æ€§å’ŒåŸå­æ€§</strong></p>
</blockquote>
<h4 id="MySQLä¸»ä»åŒæ­¥åŸç†ï¼Ÿ"><a href="#MySQLä¸»ä»åŒæ­¥åŸç†ï¼Ÿ" class="headerlink" title="MySQLä¸»ä»åŒæ­¥åŸç†ï¼Ÿ"></a><span style = "color:red"><strong>MySQLä¸»ä»åŒæ­¥åŸç†ï¼Ÿ</strong></span></h4><blockquote>
<p>MySQLä¸»ä»å¤åˆ¶çš„æ ¸å¿ƒå°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—binlog[<strong>DDL(æ•°æ®å®šä¹‰è¯­è¨€)è¯­å¥</strong> å’Œ <strong>DML(æ•°æ®æ“çºµè¯­è¨€)è¯­å¥</strong>]<br>ä¸»åº“åœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œä¼šæŠŠæ•°æ®å˜æ›´è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ Binlog ä¸­ã€‚<br>ä»åº“è¯»å–ä¸»åº“çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ Binlogï¼Œå†™å…¥åˆ°ä»åº“çš„ä¸­ç»§æ—¥å¿— Relay Logã€‚<br>ä»åº“é‡åšä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå°†æ”¹å˜åæ˜ å®ƒè‡ªå·±çš„æ•°æ®ã€‚</p>
<pre><code class="java">ä¸»æœåŠ¡å™¨ï¼ˆMasterï¼‰ä¸Šçš„æ•°æ®æ›´æ”¹ï¼ˆå¦‚INSERTã€UPDATEã€DELETEæ“ä½œï¼‰ä¼šè¢«è®°å½•åˆ°äºŒè¿›åˆ¶æ—¥å¿—ä¸­ã€‚
ä»æœåŠ¡å™¨ï¼ˆSlaveï¼‰ä¸Šçš„I/Oçº¿ç¨‹è¿æ¥åˆ°ä¸»æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¸»æœåŠ¡å™¨ä¸Šçš„äºŒè¿›åˆ¶æ—¥å¿—ã€‚
ä¸»æœåŠ¡å™¨å°†äºŒè¿›åˆ¶æ—¥å¿—å‘é€ç»™ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨å°†è¿™äº›æ—¥å¿—äº‹ä»¶å†™å…¥åˆ°æœ¬åœ°çš„ä¸­ç»§æ—¥å¿—ï¼ˆRelay Logï¼‰ã€‚
ä»æœåŠ¡å™¨ä¸Šçš„SQLçº¿ç¨‹è¯»å–ä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå¹¶åœ¨æœ¬åœ°æ‰§è¡Œè¿™äº›äº‹ä»¶ï¼Œä»è€Œå®ç°æ•°æ®çš„å¤åˆ¶ã€‚
</code></pre>
</blockquote>
<p>MySQLä¸»ä»å¤åˆ¶çš„æ ¸å¿ƒå°±æ˜¯äºŒè¿›åˆ¶æ—¥å¿—</p>
<blockquote>
<p>äºŒè¿›åˆ¶æ–‡ä»¶(BINLOG) è®°å½•äº†æ‰€æœ‰çš„<strong>DDL(æ•°æ®å®šä¹‰è¯­è¨€)è¯­å¥</strong> å’Œ <strong>DML(æ•°æ®æ“çºµè¯­è¨€)è¯­å¥</strong>ï¼Œä½†ä¸åŒ…æ‹¬<u>æ•°æ®æŸ¥è¯¢(SELECTã€SHOW)è¯­å¥</u></p>
</blockquote>
<img src="https://raw.githubusercontent.com/P-luminary/images/678966e16f791c838ee0d8be04e35897d7f4ae47/%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86%E5%9B%BE.jpg" style="zoom:200%;" />

<h6 id="å¤åˆ¶åˆ†æˆä¸‰æ­¥ï¼š"><a href="#å¤åˆ¶åˆ†æˆä¸‰æ­¥ï¼š" class="headerlink" title="å¤åˆ¶åˆ†æˆä¸‰æ­¥ï¼š"></a>å¤åˆ¶åˆ†æˆä¸‰æ­¥ï¼š</h6><ul>
<li>Masterä¸»åº“åœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œä¼šæŠŠæ•°æ®å˜æ›´è®°å½•åœ¨äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶Binlogä¸­</li>
<li>ä»åº“è¯»å–ä¸»åº“çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶Binlogï¼Œå†™å…¥åˆ°ä»åº“çš„ä¸­ç»§æ—¥å¿—Relay Log</li>
<li>slaveé‡åšä¸­ç»§æ—¥å¿—ä¸­çš„äº‹ä»¶ï¼Œå°†æ”¹å˜ååº”ä»–è‡ªå·±çš„æ•°æ®</li>
</ul>
<h4 id="é¡¹ç›®ä¸­å“ªé‡Œæ¶‰åŠåˆ°åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜-ä½ æ˜¯æ€ä¹ˆè§£å†³çš„-èƒ½è¯´ä¸€ä¸‹"><a href="#é¡¹ç›®ä¸­å“ªé‡Œæ¶‰åŠåˆ°åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜-ä½ æ˜¯æ€ä¹ˆè§£å†³çš„-èƒ½è¯´ä¸€ä¸‹" class="headerlink" title="é¡¹ç›®ä¸­å“ªé‡Œæ¶‰åŠåˆ°åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜? ä½ æ˜¯æ€ä¹ˆè§£å†³çš„? èƒ½è¯´ä¸€ä¸‹"></a>é¡¹ç›®ä¸­å“ªé‡Œæ¶‰åŠåˆ°åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜? ä½ æ˜¯æ€ä¹ˆè§£å†³çš„? èƒ½è¯´ä¸€ä¸‹</h4><p>åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜å¯èƒ½å‡ºç°åœ¨è·¨å¤šä¸ªæœåŠ¡æˆ–æ•°æ®åº“çš„æ“ä½œä¸­ï¼Œä¾‹å¦‚åœ¨è®¢å•æœåŠ¡ä¸­åŒæ—¶æ›´æ–°è®¢å•çŠ¶æ€å’Œæ‰£å‡åº“å­˜ã€‚<del>ç§’æ€æ¡ˆä¾‹ï¼šæ˜¯å…ˆæ‰£åº“å­˜æå‰ç¼“å­˜åˆ°redisé‡Œï¼Œåˆ¤æ–­å¤Ÿä¸å¤Ÿï¼Œç”¨RabbitMQå¼‚æ­¥ä¸‹æ¥</del></p>
<p>è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ï¼Œå¦‚Seataï¼Œå…¶ä¸­ATæ¨¡å¼æ˜¯ä¸€ç§å¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>ATæ¨¡å¼åŸç†ï¼š</strong></p>
<ul>
<li>ATæ¨¡å¼åŸºäºä¸¤é˜¶æ®µæäº¤ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šä¸€é˜¶æ®µ prepare å’ŒäºŒé˜¶æ®µ commit&#x2F;rollbackã€‚</li>
<li>åœ¨ä¸šåŠ¡æ–¹æ³•å¼€å§‹æ—¶ï¼ŒSeataä¼šæ‹¦æˆªä¸šåŠ¡SQLï¼Œè®°å½•ä¸šåŠ¡æ•°æ®åœ¨æ‰§è¡Œå‰åçš„é•œåƒï¼Œç”Ÿæˆè¡Œé”ã€‚</li>
<li>å¦‚æœä¸€é˜¶æ®µ prepare æˆåŠŸï¼Œåˆ™äºŒé˜¶æ®µè¿›è¡Œ commitï¼Œç›´æ¥æäº¤äº‹åŠ¡ï¼›å¦‚æœ prepare å¤±è´¥ï¼Œåˆ™æ‰§è¡Œ rollbackï¼Œåˆ©ç”¨ä¹‹å‰ä¿å­˜çš„æ•°æ®é•œåƒå›æ»šåˆ°æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚</li>
</ul>
<blockquote>
<h2 id="é¢è¯•ç­”é¢˜æ¨¡æ¿ï¼šé¡¹ç›®ä¸­å¦‚ä½•è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"><a href="#é¢è¯•ç­”é¢˜æ¨¡æ¿ï¼šé¡¹ç›®ä¸­å¦‚ä½•è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜" class="headerlink" title="é¢è¯•ç­”é¢˜æ¨¡æ¿ï¼šé¡¹ç›®ä¸­å¦‚ä½•è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"></a>é¢è¯•ç­”é¢˜æ¨¡æ¿ï¼šé¡¹ç›®ä¸­å¦‚ä½•è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</h2><h3 id="1-åœ¨å“ªäº›åœ°æ–¹é‡åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"><a href="#1-åœ¨å“ªäº›åœ°æ–¹é‡åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ" class="headerlink" title="1. åœ¨å“ªäº›åœ°æ–¹é‡åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ"></a>1. <strong>åœ¨å“ªäº›åœ°æ–¹é‡åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ</strong></h3><blockquote>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œå½“ä¸€ä¸ªæ“ä½œéœ€è¦<strong>åŒæ—¶ä¿®æ”¹å¤šä¸ªæœåŠ¡æˆ–æ•°æ®åº“ä¸­çš„æ•°æ®</strong>æ—¶ï¼Œå°±æ¶‰åŠåˆ°åˆ†å¸ƒå¼äº‹åŠ¡ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ç”¨æˆ·ä¸‹å•æ—¶ï¼ŒåŒæ—¶éœ€è¦æ›´æ–°<strong>è®¢å•æœåŠ¡</strong>ã€<strong>åº“å­˜æœåŠ¡</strong>ã€<strong>è´¦æˆ·æœåŠ¡</strong></li>
<li>ç§’æ€ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æäº¤è®¢å• â†’ æ‰£å‡åº“å­˜ â†’ æ”¯ä»˜ â†’ å‘è´§ï¼Œè¿™äº›æœåŠ¡å½¼æ­¤ç‹¬ç«‹ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨æœ¬åœ°äº‹åŠ¡</li>
<li>ä½¿ç”¨äº†å¾®æœåŠ¡æ¶æ„ï¼ˆSpring Cloud æˆ– Dubboï¼‰ï¼ŒæœåŠ¡ä¹‹é—´é€šè¿‡ RPC æˆ– MQ é€šä¿¡</li>
</ul>
</blockquote>
<hr>
<h3 id="2-ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æœ¬åœ°äº‹åŠ¡ï¼Ÿ"><a href="#2-ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æœ¬åœ°äº‹åŠ¡ï¼Ÿ" class="headerlink" title="2. ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æœ¬åœ°äº‹åŠ¡ï¼Ÿ"></a>2. <strong>ä¸ºä»€ä¹ˆä¸èƒ½ç”¨æœ¬åœ°äº‹åŠ¡ï¼Ÿ</strong></h3><blockquote>
<p>å› ä¸ºæ¯ä¸ªæœåŠ¡æœ‰ç‹¬ç«‹çš„æ•°æ®æºå’Œäº‹åŠ¡ç®¡ç†å™¨ï¼ŒSpring æˆ–æ•°æ®åº“äº‹åŠ¡ä¸èƒ½è·¨ JVMã€ä¸èƒ½è·¨åº“ã€‚ä½¿ç”¨ <code>@Transactional</code> åªå¯¹ä¸€ä¸ªæœåŠ¡å†…éƒ¨æœ‰æ•ˆã€‚</p>
</blockquote>
<hr>
<h3 id="3-æ€ä¹ˆè§£å†³çš„ï¼Ÿä½ é¡¹ç›®ä¸­ç”¨çš„ä»€ä¹ˆæ–¹å¼ï¼Ÿ"><a href="#3-æ€ä¹ˆè§£å†³çš„ï¼Ÿä½ é¡¹ç›®ä¸­ç”¨çš„ä»€ä¹ˆæ–¹å¼ï¼Ÿ" class="headerlink" title="3. æ€ä¹ˆè§£å†³çš„ï¼Ÿä½ é¡¹ç›®ä¸­ç”¨çš„ä»€ä¹ˆæ–¹å¼ï¼Ÿ"></a>3. <strong>æ€ä¹ˆè§£å†³çš„ï¼Ÿä½ é¡¹ç›®ä¸­ç”¨çš„ä»€ä¹ˆæ–¹å¼ï¼Ÿ</strong></h3><blockquote>
<p>æˆ‘ä»¬ä½¿ç”¨äº† <strong>Seata</strong> åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ï¼Œé…åˆ <strong>MySQL + Nacos æ³¨å†Œä¸­å¿ƒ + Spring Cloud Alibaba</strong>ã€‚</p>
</blockquote>
<h4 id="âœ…-ä¸»è¦ä½¿ç”¨çš„æ˜¯-AT-æ¨¡å¼ï¼š"><a href="#âœ…-ä¸»è¦ä½¿ç”¨çš„æ˜¯-AT-æ¨¡å¼ï¼š" class="headerlink" title="âœ… ä¸»è¦ä½¿ç”¨çš„æ˜¯ AT æ¨¡å¼ï¼š"></a>âœ… ä¸»è¦ä½¿ç”¨çš„æ˜¯ <strong>AT æ¨¡å¼</strong>ï¼š</h4><ul>
<li><strong>ä¸€é˜¶æ®µï¼ˆtryï¼‰</strong>ï¼šæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ’å…¥è®¢å•ã€æ‰£åº“å­˜ï¼‰ï¼ŒSeata ä¼šè‡ªåŠ¨ä»£ç†æ•°æ®æºï¼Œè®°å½•<strong>å‰é•œåƒ</strong>å’Œ<strong>åé•œåƒ</strong>ï¼Œå¹¶ç”Ÿæˆå…¨å±€é”ï¼ŒæŒ‚èµ·å…¨å±€äº‹åŠ¡ã€‚</li>
<li><strong>äºŒé˜¶æ®µ commit</strong>ï¼šå¦‚æœæ‰€æœ‰å­äº‹åŠ¡éƒ½æ‰§è¡ŒæˆåŠŸï¼ŒSeata é‡Šæ”¾èµ„æºï¼Œæ•°æ®è‡ªåŠ¨æäº¤ã€‚</li>
<li><strong>äºŒé˜¶æ®µ rollback</strong>ï¼šå¦‚æœå…¶ä¸­ä¸€ä¸ªå¤±è´¥ï¼ŒSeata ä¼šæ ¹æ®å‰é•œåƒè‡ªåŠ¨å›æ»šå…¶ä»–æ“ä½œã€‚</li>
</ul>
</blockquote>
<h4 id="é¡¹ç›®ä¸­å“ªé‡Œç”¨åˆ°MQï¼Œç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ"><a href="#é¡¹ç›®ä¸­å“ªé‡Œç”¨åˆ°MQï¼Œç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ" class="headerlink" title="é¡¹ç›®ä¸­å“ªé‡Œç”¨åˆ°MQï¼Œç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ"></a><strong>é¡¹ç›®ä¸­å“ªé‡Œç”¨åˆ°MQï¼Œç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿ</strong></h4><blockquote>
<h3 id="ä½¿ç”¨-MQ-çš„ä¸»è¦åœºæ™¯"><a href="#ä½¿ç”¨-MQ-çš„ä¸»è¦åœºæ™¯" class="headerlink" title="ä½¿ç”¨ MQ çš„ä¸»è¦åœºæ™¯"></a>ä½¿ç”¨ MQ çš„ä¸»è¦åœºæ™¯</h3><p>æˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨äº† MQ æ¥å®ç°ä¸€äº›<strong>å¼‚æ­¥è§£è€¦ã€æµé‡å‰Šå³°ã€å»¶è¿Ÿå¤„ç†</strong>çš„éœ€æ±‚ï¼Œå…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ä¸‹å•æˆåŠŸåå¼‚æ­¥å‘æ”¾ä¼˜æƒ åˆ¸å’Œç§¯åˆ†</strong></li>
<li><strong>è®¢å•æ”¯ä»˜æˆåŠŸåé€šçŸ¥ç‰©æµå‘è´§</strong></li>
<li><strong>å»¶è¿Ÿå…³é—­æœªæ”¯ä»˜è®¢å•ï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰</strong></li>
</ul>
<h3 id="å…·ä½“ä¸šåŠ¡æµç¨‹ï¼ˆè®¢å•-ç§¯åˆ†-ä¼˜æƒ åˆ¸ï¼‰"><a href="#å…·ä½“ä¸šåŠ¡æµç¨‹ï¼ˆè®¢å•-ç§¯åˆ†-ä¼˜æƒ åˆ¸ï¼‰" class="headerlink" title="å…·ä½“ä¸šåŠ¡æµç¨‹ï¼ˆè®¢å• + ç§¯åˆ† + ä¼˜æƒ åˆ¸ï¼‰"></a>å…·ä½“ä¸šåŠ¡æµç¨‹ï¼ˆè®¢å• + ç§¯åˆ† + ä¼˜æƒ åˆ¸ï¼‰</h3><h4 id="ğŸ“¦-ç”¨æˆ·ä¸‹å•-â†’-æ”¯ä»˜æˆåŠŸ-â†’-MQ-å¼‚æ­¥é€šçŸ¥ï¼š"><a href="#ğŸ“¦-ç”¨æˆ·ä¸‹å•-â†’-æ”¯ä»˜æˆåŠŸ-â†’-MQ-å¼‚æ­¥é€šçŸ¥ï¼š" class="headerlink" title="ğŸ“¦ ç”¨æˆ·ä¸‹å• â†’ æ”¯ä»˜æˆåŠŸ â†’ MQ å¼‚æ­¥é€šçŸ¥ï¼š"></a>ğŸ“¦ ç”¨æˆ·ä¸‹å• â†’ æ”¯ä»˜æˆåŠŸ â†’ MQ å¼‚æ­¥é€šçŸ¥ï¼š</h4><ol>
<li><p>ç”¨æˆ·æäº¤è®¢å•ï¼Œè®¢å•æœåŠ¡åˆ›å»ºè®¢å•ã€‚</p>
</li>
<li><p>ç”¨æˆ·å®Œæˆæ”¯ä»˜ï¼Œ<strong>è®¢å•æœåŠ¡æ›´æ–°è®¢å•çŠ¶æ€ä¸ºâ€œå·²æ”¯ä»˜â€</strong>ã€‚</p>
</li>
<li><p>ç„¶åå°†è®¢å•ä¿¡æ¯å°è£…æˆæ¶ˆæ¯ï¼Œå‘é€åˆ°å¤šä¸ª Topicï¼š</p>
<pre><code class="json">&#123;
  &quot;orderId&quot;: &quot;123456789&quot;,
  &quot;userId&quot;: &quot;user123&quot;,
  &quot;status&quot;: &quot;PAID&quot;
&#125;
</code></pre>
<ul>
<li>å‘ç»™ <code>coupon_topic</code>ï¼šå¼‚æ­¥å‘æ”¾ä¼˜æƒ åˆ¸</li>
<li>å‘ç»™ <code>point_topic</code>ï¼šå¼‚æ­¥å‘æ”¾ç§¯åˆ†</li>
<li>å‘ç»™ <code>logistics_topic</code>ï¼šå¼‚æ­¥å‡†å¤‡å‘è´§</li>
</ul>
</li>
</ol>
<h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨-MQï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨-MQï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ MQï¼Ÿ"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ MQï¼Ÿ</h3><table>
<thead>
<tr>
<th>ç›®çš„</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>è§£è€¦æœåŠ¡</strong></td>
<td>å„ä¸ªæœåŠ¡ï¼ˆç§¯åˆ†&#x2F;ä¼˜æƒ åˆ¸&#x2F;ç‰©æµï¼‰ç‹¬ç«‹å¼€å‘éƒ¨ç½²ï¼Œè®¢å•æœåŠ¡åªéœ€å‘é€æ¶ˆæ¯ï¼Œä¸å…³å¿ƒæ¥æ”¶è€…</td>
</tr>
<tr>
<td><strong>å¼‚æ­¥å¤„ç†</strong></td>
<td>è®¢å•æœåŠ¡å¿«é€Ÿå“åº”ç”¨æˆ·è¯·æ±‚ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</td>
</tr>
<tr>
<td><strong>æµé‡å‰Šå³°</strong></td>
<td>é«˜å¹¶å‘ç§’æ€åœºæ™¯ä¸­ï¼Œé€šè¿‡ MQ ç¼“å†²è¯·æ±‚ï¼Œé¿å…åº“å­˜æœåŠ¡è¢«ç›´æ¥æ‰“çˆ†</td>
</tr>
<tr>
<td><strong>å»¶è¿Ÿå¤„ç†</strong></td>
<td>é€šè¿‡å»¶è¿Ÿæ¶ˆæ¯æœºåˆ¶å®ç°â€œ30åˆ†é’Ÿæœªæ”¯ä»˜è‡ªåŠ¨å…³é—­è®¢å•â€ç­‰åŠŸèƒ½</td>
</tr>
</tbody></table>
<h3 id="ç¤ºä¾‹ï¼šå¼‚æ­¥å‘æ”¾ç§¯åˆ†ä¸ä¼˜æƒ åˆ¸"><a href="#ç¤ºä¾‹ï¼šå¼‚æ­¥å‘æ”¾ç§¯åˆ†ä¸ä¼˜æƒ åˆ¸" class="headerlink" title="ç¤ºä¾‹ï¼šå¼‚æ­¥å‘æ”¾ç§¯åˆ†ä¸ä¼˜æƒ åˆ¸"></a>ç¤ºä¾‹ï¼šå¼‚æ­¥å‘æ”¾ç§¯åˆ†ä¸ä¼˜æƒ åˆ¸</h3><h4 id="ğŸ› -æŠ€æœ¯æ ˆ"><a href="#ğŸ› -æŠ€æœ¯æ ˆ" class="headerlink" title="ğŸ›  æŠ€æœ¯æ ˆ"></a>ğŸ›  æŠ€æœ¯æ ˆ</h4><ul>
<li>æ¶ˆæ¯ä¸­é—´ä»¶ï¼šRocketMQ &#x2F; RabbitMQ &#x2F; Kafkaï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯ RocketMQï¼‰</li>
<li>æ¶ˆæ¯æ ¼å¼ï¼šJSON</li>
<li>å‘é€æ–¹å¼ï¼šå¼‚æ­¥å‘é€ <code>sendAsync</code> æˆ–å¯é å‘é€ <code>sendSync</code></li>
</ul>
<h4 id="ğŸ‘‡-ç¤ºä¾‹ä»£ç ï¼š"><a href="#ğŸ‘‡-ç¤ºä¾‹ä»£ç ï¼š" class="headerlink" title="ğŸ‘‡ ç¤ºä¾‹ä»£ç ï¼š"></a>ğŸ‘‡ ç¤ºä¾‹ä»£ç ï¼š</h4><p><strong>è®¢å•æœåŠ¡ - å‘é€æ¶ˆæ¯</strong></p>
<pre><code class="java">OrderMessage message = new OrderMessage(orderId, userId, &quot;PAID&quot;);
rocketMQTemplate.syncSend(&quot;point_topic&quot;, message);
rocketMQTemplate.syncSend(&quot;coupon_topic&quot;, message);
</code></pre>
<p><strong>ç§¯åˆ†æœåŠ¡ - ç›‘å¬æ¶ˆæ¯</strong></p>
<pre><code class="java">@RocketMQMessageListener(topic = &quot;point_topic&quot;, consumerGroup = &quot;point_group&quot;)
public class PointConsumer implements RocketMQListener&lt;OrderMessage&gt; &#123;
    public void onMessage(OrderMessage msg) &#123;
        pointService.addPoint(msg.getUserId(), 100);
    &#125;
&#125;
</code></pre>
<h3 id="å»¶è¿Ÿé˜Ÿåˆ—ï¼šå…³é—­æœªæ”¯ä»˜è®¢å•"><a href="#å»¶è¿Ÿé˜Ÿåˆ—ï¼šå…³é—­æœªæ”¯ä»˜è®¢å•" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—ï¼šå…³é—­æœªæ”¯ä»˜è®¢å•"></a>å»¶è¿Ÿé˜Ÿåˆ—ï¼šå…³é—­æœªæ”¯ä»˜è®¢å•</h3><ul>
<li>ä¸‹å•æˆåŠŸä½†æœªæ”¯ä»˜æ—¶ï¼Œå‘é€ä¸€æ¡å»¶è¿Ÿæ¶ˆæ¯åˆ° <code>order_timeout_topic</code>ï¼Œå»¶è¿Ÿ30åˆ†é’Ÿã€‚</li>
<li>æ¶ˆè´¹æ—¶åˆ¤æ–­è®¢å•çŠ¶æ€æ˜¯å¦å·²æ”¯ä»˜ï¼Œæœªæ”¯ä»˜åˆ™å…³é—­è®¢å•å¹¶æ¢å¤åº“å­˜ã€‚</li>
</ul>
<pre><code class="java">Message message = MessageBuilder.withPayload(orderId)
    .setHeader(MessageConst.PROPERTY_DELAY_TIME_LEVEL, 16) // å»¶è¿Ÿ30åˆ†é’Ÿ
    .build();
rocketMQTemplate.syncSend(&quot;order_timeout_topic&quot;, message);
</code></pre>
<hr>
<hr>
<h5 id="é—®ï¼šmqå‘é€çš„æ¶ˆæ¯-é‚£æ€ä¹ˆæ ·æ‰æ˜¯å¯¹æ¥åˆ°äº†çœŸæ­£çš„ä¸šåŠ¡ä»£ç -æ¯”å¦‚æˆ‘30åˆ†é’Ÿæ²¡ä»˜æ¬¾-é‚£å°±ç»™æˆ‘å…³é—­æœªæ”¯ä»˜è®¢å•-æˆ‘è¿™é‡Œæ˜¯mqä¸åªæ˜¯å‘é€æ¶ˆæ¯çš„å—-åˆæ€ä¹ˆèƒ½è§¦ç¢°åˆ°çœŸå®çš„è°ƒç”¨å…³é—­æœªæ”¯ä»˜è®¢å•çš„é‚£ä¸ªä¸šåŠ¡é€»è¾‘ä»£ç å‘¢ï¼Ÿ"><a href="#é—®ï¼šmqå‘é€çš„æ¶ˆæ¯-é‚£æ€ä¹ˆæ ·æ‰æ˜¯å¯¹æ¥åˆ°äº†çœŸæ­£çš„ä¸šåŠ¡ä»£ç -æ¯”å¦‚æˆ‘30åˆ†é’Ÿæ²¡ä»˜æ¬¾-é‚£å°±ç»™æˆ‘å…³é—­æœªæ”¯ä»˜è®¢å•-æˆ‘è¿™é‡Œæ˜¯mqä¸åªæ˜¯å‘é€æ¶ˆæ¯çš„å—-åˆæ€ä¹ˆèƒ½è§¦ç¢°åˆ°çœŸå®çš„è°ƒç”¨å…³é—­æœªæ”¯ä»˜è®¢å•çš„é‚£ä¸ªä¸šåŠ¡é€»è¾‘ä»£ç å‘¢ï¼Ÿ" class="headerlink" title="é—®ï¼šmqå‘é€çš„æ¶ˆæ¯ é‚£æ€ä¹ˆæ ·æ‰æ˜¯å¯¹æ¥åˆ°äº†çœŸæ­£çš„ä¸šåŠ¡ä»£ç  æ¯”å¦‚æˆ‘30åˆ†é’Ÿæ²¡ä»˜æ¬¾ é‚£å°±ç»™æˆ‘å…³é—­æœªæ”¯ä»˜è®¢å• æˆ‘è¿™é‡Œæ˜¯mqä¸åªæ˜¯å‘é€æ¶ˆæ¯çš„å— åˆæ€ä¹ˆèƒ½è§¦ç¢°åˆ°çœŸå®çš„è°ƒç”¨å…³é—­æœªæ”¯ä»˜è®¢å•çš„é‚£ä¸ªä¸šåŠ¡é€»è¾‘ä»£ç å‘¢ï¼Ÿ"></a><span style = "color:blue">é—®ï¼šmqå‘é€çš„æ¶ˆæ¯ é‚£æ€ä¹ˆæ ·æ‰æ˜¯å¯¹æ¥åˆ°äº†çœŸæ­£çš„ä¸šåŠ¡ä»£ç  æ¯”å¦‚æˆ‘30åˆ†é’Ÿæ²¡ä»˜æ¬¾ é‚£å°±ç»™æˆ‘å…³é—­æœªæ”¯ä»˜è®¢å• æˆ‘è¿™é‡Œæ˜¯mqä¸åªæ˜¯å‘é€æ¶ˆæ¯çš„å— åˆæ€ä¹ˆèƒ½è§¦ç¢°åˆ°çœŸå®çš„è°ƒç”¨å…³é—­æœªæ”¯ä»˜è®¢å•çš„é‚£ä¸ªä¸šåŠ¡é€»è¾‘ä»£ç å‘¢ï¼Ÿ</span></h5><h2 id="âœ…-æ‰€ä»¥å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š"><a href="#âœ…-æ‰€ä»¥å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š" class="headerlink" title="âœ… æ‰€ä»¥å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š"></a>âœ… æ‰€ä»¥å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š</h2><h3 id="åœºæ™¯ï¼š30åˆ†é’Ÿå†…æœªæ”¯ä»˜-â†’-è‡ªåŠ¨å…³é—­è®¢å•ï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰"><a href="#åœºæ™¯ï¼š30åˆ†é’Ÿå†…æœªæ”¯ä»˜-â†’-è‡ªåŠ¨å…³é—­è®¢å•ï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰" class="headerlink" title="åœºæ™¯ï¼š30åˆ†é’Ÿå†…æœªæ”¯ä»˜ â†’ è‡ªåŠ¨å…³é—­è®¢å•ï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰"></a>åœºæ™¯ï¼š30åˆ†é’Ÿå†…æœªæ”¯ä»˜ â†’ è‡ªåŠ¨å…³é—­è®¢å•ï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰</h3><hr>
<h3 id="âœ…-1-ä¸‹å•æˆåŠŸ-â†’-å‘ä¸€æ¡å»¶è¿Ÿæ¶ˆæ¯-åˆ°-MQ"><a href="#âœ…-1-ä¸‹å•æˆåŠŸ-â†’-å‘ä¸€æ¡å»¶è¿Ÿæ¶ˆæ¯-åˆ°-MQ" class="headerlink" title="âœ… 1. ä¸‹å•æˆåŠŸ â†’ å‘ä¸€æ¡å»¶è¿Ÿæ¶ˆæ¯ åˆ° MQ"></a>âœ… 1. ä¸‹å•æˆåŠŸ â†’ å‘ä¸€æ¡<strong>å»¶è¿Ÿæ¶ˆæ¯</strong> åˆ° MQ</h3><p>è¿™ä¸€æ­¥ç”±<strong>è®¢å•æœåŠ¡</strong>å®Œæˆï¼Œå®ƒåªæ˜¯<strong>æŠŠè®¢å•IDå°è£…æˆæ¶ˆæ¯ï¼Œå‘åˆ°æŸä¸ªå»¶è¿ŸTopic</strong>ï¼Œæ¯”å¦‚ <code>order_timeout_topic</code>ã€‚</p>
<pre><code class="java">Message&lt;String&gt; message = MessageBuilder.withPayload(orderId)
    .setHeader(MessageConst.PROPERTY_DELAY_TIME_LEVEL, 16) // å»¶è¿Ÿ30åˆ†é’Ÿ
    .build();

rocketMQTemplate.syncSend(&quot;order_timeout_topic&quot;, message);
</code></pre>
<h3 id="âœ…-2-ç­‰å¾…30åˆ†é’Ÿï¼Œæ¶ˆæ¯è¾¾åˆ°æ—¶é—´è¢«æŠ•é€’-â†’-è§¦å‘æ¶ˆè´¹è€…"><a href="#âœ…-2-ç­‰å¾…30åˆ†é’Ÿï¼Œæ¶ˆæ¯è¾¾åˆ°æ—¶é—´è¢«æŠ•é€’-â†’-è§¦å‘æ¶ˆè´¹è€…" class="headerlink" title="âœ… 2. ç­‰å¾…30åˆ†é’Ÿï¼Œæ¶ˆæ¯è¾¾åˆ°æ—¶é—´è¢«æŠ•é€’ â†’ è§¦å‘æ¶ˆè´¹è€…"></a>âœ… 2. ç­‰å¾…30åˆ†é’Ÿï¼Œæ¶ˆæ¯è¾¾åˆ°æ—¶é—´è¢«æŠ•é€’ â†’ <strong>è§¦å‘æ¶ˆè´¹è€…</strong></h3><p>è¿™ä¸€æ­¥ç”±<strong>ä½ è‡ªå·±å†™çš„æ¶ˆè´¹è€…ç±»</strong>å®Œæˆã€‚</p>
<pre><code class="java">@RocketMQMessageListener(
    topic = &quot;order_timeout_topic&quot;, 
    consumerGroup = &quot;order_timeout_group&quot;
)
@Component
public class OrderTimeoutConsumer implements RocketMQListener&lt;String&gt; &#123;

    @Autowired
    private OrderService orderService;

    @Override
    public void onMessage(String orderId) &#123;
        // âœ… çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘è°ƒç”¨å°±åœ¨è¿™é‡Œ
        orderService.closeUnpaidOrder(orderId);
    &#125;
&#125;
</code></pre>
<h3 id="âœ…-3-æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œè°ƒç”¨ä½ çš„çœŸå®ä¸šåŠ¡ä»£ç ï¼š"><a href="#âœ…-3-æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œè°ƒç”¨ä½ çš„çœŸå®ä¸šåŠ¡ä»£ç ï¼š" class="headerlink" title="âœ… 3. æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œè°ƒç”¨ä½ çš„çœŸå®ä¸šåŠ¡ä»£ç ï¼š"></a>âœ… 3. æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œ<strong>è°ƒç”¨ä½ çš„çœŸå®ä¸šåŠ¡ä»£ç </strong>ï¼š</h3><pre><code class="java">public void closeUnpaidOrder(String orderId) &#123;
    Order order = orderMapper.selectById(orderId);
    
    // âœ… æ ¡éªŒçŠ¶æ€ï¼šåªæœ‰æœªæ”¯ä»˜æ‰å…³é—­
    if (&quot;UNPAID&quot;.equals(order.getStatus())) &#123;
        // æ›´æ–°è®¢å•çŠ¶æ€ä¸ºâ€œå·²å…³é—­â€
        order.setStatus(&quot;CLOSED&quot;);
        orderMapper.updateById(order);

        // å›æ»šåº“å­˜ï¼ˆå¦‚æœä¹‹å‰é¢„æ‰£äº†åº“å­˜ï¼‰
        stockService.rollbackStock(order.getItems());

        log.info(&quot;è®¢å• &#123;&#125; å·²è¶…æ—¶æœªæ”¯ä»˜ï¼Œè‡ªåŠ¨å…³é—­&quot;, orderId);
    &#125;
&#125;
</code></pre>
<h2 id="âœ…-æ€»ç»“ä¸€å¥è¯ï¼š"><a href="#âœ…-æ€»ç»“ä¸€å¥è¯ï¼š" class="headerlink" title="âœ… æ€»ç»“ä¸€å¥è¯ï¼š"></a>âœ… æ€»ç»“ä¸€å¥è¯ï¼š</h2><blockquote>
<p><strong>MQ åªæ˜¯â€œæ¶ˆæ¯çš„æ¬è¿å·¥â€</strong>ï¼Œä½†ä½ è¦å†™æ¶ˆè´¹è€…ç±»ï¼ˆ<code>RocketMQListener</code> &#x2F; <code>@RabbitListener</code> &#x2F; <code>KafkaListener</code>ï¼‰ï¼Œ<strong>åœ¨ <code>onMessage()</code> æ–¹æ³•ä¸­è°ƒç”¨ä½ çš„ä¸šåŠ¡ä»£ç </strong>ï¼Œæ‰ç®—çœŸæ­£â€œå¯¹æ¥äº†ä¸šåŠ¡é€»è¾‘â€ã€‚</p>
</blockquote>
<hr>
<h3 id="ğŸ“Œ-è¿™æ ·ä½ å°±èƒ½å®ç°ï¼š"><a href="#ğŸ“Œ-è¿™æ ·ä½ å°±èƒ½å®ç°ï¼š" class="headerlink" title="ğŸ“Œ è¿™æ ·ä½ å°±èƒ½å®ç°ï¼š"></a>ğŸ“Œ è¿™æ ·ä½ å°±èƒ½å®ç°ï¼š</h3><ul>
<li>ä¸‹å•æ—¶å‘é€ä¸€æ¡â€œ30åˆ†é’Ÿåçš„æé†’æ¶ˆæ¯â€</li>
<li>30åˆ†é’Ÿåï¼Œæ¶ˆæ¯è¢«è‡ªåŠ¨æŠ•é€’</li>
<li>æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯</li>
<li>æ¶ˆè´¹è€…å»æ‰§è¡Œä½ å†™å¥½çš„â€œå…³é—­è®¢å•â€é€»è¾‘</li>
</ul>
<h3 id="âœ…-ä½ å†™çš„ä¸šåŠ¡ä»£ç åªæ˜¯â€œæ”¶åˆ°é€šçŸ¥ä¹‹åâ€æ‰§è¡Œ"><a href="#âœ…-ä½ å†™çš„ä¸šåŠ¡ä»£ç åªæ˜¯â€œæ”¶åˆ°é€šçŸ¥ä¹‹åâ€æ‰§è¡Œ" class="headerlink" title="âœ… ä½ å†™çš„ä¸šåŠ¡ä»£ç åªæ˜¯â€œæ”¶åˆ°é€šçŸ¥ä¹‹åâ€æ‰§è¡Œ"></a>âœ… <strong>ä½ å†™çš„ä¸šåŠ¡ä»£ç åªæ˜¯â€œæ”¶åˆ°é€šçŸ¥ä¹‹åâ€æ‰§è¡Œ</strong></h3><h3 id="â—æ˜¯-MQ-å»¶è¿Ÿé˜Ÿåˆ—åœ¨èƒŒåå¸®ä½ ç­‰å¾…-30-åˆ†é’Ÿ"><a href="#â—æ˜¯-MQ-å»¶è¿Ÿé˜Ÿåˆ—åœ¨èƒŒåå¸®ä½ ç­‰å¾…-30-åˆ†é’Ÿ" class="headerlink" title="â—æ˜¯ MQ å»¶è¿Ÿé˜Ÿåˆ—åœ¨èƒŒåå¸®ä½ ç­‰å¾… 30 åˆ†é’Ÿ"></a>â—<strong>æ˜¯ MQ å»¶è¿Ÿé˜Ÿåˆ—åœ¨èƒŒåå¸®ä½ ç­‰å¾… 30 åˆ†é’Ÿ</strong></h3><h2 id="ğŸ”-ä¸¤ç§â€œå®šæ—¶ä»»åŠ¡â€çš„æ–¹å¼å¯¹æ¯”"><a href="#ğŸ”-ä¸¤ç§â€œå®šæ—¶ä»»åŠ¡â€çš„æ–¹å¼å¯¹æ¯”" class="headerlink" title="ğŸ” ä¸¤ç§â€œå®šæ—¶ä»»åŠ¡â€çš„æ–¹å¼å¯¹æ¯”"></a>ğŸ” ä¸¤ç§â€œå®šæ—¶ä»»åŠ¡â€çš„æ–¹å¼å¯¹æ¯”</h2><table>
<thead>
<tr>
<th>å®ç°æ–¹å¼</th>
<th>è°æ¥ç­‰å¾…30åˆ†é’Ÿï¼Ÿ</th>
<th>ç¼ºç‚¹</th>
<th>ä¼˜ç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>å®šæ—¶ä»»åŠ¡ Cron</strong></td>
<td>ä½ å†™ä¸€ä¸ª <code>@Scheduled</code> æ¯éš”1åˆ†é’Ÿè½®è¯¢æ•°æ®åº“</td>
<td>æ•°æ®å¤šäº†ä¼šå¯¼è‡´ <strong>æ‰«ææ€§èƒ½å·®</strong>ï¼Œä¸” <strong>ä¸ç²¾ç¡®</strong></td>
<td>ç®€å•ã€ç›´è§‚</td>
</tr>
<tr>
<td><strong>MQ å»¶è¿Ÿé˜Ÿåˆ—</strong></td>
<td><strong>MQè‡ªåŠ¨ç­‰å¾…30åˆ†é’ŸåæŠ•é€’æ¶ˆæ¯</strong></td>
<td>è¦é…åˆæ¶ˆæ¯ç³»ç»Ÿã€æ¶ˆè´¹è€…å†™æ³•ç•¥å¤æ‚</td>
<td>ç²¾å‡†ã€æ€§èƒ½é«˜ã€æ— æ„ŸçŸ¥ã€æ— éœ€æ•°æ®åº“è½®è¯¢</td>
</tr>
</tbody></table>
<h2 id="ğŸ§©-çœŸå®æ‰§è¡Œæµç¨‹å†è§£é‡Šä¸€é"><a href="#ğŸ§©-çœŸå®æ‰§è¡Œæµç¨‹å†è§£é‡Šä¸€é" class="headerlink" title="ğŸ§© çœŸå®æ‰§è¡Œæµç¨‹å†è§£é‡Šä¸€é"></a>ğŸ§© çœŸå®æ‰§è¡Œæµç¨‹å†è§£é‡Šä¸€é</h2><h3 id="ğŸ”µ-ç”¨æˆ·ä¸‹å•æˆåŠŸ"><a href="#ğŸ”µ-ç”¨æˆ·ä¸‹å•æˆåŠŸ" class="headerlink" title="ğŸ”µ ç”¨æˆ·ä¸‹å•æˆåŠŸ"></a>ğŸ”µ ç”¨æˆ·ä¸‹å•æˆåŠŸ</h3><p>ä¸šåŠ¡ä»£ç æ‰§è¡Œå®Œååšä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>æŠŠè®¢å•çŠ¶æ€å†™å…¥æ•°æ®åº“ï¼š<code>UNPAID</code></li>
<li>å‘ MQ å‘ä¸€æ¡â€œå»¶è¿Ÿ30åˆ†é’Ÿâ€çš„æ¶ˆæ¯ï¼Œå†…å®¹æ˜¯è®¢å•ID</li>
</ol>
<hr>
<h3 id="ğŸŸ¡-MQ-å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆå¦‚-RocketMQï¼‰"><a href="#ğŸŸ¡-MQ-å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆå¦‚-RocketMQï¼‰" class="headerlink" title="ğŸŸ¡ MQ å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆå¦‚ RocketMQï¼‰"></a>ğŸŸ¡ MQ å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆå¦‚ RocketMQï¼‰</h3><p>ä½ è®¾ç½®äº†ï¼š</p>
<pre><code>.setHeader(MessageConst.PROPERTY_DELAY_TIME_LEVEL, 16); // è¡¨ç¤ºå»¶è¿Ÿ30åˆ†é’Ÿ
</code></pre>
<p>MQ ä¼šå¸®ä½ ç¼“å­˜è¿™æ¡æ¶ˆæ¯ï¼Œ<strong>ä¸ä¼šç«‹å³æŠ•é€’ï¼</strong></p>
<hr>
<h3 id="ğŸ”´-ç­‰åˆ°-30-åˆ†é’Ÿåï¼ŒMQ-æ‰æŠŠè¿™æ¡æ¶ˆæ¯äº¤ç»™ä½ å†™çš„æ¶ˆè´¹è€…ç±»ï¼ˆæ¯”å¦‚-OrderTimeoutConsumerï¼‰"><a href="#ğŸ”´-ç­‰åˆ°-30-åˆ†é’Ÿåï¼ŒMQ-æ‰æŠŠè¿™æ¡æ¶ˆæ¯äº¤ç»™ä½ å†™çš„æ¶ˆè´¹è€…ç±»ï¼ˆæ¯”å¦‚-OrderTimeoutConsumerï¼‰" class="headerlink" title="ğŸ”´ ç­‰åˆ° 30 åˆ†é’Ÿåï¼ŒMQ æ‰æŠŠè¿™æ¡æ¶ˆæ¯äº¤ç»™ä½ å†™çš„æ¶ˆè´¹è€…ç±»ï¼ˆæ¯”å¦‚ OrderTimeoutConsumerï¼‰"></a>ğŸ”´ ç­‰åˆ° 30 åˆ†é’Ÿåï¼ŒMQ æ‰æŠŠè¿™æ¡æ¶ˆæ¯äº¤ç»™ä½ å†™çš„æ¶ˆè´¹è€…ç±»ï¼ˆæ¯”å¦‚ <code>OrderTimeoutConsumer</code>ï¼‰</h3><p>ä½ çš„æ¶ˆè´¹è€…ä»£ç æ‰ä¼šè¢«æ‰§è¡Œï¼š</p>
<pre><code class="java">public void onMessage(String orderId) &#123;
    orderService.closeUnpaidOrder(orderId);
&#125;
</code></pre>
<p>æ­¤æ—¶æ‰ä¼šè°ƒç”¨ä½ å†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œ<strong>æ£€æŸ¥è®¢å•æ˜¯å¦å·²æ”¯ä»˜ï¼Œå¦‚æœæ²¡æ”¯ä»˜ï¼Œå°±è‡ªåŠ¨å…³é—­</strong></p>
<h2 id="âœ…-ä¸ºä»€ä¹ˆä¸ç”¨-Scheduled-ï¼Ÿ"><a href="#âœ…-ä¸ºä»€ä¹ˆä¸ç”¨-Scheduled-ï¼Ÿ" class="headerlink" title="âœ… ä¸ºä»€ä¹ˆä¸ç”¨ @Scheduled ï¼Ÿ"></a>âœ… ä¸ºä»€ä¹ˆä¸ç”¨ <code>@Scheduled</code> ï¼Ÿ</h2><p>ä½ å½“ç„¶<strong>å¯ä»¥ç”¨å®šæ—¶ä»»åŠ¡</strong>ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="java">@Scheduled(cron = &quot;0 */1 * * * ?&quot;)
public void scanUnpaidOrders() &#123;
    // æ¯1åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ•°æ®åº“é‡ŒçŠ¶æ€ä¸º UNPAID ä¸”è¶…è¿‡30åˆ†é’Ÿçš„è®¢å•
&#125;
</code></pre>
<h3 id="â—ä½†æ˜¯é—®é¢˜æ˜¯ï¼š"><a href="#â—ä½†æ˜¯é—®é¢˜æ˜¯ï¼š" class="headerlink" title="â—ä½†æ˜¯é—®é¢˜æ˜¯ï¼š"></a>â—ä½†æ˜¯é—®é¢˜æ˜¯ï¼š</h3><ul>
<li>æ¯æ¬¡éƒ½è¦ <strong>æ‰«æ•´ä¸ªè¡¨</strong> æˆ–è€…ä¸€éƒ¨åˆ†æ•°æ®ï¼Œæ€§èƒ½å·®</li>
<li>ä¸èƒ½åšåˆ°<strong>ç§’çº§å‡†ç¡®æ‰§è¡Œ</strong>ï¼ˆå¯èƒ½è¦ç­‰1åˆ†é’Ÿæ‰è§¦å‘ï¼‰</li>
<li>é«˜å¹¶å‘ç³»ç»Ÿï¼ˆåƒç”µå•†ã€ç§’æ€ï¼‰<strong>æ ¹æœ¬æ‰›ä¸ä½é¢‘ç¹è½®è¯¢</strong></li>
</ul>
<h2 id="âœ…-ä¸ºä»€ä¹ˆç”¨-MQ-å»¶è¿Ÿæ¶ˆæ¯æ˜¯æœ€ä½³é€‰æ‹©ï¼Ÿ"><a href="#âœ…-ä¸ºä»€ä¹ˆç”¨-MQ-å»¶è¿Ÿæ¶ˆæ¯æ˜¯æœ€ä½³é€‰æ‹©ï¼Ÿ" class="headerlink" title="âœ… ä¸ºä»€ä¹ˆç”¨ MQ å»¶è¿Ÿæ¶ˆæ¯æ˜¯æœ€ä½³é€‰æ‹©ï¼Ÿ"></a>âœ… ä¸ºä»€ä¹ˆç”¨ MQ å»¶è¿Ÿæ¶ˆæ¯æ˜¯æœ€ä½³é€‰æ‹©ï¼Ÿ</h2><ul>
<li><strong>MQè‡ªå·±ç»´æŠ¤å»¶æ—¶ï¼Œç²¾ç¡®åˆ°ç§’çº§</strong></li>
<li><strong>ä¸ä¾èµ–æ•°æ®åº“å®šæ—¶è½®è¯¢</strong></li>
<li><strong>ä¸€æ¡æ¶ˆæ¯å°±æ˜¯ä¸€ç¬”è®¢å•ï¼Œåˆ°æ—¶é—´å†æŠ•é€’ï¼Œæ€§èƒ½é«˜</strong></li>
<li><strong>å’Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®Œå…¨è§£è€¦</strong></li>
</ul>
</blockquote>
<p>å¼‚æ­¥å‘ä¼˜æƒ å· + ç§¯åˆ† [ç”¨æˆ·å¯¹äºå®æ—¶æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜]</p>
<ul>
<li><h5 id="ä½¿ç”¨MQçš„åœºæ™¯ï¼šè®¢å•å¤„ç†"><a href="#ä½¿ç”¨MQçš„åœºæ™¯ï¼šè®¢å•å¤„ç†" class="headerlink" title="ä½¿ç”¨MQçš„åœºæ™¯ï¼šè®¢å•å¤„ç†"></a>ä½¿ç”¨MQçš„åœºæ™¯ï¼šè®¢å•å¤„ç†</h5><h5 id="å…·ä½“åœºæ™¯"><a href="#å…·ä½“åœºæ™¯" class="headerlink" title="å…·ä½“åœºæ™¯"></a>å…·ä½“åœºæ™¯</h5><p>å½“ç”¨æˆ·åœ¨ç”µå­å•†åŠ¡å¹³å°ä¸ŠæˆåŠŸä¸‹å•åï¼Œè®¢å•æœåŠ¡éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ol>
<li>æ›´æ–°è®¢å•çŠ¶æ€ä¸ºâ€œå·²æ”¯ä»˜â€ã€‚</li>
<li>æ‰£å‡å•†å“åº“å­˜ã€‚</li>
<li>é€šçŸ¥æ”¯ä»˜æœåŠ¡å¤„ç†æ”¯ä»˜ã€‚</li>
<li>é€šçŸ¥ç‰©æµæœåŠ¡å‡†å¤‡å‘è´§ã€‚</li>
</ol>
<h5 id="ä½¿ç”¨MQçš„åŸå› "><a href="#ä½¿ç”¨MQçš„åŸå› " class="headerlink" title="ä½¿ç”¨MQçš„åŸå› "></a>ä½¿ç”¨MQçš„åŸå› </h5><p>åœ¨è¿™äº›æ“ä½œä¸­ï¼Œæ›´æ–°è®¢å•çŠ¶æ€å’Œæ‰£å‡åº“å­˜æ˜¯å®æ—¶ä¸”åŒæ­¥çš„æ“ä½œï¼Œä½†é€šçŸ¥æ”¯ä»˜æœåŠ¡å’Œç‰©æµæœåŠ¡åˆ™å¯ä»¥å¼‚æ­¥è¿›è¡Œã€‚ä½¿ç”¨MQå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ä»¥ä¸‹ç›®æ ‡ï¼š</p>
<ul>
<li><strong>è§£è€¦æœåŠ¡</strong>ï¼šè®¢å•æœåŠ¡ä¸éœ€è¦ç›´æ¥è°ƒç”¨æ”¯ä»˜æœåŠ¡å’Œç‰©æµæœåŠ¡ï¼Œé™ä½äº†æœåŠ¡é—´çš„è€¦åˆåº¦ã€‚</li>
<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šè®¢å•æœåŠ¡å¯ä»¥ç«‹å³å“åº”å®¢æˆ·ç«¯ï¼Œä¸å¿…ç­‰å¾…æ”¯ä»˜å’Œç‰©æµæœåŠ¡çš„å¤„ç†ç»“æœã€‚</li>
<li><strong>æµé‡å‰Šå³°</strong>ï¼šåœ¨é«˜å³°æœŸï¼ŒMQå¯ä»¥ç¼“å†²å¤§é‡çš„è®¢å•å¤„ç†è¯·æ±‚ï¼Œé¿å…æœåŠ¡è¢«å‹å®ã€‚</li>
</ul>
</li>
</ul>
<p><strong>è®¢å•æœåŠ¡ç”Ÿäº§æ¶ˆæ¯ï¼š</strong> å½“è®¢å•æœåŠ¡å®Œæˆè®¢å•çŠ¶æ€æ›´æ–°å’Œåº“å­˜æ‰£å‡åï¼Œå®ƒå°†ä»¥ä¸‹æ¶ˆæ¯å‘é€åˆ°</p>
<pre><code>&#123;
  &quot;orderId&quot;: &quot;123456789&quot;,
  &quot;status&quot;: &quot;paid&quot;,
  &quot;userId&quot;: &quot;user123&quot;,
  &quot;items&quot;: [
    &#123;&quot;productId&quot;: &quot;prod123&quot;, &quot;quantity&quot;: 1&#125;,
    &#123;&quot;productId&quot;: &quot;prod456&quot;, &quot;quantity&quot;: 2&#125;
  ]
&#125;
</code></pre>
<p>è¿™ä¸ªæ¶ˆæ¯å°†è¢«å‘é€åˆ°ä¸åŒçš„ä¸»é¢˜æˆ–é˜Ÿåˆ—ï¼Œä¾‹å¦‚<code>payment_topic</code>å’Œ<code>logistics_topic</code>ã€‚</p>
<p><strong>2. æ”¯ä»˜æœåŠ¡å’Œç‰©æµæœåŠ¡æ¶ˆè´¹æ¶ˆæ¯ï¼š</strong></p>
<ul>
<li><strong>æ”¯ä»˜æœåŠ¡</strong>è®¢é˜…<code>payment_topic</code>ï¼Œå½“æ¥æ”¶åˆ°è®¢å•æ”¯ä»˜æ¶ˆæ¯åï¼Œå®ƒä¼šå¤„ç†æ”¯ä»˜é€»è¾‘ï¼Œå¦‚éªŒè¯æ”¯ä»˜çŠ¶æ€ã€è®°å½•äº¤æ˜“æ—¥å¿—ç­‰ã€‚</li>
<li><strong>ç‰©æµæœåŠ¡</strong>è®¢é˜…<code>logistics_topic</code>ï¼Œå½“æ¥æ”¶åˆ°è®¢å•æ¶ˆæ¯åï¼Œå®ƒä¼šå‡†å¤‡å‘è´§ï¼Œæ›´æ–°ç‰©æµä¿¡æ¯ï¼Œå¹¶é€šçŸ¥ç”¨æˆ·ã€‚</li>
</ul>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè®¢å•æœåŠ¡å¯ä»¥å¿«é€Ÿå“åº”ç”¨æˆ·è¯·æ±‚ï¼Œè€Œæ”¯ä»˜å’Œç‰©æµæœåŠ¡å¯ä»¥æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥å¤„ç†è®¢å•ç›¸å…³çš„æ“ä½œï¼Œæ•´ä¸ªç³»ç»Ÿå› æ­¤å˜å¾—æ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚</p>
<h4 id="å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ"></a><strong>å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ</strong></h4><p>ä¿è¯ç”Ÿäº§è€…èƒ½å¤ŸæˆåŠŸå‘é€åˆ°äº¤æ¢æœºå’Œé˜Ÿåˆ—(å­˜å‚¨æ¶ˆæ¯)ï¼Œç”Ÿäº§è€…æä¾›äº†æ¶ˆæ¯ç¡®è®¤æœºåˆ¶<br>åˆ°é˜Ÿåˆ—åæ¶ˆæ¯è¦æœ‰æŒä¹…åŒ–æœºåˆ¶<br>æ¶ˆè´¹è€…è¦æœ‰ä¸€ä¸ªæ¶ˆæ¯ç¡®è®¤æœºåˆ¶ ä¿è¯æ¶ˆè´¹è€…è‡³å°‘æ¶ˆè´¹æˆåŠŸæ¶ˆæ¯ä¸€æ¬¡</p>
<blockquote>
<ul>
<li><p>å¼€å¯ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶ï¼Œç¡®ä¿ç”Ÿäº§è€…çš„æ¶ˆæ¯èƒ½åˆ°è¾¾é˜Ÿåˆ—<br>confirmåˆ°äº¤æ¢æœºack ä¸åˆ°nack å’Œ returnæ²¡åˆ°è¿”å›nackæœºåˆ¶ä¿è¯ç”Ÿäº§è€…æŠŠæ¶ˆæ¯å‘è¿‡å»</p>
</li>
<li><p>å¼€å¯æŒä¹…åŒ–åŠŸèƒ½ï¼Œç¡®ä¿æ¶ˆæ¯æœªæ¶ˆè´¹å‰åœ¨é˜Ÿåˆ—ä¸­ä¸ä¼šä¸¢å¤±<br>ä¸‡ä¸€brokeræŒ‚æ‰å°±æƒ¨äº† ä¿è¯è‡³å°‘æˆåŠŸä¸€æ¬¡æ¶ˆè´¹</p>
</li>
<li><p>å¼€å¯æ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ä¸ºautoï¼Œç”±springç¡®è®¤æ¶ˆæ¯å¤„ç†æˆåŠŸåå®Œæˆack<br>æ¶ˆè´¹è€…ä¸‰ç§æœºåˆ¶ï¼š</p>
<blockquote>
<p>RabbitMQæ”¯æŒæ¶ˆè´¹è€…ç¡®è®¤æœºåˆ¶ï¼Œå³ï¼šæ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯åå¯ä»¥å‘MQå‘é€ackå›æ‰§ï¼ŒMQæ”¶åˆ°ackå›æ‰§åæ‰ä¼šåˆ é™¤è¯¥æ¶ˆæ¯ï¼Œè€ŒSpringAMQPåˆ™å…è®¸é…ç½®ä¸‰ç§ç¡®è®¤æ¨¡å¼ï¼š</p>
<ul>
<li><p><strong>manual</strong>ï¼šæ‰‹åŠ¨ackï¼Œéœ€è¦åœ¨ä¸šåŠ¡ä»£ç ç»“æŸåï¼Œè°ƒç”¨apiå‘é€ackã€‚</p>
</li>
<li><p><strong>auto</strong>ï¼šè‡ªåŠ¨ackï¼Œç”±springç›‘æµ‹listenerä»£ç æ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œæ²¡æœ‰å¼‚å¸¸åˆ™è¿”å›ackï¼›æŠ›å‡ºå¼‚å¸¸åˆ™è¿”å›nack</p>
</li>
<li><p><strong>none</strong>ï¼šå…³é—­ackï¼ŒMQå‡å®šæ¶ˆè´¹è€…è·å–æ¶ˆæ¯åä¼šæˆåŠŸå¤„ç†ï¼Œå› æ­¤æ¶ˆæ¯æŠ•é€’åç«‹å³è¢«åˆ é™¤</p>
</li>
</ul>
</blockquote>
</li>
<li><p>å¼€å¯æ¶ˆè´¹è€…å¤±è´¥é‡è¯•æœºåˆ¶ï¼Œå¤šæ¬¡é‡è¯•å¤±è´¥åå°†æ¶ˆæ¯æŠ•é€’åˆ°å¼‚å¸¸äº¤æ¢æœºï¼Œäº¤ç”±äººå·¥å¤„ç†</p>
<blockquote>
<p>åœ¨å¼€å¯é‡è¯•æ¨¡å¼åï¼Œé‡è¯•æ¬¡æ•°è€—å°½ï¼Œå¦‚æœæ¶ˆæ¯ä¾ç„¶å¤±è´¥ï¼Œåˆ™éœ€è¦æœ‰MessageRecovereræ¥å£æ¥å¤„ç†ï¼Œå®ƒåŒ…å«ä¸‰ç§ä¸åŒçš„å®ç°ï¼š</p>
<ul>
<li><p><strong>RejectAndDontRequeueRecoverer</strong>ï¼šé‡è¯•è€—å°½åï¼Œç›´æ¥rejectï¼Œä¸¢å¼ƒæ¶ˆæ¯ã€‚é»˜è®¤å°±æ˜¯è¿™ç§æ–¹å¼</p>
</li>
<li><p><strong>ImmediateRequeueMessageRecoverer</strong>ï¼šé‡è¯•è€—å°½åï¼Œè¿”å›nackï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿ</p>
</li>
<li><p><strong>RepublishMessageRecoverer</strong>ï¼šé‡è¯•è€—å°½åï¼Œå°†å¤±è´¥æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„äº¤æ¢æœº</p>
</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<ul>
<li>å¼‚æ­¥å‘é€ï¼ˆéªŒè¯ç ã€çŸ­ä¿¡ã€é‚®ä»¶ï¼‰</li>
<li>MySQLå’ŒRedisï¼ŒESä¹‹é—´çš„æ•°æ®åŒæ­¥</li>
<li>åˆ†å¸ƒå¼äº‹åŠ¡</li>
<li>å‰Šå³°å¡«è°·</li>
</ul>
<h4 id="å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹ï¼Ÿ"><a href="#å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹ï¼Ÿ" class="headerlink" title="å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹ï¼Ÿ"></a><strong>å¦‚ä½•è§£å†³æ¶ˆæ¯ç§¯å‹ï¼Ÿ</strong></h4><p>äº§ç”ŸåŸå› ï¼šå½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é€Ÿåº¦è¶…è¿‡äº†æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯çš„é€Ÿåº¦ï¼Œå°±ä¼šå¯¼è‡´é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å †ç§¯ï¼Œç›´åˆ°é˜Ÿåˆ—å­˜å‚¨æ¶ˆæ¯è¾¾åˆ°ä¸Šé™ã€‚ä¹‹åå‘é€çš„æ¶ˆæ¯å°±ä¼šæˆä¸ºæ­»ä¿¡ï¼Œå¯èƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œè¿™å°±æ˜¯å †ç§¯é—®é¢˜</p>
<p>**è§£å†³æ¶ˆæ¯å †ç§¯æœ‰ä¸‰ç§æ€è·¯ **</p>
<ul>
<li>å¢åŠ æ›´å¤šæ¶ˆè´¹è€…ï¼Œæé«˜æ¶ˆè´¹é€Ÿåº¦</li>
<li>åœ¨æ¶ˆè´¹è€…å†…å¼€å¯çº¿ç¨‹æ± åŠ å¿«æ¶ˆæ¯å¤„ç†é€Ÿåº¦</li>
<li>æ‰©å¤§é˜Ÿåˆ—å®¹ç§¯ï¼Œæé«˜å †ç§¯ä¸Šé™</li>
</ul>
<h4 id="å¦‚ä½•ä¿è¯æ¶ˆè´¹å¹‚ç­‰æ€§ã€MQã€‘"><a href="#å¦‚ä½•ä¿è¯æ¶ˆè´¹å¹‚ç­‰æ€§ã€MQã€‘" class="headerlink" title="å¦‚ä½•ä¿è¯æ¶ˆè´¹å¹‚ç­‰æ€§ã€MQã€‘"></a>å¦‚ä½•ä¿è¯æ¶ˆè´¹å¹‚ç­‰æ€§ã€MQã€‘</h4><p>å¹‚ç­‰æ€§æ˜¯æŒ‡åŒä¸€ä¸ªæ“ä½œæ‰§è¡Œå¤šæ¬¡å’Œæ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœç›¸åŒã€‚åœ¨æ¶ˆæ¯æ¶ˆè´¹çš„åœºæ™¯ä¸­ï¼Œä¿è¯å¹‚ç­‰æ€§é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š<br><strong><u>åˆ©ç”¨æ•°æ®åº“çš„å”¯ä¸€çº¦æŸ</u><strong>ï¼š<br>åœ¨æ•°æ®åº“ä¸­ä¸ºæ¶ˆæ¯è®¾ç½®å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚æ¶ˆæ¯IDï¼‰ï¼Œåœ¨å¤„ç†æ¶ˆæ¯å‰å…ˆæ£€æŸ¥è¯¥æ ‡è¯†æ˜¯å¦å·²å­˜åœ¨ã€‚<br>å¯¼è‡´é‡å¤æ¶ˆè´¹ è¿”å›ackï¼Œblockeræœªæ”¶åˆ°ã€‚ä¸€å®šè¦åœ¨</strong>ç”Ÿäº§è€…</strong>æŠ•é€’çš„æ—¶å€™ç”Ÿæˆå…¨å±€å”¯ä¸€çš„idï¼Œæ¶ˆè´¹è€…å°±ä¼šå»åˆ¤æ–­ã€‚å¼‚æ­¥ç”Ÿæˆ æ‹¿è®¢å•å·å»æ•°æ®åº“æŸ¥ å¦‚æœæŸ¥å¾—åˆ°å°±ç›´æ¥return<br><strong>ç²¾é«“å°±æ˜¯å…¨å±€å”¯ä¸€</strong><br>UUIDä¸è¡Œ å› ä¸ºæ¯æ¬¡å‘é€çš„æ¶ˆæ¯éƒ½ä¸æ˜¯åŒä¸€ä¸ªUUID è¦ç”¨ä¸šåŠ¡ä¸Šçš„</p>
<h6 id="å“ªäº›åœ°æ–¹è¿˜ä¼šæœ‰å¹‚ç­‰é—®é¢˜ï¼Ÿ"><a href="#å“ªäº›åœ°æ–¹è¿˜ä¼šæœ‰å¹‚ç­‰é—®é¢˜ï¼Ÿ" class="headerlink" title="å“ªäº›åœ°æ–¹è¿˜ä¼šæœ‰å¹‚ç­‰é—®é¢˜ï¼Ÿ"></a>å“ªäº›åœ°æ–¹è¿˜ä¼šæœ‰å¹‚ç­‰é—®é¢˜ï¼Ÿ</h6><p>æä¾›è€…çš„openfeginã€xxl-jobã€è¢«åˆ«äººè°ƒç”¨ä¸”æ¶‰åŠåˆ°å¢åˆ æ”¹</p>
<h6 id="çŠ¶æ€è®°å½•ï¼š"><a href="#çŠ¶æ€è®°å½•ï¼š" class="headerlink" title="çŠ¶æ€è®°å½•ï¼š"></a>çŠ¶æ€è®°å½•ï¼š</h6><p>åœ¨æ¶ˆè´¹æ¶ˆæ¯å‰ï¼Œè®°å½•æ¶ˆæ¯çš„çŠ¶æ€ï¼ˆå¦‚å·²å¤„ç†ï¼‰ï¼Œå¤„ç†å®Œæ¯•åå†æ›´æ–°çŠ¶æ€ã€‚è¦æ ¹æ®è®¢å•ID+çŠ¶æ€ æ¥ä¿è¯æ¶ˆè´¹å¹‚ç­‰æ€§ã€‚è®¢å•å­˜åœ¨ä¸”æœªæ”¯ä»˜ â†’ æ›´æ–°<del>é”è®¢å•ID</del></p>
<h6 id="å¹¶å‘æƒ…å†µå¹‚ç­‰æ€§ï¼š"><a href="#å¹¶å‘æƒ…å†µå¹‚ç­‰æ€§ï¼š" class="headerlink" title="å¹¶å‘æƒ…å†µå¹‚ç­‰æ€§ï¼š"></a>å¹¶å‘æƒ…å†µå¹‚ç­‰æ€§ï¼š</h6><p>å®Œç¾çš„å¹‚ç­‰è¦åŠ ä¸Šåˆ†å¸ƒå¼é”<del>å¯¹æ•æ„Ÿæ€§è¦æ±‚é«˜ï¼Œä¸”è¦æ§åˆ¶å¥½é”çš„åŠ›åº¦</del></p>
<h4 id="å¦‚ä½•ä¿è¯æ¶ˆè´¹æœ‰åºæ€§"><a href="#å¦‚ä½•ä¿è¯æ¶ˆè´¹æœ‰åºæ€§" class="headerlink" title="å¦‚ä½•ä¿è¯æ¶ˆè´¹æœ‰åºæ€§"></a>å¦‚ä½•ä¿è¯æ¶ˆè´¹æœ‰åºæ€§</h4><p>é˜Ÿåˆ—ä¸­å¯ä»¥æŒ‡å®šæ¶ˆæ¯çš„æ¶ˆè´¹é¡ºåº</p>
<p>  <strong>RabbitMQ</strong> â†’ å¤šä¸ªç”Ÿäº§è€…å¹¶å‘æŠ•ï¼Œæ‰€ä»¥ç”Ÿäº§è€…ä¸èƒ½ä¿è¯æœ‰åºæ€§ï¼Œåªè€ƒè™‘æ¶ˆè´¹æœ‰åºæ€§ã€‚ä»¥æ¶ˆæ¯è¿›å…¥çš„MQçš„æ¶ˆæ¯å»å›ç­”ã€‚</p>
<h5 id="æ€ä¹ˆä¿è¯ï¼Ÿ"><a href="#æ€ä¹ˆä¿è¯ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä¿è¯ï¼Ÿ"></a>æ€ä¹ˆä¿è¯ï¼Ÿ</h5><h6 id="å•çº¿ç¨‹æ¶ˆè´¹ï¼š"><a href="#å•çº¿ç¨‹æ¶ˆè´¹ï¼š" class="headerlink" title="å•çº¿ç¨‹æ¶ˆè´¹ï¼š"></a>å•çº¿ç¨‹æ¶ˆè´¹ï¼š</h6><p>åœ¨æ¶ˆè´¹è€…ç«¯ä½¿ç”¨å•ä¸ªçº¿ç¨‹å¤„ç†æ¶ˆæ¯ï¼Œç¡®ä¿æ¶ˆæ¯æŒ‰é¡ºåºå¤„ç†ã€‚</p>
<h6 id="åˆ†åŒºæœ‰åºï¼š"><a href="#åˆ†åŒºæœ‰åºï¼š" class="headerlink" title="åˆ†åŒºæœ‰åºï¼š"></a>åˆ†åŒºæœ‰åºï¼š</h6><p>åœ¨å¦‚Kafkaè¿™æ ·çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå¯ä»¥ä¿è¯åŒä¸€ä¸ªåˆ†åŒºå†…çš„æ¶ˆæ¯æ˜¯æœ‰åºçš„ã€‚</p>
<h4 id="å¦‚ä½•æ—¢è¦åˆè¦ã€æœ‰åº-é€Ÿåº¦å¿«ã€‘"><a href="#å¦‚ä½•æ—¢è¦åˆè¦ã€æœ‰åº-é€Ÿåº¦å¿«ã€‘" class="headerlink" title="å¦‚ä½•æ—¢è¦åˆè¦ã€æœ‰åº + é€Ÿåº¦å¿«ã€‘"></a>å¦‚ä½•æ—¢è¦åˆè¦ã€æœ‰åº + é€Ÿåº¦å¿«ã€‘</h4><p>æ—¢è¦åˆè¦â€é€šå¸¸æŒ‡çš„æ˜¯åœ¨ä¿è¯æ¶ˆæ¯çš„å¹‚ç­‰æ€§å’Œæœ‰åºæ€§çš„åŒæ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘å…¶ä»–ç‰¹æ€§ï¼ˆå¦‚é«˜æ€§èƒ½ã€é«˜å¯ç”¨ç­‰ï¼‰<br>åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œå¯èƒ½éœ€è¦åœ¨æ€§èƒ½å’Œä¸€è‡´æ€§ä¹‹é—´åšæƒè¡¡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€‰æ‹©æœ€ç»ˆä¸€è‡´æ€§æ¥æ¢å–æ›´é«˜çš„æ€§èƒ½ã€‚<br>Kafka å’Œ RocketMQå¯ä»¥å¤©ç”Ÿå®ç°ã€åº•å±‚Hashå–æ¨¡ã€‘</p>
<h6 id="è‹¥éè¦ç”¨RabbitMQå®ç°å‘¢ï¼Ÿ"><a href="#è‹¥éè¦ç”¨RabbitMQå®ç°å‘¢ï¼Ÿ" class="headerlink" title="è‹¥éè¦ç”¨RabbitMQå®ç°å‘¢ï¼Ÿ"></a>è‹¥éè¦ç”¨RabbitMQå®ç°å‘¢ï¼Ÿ</h6><p>ä¸åŒè®¢å•ä¹‹é—´æ˜¯å¦è¦æ±‚ä¸€å®šé¡ºåºï¼Ÿï¼Ÿ<br>é•œåƒé›†ç¾¤ï¼Œå…ˆæ­3ä¸ªèŠ‚ç‚¹çš„é•œåƒé›†ç¾¤ï¼Œå»ºç«‹ä¸‰ä¸ªé˜Ÿåˆ—åˆ†ä¸ºä¸åŒçš„é•œåƒèŠ‚ç‚¹ å„å ä¸€ä¸ªé˜Ÿåˆ—ï¼Œéœ€è¦è‡ªå·±å»å®ç°<br>å¯¹è®¢å•å·è¿›è¡Œhashå–æ¨¡çœ‹åˆ°è½åˆ°å“ªä¸ªèŠ‚ç‚¹<br>ä¸‰ä¸ªé˜Ÿåˆ—è‡³å°‘ä¸‰ä¸ªæ¶ˆè´¹è€… åˆ†åˆ«å»æ¶ˆè´¹å®ƒä»¬<br>æ­¤æ—¶å°±å¯ä»¥å¹¶è¡Œæœ‰ä¸‰ä¸ªæ¶ˆè´¹è€…å»æ‰§è¡Œ<br>æŠŠä¸šåŠ¡æ•°æ®æ²¡å…³ç³»çš„æ”¾åœ¨ä¸åŒçš„é˜Ÿåˆ—å»ç®¡ç†</p>
<h6 id="ä¸‡ä¸€æŒ‚æ‰äº†å‘¢ï¼Ÿ"><a href="#ä¸‡ä¸€æŒ‚æ‰äº†å‘¢ï¼Ÿ" class="headerlink" title="ä¸‡ä¸€æŒ‚æ‰äº†å‘¢ï¼Ÿ"></a>ä¸‡ä¸€æŒ‚æ‰äº†å‘¢ï¼Ÿ</h6><p>é˜Ÿåˆ—æœ‰æŒä¹…åŒ–ä¸ç”¨æ‹…å¿ƒ</p>
<h4 id="èƒ½è¯´ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æ­»ä¿¡äº¤æ¢æœºå—æ”¯ä»˜"><a href="#èƒ½è¯´ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æ­»ä¿¡äº¤æ¢æœºå—æ”¯ä»˜" class="headerlink" title="èƒ½è¯´ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æ­»ä¿¡äº¤æ¢æœºå—æ”¯ä»˜"></a>èƒ½è¯´ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨æ­»ä¿¡äº¤æ¢æœºå—<del>æ”¯ä»˜</del></h4><p>æ­»ä¿¡äº¤æ¢æœºï¼ˆDLXï¼‰ç”¨äºå¤„ç†æ— æ³•æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯<br>åˆ›å»ºä¸€ä¸ªæ­£å¸¸çš„äº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼Œä»¥åŠä¸€ä¸ªæ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—ã€‚</p>
<blockquote>
<ol>
<li><strong>å®šä¹‰æ­»ä¿¡äº¤æ¢æœº</strong>ï¼šåˆ›å»ºä¸€ä¸ªç”¨äºå¤„ç†æ­»ä¿¡çš„äº¤æ¢æœºã€‚</li>
<li><strong>å®šä¹‰æ­»ä¿¡é˜Ÿåˆ—</strong>ï¼šåˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ç”¨äºæ¥æ”¶æ­»ä¿¡ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°æ­»ä¿¡äº¤æ¢æœºã€‚</li>
<li><strong>é…ç½®ä¸»é˜Ÿåˆ—çš„æ­»ä¿¡äº¤æ¢æœºå±æ€§</strong>ï¼šåœ¨ä¸»é˜Ÿåˆ—ä¸Šè®¾ç½®å‚æ•°ï¼ŒæŒ‡å®šå½“æ¶ˆæ¯æ— æ³•æ­£å¸¸å¤„ç†æ—¶åº”è¯¥å‘é€åˆ°å“ªä¸ªæ­»ä¿¡äº¤æ¢æœºã€‚</li>
<li><strong>å‘é€æ¶ˆæ¯åˆ°ä¸»é˜Ÿåˆ—</strong>ï¼šç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°ä¸»äº¤æ¢æœºï¼Œè¿›è€Œè·¯ç”±åˆ°ä¸»é˜Ÿåˆ—ã€‚</li>
<li><strong>æ¶ˆè´¹ä¸»é˜Ÿåˆ—æ¶ˆæ¯</strong>ï¼šæ¶ˆè´¹è€…ä»ä¸»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†ã€‚å¦‚æœæ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œå®ƒå°†è¢«è·¯ç”±åˆ°æ­»ä¿¡äº¤æ¢æœºã€‚</li>
<li><strong>æ¶ˆè´¹æ­»ä¿¡é˜Ÿåˆ—æ¶ˆæ¯</strong>ï¼šè®¾ç½®æ¶ˆè´¹è€…æ¥å¤„ç†æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œè¿›è¡Œé”™è¯¯å¤„ç†æˆ–è®°å½•æ—¥å¿—ç­‰æ“ä½œã€‚</li>
</ol>
</blockquote>
<h4 id="mysqlå¦‚ä½•æå‡æ·±åˆ†é¡µæŸ¥è¯¢æ•ˆç‡å­æŸ¥è¯¢-ç´¢å¼•"><a href="#mysqlå¦‚ä½•æå‡æ·±åˆ†é¡µæŸ¥è¯¢æ•ˆç‡å­æŸ¥è¯¢-ç´¢å¼•" class="headerlink" title="mysqlå¦‚ä½•æå‡æ·±åˆ†é¡µæŸ¥è¯¢æ•ˆç‡å­æŸ¥è¯¢+ç´¢å¼•"></a>mysqlå¦‚ä½•æå‡æ·±åˆ†é¡µæŸ¥è¯¢æ•ˆç‡<del>å­æŸ¥è¯¢+ç´¢å¼•</del></h4><p><strong>ä½¿ç”¨ç´¢å¼•</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿æŸ¥è¯¢ä¸­ä½¿ç”¨çš„åˆ—ä¸Šæœ‰é€‚å½“çš„ç´¢å¼•ï¼Œè¿™æ ·å¯ä»¥åŠ å¿«æŸ¥æ‰¾é€Ÿåº¦ã€‚</li>
</ul>
<p>**é¿å…ä½¿ç”¨<code>OFFSET</code>å’Œ<code>LIMIT</code>**ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>OFFSET</code>è¿›è¡Œæ·±åˆ†é¡µæ—¶ï¼ŒMySQLéœ€è¦éå†æ‰€æœ‰<code>OFFSET</code>ä¹‹å‰çš„è¡Œã€‚å¯ä»¥é€šè¿‡è®°ä½ä¸Šä¸€æ¬¡æŸ¥è¯¢çš„æœ€å¤§IDæ¥é¿å…ä½¿ç”¨<code>OFFSET</code>ã€‚</li>
</ul>
<p><strong>ä½¿ç”¨æ¡ä»¶è¿‡æ»¤</strong>ï¼š</p>
<ul>
<li>å¦‚æœå¯èƒ½ï¼Œä½¿ç”¨WHEREå­å¥æ¥å‡å°‘éœ€è¦æ‰«æçš„æ•°æ®é‡ã€‚</li>
</ul>
<p><strong>å¢åŠ <code>LIMIT</code>çš„å¤§å°</strong>ï¼š</p>
<ul>
<li>å¦‚æœä¸šåŠ¡å…è®¸ï¼Œå¯ä»¥å¢åŠ æ¯æ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœé›†å¤§å°ï¼Œå‡å°‘åˆ†é¡µæ¬¡æ•°ã€‚</li>
</ul>
<p><strong>ç¼“å­˜</strong>ï¼š</p>
<ul>
<li>å¯¹äºä¸ç»å¸¸å˜æ›´çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜æ¥å­˜å‚¨å·²ç»æŸ¥è¯¢è¿‡çš„é¡µã€‚</li>
</ul>
<p><strong>ä½¿ç”¨<code>EXPLAIN</code>åˆ†ææŸ¥è¯¢</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>EXPLAIN</code>æ¥åˆ†ææŸ¥è¯¢è®¡åˆ’ï¼Œæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆå¹¶è¿›è¡Œä¼˜åŒ–ã€‚</li>
</ul>
<h4 id="èƒ½è¯´ä¸€ä¸‹å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ä»¥åŠå®ƒä»¬çš„å·®å¼‚å—"><a href="#èƒ½è¯´ä¸€ä¸‹å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ä»¥åŠå®ƒä»¬çš„å·®å¼‚å—" class="headerlink" title="èƒ½è¯´ä¸€ä¸‹å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ä»¥åŠå®ƒä»¬çš„å·®å¼‚å—"></a>èƒ½è¯´ä¸€ä¸‹å¸¸ç”¨çš„å­˜å‚¨å¼•æ“ä»¥åŠå®ƒä»¬çš„å·®å¼‚å—</h4><p><strong>InnoDB</strong>ï¼š<br>æ”¯æŒäº‹åŠ¡ã€è¡Œçº§é”å’Œå¤–é”®ã€‚<br>é€‚åˆå¤„ç†å¤§é‡çŸ­æœŸäº‹åŠ¡ã€‚<br>ä¸ºäº†ç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§ï¼Œå†™æ“ä½œç›¸å¯¹è¾ƒæ…¢</p>
<p><strong>MyISAM</strong>ï¼š</p>
<p>ä¸æ”¯æŒäº‹åŠ¡ã€ä¸æ”¯æŒè¡Œé”åªæ”¯æŒè¡¨é”<br>å¹¶å‘æ²¡é‚£ä¹ˆå¤§ äº‹åŠ¡è¦æ±‚æ²¡é‚£ä¹ˆé«˜å¯ä»¥ç”¨</p>
<h4 id="èƒ½è¯´ä¸€ä¸‹å€’æ’ç´¢å¼•çš„åŸç†å—ï¼Ÿ"><a href="#èƒ½è¯´ä¸€ä¸‹å€’æ’ç´¢å¼•çš„åŸç†å—ï¼Ÿ" class="headerlink" title="èƒ½è¯´ä¸€ä¸‹å€’æ’ç´¢å¼•çš„åŸç†å—ï¼Ÿ"></a>èƒ½è¯´ä¸€ä¸‹å€’æ’ç´¢å¼•çš„åŸç†å—ï¼Ÿ</h4><p>æ ¹æ®å‚ä¸æ–‡æ¡£ä¸­çš„å­—æ®µ è¦æ„å»ºå€’æ’å°±ä¼šå»åˆ†è¯<br>æ ¹æ®ç”¨æˆ·ç´¢å¼•ä¹Ÿä¼šåˆ†è¯ å°±ä¼šå»æŸ¥æ–‡æ¡£id å†å»æŸ¥æ–‡æ¡£<br>ä¸­æ–‡è¯åº“ä¸ºIK <del>(Ikun ä½ å¹²å˜› å“å“Ÿ~)</del></p>
<h4 id="esçš„textå’Œkeywordçš„åŒºåˆ«"><a href="#esçš„textå’Œkeywordçš„åŒºåˆ«" class="headerlink" title="esçš„textå’Œkeywordçš„åŒºåˆ«"></a>esçš„textå’Œkeywordçš„åŒºåˆ«</h4><h6 id="text"><a href="#text" class="headerlink" title="text"></a>text</h6><p>ç”¨äºå…¨æ–‡æœç´¢ï¼Œä¼šåˆ†è¯ï¼Œå­—ç¬¦ä¸²ç±»å‹</p>
<h6 id="keywod"><a href="#keywod" class="headerlink" title="keywod"></a>keywod</h6><p>ç”¨äºç²¾ç¡®æœç´¢å­—æ®µï¼Œä¸ä¼šè¢«åˆ†è¯ï¼Œå­—ç¬¦ä¸²ç±»å‹</p>
<h4 id="esåœ¨ä½ çš„é¡¹ç›®ä¸­æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„"><a href="#esåœ¨ä½ çš„é¡¹ç›®ä¸­æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„" class="headerlink" title="esåœ¨ä½ çš„é¡¹ç›®ä¸­æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„"></a>esåœ¨ä½ çš„é¡¹ç›®ä¸­æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„</h4><p>å¿«é€Ÿæœç´¢<del>å•†å“(Cç«¯)ã€è®¢å•(åå°)</del> + æ—¥å¿—æŸ¥è¯¢ + åœ°ç†ä½ç½®æœç´¢<del>ç»çº¬åº¦å®šä½é™„è¿‘çš„äº‹ç‰©</del></p>
<h4 id="mysqlå’ŒElasticSearchå¦‚ä½•åšæ•°æ®åŒæ­¥"><a href="#mysqlå’ŒElasticSearchå¦‚ä½•åšæ•°æ®åŒæ­¥" class="headerlink" title="mysqlå’ŒElasticSearchå¦‚ä½•åšæ•°æ®åŒæ­¥"></a>mysqlå’ŒElasticSearchå¦‚ä½•åšæ•°æ®åŒæ­¥</h4><p>mysqlè¿›è¡Œå¢åˆ æ”¹çš„æ—¶å€™<br>å¯¹æ•°æ®æ•æ„Ÿæ€§å®æ—¶æ€§è¦æ±‚æ²¡é‚£ä¹ˆé«˜ åªçœ‹<u>å¯é æ€§</u>[<strong>MQ</strong>å¼‚æ­¥  +  <strong>å®šæ—¶ä»»åŠ¡</strong>  &#x3D; æ²¡æœ‰é‚£ä¹ˆå¼ºä¸€è‡´æ€§]</p>
<h6 id="å¦‚æœæ•°æ®é‡æ²¡é‚£ä¹ˆå¤§-æœ‰æ²¡æœ‰å¿…è¦ä¸ŠESï¼Ÿ"><a href="#å¦‚æœæ•°æ®é‡æ²¡é‚£ä¹ˆå¤§-æœ‰æ²¡æœ‰å¿…è¦ä¸ŠESï¼Ÿ" class="headerlink" title="å¦‚æœæ•°æ®é‡æ²¡é‚£ä¹ˆå¤§ æœ‰æ²¡æœ‰å¿…è¦ä¸ŠESï¼Ÿ"></a>å¦‚æœæ•°æ®é‡æ²¡é‚£ä¹ˆå¤§ æœ‰æ²¡æœ‰å¿…è¦ä¸ŠESï¼Ÿ</h6><p>æ²¡æœ‰å¿…è¦ï¼Œæ­£æ’ç´¢å¼•ä¸èµ°å…¨è¡¨æ‰«æä¹Ÿè›®å¿«<br>ç»„é•¿è¿›è¡ŒæŠ€æœ¯é€‰å‹ è€ƒè™‘åˆ°ä»¥åçš„ä¸šåŠ¡å¢é•¿</p>
<h6 id="é¡¹ç›®å·²ç»ä¸Šçº¿äº†-ä½†æ˜¯ä¸­é€”æƒ³æ¢æˆES-æ€ä¹ˆåŠ"><a href="#é¡¹ç›®å·²ç»ä¸Šçº¿äº†-ä½†æ˜¯ä¸­é€”æƒ³æ¢æˆES-æ€ä¹ˆåŠ" class="headerlink" title="é¡¹ç›®å·²ç»ä¸Šçº¿äº† ä½†æ˜¯ä¸­é€”æƒ³æ¢æˆES æ€ä¹ˆåŠ"></a>é¡¹ç›®å·²ç»ä¸Šçº¿äº† ä½†æ˜¯ä¸­é€”æƒ³æ¢æˆES æ€ä¹ˆåŠ</h6><p>mysqlæ˜¯å…¨é‡æ•°æ® mqåªèƒ½åŒæ­¥å¢é‡æ•°æ® æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>æ–°ä¸Šæ¶çš„åªèƒ½åˆ°ES é‚£åº”è¯¥å¦‚ä½•ï¼Ÿ</p>
<p>æ­¤æ—¶æ¶‰åŠåˆ°å…¨é‡å’Œå¢é‡çš„åŒæ­¥<del>ä¸Redisä¸ä¸€æ ·</del><br>åŠ å®šæ—¶ä»»åŠ¡æ¯å‘¨&#x2F;æ¯å¤© ä¼šå®šæœŸé‡æ„ä¸€æ¬¡ç´¢å¼•åº“<del>æ™šä¸Šè·‘â†’å…œåº•æ¨¡å¼</del>ï¼Œå…¨é‡åŒæ­¥ï¼ŒåæœŸå†å¢é‡åŒæ­¥</p>
<h4 id="èƒ½è¯´ä¸€ä¸‹åˆ†è¯çš„åŸç†å—"><a href="#èƒ½è¯´ä¸€ä¸‹åˆ†è¯çš„åŸç†å—" class="headerlink" title="èƒ½è¯´ä¸€ä¸‹åˆ†è¯çš„åŸç†å—"></a>èƒ½è¯´ä¸€ä¸‹åˆ†è¯çš„åŸç†å—</h4><p>åº•å±‚æ˜¯å¤§æ•°æ®é‡çš„å†…å®¹ æ ‘çš„ç»“æ„æ¥æ„å»ºåˆ†è¯ IKï¼Œ<u>å­—ç¬¦åˆ†å‰²ã€è¯æ±‡è¯†åˆ«ã€è¿‡æ»¤åœç”¨è¯</u><br>ä¸å¥½æ„æ€é¢è¯•å®˜ å…·ä½“åº•å±‚åŸç†ä¸æ˜¯å¾ˆäº†è§£</p>
<h4 id="ä½¿ç”¨ESæœ‰é‡åˆ°ä»€ä¹ˆé—®é¢˜å—"><a href="#ä½¿ç”¨ESæœ‰é‡åˆ°ä»€ä¹ˆé—®é¢˜å—" class="headerlink" title="ä½¿ç”¨ESæœ‰é‡åˆ°ä»€ä¹ˆé—®é¢˜å—"></a>ä½¿ç”¨ESæœ‰é‡åˆ°ä»€ä¹ˆé—®é¢˜å—</h4><p>ç±»ä¼¼äºæ·±åˆ†é¡µï¼<br>æµ‹è¯•ç¯å¢ƒæ•°æ®é‡ä¸ä¼šå¾ˆå¤§ ç­‰åˆ°ä¸Šçº¿åæ‰ä¼šæœ‰è¿™ç§é—®é¢˜</p>
<h4 id="è¯´ä¸€ä¸‹jvmçš„å†…å­˜åŒºåŸŸï¼Œä»¥åŠæ¯ä¸ªåŒºåŸŸæ˜¯å¹²ä»€ä¹ˆçš„"><a href="#è¯´ä¸€ä¸‹jvmçš„å†…å­˜åŒºåŸŸï¼Œä»¥åŠæ¯ä¸ªåŒºåŸŸæ˜¯å¹²ä»€ä¹ˆçš„" class="headerlink" title="è¯´ä¸€ä¸‹jvmçš„å†…å­˜åŒºåŸŸï¼Œä»¥åŠæ¯ä¸ªåŒºåŸŸæ˜¯å¹²ä»€ä¹ˆçš„"></a>è¯´ä¸€ä¸‹jvmçš„å†…å­˜åŒºåŸŸï¼Œä»¥åŠæ¯ä¸ªåŒºåŸŸæ˜¯å¹²ä»€ä¹ˆçš„</h4><p>è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€ç¨‹åºè®¡æ•°å™¨ã€å…ƒç©ºé—´ã€å †</p>
<blockquote>
<h6 id="è¿è¡Œæ—¶æ•°æ®åŒº"><a href="#è¿è¡Œæ—¶æ•°æ®åŒº" class="headerlink" title="è¿è¡Œæ—¶æ•°æ®åŒº"></a>è¿è¡Œæ—¶æ•°æ®åŒº</h6><p><strong>è™šæ‹Ÿæœºæ ˆ</strong>ï¼šæ¯ä¸ªçº¿ç¨‹è¿è¡Œæ—¶æ‰€éœ€è¦çš„å†…å­˜(<u><strong>å…ˆè¿›åå‡º</strong></u>)<del>æ–¹æ³•è°ƒç”¨è¿‡ç¨‹</del>ã€‚æ¯ä¸ªæ ˆç”±å¤šä¸ªæ ˆå¸§ç»„æˆï¼Œå¯¹åº”ç€æ¯æ¬¡æ–¹æ³•è°ƒç”¨æ‰€å ç”¨çš„å†…å­˜ã€‚æ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªæ´»åŠ¨<strong>æ ˆå¸§</strong>ï¼Œå¯¹åº”ç€å½“å‰æ‰§è¡Œçš„é‚£ä¸ªæ–¹æ³•</p>
<p><strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>ï¼šä¸è™šæ‹Ÿæœºæ ˆç±»ä¼¼ï¼ŒåŒºåˆ«â†’è™šæ‹Ÿæœºæ ˆæ‰§è¡Œjavaæ–¹æ³•ï¼Œæœ¬åœ°æ–¹æ³•æ ˆæ‰§è¡Œnativeæ–¹æ³•ã€è¢«å°è£…çš„æ–¹æ³•  æ²¡æœ‰å…·ä½“å®ç°çš„ éƒ½å°è£…åœ¨javaè™šæ‹Ÿæœºä¸­ã€‘ä¸“é—¨å­˜å‚¨javaå†™çš„å±€éƒ¨æ–¹æ³•çš„å±€éƒ¨å˜é‡</p>
<p><strong>ç¨‹åºè®¡æ•°å™¨</strong>ï¼šæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤çš„è¡Œå·æŒ‡ç¤ºå™¨ åŒä¸€ä¸ªæ ¸æ˜¯é”™å³°å‡ºè¡Œ ä¼šä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¦ç”¨ç¨‹åºè®¡æ•°å™¨è®°å½•ä¸‹å½“å‰æ‰§è¡Œåˆ°å“ªé‡Œçš„ä»£ç </p>
<p><strong>å…ƒç©ºé—´</strong>ï¼šå…ƒç©ºé—´çš„æœ¬è´¨å’Œæ°¸ä¹…ä»£ç±»ä¼¼ï¼Œéƒ½æ˜¯å¯¹JVMè§„èŒƒä¸­æ–¹æ³•åŒºçš„å®ç°ã€‚æœ€å¤§åŒºåˆ«æ˜¯<strong>å…ƒç©ºé—´åœ¨æœ¬åœ°å†…å­˜</strong>ä¸­è€Œä¸æ˜¯è™šæ‹Ÿæœºä¸­ã€‚1.8ä»¥å‰å«æ°¸ä¹…ä»£   1.8åå«æ–¹æ³•åŒºæˆ–å…ƒç©ºé—´ ä¸€èˆ¬å­˜å‚¨ç±»å…ƒä¿¡æ¯ã€‚è¿˜ä¼šå­˜æœ‰è¿è¡Œæ—¶å¸¸é‡æ± ã€‚åœ¨é‡Œé¢è¿˜ä¼šå­˜æœ‰é™æ€å˜é‡</p>
<p><strong>å †å†…å­˜</strong>ï¼šæ˜¯JVMæ‰€æœ‰çº¿ç¨‹å…±äº«çš„éƒ¨åˆ†ï¼Œå”¯ä¸€ç”¨é€”æ˜¯æ¥ä¿å­˜å¯¹è±¡å®ä¾‹ã€æ•°ç»„ï¼›ç”±å¹´è½»ä»£å’Œè€å¹´ä»£ç»„æˆã€‚newä¸€ä¸ªéƒ½ä¼šå¼€å¯ä¸€ä¸ªç©ºé—´</p>
</blockquote>
<p><strong>ç±»åŠ è½½å™¨</strong>ï¼šç±»åŠ è½½å™¨ï¼ˆClass Loaderï¼‰è´Ÿè´£å°†ç±»çš„å­—èŠ‚ç æ–‡ä»¶ï¼ˆ.classæ–‡ä»¶ï¼‰åŠ è½½åˆ°JVMä¸­ï¼Œå¹¶è½¬åŒ–ä¸ºå¯¹åº”çš„<code>java.lang.Class</code>å¯¹è±¡ï¼Œä»¥ä¾›Javaç¨‹åºä½¿ç”¨ã€‚</p>
<p><strong>æ‰§è¡Œå¼•æ“</strong>ï¼šæ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰æ˜¯è´Ÿè´£æ‰§è¡Œå­—èŠ‚ç çš„æ ¸å¿ƒç»„ä»¶ã€‚æ‰§è¡Œå¼•æ“çš„ä½œç”¨æ˜¯è¯»å–å­—èŠ‚ç æŒ‡ä»¤ï¼Œå¯¹å®ƒä»¬è¿›è¡Œè§£æå¹¶æ‰§è¡Œï¼Œä»è€Œå®ç°Javaç¨‹åºçš„åŠŸèƒ½</p>
<p><strong>æœ¬åœ°åº“æ¥å£</strong>ï¼šæ˜¯Javaè™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå…è®¸Javaç¨‹åºè°ƒç”¨å…¶ä»–è¯­è¨€ç¼–å†™çš„æœ¬åœ°åº”ç”¨ç¨‹åºå’Œåº“ï¼ˆé€šå¸¸æ˜¯Cæˆ–C++ï¼‰ã€‚è¿™æ˜¯å› ä¸ºJavaæœ¬èº«è®¾è®¡ä¸ºå¹³å°æ— å…³çš„è¯­è¨€ï¼Œä½†å®ƒæœ‰æ—¶éœ€è¦ä¸ç‰¹å®šå¹³å°çš„åº•å±‚ç³»ç»Ÿæˆ–ç¡¬ä»¶è¿›è¡Œäº¤äº’ï¼Œè€Œè¿™é€šå¸¸æ˜¯é€šè¿‡æœ¬åœ°ä»£ç å®ç°çš„ã€‚</p>
<p><strong>ç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰</strong>ï¼šç›´æ¥å†…å­˜å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯Javaè™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸã€‚ä½†æ˜¯è¿™éƒ¨åˆ†å†…å­˜ä¹Ÿè¢«é¢‘ç¹åœ°ä½¿ç”¨ï¼Œè€Œä¸”ä¹Ÿå¯èƒ½å¯¼è‡´OutOfMemoryErrorå¼‚å¸¸å‡ºç°ã€‚åœ¨JDK 1.4ä¸­æ–°åŠ å…¥äº†NIOï¼ˆNew Input&#x2F;Outputï¼‰ç±»ï¼Œå¼•å…¥äº†ä¸€ç§åŸºäºé€šé“ï¼ˆChannelï¼‰ä¸ç¼“å†²åŒºï¼ˆBufferï¼‰çš„I&#x2F;Oæ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨Nativeå‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †ä¸­çš„DirectByteBufferå¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚</p>
<h4 id="è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•-ä»–ä»¬çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³•-ä»–ä»¬çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³• ä»–ä»¬çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶ç®—æ³• ä»–ä»¬çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p><strong>æ ‡è®°æ¸…é™¤ç®—æ³•</strong>ï¼šå°†åƒåœ¾å›æ”¶åˆ†ä¸º2ä¸ªé˜¶æ®µï¼Œæ ‡è®°å’Œæ¸…é™¤ã€‚å†…å­˜ç¢ç‰‡é«˜ï¼Œæ•ˆç‡é«˜ï¼Œæ¸…é™¤å¿«<br><strong>æ ‡è®°æ•´ç†ç®—æ³•</strong>ï¼šä¸€èˆ¬ç”¨äºè€å¹´ä»£ï¼Œå°†å­˜æ´»çš„å¯¹è±¡éƒ½å‘å¦ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç†è¾¹ç•Œä»¥å¤–çš„åƒåœ¾ã€‚[å¯¹è±¡è¦ç§»åŠ¨,æ•ˆç‡ä½]ï¼Œæ•ˆç‡æ…¢ä¸€äº› éœ€è¦æŠŠå†…å­˜ç¢ç‰‡ç§»åŠ¨ï¼Œå†…å­˜ç¢ç‰‡æ²¡æœ‰ ä½†æ˜¯æ•ˆç‡ä½ä¸€ç‚¹<br><strong>å¤åˆ¶ç®—æ³•</strong>ï¼šå°†åŸæœ‰çš„å†…å­˜ç©ºé—´ä¸€åˆ†ä¸ºäºŒï¼Œæ¯æ¬¡åªç”¨å…¶ä¸­ä¸€å—ï¼Œæ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªå†…å­˜ä¸­ï¼Œç„¶åå°†è¯¥å†…å­˜ç©ºé—´æ¸…ç©ºï¼Œäº¤æ¢ä¸¤ä¸ªå†…å­˜çš„è§’è‰²ï¼Œå®Œæˆåƒåœ¾å›æ”¶ã€‚</p>
<p><u>è¢«æ ‡è®°çš„æ˜¯æ²¡æœ‰è¢«å›æ”¶çš„</u></p>
<h4 id="è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶å™¨ä»¥åŠä»–ä»¬çš„ç‰¹ç‚¹åƒåœ¾æ”¶é›†å™¨æ˜¯åƒåœ¾æ”¶é›†ç®—æ³•çš„å…·ä½“å®ç°"><a href="#è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶å™¨ä»¥åŠä»–ä»¬çš„ç‰¹ç‚¹åƒåœ¾æ”¶é›†å™¨æ˜¯åƒåœ¾æ”¶é›†ç®—æ³•çš„å…·ä½“å®ç°" class="headerlink" title="è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶å™¨ä»¥åŠä»–ä»¬çš„ç‰¹ç‚¹åƒåœ¾æ”¶é›†å™¨æ˜¯åƒåœ¾æ”¶é›†ç®—æ³•çš„å…·ä½“å®ç°"></a>è¯´ä¸€ä¸‹å¸¸è§çš„åƒåœ¾å›æ”¶å™¨ä»¥åŠä»–ä»¬çš„ç‰¹ç‚¹<del>åƒåœ¾æ”¶é›†å™¨æ˜¯åƒåœ¾æ”¶é›†ç®—æ³•çš„å…·ä½“å®ç°</del></h4><p><strong>ä¸²è¡Œ</strong>åƒåœ¾æ”¶é›†å™¨[æ–°ç”Ÿä»£åŒº]ï¼šæŒ‡ä½¿ç”¨<strong>å•çº¿ç¨‹</strong>è¿›è¡Œåƒåœ¾å›æ”¶(ç”¨æˆ·è¯·æ±‚ä¸èƒ½è®¿é—®<del>STW</del>)ï¼Œå †å†…å­˜è¾ƒå°é€‚åˆä¸ªäººç”µè„‘ã€‚åº•å±‚ç”¨çš„<strong>å¤åˆ¶ç®—æ³•</strong><br><strong>å¹¶è¡Œ</strong>åƒåœ¾æ”¶é›†å™¨ï¼šJDK8é»˜è®¤ä½¿ç”¨æ­¤åƒåœ¾å›æ”¶å™¨ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œ<strong>å¤šä¸ªçº¿ç¨‹</strong>åœ¨å·¥ä½œ(ç”¨æˆ·è¯·æ±‚ä¸èƒ½è®¿é—®<del>STW</del>)ï¼Œå¹¶ä¸”javaåº”ç”¨ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½è¦æš‚åœï¼Œç­‰å¾…åƒåœ¾å›æ”¶çš„å®Œæˆã€‚åº•å±‚ç”¨çš„<strong>å¤åˆ¶ç®—æ³•</strong><br><strong>CMS</strong>(å¹¶å‘[Concurrent Mark Sweep])åƒåœ¾æ”¶é›†å™¨ï¼šæ˜¯ä¸€æ¬¾å¹¶å‘çš„ã€ä½¿ç”¨æ ‡è®°â€”æ¸…é™¤ç®—æ³•çš„åƒåœ¾å›æ”¶å™¨(é’ˆå¯¹è€å¹´ä»£)   <u>åˆå§‹æ ‡è®° â†’ å¹¶å‘æ ‡è®° â†’ å¹¶å‘é¢„æ¸…ç† â†’ æœ€ç»ˆæ ‡è®° â†’ å¹¶å‘æ¸…é™¤ â†’ å¹¶å‘é‡ç½®</u>  å°äº8Gå†…å­˜ç”¨CMS  ä¸€èˆ¬ç”¨å¹¶å‘åƒåœ¾æ”¶é›†å™¨é…åˆæ”¶é›†å¹´è½»å°å†…å­˜<br><strong>G1</strong>åƒåœ¾æ”¶é›†å™¨[å¤åˆ¶ç®—æ³•]ï¼šEden(2M)ã€æœ€å¤§å›æ”¶åœé¡¿æ—¶é—´ã€å¤§å†…å­˜é€‚åˆç”¨G1ã€å¤§äº8Gå†…å­˜ç”¨G1</p>
<h4 id="è¯´ä¸€ä¸‹cmsçš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹CMSä¸€èˆ¬éƒ½æ¸…ç†è€å¹´ä»£"><a href="#è¯´ä¸€ä¸‹cmsçš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹CMSä¸€èˆ¬éƒ½æ¸…ç†è€å¹´ä»£" class="headerlink" title="è¯´ä¸€ä¸‹cmsçš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹CMSä¸€èˆ¬éƒ½æ¸…ç†è€å¹´ä»£"></a>è¯´ä¸€ä¸‹cmsçš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹<del>CMSä¸€èˆ¬éƒ½æ¸…ç†è€å¹´ä»£</del></h4><p>è¿‡ç¨‹ï¼šåˆå§‹æ ‡è®° â†’ å¹¶å‘æ ‡è®° â†’ å¹¶å‘é¢„æ¸…ç† â†’ æœ€ç»ˆæ ‡è®° â†’ å¹¶å‘æ¸…é™¤ â†’ å¹¶å‘é‡ç½®<br>æ˜¯ä¸€æ¬¾ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ï¼Œåœé¡¿æ—¶é—´çŸ­ï¼Œç”¨æˆ·ä½“éªŒå°±å¥½ã€‚<br>å…¶æœ€å¤§ç‰¹ç‚¹æ˜¯åœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œåº”ç”¨ä»ç„¶èƒ½æ­£å¸¸è¿è¡Œ</p>
<p><strong>åˆå§‹æ ‡è®°</strong>ï¼šæ‰¾GCRootæ ¹å»çš„ç¬¬ä¸€å±‚å¯¹è±¡[STW] é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ã€‚ä¸ºä»€ä¹ˆSTWï¼Ÿå¦‚æœæ‰¾çš„æ—¶å€™åŒæ—¶ä¹Ÿè¦æ ‡è®° é‚£ä¹ˆè‹¥è¿™æ—¶å€™æœ‰çš„æœªè¢«æ ‡è®°é‚£å°±æœ‰å¤§BUGã€‚<br><strong>å¹¶å‘æ ‡è®°</strong>ï¼šä»ç¬¬ä¸€å±‚æ‰¾åˆ°åçš„ä¹‹åé‚£äº›å¯¹è±¡ä¸èƒ½è¢«å›æ”¶(CMSå›æ”¶å™¨ä¼šéå†è€å¹´ä»£ï¼Œæ ‡è®°å‡ºæ‰€æœ‰æ´»åŠ¨çš„å¯¹è±¡)ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µï¼Œåº”ç”¨ç¨‹åºçº¿ç¨‹ä¸åƒåœ¾å›æ”¶çº¿ç¨‹å¹¶å‘è¿è¡Œ[èƒ½æ¥æ”¶ç”¨æˆ·è¯·æ±‚]ï¼Œä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡ã€‚<br><strong>å¹¶å‘é¢„æ¸…ç†</strong>ï¼šè¿™ä¸ªé˜¶æ®µä¹Ÿæ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œç›®çš„æ˜¯å¤„ç†åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µåº”ç”¨ç¨‹åºçº¿ç¨‹äº§ç”Ÿçš„æ–°åƒåœ¾ï¼ŒCMSå›æ”¶å™¨ä¼šæ¸…ç†é‚£äº›åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µè¢«ä¿®æ”¹çš„å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œä¸€äº›é¢„æ¸…ç†å·¥ä½œï¼Œä»¥å‡å°‘ä¸‹ä¸€ä¸ªSTWé˜¶æ®µçš„æš‚åœæ—¶é—´ã€‚<br><strong>æœ€ç»ˆæ ‡è®°</strong>ï¼šè¿™ä¸ªé˜¶æ®µæ˜¯STWçš„ï¼Œå®ƒæ˜¯ä¸ºäº†å¤„ç†åœ¨å¹¶å‘æ ‡è®°å’Œå¹¶å‘é¢„æ¸…ç†é˜¶æ®µæœªè¢«å¤„ç†çš„å¯¹è±¡ã€‚CMSå›æ”¶å™¨ä¼šå®Œæˆæ‰€æœ‰å‰©ä½™çš„æ ‡è®°å·¥ä½œï¼Œç¡®ä¿æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½è¢«æ­£ç¡®æ ‡è®°<br><strong>å¹¶å‘æ¸…é™¤</strong>ï¼šåœ¨è¿™ä¸ªé˜¶æ®µï¼Œåº”ç”¨ç¨‹åºçº¿ç¨‹ä¸åƒåœ¾å›æ”¶çº¿ç¨‹å†æ¬¡å¹¶å‘è¿è¡Œã€‚CMSå›æ”¶å™¨ä¼šæ¸…é™¤æœªè¢«æ ‡è®°çš„å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ã€‚æ¸…é™¤è¿‡ç¨‹ä¸­ä¸ä¼šç§»åŠ¨å­˜æ´»å¯¹è±¡ï¼Œå› æ­¤å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚<br><strong>å¹¶å‘é‡ç½®</strong>ï¼šè¿™ä¸ªé˜¶æ®µæ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œç›®çš„æ˜¯é‡ç½®CMSæ•°æ®ç»“æ„ï¼Œä¸ºä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶åšå‡†å¤‡ã€‚</p>
<h4 id="è¯´ä¸€ä¸‹g1çš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹ï¼Œ"><a href="#è¯´ä¸€ä¸‹g1çš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹ï¼Œ" class="headerlink" title="è¯´ä¸€ä¸‹g1çš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹ï¼Œ"></a>è¯´ä¸€ä¸‹g1çš„å„ä¸ªé˜¶æ®µè¿‡ç¨‹ä»¥åŠç‰¹ç‚¹ï¼Œ</h4><p>åˆ’åˆ†æˆå¤šä¸ªåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸéƒ½å¯ä»¥å……å½“edenï¼Œsurvivorï¼Œoldï¼Œhumongousï¼Œå…¶ä¸­<code>humongous</code>ä¸“ä¸ºå¤§å¯¹è±¡å‡†å¤‡<br>åˆ†æˆä¸‰ä¸ªé˜¶æ®µï¼šæ–°ç”Ÿä»£å›æ”¶(STW)ã€å¹¶å‘æ ‡è®°(é‡æ–°æ ‡è®°STW)ã€æ··åˆæ”¶é›†ã€‚å¦‚æœå¹¶å‘å¤±è´¥(å³å›æ”¶é€Ÿåº¦èµ¶ä¸ä¸Šåˆ›å»ºæ–°å¯¹è±¡é€Ÿåº¦)ï¼Œå°±ä¼šè§¦å‘<code>Full GC</code></p>
<h4 id="ä½ ä»¬é¡¹ç›®æ˜¯ç”¨å“ªä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ª"><a href="#ä½ ä»¬é¡¹ç›®æ˜¯ç”¨å“ªä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ª" class="headerlink" title="ä½ ä»¬é¡¹ç›®æ˜¯ç”¨å“ªä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ª?"></a>ä½ ä»¬é¡¹ç›®æ˜¯ç”¨å“ªä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ª?</h4><p>æ¯ä¸ªæœåŠ¡ä¸¤ä¸ªèŠ‚ç‚¹ 8G4æ ¸ ç”¨CMS å¤ªå¤§å°±ç”¨G1</p>
<h4 id="ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«æˆä¸ºåƒåœ¾å¯¹è±¡ï¼Ÿ"><a href="#ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«æˆä¸ºåƒåœ¾å¯¹è±¡ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«æˆä¸ºåƒåœ¾å¯¹è±¡ï¼Ÿ"></a>ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«æˆä¸ºåƒåœ¾å¯¹è±¡ï¼Ÿ</h4><p>å¦‚æœä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡æ²¡æœ‰ä»»ä½•çš„å¼•ç”¨æŒ‡å‘å®ƒäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ç°åœ¨å°±æ˜¯åƒåœ¾ï¼Œå¦‚æœå®šä½äº†åƒåœ¾ï¼Œåˆ™æœ‰å¯èƒ½ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶</p>
<h6 id="æ€ä¹ˆç¡®å®šä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ"><a href="#æ€ä¹ˆç¡®å®šä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ" class="headerlink" title="æ€ä¹ˆç¡®å®šä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ"></a>æ€ä¹ˆç¡®å®šä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ</h6><ul>
<li><p><strong>å¼•ç”¨è®¡æ•°æ³•</strong><br>ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨äº†ä¸€æ¬¡ï¼Œåœ¨å½“å‰çš„å¯¹è±¡å¤´ä¸Šé€’å¢ä¸€æ¬¡å¼•ç”¨æ¬¡æ•°ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨æ¬¡æ•°ä¸º0ï¼Œä»£è¡¨è¿™ä¸ªå¯¹è±¡å¯å›æ”¶</p>
</li>
<li><p><strong>å¯è¾¾æ€§åˆ†æç®—æ³•</strong></p>
<ol>
<li><strong>æ ‡è®°é˜¶æ®µ</strong>ï¼šä»GCRootså¼€å§‹ï¼Œæ ‡è®°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ã€‚</li>
<li><strong>å›æ”¶é˜¶æ®µ</strong>ï¼šéå†å †ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œå›æ”¶é‚£äº›æœªè¢«æ ‡è®°çš„å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ã€‚</li>
</ol>
<p>é‡‡ç”¨çš„éƒ½æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•æ¥ç¡®å®šå“ªäº›å†…å®¹æ˜¯åƒåœ¾</p>
<p>é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•ï¼Œé‚£äº›ä»ä»»ä½•GCRootséƒ½æ— æ³•åˆ°è¾¾çš„å¯¹è±¡è¢«è®¤ä¸ºæ˜¯ä¸å¯è¾¾çš„ï¼Œå› æ­¤å¯ä»¥è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚è¿™ç§æ–¹æ³•èƒ½å¤Ÿå¤„ç†å¾ªç¯å¼•ç”¨çš„æƒ…å†µï¼Œè¿™æ˜¯å¼•ç”¨è®¡æ•°æ³•æ‰€æ— æ³•è§£å†³çš„</p>
</li>
</ul>
<p>é™æ€çš„æˆå‘˜å˜é‡[å…ƒç©ºé—´ åŸºæœ¬ä¸ä¼šè¢«å›æ”¶] å±€éƒ¨å˜é‡ æˆå‘˜å±æ€§ </p>
<h4 id="è¯´ä¸€ä¸‹åŒäº²å§”æ´¾æœºåˆ¶ä»¥åŠä¼˜ç‚¹"><a href="#è¯´ä¸€ä¸‹åŒäº²å§”æ´¾æœºåˆ¶ä»¥åŠä¼˜ç‚¹" class="headerlink" title="è¯´ä¸€ä¸‹åŒäº²å§”æ´¾æœºåˆ¶ä»¥åŠä¼˜ç‚¹"></a>è¯´ä¸€ä¸‹åŒäº²å§”æ´¾æœºåˆ¶ä»¥åŠä¼˜ç‚¹</h4><p>åŠ è½½æŸä¸€ä¸ªç±»ï¼Œå…ˆå§”æ‰˜ä¸Šä¸€çº§çš„åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œå¦‚æœä¸Šçº§åŠ è½½å™¨ä¹Ÿæœ‰ä¸Šçº§ï¼Œåˆ™ä¼šç»§ç»­å‘ä¸Šå§”æ‰˜ï¼Œå¦‚æœè¯¥ç±»å§”æ‰˜ä¸Šçº§æ²¡æœ‰è¢«åŠ è½½ï¼Œå­åŠ è½½å™¨å°è¯•åŠ è½½è¯¥ç±»<br>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é€šè¿‡åŒäº²å§”æ´¾æœºåˆ¶å¯ä»¥é¿å…æŸä¸€ä¸ªç±»è¢«é‡å¤åŠ è½½ï¼Œå½“çˆ¶ç±»å·²ç»åŠ è½½ååˆ™æ— éœ€é‡å¤åŠ è½½ï¼Œä¿è¯å”¯ä¸€æ€§</li>
<li>ä¸ºäº†å®‰å…¨ï¼Œä¿è¯ç±»åº“APIä¸ä¼šè¢«ä¿®æ”¹</li>
</ul>
<p>ç”¨ç›¸åŒçš„åŠ è½½å™¨åœ¨åŒä¸€ä¸ªè·¯å¾„ä¸‹åªèƒ½ç”¨åŒä¸€ä¸ªè·¯å¾„çš„ç±» ç”¨ä¸åŒçš„åŠ è½½å™¨å°±å¯ä»¥åŠ è½½</p>
<h6 id="å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"><a href="#å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ"></a>å¦‚ä½•æ‰“ç ´åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ</h6><p><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼š</p>
<ul>
<li><p>é€šè¿‡<strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼Œå¹¶é‡å†™<code>loadClass</code>æ–¹æ³•ï¼Œå¯ä»¥å®ç°åœ¨åŠ è½½ç±»æ—¶ä¸éµå¾ªåŒäº²å§”æ´¾æ¨¡å‹ã€‚åœ¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥å°è¯•åŠ è½½ç±»ï¼Œè€Œä¸æ˜¯å…ˆå§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨ã€‚</p>
<pre><code class="java">public class CustomClassLoader extends ClassLoader &#123;
    @Override
    public Class&lt;?&gt; loadClass(String name) throws ClassNotFoundException &#123;
        // ç›´æ¥åŠ è½½ï¼Œä¸å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨
        return findClass(name);
    &#125;
&#125;
</code></pre>
</li>
</ul>
<h4 id="jvmå¸¸ç”¨çš„å‚æ•°æœ‰å“ªäº›ï¼Ÿä»£è¡¨ä»€ä¹ˆæ„æ€"><a href="#jvmå¸¸ç”¨çš„å‚æ•°æœ‰å“ªäº›ï¼Ÿä»£è¡¨ä»€ä¹ˆæ„æ€" class="headerlink" title="jvmå¸¸ç”¨çš„å‚æ•°æœ‰å“ªäº›ï¼Ÿä»£è¡¨ä»€ä¹ˆæ„æ€"></a>jvmå¸¸ç”¨çš„å‚æ•°æœ‰å“ªäº›ï¼Ÿä»£è¡¨ä»€ä¹ˆæ„æ€</h4><p>jps è¿›ç¨‹çŠ¶æ€ä¿¡æ¯<br>jstack æŸ¥çœ‹è¿›ç¨‹å†…çº¿ç¨‹çš„å †æ ˆä¿¡æ¯(äº§ç”Ÿæ­»é”ä¹Ÿå¯ä»¥æŸ¥çœ‹)<br>jmap æŸ¥çœ‹å †æ ˆä¿¡æ¯(ç”Ÿæˆå †æ ˆå†…å­˜å¿«ç…§ï¼Œå†…å­˜ä½¿ç”¨ä¿¡æ¯)<br>jhat å †è½¬å­˜å¿«ç…§åˆ†æå·¥å…·<br>jstat JVMç»Ÿè®¡ç›‘æµ‹å·¥å…·</p>
<ol>
<li><code>-Xms</code> å’Œ <code>-Xmx</code>ï¼š<ul>
<li><code>-Xms</code>ï¼šè®¾ç½®JVMå †å†…å­˜çš„åˆå§‹å¤§å°ï¼ˆæœ€å°å€¼ï¼‰ã€‚</li>
<li><code>-Xmx</code>ï¼šè®¾ç½®JVMå †å†…å­˜çš„æœ€å¤§å¤§å°ã€‚</li>
</ul>
</li>
<li><code>-Xss</code>ï¼š<ul>
<li>è®¾ç½®æ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å°ã€‚</li>
</ul>
</li>
<li><code>-XX:NewSize</code> å’Œ <code>-XX:MaxNewSize</code>ï¼š<ul>
<li><code>-XX:NewSize</code>ï¼šè®¾ç½®æ–°ç”Ÿä»£å†…å­˜çš„åˆå§‹å¤§å°ã€‚</li>
<li><code>-XX:MaxNewSize</code>ï¼šè®¾ç½®æ–°ç”Ÿä»£å†…å­˜çš„æœ€å¤§å¤§å°ã€‚</li>
</ul>
</li>
<li><code>-XX:SurvivorRatio</code>ï¼š<ul>
<li>è®¾ç½®æ–°ç”Ÿä»£ä¸­EdenåŒºä¸SurvivoråŒºçš„å®¹é‡æ¯”ä¾‹ã€‚</li>
</ul>
</li>
<li><code>-XX:PermSize</code> å’Œ <code>-XX:MaxPermSize</code>ï¼ˆJava 8åŠä¹‹å‰ç‰ˆæœ¬ï¼‰ï¼š<ul>
<li><code>-XX:PermSize</code>ï¼šè®¾ç½®æ°¸ä¹…ä»£ï¼ˆæ–¹æ³•åŒºï¼‰çš„åˆå§‹å¤§å°ã€‚</li>
<li><code>-XX:MaxPermSize</code>ï¼šè®¾ç½®æ°¸ä¹…ä»£çš„æœ€å¤§å¤§å°ã€‚</li>
</ul>
</li>
<li>è®¾ç½®å…ƒç©ºé—´å¤§å°<ol>
<li><code>-XX:MetaspaceSize</code>ï¼š<ul>
<li>è®¾ç½®å…ƒç©ºé—´çš„åˆå§‹å¤§å°ã€‚å½“å…ƒç©ºé—´è€—å°½æ—¶ï¼ŒJVMä¼šå°è¯•æ‰©å±•å…ƒç©ºé—´çš„å¤§å°ï¼Œç›´åˆ°è¾¾åˆ°æœ€å¤§å€¼ï¼ˆå¦‚æœè®¾ç½®äº†çš„è¯ï¼‰ã€‚</li>
</ul>
</li>
<li><code>-XX:MaxMetaspaceSize</code>ï¼š<ul>
<li>è®¾ç½®å…ƒç©ºé—´çš„æœ€å¤§å¤§å°ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸ªå‚æ•°ï¼Œå…ƒç©ºé—´çš„å¤§å°åªå—æœ¬åœ°å†…å­˜é™åˆ¶ã€‚</li>
</ul>
</li>
</ol>
</li>
</ol>
<h4 id="å››å¤§å¼•ç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ"><a href="#å››å¤§å¼•ç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ" class="headerlink" title="å››å¤§å¼•ç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ"></a>å››å¤§å¼•ç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Ÿ</h4><p><strong>å¼ºå¼•ç”¨</strong>ï¼šåªè¦æ‰€æœ‰ GC Roots èƒ½æ‰¾åˆ°ï¼Œå°±ä¸ä¼šè¢«å›æ”¶ã€‚<br><strong>è½¯å¼•ç”¨</strong>ï¼šéœ€è¦é…åˆ<code>SoftReference</code>ä½¿ç”¨ï¼Œå½“åƒåœ¾å¤šæ¬¡å›æ”¶ï¼Œ<strong>å†…å­˜ä¾ç„¶ä¸å¤Ÿ</strong>æ—¶å€™ä¼šå›æ”¶è½¯å¼•ç”¨å¯¹è±¡<br><strong>å¼±å¼•ç”¨</strong>ï¼šéœ€è¦é…åˆ<code>WeakReference</code>ä½¿ç”¨ï¼Œ<strong>åªè¦è¿›è¡Œäº†åƒåœ¾å›æ”¶</strong>ï¼Œå°±ä¼šæŠŠå¼•ç”¨å¯¹è±¡å›æ”¶<br><strong>è™šå¼•ç”¨</strong>ï¼šå¿…é¡»é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨ï¼Œè¢«å¼•ç”¨å¯¹è±¡å›æ”¶æ—¶ï¼Œä¼šå°†è™šå¼•ç”¨å…¥é˜Ÿç”± <code>Reference Handler</code> çº¿ç¨‹è°ƒç”¨è™šå¼•ç”¨ç›¸å…³æ–¹æ³•é‡Šæ”¾ç›´æ¥å†…å­˜</p>
<p>â— å¼ºå¼•ç”¨æŒ‡çš„å°±æ˜¯ä»£ç ä¸­æ™®éå­˜åœ¨çš„èµ‹å€¼æ–¹å¼ï¼Œæ¯”å¦‚A ä½†æ˜¯ä¸a &#x3D; new A()è¿™ç§ã€‚å¼ºå¼•ç”¨å…³è”çš„å¯¹è±¡ï¼Œæ°¸è¿œä¸ä¼šè¢«GCå›æ”¶ã€‚<br>â— è½¯å¼•ç”¨å¯ä»¥ç”¨SoftReferenceæ¥æè¿°ï¼ŒæŒ‡çš„æ˜¯é‚£äº›æœ‰ç”¨æ˜¯å¿…é¡»è¦çš„å¯¹è±¡ã€‚ç³»ç»Ÿåœ¨å‘ç”Ÿå†…å­˜æº¢å‡ºå‰ä¼šå¯¹è¿™ç±»å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚<br>â— å¼±å¼•ç”¨å¯ä»¥ç”¨WeakReferenceæ¥æè¿°ï¼Œä»–çš„å¼ºåº¦æ¯”è½¯å¼•ç”¨æ›´ä½ä¸€ç‚¹ï¼Œåªè¦è¿›è¡Œäº†åƒåœ¾å›æ”¶ï¼Œå°±ä¼šæŠŠå¼•ç”¨å¯¹è±¡å›æ”¶ã€‚<br>â— è™šå¼•ç”¨ä»–å¿…é¡»å’ŒReferenceQueueä¸€èµ·ä½¿ç”¨ï¼Œå¿…é¡»é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨ï¼Œè¢«å¼•ç”¨å¯¹è±¡å›æ”¶æ—¶ï¼Œ<br>ä¼šå°†è™šå¼•ç”¨å…¥é˜Ÿç”± <code>Reference Handler</code> çº¿ç¨‹è°ƒç”¨è™šå¼•ç”¨ç›¸å…³æ–¹æ³•é‡Šæ”¾ç›´æ¥å†…å­˜ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯å†…å­˜æº¢å‡ºï¼Ÿä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å†…å­˜æº¢å‡ºï¼Ÿä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å†…å­˜æº¢å‡ºï¼Ÿä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å†…å­˜æº¢å‡ºï¼Ÿä»€ä¹ˆæ˜¯å†…å­˜æ³„éœ²ï¼Ÿ</h4><p><strong>å†…å­˜æº¢å‡º</strong>ï¼šå†…å­˜æº¢å‡ºæ˜¯æŒ‡ç¨‹åºåœ¨ç”³è¯·å†…å­˜æ—¶ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ä¾›å…¶ä½¿ç”¨ï¼Œå¯¼è‡´æ‰€éœ€è¦çš„å†…å­˜è¶…å‡ºäº†ç³»ç»Ÿæ‰€èƒ½æä¾›çš„æœ€å¤§å†…å­˜ã€‚ã€ä¼šå…ˆè¿›è¡Œä¸€æ¬¡GCå®åœ¨ä¸å¤Ÿå°±OOM å †\æ ˆ(é€’å½’è¿‡å¤š,å±€éƒ¨å˜é‡è¿‡å¤š)\æ–¹æ³•åŒºéƒ½æœ‰å¯èƒ½å‘ç”Ÿå†…å­˜æº¢å‡ºã€‘<br><strong>å†…å­˜æ³„éœ²</strong><del>ThreadLocalä¼šå¯¼è‡´(æœªåŠæ—¶é‡Šæ”¾)</del>ï¼šå†…å­˜æ³„éœ²æ˜¯æŒ‡ç¨‹åºä¸­å·²åˆ†é…çš„å†…å­˜ç”±äºæŸç§åŸå› æœªèƒ½é‡Šæ”¾ï¼Œå³ä½¿åœ¨ä¸å†éœ€è¦è¿™äº›å†…å­˜çš„æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä»ç„¶ä¿æŒåˆ†é…çŠ¶æ€ï¼Œå¯¼è‡´å¯ç”¨å†…å­˜é€æ¸å‡å°‘</p>
<h4 id="ä½ çš„é¡¹ç›®ä¸­å‡ºç°è¿‡å†…å­˜æ³„æ¼å—ï¼Ÿä½ æ˜¯æ€ä¹ˆæ’æŸ¥å¹¶ä¸”è§£å†³çš„ï¼Ÿ"><a href="#ä½ çš„é¡¹ç›®ä¸­å‡ºç°è¿‡å†…å­˜æ³„æ¼å—ï¼Ÿä½ æ˜¯æ€ä¹ˆæ’æŸ¥å¹¶ä¸”è§£å†³çš„ï¼Ÿ" class="headerlink" title="ä½ çš„é¡¹ç›®ä¸­å‡ºç°è¿‡å†…å­˜æ³„æ¼å—ï¼Ÿä½ æ˜¯æ€ä¹ˆæ’æŸ¥å¹¶ä¸”è§£å†³çš„ï¼Ÿ"></a>ä½ çš„é¡¹ç›®ä¸­å‡ºç°è¿‡å†…å­˜æ³„æ¼å—ï¼Ÿä½ æ˜¯æ€ä¹ˆæ’æŸ¥å¹¶ä¸”è§£å†³çš„ï¼Ÿ</h4><p>æœ‰çš„ï¼Œå†…å­˜æ³„æ¼é€šå¸¸æ˜¯æŒ‡å †å†…å­˜ï¼Œé€šå¸¸æ˜¯æŒ‡ä¸€äº›å¤§å¯¹è±¡ä¸è¢«å›æ”¶çš„æƒ…å†µ<br>1ã€é€šè¿‡jmapæˆ–è®¾ç½®jvmå‚æ•°è·å–å †å†…å­˜å¿«ç…§dump<br>2ã€é€šè¿‡å·¥å…·ï¼ŒVisualVMå»åˆ†ædumpæ–‡ä»¶ï¼ŒVisualVMå¯ä»¥åŠ è½½ç¦»çº¿çš„dumpæ–‡ä»¶<br>3ã€é€šè¿‡æŸ¥çœ‹å †ä¿¡æ¯çš„æƒ…å†µï¼Œå¯ä»¥å¤§æ¦‚å®šä½å†…å­˜æº¢å‡ºæ˜¯å“ªè¡Œä»£ç å‡ºäº†é—®é¢˜<br>4ã€æ‰¾åˆ°å¯¹åº”çš„ä»£ç ï¼Œé€šè¿‡é˜…è¯»ä¸Šä¸‹æ–‡çš„æƒ…å†µï¼Œè¿›è¡Œä¿®å¤å³å¯</p>
<p>å¼‚å¸¸çš„ç¥–å…ˆæ˜¯ï¼š<code>Throwable</code></p>
<h4 id="æ€ä¹ˆè§£å†³cpué£™é«˜"><a href="#æ€ä¹ˆè§£å†³cpué£™é«˜" class="headerlink" title="æ€ä¹ˆè§£å†³cpué£™é«˜"></a>æ€ä¹ˆè§£å†³cpué£™é«˜</h4><p>ä½¿ç”¨topå‘½ä»¤æŸ¥çœ‹å ç”¨cpuçš„æƒ…å†µ<br>é€šè¿‡topå‘½ä»¤æŸ¥çœ‹åï¼Œå¯ä»¥æŸ¥çœ‹æ˜¯å“ªä¸€ä¸ªè¿›ç¨‹å ç”¨cpuè¾ƒé«˜<br>ä½¿ç”¨pså‘½ä»¤æŸ¥çœ‹è¿›ç¨‹ä¸­çš„çº¿ç¨‹ä¿¡æ¯<br>ä½¿ç”¨jstackå‘½ä»¤æŸ¥çœ‹è¿›ç¨‹ä¸­å“ªäº›çº¿ç¨‹å‡ºç°äº†é—®é¢˜ï¼Œæœ€ç»ˆå®šä½é—®é¢˜</p>
<ul>
<li><p>ä½¿ç”¨topå‘½ä»¤æŸ¥çœ‹å ç”¨cpuçš„æƒ…å†µ<code>å“ªä¸ªè¿›ç¨‹å ç”¨çš„cpuæœ€é«˜</code></p>
<p>finalShellä¸­è¾“å…¥ <code>top</code></p>
</li>
<li><p>æŸ¥çœ‹è¿›ç¨‹ä¸­çš„çº¿ç¨‹ä¿¡æ¯  <code>ps H -eo pid,tid,%cpu | gerp pid</code></p>
</li>
<li><p><strong>jstack</strong> æŸ¥çœ‹è¿›ç¨‹å†…çº¿ç¨‹çš„å †æ ˆä¿¡æ¯<del>äº§ç”Ÿæ­»é”å¯ä»¥æŸ¥çœ‹</del></p>
<p>å› ä¸ºæ˜¯åå…­è¿›ç¨‹æ‰€ä»¥è¦åè¿›ç¨‹<strong>è½¬æ¢åå…­è¿›ç¨‹</strong><br>ç›´æ¥linuxè¾“å…¥ <code>printf &quot;%x\n&quot; Pid</code><br>ç„¶åå°±å¯ä»¥æ ¹æ®åå…­è¿›åˆ¶çš„å»æ‰¾å“ªä¸ªçº¿ç¨‹cpuå ç”¨<br>ä¹‹åæŸ¥çœ‹æ–‡ä»¶æ˜¯<code>cat xxx</code></p>
</li>
</ul>
<h4 id="é¡¹ç›®ä¸­é‡åˆ°çš„éš¾ç‚¹"><a href="#é¡¹ç›®ä¸­é‡åˆ°çš„éš¾ç‚¹" class="headerlink" title="é¡¹ç›®ä¸­é‡åˆ°çš„éš¾ç‚¹"></a>é¡¹ç›®ä¸­é‡åˆ°çš„éš¾ç‚¹</h4><p>1.ä»ä¸šåŠ¡è§’åº¦ æ›¾ç»åšè¿‡ä¿é™©é¡¹ç›® é‡‘èä¿é™©é¢†åŸŸ è¡Œå¤–äººéœ€è¦èŠ±å¾ˆå¤šæ—¶é—´äº†è§£éœ€æ±‚è¿˜æœ‰åŒäº‹çš„å¸®åŠ©æ‰æ‡‚å¾—éœ€æ±‚çŸ¥é“å¦‚ä½•å»å†™</p>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/é¢è¯•" style=color:#00bcd4>
                é¢è¯•
            </a>
        </span>
        
    </div>

    <a href="/2025/02/09/é¢è¯•/æ´ªå“¥é¢è¯•é¢˜/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/02/07/é¢è¯•/JL/">
        <h2>
            JL
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/2/7
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h4 id="æ‹›è˜æµç¨‹"><a href="#æ‹›è˜æµç¨‹" class="headerlink" title="æ‹›è˜æµç¨‹"></a>æ‹›è˜æµç¨‹</h4><p>ä¸»æµç½‘ç«™ï¼šBossç›´è˜<br>å…ˆè¿‡ç³»ç»Ÿç­›é€‰[å†™æœ¬ç§‘ å†™è®¡ç®—æœºä¸“ä¸š è¿‡ç­›é€‰ å¾—åˆ°é¢è¯•æœºä¼š]<br>HRä¼šå¸®æˆ‘ä»¬çš„ éœ€è¦KPIå½“æœˆç›®æ ‡å’Œä¸šç»©<br>é»‘é©¬è¯¾ç¨‹å¯¹æ ‡3å¹´å·¥ä½œç»éªŒ å¤§å‚211éƒ½ä¸å¥½è¿›</p>
<p>æ¯æ¬¡éƒ½è¦å¾®ä¿¡é—®ä¸€ä¸‹HRï¼š**<u>æŠ€æœ¯é¢</u>** è¿˜æ˜¯ äººåŠ›é¢<br>å¯ä»¥æ‰“å¬é¢è¯•å®˜ä¾§é‡ç‚¹ï¼Œé—®ä¸€ä¸‹æ˜¯é¢†å¯¼è¿˜æ˜¯ä¸»ç®¡è¿˜æ˜¯æŠ€æœ¯ç»„é•¿</p>
<p>ä¸è¦ä¹±è®²è¯ï¼ï¼ä¸è¦ä¹±è®²è¯ï¼ï¼ä¸è¦ä¹±è®²è¯ï¼ï¼ä¸è¦ä¹±è®²è¯ï¼ï¼</p>
<p>å­¦ä¿¡ç½‘å¯æŸ¥å—ï¼Ÿ å…ˆè¯´å¯æŸ¥  è‹¥è®© <em><strong>å‘ç¼–å·</strong></em> å°±ä¸‹ä¸€å®¶      [<u>å¯å¡«ä¸“ç§‘å—ï¼Ÿï¼Ÿï¼Ÿ</u>]</p>
<hr>
<h4 id="ç®€å†æ€ä¹ˆå†™å¥½ï¼Ÿ"><a href="#ç®€å†æ€ä¹ˆå†™å¥½ï¼Ÿ" class="headerlink" title="ç®€å†æ€ä¹ˆå†™å¥½ï¼Ÿ"></a>ç®€å†æ€ä¹ˆå†™å¥½ï¼Ÿ</h4><p>åŸºæœ¬ä¿¡æ¯ ç±è´¯ <strong>å·¥ä½œå¹´é™</strong> æ±‚èŒå²—ä½(Javaå¼€å‘å·¥ç¨‹å¸ˆ) è–ªèµ„(é¢è®®)<br>è–ªèµ„èŒƒå›´6-18k æ‹‰å¤§èŒƒå›´  å…¥èŒæ—¶é—´ï¼šä¸€å‘¨å†…åˆ°å²—<br>ç”µè¯å¿…å†™ é‚®ç®±ä¹Ÿå¿…å†™</p>
<p><u>é¢è¯•é—®ä½ ä»€ä¹ˆæ—¶å€™èƒ½åˆ°å²—</u>ï¼Ÿ<strong>3ä¸ªå·¥ä½œæ—¥å·¦å³ &#x2F; (3å¤©å·¦å³)</strong></p>
<p><img src="C:\Users\Pluminary\AppData\Roaming\Typora\typora-user-images\image-20250207105915015.png" alt="image-20250207105915015"></p>
<p><strong>æ•™è‚²ç»å†</strong><br>25å±Š  19-23  ä¹Ÿå¯ä»¥å¤§ä¸‰å‡ºå»å®ä¹  21-24<br>åœ¨æ ¡ï¼šå¾€å‰æ¨ä¸€å¹´<br>å­¦æ ¡ + ä¸“ä¸š</p>
<p><strong>å·¥ä½œç»å†</strong><br>æ¯ä¸€å®¶ä¸€å¹´å¤š å»ºè®®2ä¸ªå…¬å¸<br>ä¸Šä¸€å®¶å…¬å¸è·ç¦»ç°åœ¨ ä¸èƒ½æœ‰å¾ˆç©ºçª—æ—¶æœŸã€<strong>å®æ—¶ä¿®æ”¹å·¥ä½œç»éªŒæ—¶é—´</strong>ã€‘</p>
<p><strong>ä¸Šå‘¨ç¦»èŒ</strong>ï¼Ÿ<br>æœ‰æ²¡æœ‰é¢è¯•å…¶ä»–ï¼Ÿ<br>æ²¡æœ‰ æˆ‘ä¹Ÿæ˜¯åˆšå¥½ç¢°åˆ°è´µå…¬å¸  æœ‰ æ‹¿åˆ°äº†offerä½†æ˜¯æˆ‘è¿˜æ˜¯æ„æ„¿æœ€å¤§è´µå…¬å¸å–œæ¬¢è´µå…¬å¸çš„ç¯å¢ƒ</p>
<p><strong>å¼€å‘æŠ€èƒ½</strong> [15æ¡ä»¥ä¸Š]<br>ç»†èŠ‚å¼•å¯¼é¢è¯•å®˜å»ä¹¦å†™å¼€å‘æŠ€èƒ½<br>è®°å¾—è¦è®¾ç½®é™·é˜±<br>ä»ä¼˜å…ˆçº§é«˜åˆ°ä½å†™<br>å‰ç«¯ä¸€å®šè¦å†™</p>
<p>JavaåŸºç¡€å…ˆå†™åˆ°å‰é¢<br>å¤§æ•°æ®ç»Ÿè®¡è‡³å°‘è¦ 3å¹´ç»éªŒ 4ä¸ªé¡¹ç›®ç»éªŒ </p>
<p><strong>é¡¹ç›®å‘¨æœŸ</strong>ï¼šæ—¶é—´æ§åˆ¶åœ¨5-8ä¸ªæœˆ<br>ç¬¬ä¸€ä¸ªé¡¹ç›®ç»å†è‡³å°‘7-8ç‚¹ éœ€è¦ä¸šåŠ¡+æŠ€æœ¯ç‚¹<br>ç¬¬äºŒä¸ªé¡¹ç›®è‡³å°‘5-6æ¡ è¾¾åˆ°é¡¹ç›®ä¸€çš„ä¸ƒæˆ<br>ç¬¬ä¸‰å››é¡¹ç›®è‡³å°‘3æ¡ å‡é‡ä¸å‡è´¨ã€ä¸è¦é¾™å¤´è›‡å°¾ã€‘</p>
<p>2025.2.10å·ä¸­åˆæ”¶é›†å¥½ç®€å†</p>
<p>æ–‡ä»¶åç§°ï¼š**<u>Javaå¼€å‘å·¥ç¨‹å¸ˆ _ 3å¹´ _ æ½˜æ˜¥å°§</u>**.pdf</p>
<hr>
<hr>
<h4 id="æ±‚èŒæ„å‘"><a href="#æ±‚èŒæ„å‘" class="headerlink" title="æ±‚èŒæ„å‘"></a>æ±‚èŒæ„å‘</h4><p>æœŸæœ›åŸå¸‚ï¼šä¸é™<br>æœŸæœ›å²—ä½ï¼šJavaå¼€å‘å·¥ç¨‹å¸ˆ<br>æœŸæœ›è–ªèµ„ï¼šé¢è®®<br>åˆ°å²—æ—¶é—´ï¼šä¸€å‘¨å†…&#x2F;éšæ—¶<br>å†™è™šå²ï¼ï¼</p>
<h4 id="æ•™è‚²ç»å†"><a href="#æ•™è‚²ç»å†" class="headerlink" title="æ•™è‚²ç»å†"></a>æ•™è‚²ç»å†</h4><p>æ°‘æ•™ç½‘3å¹´ï¼š2018.9-2022.7     xxxå¤§å­¦   ä¸“ä¸šï¼šä¸ç›¸å…³å¯ä»¥ä¸å†™</p>
<p>å­¦ä¿¡ç½‘<br>25å±Šï¼šå®ä¹ <br>23-24å±Šï¼š1-2å¹´</p>
<h4 id="å·¥ä½œç»å†-ä¸€å®¶å…¬å¸è¶…è¿‡ä¸¤å¹´å·¦å³-5-8ä¸ªæœˆ-x2F-ä¸€ä¸ªé¡¹ç›®"><a href="#å·¥ä½œç»å†-ä¸€å®¶å…¬å¸è¶…è¿‡ä¸¤å¹´å·¦å³-5-8ä¸ªæœˆ-x2F-ä¸€ä¸ªé¡¹ç›®" class="headerlink" title="å·¥ä½œç»å†(ä¸€å®¶å…¬å¸è¶…è¿‡ä¸¤å¹´å·¦å³)  5-8ä¸ªæœˆ &#x2F; ä¸€ä¸ªé¡¹ç›®"></a>å·¥ä½œç»å†<del>(ä¸€å®¶å…¬å¸è¶…è¿‡ä¸¤å¹´å·¦å³)</del>  5-8ä¸ªæœˆ &#x2F; ä¸€ä¸ªé¡¹ç›®</h4><p><u>xxxå…¬å¸(æ‰¾è‡ªå·±ç†Ÿæ‚‰åŸå¸‚ï¼Œ<strong>ä¸è¦æ‰¾åœ¨çº¿æ‹›è˜</strong><del>ä¼šè¢«HRç›´æ¥é—®å¯¹é¢æ‹›è˜ä¸­çš„HR</del>)</u></p>
<p>æ²¡æœ‰ç¤¾ä¿ï¼šä¸å†™æœŸæœ›åŸå¸‚<br>ç¤¾ä¿ï¼šå†™ç¤¾ä¿æ‰€åœ¨åœ°<br>å…¬å¸å¼€ä¸šæ—¶é—´ã€å°å…¬å¸(100äººä»¥å†…)ã€ç§‘æŠ€æœ‰é™å…¬å¸ã€ä¸Šç­åœ°ç‚¹äº¤é€šæ–¹å¼ã€èƒŒæ™¯è°ƒæŸ¥å†™æ´ªå“¥ã€æ³•äºº(è€æ¿)ã€å…¬å¸åœ°å€</p>
<p>èƒŒè°ƒï¼šæ¨¡æ¿<br>å†™çº¸è´¨ç‰ˆä¿¡æ¯è¡¨ å‡ºç”Ÿå¹´æœˆæ—¥ â†’ å†™çœŸå®çš„æ—¥æœŸ</p>
<p>ç¬¬ä¸€æ­¥ï¼šå†™çº¸è´¨ä¿¡æ¯è¡¨ï¼ˆè¯æ˜äººï¼šç”µè¯ï¼‰<del>æ´ªå“¥æ•å§</del><br><strong>èƒŒè°ƒä¿¡æ¯</strong>ï¼šå‘ç»™æ´ªå“¥æ•å§</p>
<blockquote>
<p>hrä¼šæ ¹æ®ä½ ç»™çš„ç”µè¯ç›´æ¥<br>ä¸Šçº§é¢†å¯¼ï¼šé¡¹ç›®<br>ç¬¬ä¸‰è€…ï¼šæœ‹å‹&#x2F;åŒå­¦&#x2F;åŒäº‹ [å¯ä»¥æ‹’ç»å›ç­”å¾ˆå¤š]</p>
</blockquote>
<p><strong>ç¬¬ä¸‰æ–¹èƒŒè°ƒ</strong>ï¼šæŸ¥ç¤¾ä¿ æŸ¥å·¥ä½œè®°å½• æŸ¥å­¦ä¿¡ç½‘</p>
<p>å¸¦èº«ä»½è¯å»çš„è¯ è¯æ˜æ¥¼ä¸‹çš„å¤§å¦éœ€è¦ç™»è®°èº«ä»½ä¿¡æ¯æ‰èƒ½è¿›</p>
<hr>
<hr>
<h4 id="Bossä¸Šçš„æŠ•é€’"><a href="#Bossä¸Šçš„æŠ•é€’" class="headerlink" title="Bossä¸Šçš„æŠ•é€’"></a>Bossä¸Šçš„æŠ•é€’</h4><p>ä¸Šä¼ PDFç‰ˆæœ¬çš„ç®€å†<br>å·¥ä½œç»å† â†’ å¯¹è¯¥å…¬å¸éšè—æˆ‘çš„ç®€å†</p>
<p>æ–‡ä»¶åç§°ï¼š**<u>æ½˜æ˜¥å°§-æœ¬ç§‘-3å¹´-Javaå¼€å‘å·¥ç¨‹å¸ˆ</u>**.pdf</p>
<h5 id="å°½é‡å…ˆä»è¿œçš„åœ°æ–¹æŠ•é€’ç®€å†-è¯•è¯•çŠ¶æ€ï¼æœ€æƒ³å»å¹¿å·çš„ç•™åˆ°æœ€åçŠ¶æ€å¥½çš„æ—¶å€™å†æŠ•é€’"><a href="#å°½é‡å…ˆä»è¿œçš„åœ°æ–¹æŠ•é€’ç®€å†-è¯•è¯•çŠ¶æ€ï¼æœ€æƒ³å»å¹¿å·çš„ç•™åˆ°æœ€åçŠ¶æ€å¥½çš„æ—¶å€™å†æŠ•é€’" class="headerlink" title="å°½é‡å…ˆä»è¿œçš„åœ°æ–¹æŠ•é€’ç®€å† è¯•è¯•çŠ¶æ€ï¼æœ€æƒ³å»å¹¿å·çš„ç•™åˆ°æœ€åçŠ¶æ€å¥½çš„æ—¶å€™å†æŠ•é€’"></a>å°½é‡å…ˆä»è¿œçš„åœ°æ–¹æŠ•é€’ç®€å† è¯•è¯•çŠ¶æ€ï¼æœ€æƒ³å»å¹¿å·çš„ç•™åˆ°æœ€åçŠ¶æ€å¥½çš„æ—¶å€™å†æŠ•é€’</h5><p><strong>å¤–åŒ…å…¬å¸</strong>ï¼šè·ŸåŸ¹è®­çš„å­¦ç”ŸåŒ¹é… å“ˆå“ˆå“ˆï¼</p>
<hr>
<hr>
<p>äº”é™©ä¸€é‡‘ï¼šåŸºæœ¬å…»è€ä¿é™©[<u>å·¥ä½œé‡Œé¢ç´¯è®¡äº¤æ»¡20å¹´é€€ä¼‘æ—¶é¢†é€€ä¼‘é‡‘</u>] ã€ åŸºæœ¬åŒ»ç–—ä¿é™© [<del>æ€»éƒ¨ä¸Šæµ·ç°åœ¨åœ¨å¹¿å·</del>ä¸€èˆ¬éƒ½æ˜¯æœ¬åœ°åŒ»ä¿æ–¹ä¾¿]ã€ å¤±ä¸šä¿é™©[<u>å·¥ä½œæ»¡ä¸€å¹´åå› å…¬å¸è¢«è¾é€€æ‰å¯ä»¥é¢†å–</u>] ã€ å·¥ä¼¤ä¿é™© ã€ ç”Ÿè‚²ä¿é™© åŠ ä½æˆ¿å…¬ç§¯é‡‘</p>
<p>ã€è¦æ‰¾å…¬ç§¯é‡‘çš„å…¬å¸ã€‘å…¬ç§¯é‡‘5% â†’ ä¹°æˆ¿å¯ä»¥ç”¨å…¬ç§¯é‡‘æ¥è´·æ¬¾ï¼›é€€ä¼‘åè¿™ç¬”é’±å¯ä»¥ä¸€æ¬¡æ€§æå–å‡ºæ¥å…»è€ï¼›è£…ä¿®&#x2F;ç§Ÿæˆ¿çš„åä¹‰æå–(åŠå¹´ä¸€æ¬¡)</p>
<p>é¢è¯•é¢˜é—®ï¼šä¸Šå®¶å…¬å¸çš„å·¥èµ„å¾…é‡ â†’ åŸå¸‚æœ€ä½æ ‡å‡†ä¹°çš„<br>10kæ‰£é™¤äº”é™©ä¸€é‡‘ ä¿é™©400-500 å…¬ç§¯é‡‘å¤§æ¦‚300-400å·¦å³ </p>
<p>ä¸ªäººæ‰€å¾—ç¨ï¼šä¸è¶…è¿‡3.6wå°±æ˜¯3%ï¼Œæ¯ä¸ªæœˆè´¢åŠ¡éƒ½ä¼šæ‰£é™¤å‘æ”¾ç¨åå·¥èµ„ï¼Œèµ·å¾ç‚¹5kï¼Œè¶…è¿‡5kçš„éƒ¨åˆ†æ‰ä¼šäº¤ç¨ã€‚10kä»¥å†…çš„å¤§æ¦‚æ˜¯3%ï¼Œ</p>
<p>é¢è¯•ï¼šå…¬å¸æœ‰ç»©æ•ˆè€ƒæ ¸  æˆ‘ä»¬æ²¡æœ‰å¾ˆæ˜ç¡®çš„è€ƒæ ¸ æ—¥å¸¸éƒ½èƒ½å®Œæˆå·¥ä½œé‡</p>
<p>å…¥èŒå½“å¤©è¦ç­¾åŠ³åŠ¡åˆåŒ 1å¹´æˆ–3å¹´ï¼Ÿ<br>åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ<br>1å¹´çš„åŠ³åŠ¨åˆåŒåªèƒ½å®š1ä¸ªæœˆè¯•ç”¨æœŸ 2å¹´2ä¸ªæœˆ 3å¹´3ä¸ªæœˆ<br>å¤§æ¦‚ç‡è¯•ç”¨æœŸ8-9æŠ˜ éƒ½æ˜¯3-6ä¸ªæœˆ</p>
<p>ç­¾è®¢åŠ³åŠ¨åˆåŒå¯ä»¥ç¦»èŒ   æœ«å°¾æ·˜æ±°åœ¨æ³•å¾‹ä¸Šä¸å…è®¸<br>è½¬æ­£ä»¥åè¢«è£å¯ä»¥n+1ä¸ªæœˆ nä»£è¡¨å¹´ è¯•ç”¨æœŸè¢«è¾é€€ä¼šèµ”å¿åŠä¸ªæœˆè–ªèµ„</p>
<p><strong>æ°‘æ•™ç½‘</strong>(1000äººä»¥ä¸‹çš„å…¬å¸) ä¸»æ”»é’ˆå¯¹å°å‹ä¼ä¸š å’Œ äºŒä¸‰çº¿åŸå¸‚<br>æµ™æ±Ÿâ†’ç»å…´æ­å·<br>è¿œå…¬å¸çº¦çº¿ä¸Šå…¬å¸ </p>
<h6 id="ç°åœ¨åœ¨å¤–åœ°-èƒ½ä¸èƒ½å¼€ä¸€è½®çš„çº¿ä¸Šé¢è¯•-å¦‚æœæœ‰éœ€æ±‚æˆ‘è¿˜æ˜¯èƒ½è¿‡å»çš„"><a href="#ç°åœ¨åœ¨å¤–åœ°-èƒ½ä¸èƒ½å¼€ä¸€è½®çš„çº¿ä¸Šé¢è¯•-å¦‚æœæœ‰éœ€æ±‚æˆ‘è¿˜æ˜¯èƒ½è¿‡å»çš„" class="headerlink" title="ç°åœ¨åœ¨å¤–åœ° èƒ½ä¸èƒ½å¼€ä¸€è½®çš„çº¿ä¸Šé¢è¯• å¦‚æœæœ‰éœ€æ±‚æˆ‘è¿˜æ˜¯èƒ½è¿‡å»çš„"></a>ç°åœ¨åœ¨å¤–åœ° èƒ½ä¸èƒ½å¼€ä¸€è½®çš„çº¿ä¸Šé¢è¯• å¦‚æœæœ‰éœ€æ±‚æˆ‘è¿˜æ˜¯èƒ½è¿‡å»çš„</h6>
            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/é¢è¯•" style=color:#00bcd4>
                é¢è¯•
            </a>
        </span>
        
    </div>

    <a href="/2025/02/07/é¢è¯•/JL/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>

<div class="post">

    <a href="/2025/01/03/åç«¯/ElasticSearch/">
        <h2>
            ElasticSearch
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/1/3
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <p>ElasticSearchç»“åˆKibanaã€Logstashã€Beatsï¼Œæ ¸å¿ƒæ˜¯elastic stackçš„æ ¸å¿ƒï¼Œè´Ÿè´£<strong>å­˜å‚¨ã€æœç´¢ã€åˆ†ææ•°æ®</strong><br>Luceneçš„ä¼˜åŠ¿ï¼šå®¹æ˜“æ‰©å±•ã€é«˜æ€§èƒ½(åŸºäºå€’æ’ç´¢å¼•)<br>Luceneçš„ç¼ºç‚¹ï¼šç›´é€‰ä¸javaè¯­è¨€å¼€å‘<br>ElasticSearchæ˜¯åŸºäºLuceneå¼€å‘çš„</p>
<h6 id="Elasticsearchï¼šå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¯ä»¥ç”¨æ¥å®ç°æœç´¢ã€æ—¥å¿—ç»Ÿè®¡ã€åˆ†æã€ç³»ç»Ÿç›‘æ§ç­‰åŠŸèƒ½"><a href="#Elasticsearchï¼šå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¯ä»¥ç”¨æ¥å®ç°æœç´¢ã€æ—¥å¿—ç»Ÿè®¡ã€åˆ†æã€ç³»ç»Ÿç›‘æ§ç­‰åŠŸèƒ½" class="headerlink" title="Elasticsearchï¼šå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¯ä»¥ç”¨æ¥å®ç°æœç´¢ã€æ—¥å¿—ç»Ÿè®¡ã€åˆ†æã€ç³»ç»Ÿç›‘æ§ç­‰åŠŸèƒ½"></a>Elasticsearchï¼šå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¯ä»¥ç”¨æ¥å®ç°æœç´¢ã€æ—¥å¿—ç»Ÿè®¡ã€åˆ†æã€ç³»ç»Ÿç›‘æ§ç­‰åŠŸèƒ½</h6><h4 id="æ­£å‘ç´¢å¼•å’Œå€’æ’ç´¢å¼•"><a href="#æ­£å‘ç´¢å¼•å’Œå€’æ’ç´¢å¼•" class="headerlink" title="æ­£å‘ç´¢å¼•å’Œå€’æ’ç´¢å¼•"></a>æ­£å‘ç´¢å¼•å’Œå€’æ’ç´¢å¼•</h4><p>ä¼ ç»Ÿæ•°æ®åº“æ˜¯<strong>æ­£å‘ç´¢å¼•</strong></p>
<p><strong>ElasticSearché‡‡ç”¨å€’æ’ç´¢å¼•</strong>ï¼š</p>
<ul>
<li>æ–‡æ¡£(document)ï¼šæ¯æ¡æ•°æ®å°±æ˜¯ä¸€ä¸ªæ–‡æ¡£</li>
<li>è¯æ¡(term)ï¼šæ–‡æ¡£æŒ‰ç…§è¯­ä¹‰åˆ†æˆè¯è¯­</li>
</ul>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">title</th>
<th align="center">price</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">å°ç±³æ‰‹æœº</td>
<td align="center">3499</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">åä¸ºæ‰‹æœº</td>
<td align="center">4999</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">åä¸ºå°ç±³å……ç”µå™¨</td>
<td align="center">49</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">å°ç±³æ‰‹ç¯</td>
<td align="center">299</td>
</tr>
</tbody></table>
<p>  â†“â†“â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“         â†“â†“ â†“â†“       </p>
<table>
<thead>
<tr>
<th align="center">è¯æ¡(term)</th>
<th align="center">æ–‡æ¡£id</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å°ç±³</td>
<td align="center">1ï¼Œ3ï¼Œ4</td>
</tr>
<tr>
<td align="center">æ‰‹æœº</td>
<td align="center">1ï¼Œ2</td>
</tr>
<tr>
<td align="center">åä¸º</td>
<td align="center">2ï¼Œ3</td>
</tr>
<tr>
<td align="center">å……ç”µå™¨</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">æ‰‹ç¯</td>
<td align="center">4</td>
</tr>
</tbody></table>
<p><strong>è¿‡ç¨‹</strong>ï¼šæœç´¢<code>åä¸ºæ‰‹æœº</code> â†’ å¾—åˆ°ï¼š<code>åä¸º</code>ã€<code>æ‰‹æœº</code>ä¸¤ä¸ªè¯æ¡ â†’ å¾—åˆ°æ¯ä¸ªè¯æ¡æ‰€åœ¨æ–‡æ¡£idï¼šåä¸º:2,3 æ‰‹æœº:1,2 â†’ å¾—åˆ°idä¸º1,2,3çš„æ–‡æ¡£ â†’ å­˜å…¥ç»“æœé›†<br><strong>å€’æ’ç´¢å¼•</strong>ï¼šå¯¹æ–‡æ¡£å†…å®¹åˆ†è¯ï¼Œå¯¹è¯æ¡åˆ›å»ºç´¢å¼•ï¼Œå¹¶è®°å½•è¯æ¡æ‰€åœ¨æ–‡æ¡£çš„ä¿¡æ¯ã€‚æŸ¥è¯¢æ—¶ç°æ ¹æ®è¯æ¡æŸ¥è¯¢åˆ°æ–‡æ¡£idï¼Œè€Œåè·å–åˆ°æ–‡æ¡£<br><strong>æ­£æ’ç´¢å¼•</strong>ï¼šåŸºäºæ–‡æ¡£idåˆ›å»ºç´¢å¼•ã€‚æŸ¥è¯¢è¯æ¡æ—¶å¿…é¡»å…ˆæ‰¾åˆ°æ–‡æ¡£ï¼Œè€Œååˆ¤æ–­æ˜¯å¦åŒ…å«è¯æ¡</p>
<h4 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h4><p>ElasticSearchæ˜¯é¢å‘æ–‡æ¡£å­˜å‚¨çš„ï¼Œå¯ä»¥æ˜¯æ•°æ®åº“ä¸­çš„ä¸€æ¡å•†å“æ•°æ®ï¼Œä¸€ä¸ªè®¢å•ä¿¡æ¯ï¼Œæ–‡æ¡£æ•°æ®ä¼šè¢«åºåˆ—åŒ–ä¸ºjsonæ ¼å¼åå­˜å‚¨åœ¨ElasticSearchä¸­<br>åœ¨ElasticSearchä¸­</p>
<ul>
<li>**ç´¢å¼•(index)**ï¼šç›¸åŒç±»å‹çš„æ–‡æ¡£çš„é›†åˆ</li>
<li>**æ˜ å°„(mapping)**ï¼šç´¢å¼•ä¸­æ–‡æ¡£çš„å­—æ®µçº¦æŸä¿¡æ¯ï¼Œç±»ä¼¼è¡¨çš„ç»“æ„çº¦æŸ</li>
</ul>
<h6 id="æ¦‚å¿µå¯¹æ¯”"><a href="#æ¦‚å¿µå¯¹æ¯”" class="headerlink" title="æ¦‚å¿µå¯¹æ¯”"></a>æ¦‚å¿µå¯¹æ¯”</h6><table>
<thead>
<tr>
<th align="center">MySQL</th>
<th align="center">ElasticSearch</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Table</td>
<td align="center">Index</td>
<td align="center">ç´¢å¼•(index)ï¼Œå°±æ˜¯æ–‡æ¡£çš„é›†åˆï¼Œç±»ä¼¼äºæ•°æ®åº“çš„è¡¨(table)</td>
</tr>
<tr>
<td align="center">Row</td>
<td align="center">Document</td>
<td align="center">æ–‡æ¡£(Document)ï¼Œå°±æ˜¯ä¸€æ¡æ¡çš„æ•°æ®ï¼Œç±»ä¼¼æ•°æ®åº“ä¸­çš„è¡Œ(Row)ï¼Œæ–‡æ¡£éƒ½æ˜¯JSONæ ¼å¼</td>
</tr>
<tr>
<td align="center">Column</td>
<td align="center">Field</td>
<td align="center">å­—æ®µ(Field)ï¼Œå°±æ˜¯JSONæ–‡æ¡£ä¸­çš„å­—æ®µï¼Œç±»ä¼¼æ•°æ®åº“ä¸­çš„åˆ—(Column)</td>
</tr>
<tr>
<td align="center">Schema</td>
<td align="center">Mapping</td>
<td align="center">Mapping(æ˜ å°„)ï¼Œå°±æ˜¯ç´¢å¼•ä¸­æ–‡æ¡£çš„çº¦æŸï¼Œä¾‹å¦‚å­—æ®µç±»å‹çº¦æŸã€‚ç±»ä¼¼æ•°æ®åº“çš„è¡¨ç»“æ„(Schema)</td>
</tr>
<tr>
<td align="center">SQL</td>
<td align="center">DSL</td>
<td align="center">DSLæ˜¯ElasticSearchæä¾›çš„JSONé£æ ¼çš„è¯·æ±‚è¯­å¥ï¼Œç”¨æ¥æ“ä½œElasticSearchï¼Œå®ç°CRUD</td>
</tr>
</tbody></table>
<h6 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h6><p><strong>MySQL</strong><del>å†™æ“ä½œ</del>ï¼šæ“…é•¿äº‹åŠ¡ç±»å‹æ“ä½œï¼Œå¯ä»¥ç¡®ä¿æ•°æ®çš„å®‰å…¨å’Œä¸€è‡´æ€§<br><strong>ElasticSearch</strong><del>æŸ¥è¯¢</del>ï¼šæ“…é•¿æµ·é‡æ•°æ®çš„æœç´¢ã€åˆ†æã€è®¡ç®—<br>[<strong><u>å¯ä»¥äº’è¡¥è¾¾åˆ°æ•°æ®åŒå†™ä¸€è‡´æ€§</u></strong>]</p>
<h2 id="1-1-åˆ›å»ºç½‘ç»œ"><a href="#1-1-åˆ›å»ºç½‘ç»œ" class="headerlink" title="1.1.åˆ›å»ºç½‘ç»œ"></a>1.1.åˆ›å»ºç½‘ç»œ</h2><p>å› ä¸ºæˆ‘ä»¬è¿˜éœ€è¦éƒ¨ç½²kibanaå®¹å™¨ï¼Œå› æ­¤éœ€è¦è®©eså’Œkibanaå®¹å™¨äº’è”ã€‚è¿™é‡Œå…ˆåˆ›å»ºä¸€ä¸ªç½‘ç»œï¼ˆåˆ›å»ºè¿‡çš„ä¸ç”¨å†åˆ›å»ºï¼‰ï¼š</p>
<pre><code class="sh">docker network create es-net
</code></pre>
<h2 id="1-2-åŠ è½½é•œåƒ"><a href="#1-2-åŠ è½½é•œåƒ" class="headerlink" title="1.2.åŠ è½½é•œåƒ"></a>1.2.åŠ è½½é•œåƒ</h2><p>è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨elasticsearchçš„7.12.1ç‰ˆæœ¬çš„é•œåƒï¼Œè¿™ä¸ªé•œåƒä½“ç§¯éå¸¸å¤§ï¼Œæ¥è¿‘1Gã€‚ä¸å»ºè®®å¤§å®¶è‡ªå·±pullã€‚</p>
<p>è¯¾å‰èµ„æ–™æä¾›äº†é•œåƒçš„taråŒ…ï¼š</p>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20210510165308064.png" alt="image-20210510165308064"></p>
<p>å¤§å®¶å°†å…¶ä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­ï¼Œç„¶åè¿è¡Œå‘½ä»¤åŠ è½½å³å¯ï¼š</p>
<pre><code class="sh"># å¯¼å…¥æ•°æ®
docker load -i es.tar
</code></pre>
<p>åŒç†è¿˜æœ‰<code>kibana</code>çš„taråŒ…ä¹Ÿéœ€è¦è¿™æ ·åšã€‚</p>
<h2 id="1-3-è¿è¡Œ"><a href="#1-3-è¿è¡Œ" class="headerlink" title="1.3.è¿è¡Œ"></a>1.3.è¿è¡Œ</h2><p>è¿è¡Œdockerå‘½ä»¤ï¼Œéƒ¨ç½²å•ç‚¹esï¼š</p>
<pre><code class="sh">docker run -d \
    --name es \
    -e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; \
    -e &quot;discovery.type=single-node&quot; \
    -v es-data:/usr/share/elasticsearch/data \
    -v es-plugins:/usr/share/elasticsearch/plugins \
    --privileged \
    --network es-net \
    -p 9200:9200 \
    -p 9300:9300 \
elasticsearch:7.12.1
</code></pre>
<p>å‘½ä»¤è§£é‡Šï¼š</p>
<ul>
<li><code>-e &quot;cluster.name=es-docker-cluster&quot;</code>ï¼šè®¾ç½®é›†ç¾¤åç§°</li>
<li><code>-e &quot;http.host=0.0.0.0&quot;</code>ï¼šç›‘å¬çš„åœ°å€ï¼Œå¯ä»¥å¤–ç½‘è®¿é—®</li>
<li><code>-e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</code>ï¼šå†…å­˜å¤§å°</li>
<li><code>-e &quot;discovery.type=single-node&quot;</code>ï¼šéé›†ç¾¤æ¨¡å¼</li>
<li><code>-v es-data:/usr/share/elasticsearch/data</code>ï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ•°æ®ç›®å½•</li>
<li><code>-v es-logs:/usr/share/elasticsearch/logs</code>ï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ—¥å¿—ç›®å½•</li>
<li><code>-v es-plugins:/usr/share/elasticsearch/plugins</code>ï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ’ä»¶ç›®å½•</li>
<li><code>--privileged</code>ï¼šæˆäºˆé€»è¾‘å·è®¿é—®æƒ</li>
<li><code>--network es-net</code> ï¼šåŠ å…¥ä¸€ä¸ªåä¸ºes-netçš„ç½‘ç»œä¸­</li>
<li><code>-p 9200:9200</code>ï¼šç«¯å£æ˜ å°„é…ç½®</li>
</ul>
<p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼š<a target="_blank" rel="noopener" href="http://192.168.xxx.xxx:9200/">http://192.168.xxx.xxx:9200</a> å³å¯çœ‹åˆ°elasticsearchçš„å“åº”ç»“æœï¼š</p>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20210506101053676.png" alt="image-20210506101053676"></p>
<h1 id="2-éƒ¨ç½²kibana"><a href="#2-éƒ¨ç½²kibana" class="headerlink" title="2.éƒ¨ç½²kibana"></a>2.éƒ¨ç½²kibana</h1><p>kibanaå¯ä»¥ç»™æˆ‘ä»¬æä¾›ä¸€ä¸ªelasticsearchçš„å¯è§†åŒ–ç•Œé¢ï¼Œä¾¿äºæˆ‘ä»¬å­¦ä¹ ã€‚</p>
<h2 id="2-1-éƒ¨ç½²"><a href="#2-1-éƒ¨ç½²" class="headerlink" title="2.1.éƒ¨ç½²"></a>2.1.éƒ¨ç½²</h2><p>è¿è¡Œdockerå‘½ä»¤ï¼Œéƒ¨ç½²kibanaï¼ŒåŒç†å…ˆåŠ è½½é•œåƒï¼š docker load -i kibana.tarï¼Œç„¶åå¯åŠ¨ï¼š</p>
<pre><code class="sh">docker run -d \
--name kibana \
-e ELASTICSEARCH_HOSTS=http://es:9200 \
--network=es-net \
-p 5601:5601  \
kibana:7.12.1
</code></pre>
<ul>
<li><code>--network es-net</code> ï¼šåŠ å…¥ä¸€ä¸ªåä¸ºes-netçš„ç½‘ç»œä¸­ï¼Œä¸elasticsearchåœ¨åŒä¸€ä¸ªç½‘ç»œä¸­</li>
<li><code>-e ELASTICSEARCH_HOSTS=http://es:9200&quot;</code>ï¼šè®¾ç½®elasticsearchçš„åœ°å€ï¼Œå› ä¸º<strong>kibanaå·²ç»ä¸elasticsearchåœ¨ä¸€ä¸ªç½‘ç»œ</strong>ï¼Œå› æ­¤å¯ä»¥ç”¨å®¹å™¨åç›´æ¥è®¿é—®elasticsearch</li>
<li><code>-p 5601:5601</code>ï¼šç«¯å£æ˜ å°„é…ç½®</li>
</ul>
<p>kibanaå¯åŠ¨ä¸€èˆ¬æ¯”è¾ƒæ…¢ï¼Œéœ€è¦å¤šç­‰å¾…ä¸€ä¼šï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ï¼š</p>
<pre><code class="sh">docker logs -f kibana
</code></pre>
<p>æŸ¥çœ‹è¿è¡Œæ—¥å¿—ï¼Œå½“æŸ¥çœ‹åˆ°ä¸‹é¢çš„æ—¥å¿—ï¼Œè¯´æ˜æˆåŠŸï¼š</p>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20210109105135812.png" alt="image-20210109105135812"></p>
<p>æ­¤æ—¶ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥åœ°å€è®¿é—®ï¼š<a href="http://192.168.xxx.xxx:5601ï¼Œå³å¯çœ‹åˆ°ç»“æœ">http://192.168.xxx.xxx:5601ï¼Œå³å¯çœ‹åˆ°ç»“æœ</a></p>
<h6 id="åˆ†è¯æ•ˆæœæ¦‚è§ˆ-Dev-Tools-Elastic"><a href="#åˆ†è¯æ•ˆæœæ¦‚è§ˆ-Dev-Tools-Elastic" class="headerlink" title="åˆ†è¯æ•ˆæœæ¦‚è§ˆ Dev Tools - Elastic"></a>åˆ†è¯æ•ˆæœæ¦‚è§ˆ <a target="_blank" rel="noopener" href="http://192.168.200.146:5601/app/dev_tools#/console">Dev Tools - Elastic</a></h6><blockquote>
<p>GET &#x2F;_analyze<br>{<br>  â€œanalyzerâ€: â€œstandardâ€,<br>  â€œtextâ€: â€œé»‘é©¬ç¨‹åºå‘˜â€<br>}</p>
</blockquote>
<pre><code class="json">&#123;
  &quot;tokens&quot; : [
    &#123;
      &quot;token&quot; : &quot;é»‘&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 1,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 0
    &#125;,
    &#123;
      &quot;token&quot; : &quot;é©¬&quot;,
      &quot;start_offset&quot; : 1,
      &quot;end_offset&quot; : 2,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 1
    &#125;,
    &#123;
      &quot;token&quot; : &quot;ç¨‹&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 3,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 2
    &#125;,
    &#123;
      &quot;token&quot; : &quot;åº&quot;,
      &quot;start_offset&quot; : 3,
      &quot;end_offset&quot; : 4,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 3
    &#125;,
    &#123;
      &quot;token&quot; : &quot;å‘˜&quot;,
      &quot;start_offset&quot; : 4,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 4
    &#125;
  ]
&#125;
</code></pre>
<p>å¦‚æœæ˜¯åˆ†æä¸­åˆå°±ä¸èƒ½ç”¨å®ƒåŸæœ‰çš„ï¼Œå­˜åœ¨æ˜æ˜¾çš„é—®é¢˜ï¼šå°†ä¸­æ–‡é€å­—åˆ†è¯ï¼Œæ²¡æœ‰ä»»ä½•ä¸šåŠ¡è¯­ä¹‰ï¼Œå› æ­¤éœ€è¦å€ŸåŠ©ä¸“ä¸šçš„åˆ†è¯å™¨</p>
<h1 id="3-å®‰è£…IKåˆ†è¯å™¨"><a href="#3-å®‰è£…IKåˆ†è¯å™¨" class="headerlink" title="3.å®‰è£…IKåˆ†è¯å™¨"></a>3.å®‰è£…IKåˆ†è¯å™¨</h1><h2 id="3-1-åœ¨çº¿å®‰è£…ikæ’ä»¶ï¼ˆè¾ƒæ…¢ï¼‰"><a href="#3-1-åœ¨çº¿å®‰è£…ikæ’ä»¶ï¼ˆè¾ƒæ…¢ï¼‰" class="headerlink" title="3.1.åœ¨çº¿å®‰è£…ikæ’ä»¶ï¼ˆè¾ƒæ…¢ï¼‰"></a>3.1.åœ¨çº¿å®‰è£…ikæ’ä»¶ï¼ˆè¾ƒæ…¢ï¼‰</h2><pre><code class="shell"># è¿›å…¥å®¹å™¨å†…éƒ¨
docker exec -it elasticsearch /bin/bash

# åœ¨çº¿ä¸‹è½½å¹¶å®‰è£…
./bin/elasticsearch-plugin  install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip

#é€€å‡º
exit
#é‡å¯å®¹å™¨
docker restart elasticsearch
</code></pre>
<h2 id="3-2-ç¦»çº¿å®‰è£…ikæ’ä»¶ï¼ˆæ¨èï¼‰"><a href="#3-2-ç¦»çº¿å®‰è£…ikæ’ä»¶ï¼ˆæ¨èï¼‰" class="headerlink" title="3.2.ç¦»çº¿å®‰è£…ikæ’ä»¶ï¼ˆæ¨èï¼‰"></a>3.2.ç¦»çº¿å®‰è£…ikæ’ä»¶ï¼ˆæ¨èï¼‰</h2><h3 id="1ï¼‰æŸ¥çœ‹æ•°æ®å·ç›®å½•"><a href="#1ï¼‰æŸ¥çœ‹æ•°æ®å·ç›®å½•" class="headerlink" title="1ï¼‰æŸ¥çœ‹æ•°æ®å·ç›®å½•"></a>1ï¼‰æŸ¥çœ‹æ•°æ®å·ç›®å½•</h3><p>å®‰è£…æ’ä»¶éœ€è¦çŸ¥é“elasticsearchçš„pluginsç›®å½•ä½ç½®ï¼Œè€Œæˆ‘ä»¬ç”¨äº†æ•°æ®å·æŒ‚è½½ï¼Œå› æ­¤éœ€è¦æŸ¥çœ‹elasticsearchçš„æ•°æ®å·ç›®å½•ï¼Œé€šè¿‡ä¸‹é¢å‘½ä»¤æŸ¥çœ‹:</p>
<pre><code class="sh">docker volume inspect es-plugins
</code></pre>
<p>æ˜¾ç¤ºç»“æœï¼š</p>
<pre><code class="json">[
    &#123;
        &quot;CreatedAt&quot;: &quot;2022-05-06T10:06:34+08:00&quot;,
        &quot;Driver&quot;: &quot;local&quot;,
        &quot;Labels&quot;: null,
        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/es-plugins/_data&quot;,
        &quot;Name&quot;: &quot;es-plugins&quot;,
        &quot;Options&quot;: null,
        &quot;Scope&quot;: &quot;local&quot;
    &#125;
]
</code></pre>
<p>è¯´æ˜pluginsç›®å½•è¢«æŒ‚è½½åˆ°äº†ï¼š<code>/var/lib/docker/volumes/es-plugins/_data </code>è¿™ä¸ªç›®å½•ä¸­ã€‚</p>
<h3 id="2ï¼‰è§£å‹ç¼©åˆ†è¯å™¨å®‰è£…åŒ…"><a href="#2ï¼‰è§£å‹ç¼©åˆ†è¯å™¨å®‰è£…åŒ…" class="headerlink" title="2ï¼‰è§£å‹ç¼©åˆ†è¯å™¨å®‰è£…åŒ…"></a>2ï¼‰è§£å‹ç¼©åˆ†è¯å™¨å®‰è£…åŒ…</h3><p>ä¸‹é¢æˆ‘ä»¬éœ€è¦æŠŠè¯¾å‰èµ„æ–™ä¸­çš„ikåˆ†è¯å™¨è§£å‹ç¼©ï¼Œé‡å‘½åä¸ºik</p>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20210506110249144.png" alt="image-20210506110249144"></p>
<h3 id="3ï¼‰ä¸Šä¼ åˆ°eså®¹å™¨çš„æ’ä»¶æ•°æ®å·ä¸­"><a href="#3ï¼‰ä¸Šä¼ åˆ°eså®¹å™¨çš„æ’ä»¶æ•°æ®å·ä¸­" class="headerlink" title="3ï¼‰ä¸Šä¼ åˆ°eså®¹å™¨çš„æ’ä»¶æ•°æ®å·ä¸­"></a>3ï¼‰ä¸Šä¼ åˆ°eså®¹å™¨çš„æ’ä»¶æ•°æ®å·ä¸­</h3><p>ä¹Ÿå°±æ˜¯<code>/var/lib/docker/volumes/es-plugins/_data </code>ï¼š</p>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20210506110704293.png" alt="image-20210506110704293"></p>
<h3 id="4ï¼‰é‡å¯å®¹å™¨"><a href="#4ï¼‰é‡å¯å®¹å™¨" class="headerlink" title="4ï¼‰é‡å¯å®¹å™¨"></a>4ï¼‰é‡å¯å®¹å™¨</h3><pre><code class="shell"># 4ã€é‡å¯å®¹å™¨
docker restart es
</code></pre>
<pre><code class="sh"># æŸ¥çœ‹esæ—¥å¿—
docker logs -f es
</code></pre>
<h3 id="5ï¼‰æµ‹è¯•ï¼š"><a href="#5ï¼‰æµ‹è¯•ï¼š" class="headerlink" title="5ï¼‰æµ‹è¯•ï¼š"></a>5ï¼‰æµ‹è¯•ï¼š</h3><p><span style = "color:red"><strong>IKåˆ†è¯å™¨åŒ…å«ä¸¤ç§æ¨¡å¼</strong>ï¼š</span></p>
<ul>
<li><p><code>ik_smart</code>ï¼šæœ€å°‘åˆ‡åˆ†</p>
</li>
<li><p><code>ik_max_word</code>ï¼šæœ€ç»†åˆ‡åˆ†</p>
</li>
</ul>
<pre><code class="json">GET /_analyze
&#123;
  &quot;analyzer&quot;: &quot;ik_max_word&quot;,
  &quot;text&quot;: &quot;é»‘é©¬ç¨‹åºå‘˜å­¦ä¹ javaå¤ªæ£’äº†&quot;
&#125;
</code></pre>
<p>ç»“æœï¼š</p>
<pre><code class="json">&#123;
  &quot;tokens&quot; : [
    &#123;
      &quot;token&quot; : &quot;é»‘é©¬&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 2,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 0
    &#125;,
    &#123;
      &quot;token&quot; : &quot;ç¨‹åºå‘˜&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 1
    &#125;,
    &#123;
      &quot;token&quot; : &quot;ç¨‹åº&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 4,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 2
    &#125;,
    &#123;
      &quot;token&quot; : &quot;å‘˜&quot;,
      &quot;start_offset&quot; : 4,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;CN_CHAR&quot;,
      &quot;position&quot; : 3
    &#125;,
    &#123;
      &quot;token&quot; : &quot;å­¦ä¹ &quot;,
      &quot;start_offset&quot; : 5,
      &quot;end_offset&quot; : 7,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 4
    &#125;,
    &#123;
      &quot;token&quot; : &quot;java&quot;,
      &quot;start_offset&quot; : 7,
      &quot;end_offset&quot; : 11,
      &quot;type&quot; : &quot;ENGLISH&quot;,
      &quot;position&quot; : 5
    &#125;,
    &#123;
      &quot;token&quot; : &quot;å¤ªæ£’äº†&quot;,
      &quot;start_offset&quot; : 11,
      &quot;end_offset&quot; : 14,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 6
    &#125;,
    &#123;
      &quot;token&quot; : &quot;å¤ªæ£’&quot;,
      &quot;start_offset&quot; : 11,
      &quot;end_offset&quot; : 13,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 7
    &#125;,
    &#123;
      &quot;token&quot; : &quot;äº†&quot;,
      &quot;start_offset&quot; : 13,
      &quot;end_offset&quot; : 14,
      &quot;type&quot; : &quot;CN_CHAR&quot;,
      &quot;position&quot; : 8
    &#125;
  ]
&#125;
</code></pre>
<h2 id="3-3-æ‰©å±•è¯è¯å…¸"><a href="#3-3-æ‰©å±•è¯è¯å…¸" class="headerlink" title="3.3 æ‰©å±•è¯è¯å…¸"></a>3.3 æ‰©å±•è¯è¯å…¸</h2><h5 id="æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯-UTF-8-æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ï¼Œå¯ä»¥ç›´æ¥linuxç³»ç»Ÿviç¼–è¾‘"><a href="#æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯-UTF-8-æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ï¼Œå¯ä»¥ç›´æ¥linuxç³»ç»Ÿviç¼–è¾‘" class="headerlink" title="æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯ UTF-8 æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ï¼Œå¯ä»¥ç›´æ¥linuxç³»ç»Ÿviç¼–è¾‘"></a><span style = "color:red">æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯ UTF-8 æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ï¼Œå¯ä»¥ç›´æ¥linuxç³»ç»Ÿviç¼–è¾‘</span></h5><p>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œâ€œé€ è¯è¿åŠ¨â€ä¹Ÿè¶Šå‘çš„é¢‘ç¹ã€‚å‡ºç°äº†å¾ˆå¤šæ–°çš„è¯è¯­ï¼Œåœ¨åŸæœ‰çš„è¯æ±‡åˆ—è¡¨ä¸­å¹¶ä¸å­˜åœ¨ã€‚æ¯”å¦‚ï¼šâ€œå¥¥åŠ›ç»™â€ï¼Œâ€œä¼ æ™ºæ’­å®¢â€ ç­‰ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„è¯æ±‡ä¹Ÿéœ€è¦ä¸æ–­çš„æ›´æ–°ï¼ŒIKåˆ†è¯å™¨æä¾›äº†æ‰©å±•è¯æ±‡çš„åŠŸèƒ½ã€‚</p>
<p>1ï¼‰æ‰“å¼€IKåˆ†è¯å™¨configç›®å½•ï¼š<code>/var/lib/docker/volumes/es-plugins/_data/ik/config/IKAnalyzer.cfg.xml</code></p>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20210506112225508.png" alt="image-20210506112225508"></p>
<p>2ï¼‰åœ¨IKAnalyzer.cfg.xmlé…ç½®æ–‡ä»¶å†…å®¹æ·»åŠ ï¼š</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE properties SYSTEM &quot;http://java.sun.com/dtd/properties.dtd&quot;&gt;
&lt;properties&gt;
        &lt;comment&gt;IK Analyzer æ‰©å±•é…ç½®&lt;/comment&gt;
      
        &lt;entry key=&quot;ext_dict&quot;&gt;ext.dic&lt;/entry&gt; 
&lt;/properties&gt;
</code></pre>
<p>3ï¼‰æ–°å»ºä¸€ä¸ª ext.dicï¼Œå¯ä»¥å‚è€ƒconfigç›®å½•ä¸‹å¤åˆ¶ä¸€ä¸ªé…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹</p>
<pre><code class="properties">ä¼ æ™ºæ’­å®¢
å¥¥åŠ›ç»™
</code></pre>
<p>4ï¼‰é‡å¯elasticsearch </p>
<pre><code class="sh">docker restart es

# æŸ¥çœ‹ æ—¥å¿—
docker logs -f es
</code></pre>
<p><img src="E:\å¹¿å·é»‘é©¬JavaEEå°±ä¸š198æœŸâ€”æ´ªå“¥\å¾®æœåŠ¡\es\day1-es\èµ„æ–™\assets\image-20201115230900504.png" alt="image-20201115230900504"></p>
<p>æ—¥å¿—ä¸­å·²ç»æˆåŠŸåŠ è½½ext.dicé…ç½®æ–‡ä»¶</p>
<p>5ï¼‰æµ‹è¯•æ•ˆæœï¼š</p>
<pre><code class="json">GET /_analyze
&#123;
  &quot;analyzer&quot;: &quot;ik_max_word&quot;,
  &quot;text&quot;: &quot;ä¼ æ™ºæ’­å®¢Javaå°±ä¸šè¶…è¿‡90%,å¥¥åŠ›ç»™ï¼&quot;
&#125;
</code></pre>
<blockquote>
<p>æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯ UTF-8 æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ï¼Œå¯ä»¥ç›´æ¥linuxç³»ç»Ÿviç¼–è¾‘</p>
</blockquote>
<h2 id="3-4-åœç”¨è¯è¯å…¸"><a href="#3-4-åœç”¨è¯è¯å…¸" class="headerlink" title="3.4 åœç”¨è¯è¯å…¸"></a>3.4 åœç”¨è¯è¯å…¸</h2><p>åœ¨äº’è”ç½‘é¡¹ç›®ä¸­ï¼Œåœ¨ç½‘ç»œé—´ä¼ è¾“çš„é€Ÿåº¦å¾ˆå¿«ï¼Œæ‰€ä»¥å¾ˆå¤šè¯­è¨€æ˜¯ä¸å…è®¸åœ¨ç½‘ç»œä¸Šä¼ é€’çš„ï¼Œå¦‚ï¼šå…³äºå®—æ•™ã€æ”¿æ²»ç­‰æ•æ„Ÿè¯è¯­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœç´¢æ—¶ä¹Ÿåº”è¯¥å¿½ç•¥å½“å‰è¯æ±‡ã€‚</p>
<p>IKåˆ†è¯å™¨ä¹Ÿæä¾›äº†å¼ºå¤§çš„åœç”¨è¯åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬åœ¨ç´¢å¼•æ—¶å°±ç›´æ¥å¿½ç•¥å½“å‰çš„åœç”¨è¯æ±‡è¡¨ä¸­çš„å†…å®¹ã€‚</p>
<p>1ï¼‰IKAnalyzer.cfg.xmlé…ç½®æ–‡ä»¶å†…å®¹æ·»åŠ ï¼š</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE properties SYSTEM &quot;http://java.sun.com/dtd/properties.dtd&quot;&gt;
&lt;properties&gt;
        &lt;comment&gt;IK Analyzer æ‰©å±•é…ç½®&lt;/comment&gt;
        &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸--&gt;
        &lt;entry key=&quot;ext_dict&quot;&gt;ext.dic&lt;/entry&gt;
         &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸  *** æ·»åŠ åœç”¨è¯è¯å…¸--&gt;
        &lt;entry key=&quot;ext_stopwords&quot;&gt;stopword.dic&lt;/entry&gt;
&lt;/properties&gt;
</code></pre>
<p>3ï¼‰åœ¨ stopword.dic æ·»åŠ åœç”¨è¯</p>
<pre><code class="properties">ä¹ å¤§å¤§
</code></pre>
<p>4ï¼‰é‡å¯elasticsearch </p>
<pre><code class="sh"># é‡å¯æœåŠ¡
docker restart es
docker restart kibana

# æŸ¥çœ‹ æ—¥å¿—
docker logs -f es
</code></pre>
<p>æ—¥å¿—ä¸­å·²ç»æˆåŠŸåŠ è½½stopword.dicé…ç½®æ–‡ä»¶</p>
<p>5ï¼‰æµ‹è¯•æ•ˆæœï¼š</p>
<pre><code class="json">GET /_analyze
&#123;
  &quot;analyzer&quot;: &quot;ik_max_word&quot;,
  &quot;text&quot;: &quot;ä¼ æ™ºæ’­å®¢Javaå°±ä¸šç‡è¶…è¿‡95%,ä¹ å¤§å¤§éƒ½ç‚¹èµ,å¥¥åŠ›ç»™ï¼&quot;
&#125;
</code></pre>
<blockquote>
<p>æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯ UTF-8 æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘</p>
</blockquote>
<hr>
<hr>
<h4 id="ç´¢å¼•åº“æ“ä½œ"><a href="#ç´¢å¼•åº“æ“ä½œ" class="headerlink" title="ç´¢å¼•åº“æ“ä½œ"></a>ç´¢å¼•åº“æ“ä½œ</h4><h5 id="mappingå±æ€§"><a href="#mappingå±æ€§" class="headerlink" title="mappingå±æ€§"></a>mappingå±æ€§</h5><h6 id="mappingæ˜¯å¯¹ç´¢å¼•åº“ä¸­æ–‡æ¡£çš„çº¦æŸï¼Œå¸¸è§çš„mappingå±æ€§åŒ…æ‹¬ï¼š"><a href="#mappingæ˜¯å¯¹ç´¢å¼•åº“ä¸­æ–‡æ¡£çš„çº¦æŸï¼Œå¸¸è§çš„mappingå±æ€§åŒ…æ‹¬ï¼š" class="headerlink" title="mappingæ˜¯å¯¹ç´¢å¼•åº“ä¸­æ–‡æ¡£çš„çº¦æŸï¼Œå¸¸è§çš„mappingå±æ€§åŒ…æ‹¬ï¼š"></a>mappingæ˜¯å¯¹ç´¢å¼•åº“ä¸­æ–‡æ¡£çš„çº¦æŸï¼Œå¸¸è§çš„mappingå±æ€§åŒ…æ‹¬ï¼š</h6><p>â€¢ typeï¼šå­—æ®µæ•°æ®ç±»å‹ï¼Œå¸¸è§çš„ç®€å•ç±»å‹æœ‰ï¼š<br>â€¢ å­—ç¬¦ä¸²ï¼štextï¼ˆå¯åˆ†è¯çš„æ–‡æœ¬ï¼‰ã€<strong>keyword</strong>ï¼ˆç²¾ç¡®å€¼ï¼Œä¾‹å¦‚ï¼šå“ç‰Œã€å›½å®¶ã€ipåœ°å€ï¼‰<br>â€¢ æ•°å€¼ï¼šlongã€integerã€shortã€byteã€doubleã€float<br>â€¢ å¸ƒå°”ï¼šboolean<br>â€¢ æ—¥æœŸï¼šdate<br>â€¢ å¯¹è±¡ï¼šobject<br>â€¢ indexï¼šæ˜¯å¦åˆ›å»ºç´¢å¼•ï¼Œé»˜è®¤ä¸ºtrueã€é»˜è®¤å€’æ’ã€‘<br>â€¢ analyzerï¼šä½¿ç”¨å“ªç§åˆ†è¯å™¨ã€åªæœ‰textæ‰éœ€è¦åˆ†è¯ã€‘<br>â€¢ propertiesï¼šè¯¥å­—æ®µçš„å­å­—æ®µ</p>
<pre><code class="java">&#123;
Â Â Â Â &quot;age&quot;:Â 21,
Â Â Â Â &quot;weight&quot;:Â 52.1,
Â Â Â Â &quot;isMarried&quot;:Â false,
Â Â Â Â &quot;info&quot;:Â &quot;é»‘é©¬ç¨‹åºå‘˜Javaè®²å¸ˆ&quot;,
    &quot;email&quot;:Â &quot;zy@itcast.cn&quot;,
    &quot;score&quot;:Â [99.1, 99.5, 98.9],
Â Â Â Â &quot;name&quot;:Â &#123;
Â Â Â Â Â Â Â Â &quot;firstName&quot;:Â &quot;äº‘&quot;,
Â Â Â Â Â Â Â Â &quot;lastName&quot;:Â &quot;èµµ&quot;
Â Â Â Â &#125;
&#125;
</code></pre>
<h5 id="ç´¢å¼•åº“æ“ä½œ-1"><a href="#ç´¢å¼•åº“æ“ä½œ-1" class="headerlink" title="ç´¢å¼•åº“æ“ä½œ"></a>ç´¢å¼•åº“æ“ä½œ</h5><h6 id="åˆ›å»ºç´¢å¼•åº“å’Œmappingçš„è¯·æ±‚è¯­æ³•"><a href="#åˆ›å»ºç´¢å¼•åº“å’Œmappingçš„è¯·æ±‚è¯­æ³•" class="headerlink" title="åˆ›å»ºç´¢å¼•åº“å’Œmappingçš„è¯·æ±‚è¯­æ³•"></a>åˆ›å»ºç´¢å¼•åº“å’Œmappingçš„è¯·æ±‚è¯­æ³•</h6><pre><code class="java">PUTÂ /ç´¢å¼•åº“åç§°
&#123;
Â Â &quot;mappings&quot;:Â &#123;
Â Â Â Â &quot;properties&quot;:Â &#123;
Â Â Â Â Â Â &quot;å­—æ®µå&quot;:&#123;
Â Â Â Â Â Â Â Â &quot;type&quot;:Â &quot;text&quot;,
Â Â Â Â Â Â Â Â &quot;analyzer&quot;:Â &quot;ik_smart&quot;
Â Â Â Â Â Â &#125;,
Â Â Â Â Â Â &quot;å­—æ®µå2&quot;:&#123;
Â Â Â Â Â Â Â Â &quot;type&quot;:Â &quot;keyword&quot;,
Â Â Â Â Â Â Â Â &quot;index&quot;:Â &quot;false&quot;
Â Â Â Â Â Â &#125;,
Â Â Â Â Â Â &quot;å­—æ®µå3&quot;:&#123;
Â Â Â Â Â Â Â Â &quot;properties&quot;:Â &#123;
Â Â Â Â Â Â Â Â Â Â &quot;å­å­—æ®µ&quot;:Â &#123;
Â Â Â Â Â Â Â Â Â Â Â Â &quot;type&quot;:Â &quot;keyword&quot;
Â Â Â Â Â Â Â Â Â Â &#125;
Â Â Â Â Â Â Â Â &#125;
Â Â Â Â Â Â &#125;,
      // ...ç•¥
Â Â Â Â &#125;
Â Â &#125;
&#125;
</code></pre>
<p>â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“    â†“ â†“</p>
<pre><code class="java"># åˆ›å»ºç´¢å¼•åº“
PUT /heima
&#123;
  &quot;mappings&quot;: &#123;
    &quot;properties&quot;: &#123;
      &quot;info&quot;:&#123;
        &quot;type&quot;: &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_max_word&quot;
      &#125;,
      &quot;email&quot;:&#123;
        &quot;type&quot;: &quot;keyword&quot;,
        &quot;index&quot;: false
      &#125;,
      &quot;name&quot;:&#123;
        &quot;type&quot;: &quot;object&quot;,
        &quot;properties&quot;: &#123;
          &quot;firstName&quot;:&#123;
            &quot;type&quot;: &quot;keyword&quot;
          &#125;,
          &quot;lastName&quot;:&#123;
            &quot;type&quot;: &quot;keyword&quot;
          &#125;
        &#125;
      &#125;
    &#125;
  &#125;
&#125;
---------------------------------------------------------------------
&#123;
  &quot;acknowledged&quot; : true,
  &quot;shards_acknowledged&quot; : true,
  &quot;index&quot; : &quot;heima&quot;
&#125;
</code></pre>
<h4 id="æ“ä½œç´¢å¼•åº“ç¦æ­¢ä¿®æ”¹ç´¢å¼•åº“-å› ä¸ºå·²ç»æ˜ å°„å¥½äº†"><a href="#æ“ä½œç´¢å¼•åº“ç¦æ­¢ä¿®æ”¹ç´¢å¼•åº“-å› ä¸ºå·²ç»æ˜ å°„å¥½äº†" class="headerlink" title="æ“ä½œç´¢å¼•åº“ç¦æ­¢ä¿®æ”¹ç´¢å¼•åº“(å› ä¸ºå·²ç»æ˜ å°„å¥½äº†)"></a>æ“ä½œç´¢å¼•åº“<del>ç¦æ­¢ä¿®æ”¹ç´¢å¼•åº“(å› ä¸ºå·²ç»æ˜ å°„å¥½äº†)</del></h4><h6 id="æŸ¥çœ‹ç´¢å¼•è¯­æ³•ï¼š"><a href="#æŸ¥çœ‹ç´¢å¼•è¯­æ³•ï¼š" class="headerlink" title="æŸ¥çœ‹ç´¢å¼•è¯­æ³•ï¼š"></a>æŸ¥çœ‹ç´¢å¼•è¯­æ³•ï¼š</h6><p><code>GET/ç´¢å¼•å</code></p>
<h6 id="åˆ é™¤ç´¢å¼•åº“çš„è¯­æ³•ï¼š"><a href="#åˆ é™¤ç´¢å¼•åº“çš„è¯­æ³•ï¼š" class="headerlink" title="åˆ é™¤ç´¢å¼•åº“çš„è¯­æ³•ï¼š"></a>åˆ é™¤ç´¢å¼•åº“çš„è¯­æ³•ï¼š</h6><p><code>DELETE/ç´¢å¼•åº“å</code></p>
<h6 id="å¯ä»¥åœ¨ä¿®æ”¹ç´¢å¼•çš„è¿‡ç¨‹ä¸­æ·»åŠ æ–°çš„å­—æ®µ"><a href="#å¯ä»¥åœ¨ä¿®æ”¹ç´¢å¼•çš„è¿‡ç¨‹ä¸­æ·»åŠ æ–°çš„å­—æ®µ" class="headerlink" title="å¯ä»¥åœ¨ä¿®æ”¹ç´¢å¼•çš„è¿‡ç¨‹ä¸­æ·»åŠ æ–°çš„å­—æ®µ"></a>å¯ä»¥åœ¨ä¿®æ”¹ç´¢å¼•çš„è¿‡ç¨‹ä¸­æ·»åŠ æ–°çš„å­—æ®µ</h6><pre><code class="java">PUTÂ /ç´¢å¼•åº“å/_mapping
&#123;
Â Â &quot;properties&quot;:Â &#123;
Â Â Â Â &quot;æ–°å­—æ®µå&quot;:&#123;
Â Â Â Â Â Â &quot;type&quot;:Â &quot;integer&quot;
Â Â Â Â &#125;
Â Â &#125;
&#125;
---------------------------
PUTÂ /heima/_mapping
&#123;
Â Â &quot;properties&quot;:Â &#123;
Â Â Â Â &quot;age&quot;:&#123;
Â Â Â Â Â Â &quot;type&quot;:Â &quot;integer&quot;
Â Â Â Â &#125;
Â Â &#125;
&#125;
</code></pre>
<blockquote>
<p>å½“æ‚¨ä½¿ç”¨Elasticsearchï¼ˆESï¼‰çš„PUTè¯·æ±‚åˆ›å»ºç´¢å¼•åº“æ—¶ï¼Œè¿™ä¸ªç´¢å¼•åº“å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨Elasticsearché›†ç¾¤çš„èŠ‚ç‚¹ä¸Šçš„ã€‚å¦‚æœæ‚¨çš„Elasticsearché›†ç¾¤æ˜¯å®‰è£…åœ¨LinuxæœåŠ¡å™¨ä¸Šçš„ï¼Œé‚£ä¹ˆæ˜¯çš„ï¼Œç´¢å¼•åº“ä¼šè¢«åˆ›å»ºåœ¨Linuxæ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</p>
<p>Elasticsearchä¸ºæ¯ä¸ªç´¢å¼•åˆ†é…ä¸€ä¸ªæˆ–å¤šä¸ªä¸»åˆ†ç‰‡ï¼Œå¹¶ä¸ºæ¯ä¸ªä¸»åˆ†ç‰‡åˆ†é…ä¸€ä¸ªæˆ–å¤šä¸ªå‰¯æœ¬åˆ†ç‰‡ã€‚è¿™äº›åˆ†ç‰‡å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨ElasticsearchèŠ‚ç‚¹çš„æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ã€‚å…·ä½“æ¥è¯´ï¼Œç´¢å¼•æ•°æ®å­˜å‚¨åœ¨ä»¥ä¸‹è·¯å¾„ï¼š</p>
<p>å¤åˆ¶</p>
<pre><code>/path/to/elasticsearch/data/nodes/&lt;node-id&gt;/&lt;index&gt;/&lt;shard-id&gt;
</code></pre>
<p>è¿™é‡Œçš„<code>/path/to/elasticsearch</code>æ˜¯Elasticsearchçš„å®‰è£…è·¯å¾„ï¼Œ<code>data</code>ç›®å½•æ˜¯é»˜è®¤çš„æ•°æ®å­˜å‚¨ä½ç½®ï¼Œ<code>nodes</code>ç›®å½•åŒ…å«äº†é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„æ•°æ®ï¼Œ<code>&lt;node-id&gt;</code>æ˜¯èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ï¼Œ<code>&lt;index&gt;</code>æ˜¯æ‚¨åˆ›å»ºçš„ç´¢å¼•åç§°ï¼Œè€Œ<code>&lt;shard-id&gt;</code>åˆ™æ˜¯åˆ†ç‰‡çš„IDã€‚</p>
</blockquote>
<h4 id="ç´¢å¼•åº“çš„å¢åˆ æ”¹æŸ¥æ±‡æ€»"><a href="#ç´¢å¼•åº“çš„å¢åˆ æ”¹æŸ¥æ±‡æ€»" class="headerlink" title="ç´¢å¼•åº“çš„å¢åˆ æ”¹æŸ¥æ±‡æ€»"></a>ç´¢å¼•åº“çš„å¢åˆ æ”¹æŸ¥æ±‡æ€»</h4><pre><code class="mysql">
# åˆ›å»ºç´¢å¼•åº“
PUT /heima
&#123;
  &quot;mappings&quot;: &#123;
    &quot;properties&quot;: &#123;
      &quot;info&quot;:&#123;
        &quot;type&quot;: &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_max_word&quot;
      &#125;,
      &quot;email&quot;:&#123;
        &quot;type&quot;: &quot;keyword&quot;,
        &quot;index&quot;: false
      &#125;,
      &quot;name&quot;:&#123;
        &quot;type&quot;: &quot;object&quot;,
        &quot;properties&quot;: &#123;
          &quot;firstName&quot;:&#123;
            &quot;type&quot;: &quot;keyword&quot;
          &#125;,
          &quot;lastName&quot;:&#123;
            &quot;type&quot;: &quot;keyword&quot;
          &#125;
        &#125;
      &#125;
    &#125;
  &#125;
&#125;

# æŸ¥è¯¢
GET /heima

# ä¿®æ”¹ç´¢å¼•åº“
PUT /heima/_mapping
&#123;
  &quot;properties&quot;:&#123;
    &quot;age&quot;:&#123;
      &quot;type&quot;: &quot;integer&quot;
    &#125;
  &#125;
&#125;

# ä¿®æ”¹
DELETE /heima
</code></pre>
<h5 id="æ–‡æ¡£æ“ä½œâ€”â€”æ·»åŠ æ–‡æ¡£"><a href="#æ–‡æ¡£æ“ä½œâ€”â€”æ·»åŠ æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£æ“ä½œâ€”â€”æ·»åŠ æ–‡æ¡£"></a>æ–‡æ¡£æ“ä½œâ€”â€”æ·»åŠ æ–‡æ¡£</h5><pre><code class="mysql"># æ¯æ¬¡å†™æ“ä½œçš„æ—¶å€™ ç‰ˆæœ¬ä¼šå¢åŠ  &quot;_version ++&quot;

# æ’å…¥æ–‡æ¡£
POST /heima/_doc/1
&#123;
  &quot;info&quot;: &quot;å¹¿å·é»‘é©¬198ç­&quot;,
  &quot;email&quot;: &quot;390415049@qq.com&quot;,
  &quot;name&quot;:&#123;
    &quot;firstName&quot;: &quot;æ˜¥&quot;,
    &quot;lastName&quot;: &quot;å°§&quot;
  &#125;
&#125;

# æŸ¥è¯¢æ–‡æ¡£
GET /heima/_doc/1

# åˆ é™¤æ–‡æ¡£
DELETE /heima/_doc/1
</code></pre>
<h5 id="æ–‡æ¡£æ“ä½œâ€”â€”ä¿®æ”¹æ–‡æ¡£"><a href="#æ–‡æ¡£æ“ä½œâ€”â€”ä¿®æ”¹æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£æ“ä½œâ€”â€”ä¿®æ”¹æ–‡æ¡£"></a>æ–‡æ¡£æ“ä½œâ€”â€”ä¿®æ”¹æ–‡æ¡£</h5><h6 id="æ–¹å¼ä¸€ï¼šå…¨é‡ä¿®æ”¹ï¼Œä¼šåˆ é™¤æ—§æ–‡æ¡£ï¼Œæ·»åŠ æ–°æ–‡æ¡£"><a href="#æ–¹å¼ä¸€ï¼šå…¨é‡ä¿®æ”¹ï¼Œä¼šåˆ é™¤æ—§æ–‡æ¡£ï¼Œæ·»åŠ æ–°æ–‡æ¡£" class="headerlink" title="æ–¹å¼ä¸€ï¼šå…¨é‡ä¿®æ”¹ï¼Œä¼šåˆ é™¤æ—§æ–‡æ¡£ï¼Œæ·»åŠ æ–°æ–‡æ¡£"></a>æ–¹å¼ä¸€ï¼šå…¨é‡ä¿®æ”¹ï¼Œä¼šåˆ é™¤æ—§æ–‡æ¡£ï¼Œæ·»åŠ æ–°æ–‡æ¡£</h6><pre><code class="java">PUTÂ /ç´¢å¼•åº“å/_doc/æ–‡æ¡£id
&#123;
Â Â Â Â &quot;å­—æ®µ1&quot;:Â &quot;å€¼1&quot;,
Â Â Â Â &quot;å­—æ®µ2&quot;:Â &quot;å€¼2&quot;,
    // ... ç•¥
&#125;
-------------------------
PUTÂ /heima/_doc/1
&#123;
Â Â Â Â &quot;info&quot;:Â &quot;é»‘é©¬ç¨‹åºå‘˜é«˜çº§Javaè®²å¸ˆ&quot;,
Â Â Â Â &quot;email&quot;:Â &quot;zy@itcast.cn&quot;,
Â Â Â Â &quot;name&quot;:Â &#123;
Â Â Â Â Â Â Â Â &quot;firstName&quot;:Â &quot;äº‘&quot;,
Â Â Â Â Â Â Â Â &quot;lastName&quot;:Â &quot;èµµ&quot;
Â Â Â Â &#125;
&#125;


# å…¨é‡ä¿®æ”¹æ–‡æ¡£
POST /heima/_doc/1
&#123;
  &quot;info&quot;: &quot;å¹¿å·é»‘é©¬198ç­&quot;,
  &quot;email&quot;: &quot;90415049@qq.com&quot;,
  &quot;name&quot;:&#123;
    &quot;firstName&quot;: &quot;å°§&quot;,
    &quot;lastName&quot;: &quot;æ˜¥&quot;
  &#125;
&#125;
</code></pre>
<h6 id="æ–¹å¼äºŒï¼šå¢é‡ä¿®æ”¹ï¼Œä¿®æ”¹æŒ‡å®šå­—æ®µå€¼"><a href="#æ–¹å¼äºŒï¼šå¢é‡ä¿®æ”¹ï¼Œä¿®æ”¹æŒ‡å®šå­—æ®µå€¼" class="headerlink" title="æ–¹å¼äºŒï¼šå¢é‡ä¿®æ”¹ï¼Œä¿®æ”¹æŒ‡å®šå­—æ®µå€¼"></a>æ–¹å¼äºŒï¼šå¢é‡ä¿®æ”¹ï¼Œä¿®æ”¹æŒ‡å®šå­—æ®µå€¼</h6><pre><code class="java">POSTÂ /ç´¢å¼•åº“å/_update/æ–‡æ¡£id
&#123;
Â Â Â Â &quot;doc&quot;: &#123;
         &quot;å­—æ®µå&quot;:Â &quot;æ–°çš„å€¼&quot;,
    &#125;
&#125;
-------------------------
POSTÂ /heima/_update/1
&#123;
Â Â &quot;doc&quot;:Â &#123;
Â Â Â Â &quot;email&quot;:Â &quot;ZhaoYun@itcast.cn&quot;
Â Â &#125;
&#125;


# å±€éƒ¨ä¿®æ”¹æ–‡æ¡£
POST /heima/_update/1
&#123;
  &quot;doc&quot;: &#123;
    &quot;email&quot;: &quot;ZYun@itcast.cn&quot;
  &#125;
&#125;
</code></pre>
<h6 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h6><p>æ–‡æ¡£æ“ä½œæœ‰å“ªäº›ï¼Ÿ</p>
<ul>
<li><p>åˆ›å»ºæ–‡æ¡£ï¼šPOST &#x2F;ç´¢å¼•åº“å&#x2F;_doc&#x2F;æ–‡æ¡£id { jsonæ–‡æ¡£ }</p>
</li>
<li><p>æŸ¥è¯¢æ–‡æ¡£ï¼šGET &#x2F;ç´¢å¼•åº“å&#x2F;_doc&#x2F;æ–‡æ¡£id</p>
</li>
<li><p>åˆ é™¤æ–‡æ¡£ï¼šDELETE &#x2F;ç´¢å¼•åº“å&#x2F;_doc&#x2F;æ–‡æ¡£id</p>
</li>
<li><p>ä¿®æ”¹æ–‡æ¡£ï¼š</p>
<ul>
<li><p>å…¨é‡ä¿®æ”¹ï¼šPUT &#x2F;ç´¢å¼•åº“å&#x2F;_doc&#x2F;æ–‡æ¡£id { jsonæ–‡æ¡£ }</p>
</li>
<li><p>å¢é‡ä¿®æ”¹ï¼šPOST &#x2F;ç´¢å¼•åº“å&#x2F;_update&#x2F;æ–‡æ¡£id { â€œdocâ€: {å­—æ®µ}}</p>
</li>
</ul>
</li>
</ul>
<h3 id="JavaRestClient"><a href="#JavaRestClient" class="headerlink" title="JavaRestClient"></a>JavaRestClient</h3><p>Elasticsearchç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯8.0ï¼Œå…¶Javaå®¢æˆ·ç«¯æœ‰å¾ˆå¤§å˜åŒ–ã€‚ä¸è¿‡å¤§å¤šæ•°ä¼ä¸šä½¿ç”¨çš„è¿˜æ˜¯8ä»¥ä¸‹ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨æ—©æœŸçš„JavaRestClientå®¢æˆ·ç«¯æ¥å­¦ä¹ ã€‚å®˜æ–¹æ–‡æ¡£åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/client/index.html">Elasticsearch Clients | Elastic</a></p>

            
        </div>
    </div>

    <div class="post-tags">
        
        <span class="icon">
            <a-icon type="tags" theme="filled" />
        </span>
        
        
        <span class="tag">
            
            <a href="/tags/åç«¯" style=color:#ff7d73>
                åç«¯
            </a>
        </span>
        
    </div>

    <a href="/2025/01/03/åç«¯/ElasticSearch/ " class="go-post">
        é˜…è¯»å…¨æ–‡
    </a>
</div>


             
<div class="page-current">

    <div class="prev">
        
        <a href="/">
            <span class="page-num">
                <a-icon type="caret-left" theme="filled" />
            </span>
        </a>
        
    </div>

    <div class="page-index">

        
        <span>

            

            
            <a href="/">
                <span class="page-num">
                    1
                </span>
            </a>
        </span>
        

        <span class="current">
            2
        </span>

        
        <span>
            <a href="/page/3/">
                <span class="page-num">
                    3
                </span>
            </a>
            
            <a href="/page/4">
                <span class="page-num">
                    4
                </span>
            </a>
            

            
            <span class="page-omit">...</span>
            <a href="/page/14">
                <span class="page-num">
                    14
                </span>
            </a>
            

        </span>
        

    </div>

    <div class="next">
        
        <a href="/page/3/ ">
            <span class="page-num">
                <a-icon type="caret-right" theme="filled" />
            </span>
        </a>
        
    </div>

</div>

        </div>
    </div>
    
    <div id="home-card">
        <a-affix :offset-top="card_top">
    <a-card class="card-style" style="width: 300px">
        <div class="avatar">
            <img src="https://raw.githubusercontent.com/P-luminary/images/master/data/asuna.jpg " alt="å¤´åƒ">
        </div>
        <div class="name">
            Asuna
        </div>
        <div class="descriptions">
            
            <div class="description">
                You are the one who can always get to me even with screen between us.
            </div>
            
        </div>
        <div class="icon-links">
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://github.com/P-luminary">

                    
                    <a-icon type="github"
                        theme="filled" />
                    
                </a>
            </span>
            
            <span class="icon-link">
                <a href="">

                    
                    <a-icon type="twitter"
                        theme="" />
                    
                </a>
            </span>
            
        </div>
        <div class="friend-links">
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://thirsty-c.github.io">
                    èƒƒç—…æ‚£è€…åšå®¢
                </a>
            </div>
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://charet.github.io">
                    ç¤¾æè‚¥å®…åšå®¢
                </a>
            </div>
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://fish214057.github.io">
                    ButterflyFishåšå®¢
                </a>
            </div>
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://mrnobody233.github.io">
                    æœ¨å­æ—¥å¤©åšå®¢
                </a>
            </div>
            
        </div>
    </a-card>
</a-affix>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            Â© 2018 - 2025 P-luminary
            <span class="footer-icon">
                <a-icon type="flag" theme="filled" /></span>
            @Asuna
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a>
<!--         & <a target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div> -->
        
    </div>

</footer>

<script src="/js/highlight.min.js"></script>
<script src="/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

</body>

</html>