
<!DOCTYPE html>
<html lang="zh_CH ">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P-luminary || Appium</title>
    <meta name="author" content="Asuna">
    <meta name="description" content=" ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/https://raw.githubusercontent.com/P-luminary/images/master/data/asuna.jpg">
    <link rel="stylesheet" href="/css/antd.min.css">
    
    <link rel="stylesheet" href="/css/maiden-theme.css">
    
    <script src="/js/vue.js"></script>
    <script src="/js/antd.min.js"></script>
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

    <div id="loading"
        style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div
            style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent"
                style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p>加载过慢请开启缓存(浏览器默认开启)</p>
                    <div>
                        <img src="/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">P-luminary</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled" />
            </span>
            <span>home</span>
        </a>
        
        <a href="/tags/语法">
            <span>
                <a-icon type="tags" theme="filled" />
            </span>
            <span>tags</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled" />
            </span>
            <span>P-luminary</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">home</div>
                </div>
            </a>
            
            <a href="/tags/语法">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="tags" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">tags</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                     
<link rel="stylesheet" href="/css/post-body.css">
<div class="article">
    <div>
        <h1>Appium </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/8/12
        </span>

        

        

        <span class="tags">
            <span class="icon">
                <a-icon type="tags" theme="filled" />
            </span>
            
            <span class="tag">
                
                <a href="/tags/运维" style=color:#ffa2c4>
                    运维
                </a>
            </span>
            
        </span>
        
    </div>

    <div class="content" v-pre>
        <h3 id="测试方面"><a href="#测试方面" class="headerlink" title="测试方面"></a>测试方面</h3><ul>
<li>功能测试</li>
<li>安装卸载测试</li>
<li>升级测试</li>
<li>兼容性测试[不同机型 系统]</li>
<li>网络切换，中断测试</li>
<li>横竖屏切换</li>
<li>健壮性</li>
</ul>
<h3 id="测试环境的搭建"><a href="#测试环境的搭建" class="headerlink" title="测试环境的搭建"></a>测试环境的搭建</h3><h6 id="需要配置的环境："><a href="#需要配置的环境：" class="headerlink" title="需要配置的环境："></a>需要配置的环境：</h6><ul>
<li>java jdk java环境</li>
<li>Android sdk 安卓环境</li>
<li>python环境<ul>
<li>第三库：appium</li>
</ul>
</li>
<li>使用真机或模拟器进行测试【夜神模拟器】</li>
</ul>
<h4 id="环境搭建验证测试"><a href="#环境搭建验证测试" class="headerlink" title="环境搭建验证测试"></a>环境搭建验证测试</h4><p>模拟器或真机</p>
<p>在cmd中输入 <code>adb devices</code> 会返回ip地址和端口号<br>获取系统版本号输入 <code>adb shell getprop ro.build.version.release</code><br>获取虚拟器里的app名称 <code>adb shell dumpsys window windows | findstr mFocusedApp</code></p>
<blockquote>
<p>{c361382 u0 com.android.settings&#x2F;.Settings t9}}}  &#x2F;.后面是界面的名字    u0后 &#x2F;.前是app名称</p>
</blockquote>
<pre><code class="python">import time

from appium import webdriver
from selenium.webdriver.common.by import by  #【利用by自动获取信息】

# 配置手机连接的参数信息
# 参数信息都是以键值对的方式进行连接
desired_caps = &#123;&#125;

# 设备的名称
desired_caps[&quot;deviceName&quot;] = &quot;127.0.0.1:62001&quot;

# 系统
desired_caps[&quot;platformName&quot;] = &quot;Android&quot;

# 系统版本号
desired_caps[&quot;platformVersion&quot;] = &quot;7.1.2&quot;

# 启动的app名称
## com.android.settings
desired_caps[&quot;appPackage&quot;] = &quot;com.android.settings&quot;

# 启动的app界面：.Settings
desired_caps[&quot;appActivity&quot;] = &quot;.Settings&quot;

# print(desired_caps)

# 发送链接  用的appium的端口  用关键字传参
driver = webdriver.Remote(&quot;http://127.0.0.1:4723/wd/hub&quot;,desired_capabilities = desired_caps)

time.sleep(5)
driver.quit()
...
...
</code></pre>
<h3 id="app自动化测试的流程"><a href="#app自动化测试的流程" class="headerlink" title="app自动化测试的流程"></a>app自动化测试的流程</h3><h6 id="①-首先明确项目的核心模块"><a href="#①-首先明确项目的核心模块" class="headerlink" title="① 首先明确项目的核心模块"></a>① 首先明确项目的核心模块</h6><ul>
<li><strong>注册登录</strong></li>
<li><strong>阅读文章</strong></li>
<li><strong>搜索内容</strong></li>
<li><strong>发布评论</strong></li>
<li><strong>关注订阅</strong></li>
<li><strong>私信聊天</strong></li>
<li><strong>点赞等等</strong></li>
</ul>
<h6 id="②-设计用例脚本"><a href="#②-设计用例脚本" class="headerlink" title="② 设计用例脚本"></a>② 设计用例脚本</h6><p>分析用例执行的步骤</p>
<ul>
<li>进入app首页</li>
<li>点击我的界面</li>
<li>点击登录&#x2F;注册</li>
<li>点击使用邮箱登录&#x2F;注册</li>
<li>输入邮箱号</li>
<li>输入密码</li>
<li>点击登录</li>
<li>登录成功&#x2F;失败</li>
<li>进行断言</li>
</ul>
<h5 id="自动截取虚拟器上界面的图片查看详情"><a href="#自动截取虚拟器上界面的图片查看详情" class="headerlink" title="自动截取虚拟器上界面的图片查看详情"></a>自动截取虚拟器上界面的图片查看详情</h5><p><code>D:\android_sdk_test\tools\uiautomatorviewer.bat</code></p>
<p><span style = "color:red">若两个 <code>resource-id</code> 定位是一样的那么就需要手写XPATH【resource-id必须唯一！！】</span></p>
<pre><code class="mysql">####### 这些都是线性脚本！！！
# 两个斜杠是代表当前界面所有的元素  增加个文本标识
driver.find_element(By.XPATH,&#39;//*[@text=&quot;我的&quot;]&#39;).click()
# 点击登录/注册
driver.find_element(By.ID,&#39;io.manong.developerdaily:id/login_btn&#39;).click()
# 点击使用邮箱登录/注册   这里有报错是因为代码执行很快 但界面有延迟 需要加等待
time.sleep(2)
driver.find_element(By.ID,&#39;io.manong.developerdaily:id/btn_email&#39;).click()

# 输入邮箱号
time.sleep(2)
driver.find_element(By.ID,&#39;io.manong.developerdaily:id/edt_email&#39;).send_keys(&quot;zzz@qq.com&quot;)
# 输入密码
driver.find_element(By.ID,&#39;io.manong.developerdaily:id/edt_email&#39;).send_keys(&quot;123123&quot;)
# 点击登录
driver.find_element(By.XPATH,&#39;//*[@text=&quot;登录&quot;]&#39;).click()
# 用户名是tata
try:
name_text = driver.find_element(By.XPATH,&#39;io.manong.developerdaily:id/nav_tv_name&#39;).click()
if name_text == &quot;tata&quot;:
    print(&quot;登录成功&quot;)

# - 登录成功/失败
# - 进行断言
    assert name_text == &quot;tata&quot;
except:
    login_failed_msg = driver.find_element(By.XPATH,&#39;io.manong.developerdaily:id/forgot&#39;).click()
    print(&quot;登录失败&quot;)
    assert login_failed_msg == &quot;忘了密码？点此找回&quot;
time.sleep(5)
...
...
</code></pre>
<p>若换了一个模块要重新截图 选取不同的app界面<br><span style = "color:red">这些用例测试属于<strong>冒烟测试</strong>的过程</span></p>
<blockquote>
<p><strong>Allure</strong>是一款灵活、轻量级的多语言测试报告工具，旨在生成美观且易于阅读的测试报告。它由Qameta Software团队开源，支持多种测试框架，如Pytest和TestNG等。Allure不仅可以快速查看测试结果，还能帮助团队成员清晰了解测试过程中的缺陷和问题。通过Allure，用户可以轻松集成测试用例，并生成统一格式的报告，提升测试的可读性和有效性。 </p>
</blockquote>
<h3 id="总结梳理"><a href="#总结梳理" class="headerlink" title="总结梳理"></a>总结梳理</h3><h6 id="核心业务流程梳理"><a href="#核心业务流程梳理" class="headerlink" title="核心业务流程梳理"></a>核心业务流程梳理</h6><ul>
<li>需求分析</li>
<li>设计用例脚本</li>
<li><strong>编写自动化测试脚本</strong><ul>
<li>将冒烟测试的脚本进行深度封装和模式设计<ul>
<li>选择设计模式：<ul>
<li>POM设计模式</li>
<li>KDT设计模式</li>
</ul>
</li>
<li>引入测试框架pytest结合设计模式进行深度封装</li>
<li>执行过程中进行日志信息的记录log</li>
<li>执行完成之后自动化完成测试报告allure</li>
<li>持续集成Jenkins</li>
</ul>
</li>
</ul>
</li>
<li>脚本维护以及迭代更新</li>
</ul>
<p>app自动化测试的核心技能点：</p>
<p><span style = "color:red"><strong>Python + Appium + pytest + parametrize + csv + pom + log + Allure + Jenkins</strong></span></p>
<h3 id="项目梳理及描述"><a href="#项目梳理及描述" class="headerlink" title="项目梳理及描述"></a>项目梳理及描述</h3><p><span style = "color:blue">脚本执行的时候会直接发送给Appium服务器 执行py代码后 在Appium会执行许多<strong>adb</strong>的命令 再去控制手机 完成自动化测试</span>【线性模块 正反例要跑通噢】</p>
<p>站在项目已经完成雏形的基础上，进行项目梳理和总结</p>
<ul>
<li><p>整个项目中的文件解析</p>
<ul>
<li>每个文件包和模块具体的使用规范</li>
</ul>
</li>
<li><p>整个项目中的模块与文件之间的联系</p>
<ul>
<li>各个模块及包之间的导入使用</li>
</ul>
</li>
<li><p>整体从项目完成之后的角度触发去讲解项目搭建流程以及使用规范</p>
<ul>
<li><p><strong>搭建app自动化测试环境</strong>：</p>
<ul>
<li>安卓sdk</li>
<li>java的sdk</li>
<li>安装appium</li>
<li>使用真机或者安装手机模拟器</li>
<li>安装第三方库：Appium-Python-Client</li>
</ul>
</li>
<li><p><strong>编写自动化的用例线性脚本</strong></p>
<ul>
<li><p>新建一个项目</p>
</li>
<li><p>创建一个script脚本包</p>
<ul>
<li><p>梳理核心业务模块和功能</p>
<ul>
<li>登录</li>
<li>注册</li>
<li>点赞评论收藏</li>
<li>发布文章</li>
<li>浏览文章</li>
<li>…</li>
</ul>
</li>
<li><p>创建py模型进行线性脚本编写</p>
<ul>
<li>通过核心业务流程模块梳理出线性脚本的执行步骤</li>
<li>然后通过编写自动化用例脚本执行完成第一轮正反例的<strong>冒烟测试</strong><ul>
<li>梳理被操作元素以及具体操作方法</li>
<li>执行正反例之后进行断言</li>
<li>保证自动化用例的准确性</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>若是那种本身图标没有id 没有任何标志的 比如点赞，收藏，评论 就可以直接通过<strong>坐标去定位</strong>【要考虑分辨率和坐标以及机型】<br>回归测试一般只需要正例脚本！！！</p>
<ul>
<li><p><strong>选择设计模式pom</strong>【Page Object Model页面对象模型的简称】</p>
<ul>
<li>封装<ul>
<li>一个类就是一个流程用例或者一个界面</li>
<li>将界面中需要被操作的每一个元素封装成类属性</li>
<li>将界面中需要被执行的用例步骤定义成一个实例方法</li>
</ul>
</li>
<li>使用<ul>
<li>创建页面类对象</li>
<li>通过对象调用方法执行用例步骤脚本</li>
<li>获取实际结果进行断言</li>
</ul>
</li>
<li>整个页面封装</li>
<li>将线性文件进行封装</li>
</ul>
</li>
<li><p><strong>引入测试框架结合用例执行以及管理</strong></p>
<ul>
<li>用例进行综合管理</li>
<li>使用参数化进行数据驱动测试：</li>
</ul>
<pre><code class="python">@pytest.mark.parametrize(&quot;user_email, password, t_a_f&quot;,[
    [&quot; &quot;, &quot;123123&quot;, False],
    [&quot;123@qq.com&quot;, &quot;123123&quot;, True],
    ...
])
</code></pre>
<ul>
<li>一般情况在用例执行之前讲参数化使用的实参进行读取使用<ul>
<li>数据量比较多的情况下会使用不同的文件格式存储数据<ul>
<li>Csv</li>
<li>text</li>
<li>Excel</li>
<li>yaml</li>
<li>JSON</li>
<li>…</li>
</ul>
</li>
<li>数据驱动测试主要核心就是在用例设计的过程中，把所有用例需要的正反例数据进行保存</li>
<li>然后再使用的时候进行读取自动化操作用例完成脚本内容</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>日志信息的记录</strong></p>
</li>
<li><p><strong>缺陷报告的生成</strong></p>
</li>
<li><p><strong>持续集成的处理</strong></p>
</li>
</ul>
<p>单独执行某个用例<code>(venv) D:\app_project&gt;pytest -vsk test_login</code><br>有很多其他的需要保持登录的情况下进行测试 ↓</p>
<pre><code class="python"># 点赞评论及收藏
def test_like_comment_collect(go_login):
    # 创建页面类对象
    l_c_l_page = LikeCommentCollectPage(go_login)
    # 通过对象调用方法执行用例步骤
    l_c_l_page.execute_cases()
    
# 发布文章
def test_publish_article(go_login):...

# 浏览文章
def test_browse_article(go_login):...
</code></pre>
<h2 id="Pywinauto基本介绍【基本解决找不到元素问题】"><a href="#Pywinauto基本介绍【基本解决找不到元素问题】" class="headerlink" title="Pywinauto基本介绍【基本解决找不到元素问题】"></a>Pywinauto基本介绍【基本解决找不到元素问题】</h2><p>主要用于自动化图形用户界面，他提供了一组功能丰富的工具和方法，能够模拟用户的各种操作:点击，输入，文本，选择菜单栏等等…从而实现对Windows应用程序的自动化控制</p>
<h5 id="pywinauto的基本特性"><a href="#pywinauto的基本特性" class="headerlink" title="pywinauto的基本特性"></a>pywinauto的基本特性</h5><ul>
<li>支持跨平台</li>
<li>强大的GUI自动化功能【用户交互图形界面】</li>
<li>简单易用</li>
<li>支持多种应用程序的类型</li>
<li>丰富的文档和社区支持</li>
<li>支持多种GUI框架</li>
<li>图像识别和模糊匹配</li>
</ul>
<h5 id="pywinauto应用场景"><a href="#pywinauto应用场景" class="headerlink" title="pywinauto应用场景"></a>pywinauto应用场景</h5><ul>
<li>自动化测试</li>
<li>ui自动化测试</li>
<li>数据录入和处理</li>
<li>窗口管理</li>
<li>…</li>
</ul>
<h5 id="pywinauto的安装和使用"><a href="#pywinauto的安装和使用" class="headerlink" title="pywinauto的安装和使用"></a>pywinauto的安装和使用</h5><p>需要安装第三方库依赖：pywinauto<br>安装命令：【pycharm可以在某个项目下安装】<br><code>pip install pywinauto</code><br>可以用<code>pip list</code>查看是否安装好了 pywinauto</p>
<h3 id="pywinauto基本使用"><a href="#pywinauto基本使用" class="headerlink" title="pywinauto基本使用"></a>pywinauto基本使用</h3><p>案例：使用pywinauto编写自动化脚本，完成记事本的基本操作<br><strong>操作流程：</strong></p>
<ul>
<li>打开记事本</li>
<li>点击帮助（关于记事本）</li>
<li>点击确定</li>
<li>输入内容</li>
<li>点击关闭记事本</li>
<li>点击不保存</li>
</ul>
<pre><code class="python"># 导包
from pywinauto.application import Application

# 启动记事本  backend=&#39;uia&#39;意思是连接记事本的后端是什么类型
# app = Application(backend=&#39;uia&#39;).start(&#39;notepad.exe&#39;)
app = Application(backend=&#39;win32&#39;).start(&#39;notepad.exe&#39;)

# 点击帮助（关于记事本） 使用快捷键完成打开关于记事本的信息  %是Alt符号  H:h  A:a
app.Notepad.type_keys(&#39;%HA&#39;, pause=1)

# 点击确定  re正则匹配
dlg = app.window(title_re=&#39;关于记事本&#39;)
 # 获取窗口的界面元素信息  【关于记事本的元素架构】
dlg.print_control_identifiers()
 #  点击    不直接调用click是要运用鼠标真实的模拟
time.sleep(1)
dlg[&#39;确定Button&#39;].click_input()

# 输入内容
app.Notepad.type_keys(&#39;xx教育&#39;)
# 点击关闭记事本
 # 菜单栏选择 -&gt;表示子菜单
app.Notepad.menu_select(&quot;文件(&amp;F)-&gt;退出(&amp;X)&quot;)
# 点击不保存
app.window(title_re=&#39;记事本&#39;).window(title_re=&#39;不保存&#39;).cli
</code></pre>
<h6 id="桌面化元素定位工具：UISpy-exe【层级树】、inspect-exe"><a href="#桌面化元素定位工具：UISpy-exe【层级树】、inspect-exe" class="headerlink" title="桌面化元素定位工具：UISpy.exe【层级树】、inspect.exe"></a>桌面化元素定位工具：UISpy.exe【层级树】、inspect.exe</h6>
    </div>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <div id="comment">
        <div id="gitalk-container">
        </div>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2018 - 2025 P-luminary
            <span class="footer-icon">
                <a-icon type="flag" theme="filled" /></span>
            @Asuna
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a>
<!--         & <a target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div> -->
        
    </div>

</footer>

<script src="/js/highlight.min.js"></script>
<script src="/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: 'hexo-theme-particle',      // The repository of store comments,
        owner: 'P-luminary',
        admin: ['P-luminary'],
        language: 'en',
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: true  // Facebook-like distraction free mode
    })
    gitalk.render('gitalk-container')
</script>

</body>

</html>