
<!DOCTYPE html>
<html lang="zh_CH ">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P-luminary || RAGFlowå·¥å…·æŠ€æœ¯æ–‡æ¡£</title>
    <meta name="author" content="Asuna">
    <meta name="description" content=" ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/https://raw.githubusercontent.com/P-luminary/images/master/data/asuna.jpg">
    <link rel="stylesheet" href="/css/antd.min.css">
    
    <link rel="stylesheet" href="/css/maiden-theme.css">
    
    <script src="/js/vue.js"></script>
    <script src="/js/antd.min.js"></script>
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

    <div id="loading"
        style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div
            style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent"
                style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p>åŠ è½½è¿‡æ…¢è¯·å¼€å¯ç¼“å­˜(æµè§ˆå™¨é»˜è®¤å¼€å¯)</p>
                    <div>
                        <img src="/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">P-luminary</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled" />
            </span>
            <span>home</span>
        </a>
        
        <a href="/tags/è¯­æ³•">
            <span>
                <a-icon type="tags" theme="filled" />
            </span>
            <span>tags</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled" />
            </span>
            <span>P-luminary</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">home</div>
                </div>
            </a>
            
            <a href="/tags/è¯­æ³•">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="tags" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">tags</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                     
<link rel="stylesheet" href="/css/post-body.css">
<div class="article">
    <div>
        <h1>RAGFlowå·¥å…·æŠ€æœ¯æ–‡æ¡£ </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2025/3/7
        </span>

        

        

        <span class="tags">
            <span class="icon">
                <a-icon type="tags" theme="filled" />
            </span>
            
            <span class="tag">
                
                <a href="/tags/AI" style=color:#879cff>
                    AI
                </a>
            </span>
            
        </span>
        
    </div>

    <div class="content" v-pre>
        <h4 id="RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ"><a href="#RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ" class="headerlink" title="RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ"></a>RAGFlowä»£ç†ç»„ä»¶çš„æ ¸å¿ƒ</h4><ul>
<li><strong>é›†æˆå¤–éƒ¨æ•°æ®æº</strong>ï¼šé€šè¿‡æ£€ç´¢æ¨¡å—æ¥ç»§æ‰¿å¤–éƒ¨çŸ¥è¯†åº“ã€æ•°æ®åº“ã€æ–‡æ¡£ç­‰å†…å®¹ï¼Œå¢å¼ºæ¨¡å‹çš„å›ç­”èƒ½åŠ›</li>
<li><strong>ç”Ÿæˆå¼ä»»åŠ¡å¤„ç†</strong>ï¼šåˆ©ç”¨æ¨¡å‹ç”Ÿæˆçš„èƒ½åŠ›ï¼ŒåŸºäºç”¨æˆ·çš„æŸ¥è¯¢è¿”å›è‡ªç„¶è¯­è¨€çš„å›ç­”</li>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šRAGFlowæ”¯æŒçµæ´»çš„æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥é€šè¿‡é…ç½®å’Œé›†æˆä¸åŒçš„ç»„ä»¶æ¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚</li>
</ul>
<h4 id="RAGFlowä»£ç†ç»„ä»¶"><a href="#RAGFlowä»£ç†ç»„ä»¶" class="headerlink" title="RAGFlowä»£ç†ç»„ä»¶"></a>RAGFlowä»£ç†ç»„ä»¶</h4><p>RAGFlow çš„ä»£ç†ç»„ä»¶æ˜¯å…¶æ¶æ„ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œè´Ÿè´£ç®¡ç†ä¸<strong>å¤–éƒ¨æ•°æ®æº</strong>å’Œ<strong>ç”Ÿæˆæ¨¡å‹</strong>çš„äº¤äº’ã€‚ä»£ç†ç»„ä»¶ä¸ä»…å¯ä»¥ä»ä¸åŒçš„å¤–éƒ¨æ•°æ®æºä¸­è·å–çŸ¥è¯†ï¼Œè¿˜èƒ½å°†æ£€ç´¢åˆ°çš„ä¿¡æ¯ä¸ç”Ÿæˆæ¨¡å‹ç»“åˆï¼Œä»è€Œç”Ÿæˆæ›´åŠ å‡†ç¡®çš„å›ç­”ã€‚</p>
<h4 id="ä»£ç†ç»„ä»¶çš„åŠŸèƒ½"><a href="#ä»£ç†ç»„ä»¶çš„åŠŸèƒ½" class="headerlink" title="ä»£ç†ç»„ä»¶çš„åŠŸèƒ½"></a>ä»£ç†ç»„ä»¶çš„åŠŸèƒ½</h4><ul>
<li><strong>æ•°æ®æ£€ç´¢</strong>ï¼šä»£ç†ç»„ä»¶ä¼šä»å¤šä¸ªå¤–éƒ¨æ•°æ®æºï¼ˆå¦‚æ•°æ®åº“ã€æ–‡æ¡£ã€APIç­‰ï¼‰è¿›è¡Œæ•°æ®æ£€ç´¢ï¼Œè·å–ä¸ç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„ä¿¡æ¯ã€‚</li>
<li><strong>ç”Ÿæˆæ¨¡å‹çš„è°ƒç”¨</strong>ï¼šå°†æ£€ç´¢åˆ°çš„ä¿¡æ¯ä¸ç”Ÿæˆæ¨¡å‹ç»“åˆï¼Œé€šè¿‡ç”Ÿæˆæ¨¡å‹æä¾›ä¸€ä¸ªæµç•…ä¸”å‡†ç¡®çš„ç­”æ¡ˆã€‚</li>
<li><strong>å¤šæºæ•°æ®èåˆ</strong>ï¼šåœ¨ç”Ÿæˆå›ç­”æ—¶ï¼Œä»£ç†ç»„ä»¶èƒ½å¤Ÿå¤„ç†å¤šæ¥æºçš„æ•°æ®ï¼Œå¹¶å°†å…¶èåˆæˆæœ€ç»ˆçš„ç­”æ¡ˆã€‚</li>
</ul>
<h3 id="ç»„ä»¶-â†’-web-x2F-src-x2F-utils-å¾…å®š"><a href="#ç»„ä»¶-â†’-web-x2F-src-x2F-utils-å¾…å®š" class="headerlink" title="ç»„ä»¶ â†’ web&#x2F;src&#x2F;utils  *å¾…å®š"></a>ç»„ä»¶ â†’ <u>web&#x2F;src&#x2F;utils</u>  *å¾…å®š</h3><p><strong>ç»„ä»¶å‰ç«¯äº¤äº’ä¸­å¿ƒ</strong>ï¼š<code>web/src/utils/api.ts</code><br>å®ƒå®šä¹‰äº†ä¸€äº›ä¸â€œç”»å¸ƒâ€ç›¸å…³çš„ API æ¥å£åœ°å€ï¼Œç”¨äºä¸åç«¯è¿›è¡Œé€šä¿¡ã€‚é€šè¿‡è¿™äº›æ¥å£ï¼Œå‰ç«¯åº”ç”¨å¯ä»¥è¿›è¡Œä¸åŒæ“ä½œï¼Œå¦‚è·å–æ¨¡æ¿ã€æ“ä½œç”»å¸ƒã€è°ƒè¯•ç­‰</p>
<blockquote>
<p><strong>listTemplates</strong>: ç”¨äºè·å–æ‰€æœ‰ç”»å¸ƒæ¨¡æ¿çš„åˆ—è¡¨ï¼Œå‘é€è¯·æ±‚åˆ° <code>/canvas/templates</code>ã€‚<br><strong>listCanvas</strong>: è·å–ç”»å¸ƒåˆ—è¡¨çš„æ¥å£ï¼Œå‘é€è¯·æ±‚åˆ° <code>/canvas/list</code></p>
</blockquote>
<h4 id="Beginç»„ä»¶"><a href="#Beginç»„ä»¶" class="headerlink" title="Beginç»„ä»¶"></a>Beginç»„ä»¶</h4><p><strong>Begin</strong> ç»„ä»¶è®¾ç½®å¼€åœºé—®å€™è¯­æˆ–æ¥å—ç”¨æˆ·çš„è¾“å…¥ã€‚å½“æ‚¨åˆ›å»ºä»£ç†æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å¡«å……åˆ°ç”»å¸ƒä¸Šï¼Œæ— è®ºæ˜¯ä»æ¨¡æ¿è¿˜æ˜¯ä»å¤´å¼€å§‹ï¼ˆä»ç©ºç™½æ¨¡æ¿ï¼‰ã€‚å·¥ä½œæµç¨‹ä¸­åº”è¯¥åªæœ‰ä¸€ä¸ª <strong>Begin</strong> ç»„ä»¶ã€‚</p>
<blockquote>
<p><code>api/ragflow/web/src/locales/zh.ts</code><br>â€¦â€¦<br><strong>setAnOpenerInitial</strong>: <code>ä½ å¥½ï¼ æˆ‘æ˜¯ä½ çš„åŠ©ç†ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°ä½ çš„å—ï¼Ÿ</code>,</p>
</blockquote>
<p><strong>é™æ€æ¶ˆæ¯</strong>: <code>/v1/canvas/set</code><br><strong>ç”Ÿæˆé—®ç­”ã€é—®é¢˜ä¼˜åŒ–ã€é—®é¢˜ç±»å‹ã€å…³é”®è¯</strong>ï¼š<code>/v1/llm/list</code><br><strong>çŸ¥è¯†æ£€ç´¢</strong>ï¼š<code>/v1/llm/list</code> + <code>/v1/kb/list</code></p>
<p>ä»¥**é—®é¢˜ä¼˜åŒ– **(RewriteQuestion:MoodyCrabsPeel) ä¸ºä¾‹ï¼š</p>
<hr>
<h6 id="åç«¯å†…å®¹"><a href="#åç«¯å†…å®¹" class="headerlink" title="åç«¯å†…å®¹"></a>åç«¯å†…å®¹</h6><p><strong>çŸ¥è¯†æ£€ç´¢</strong>ï¼š<code>Retrieval</code>        è·¯å¾„â†’<code>agent/component/retrieval.py</code></p>
<pre><code class="python"># è®°å½•æ—¥å¿—
import logging
# æŠ½è±¡åŸºç±»æ¨¡å—
from abc import ABC
# ç”¨äºæ•°æ®å¤„ç†ï¼Œå°¤å…¶æ˜¯å¤„ç†æ•°æ®æ¡†ï¼ˆDataFrameï¼‰
import pandas as pd
# ä»æ•°æ®åº“ç›¸å…³æ¨¡å—å¯¼å…¥ LLMTypeï¼Œè¿™ä¸ªå¯èƒ½æ˜¯ç”¨æ¥å®šä¹‰ LLMï¼ˆè¯­è¨€æ¨¡å‹ï¼‰ç±»å‹çš„æšä¸¾
from api.db import LLMType
# ä»æ•°æ®åº“æœåŠ¡æ¨¡å—ä¸­å¯¼å…¥ï¼Œåˆ†åˆ«ç”¨äºçŸ¥è¯†åº“æœåŠ¡å’Œ LLM é…ç½®çš„å°è£…
from api.db.services.knowledgebase_service import KnowledgebaseService
from api.db.services.llm_service import LLMBundle
# åŠ è½½åº”ç”¨ç¨‹åºçš„è®¾ç½®
from api import settings
# åŸºç¡€ç»„ä»¶ç±»ï¼Œç”¨äºæ„å»ºæ­¤ç»„ä»¶çš„çˆ¶ç±»
from agent.component.base import ComponentBase, ComponentParamBase
# ä»æ ‡ç­¾æ¨¡å—ä¸­å¯¼å…¥ï¼Œç”¨äºå¯¹æŸ¥è¯¢è¿›è¡Œæ ‡è®°
from rag.app.tag import label_question


class RetrievalParam(ComponentParamBase):

    &quot;&quot;&quot;
    Define the Retrieval component parameters.
    &quot;&quot;&quot;
    def __init__(self):
        super().__init__()
        # ç›¸ä¼¼åº¦é˜ˆå€¼
        self.similarity_threshold = 0.2
        # å…³é”®å­—ç›¸ä¼¼åº¦çš„æƒé‡
        self.keywords_similarity_weight = 0.5
        # æ£€ç´¢æ—¶è¿”å›çš„ç»“æœæ•°
        self.top_n = 8
        # åœ¨æ£€ç´¢æ—¶è€ƒè™‘çš„æœ€å¤§æ•°é‡
        self.top_k = 1024
        # çŸ¥è¯†åº“çš„ ID åˆ—è¡¨
        self.kb_ids = []
        # é‡æ–°æ’åºæ¨¡å‹çš„ ID (å¯èƒ½ä¸ºç©º)
        self.rerank_id = &quot;&quot;
        # å½“æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç»“æœæ—¶çš„å“åº”æ–‡æœ¬
        self.empty_response = &quot;&quot;
#### check_decimal_float???
   # check()ï¼šå¯¹å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿ç›¸ä¼¼åº¦é˜ˆå€¼å’Œæƒé‡ä¸ºæœ‰æ•ˆçš„å°æ•°ï¼Œä¸” top_n æ˜¯æ­£æ•°ã€‚
    def check(self):
        # &quot;ç›¸ä¼¼æ€§é˜ˆå€¼&quot;
        self.check_decimal_float(self.similarity_threshold, &quot;[Retrieval] Similarity threshold&quot;)
        # &quot;å…³é”®è¯ç›¸ä¼¼åº¦æƒé‡&quot;
        self.check_decimal_float(self.keywords_similarity_weight, &quot;[Retrieval] Keyword similarity weight&quot;)
        self.check_positive_number(self.top_n, &quot;[Retrieval] Top N&quot;)

# Retrieval ç±»ç»§æ‰¿è‡ª ComponentBase å’Œ ABCï¼ˆæŠ½è±¡åŸºç±»ï¼‰
# è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶å®ç°äº†æŠ½è±¡æ–¹æ³•
class Retrieval(ComponentBase, ABC):
    component_name = &quot;Retrieval&quot;

##### history, **kwargs???
    # _runä¸ºæ ¸å¿ƒæ–¹æ³• 
# queryè¾“å…¥æŸ¥è¯¢å†…å®¹ åŒ…æ‹¬&#39;content&#39;é”® æå–ç¬¬ä¸€ä¸ªå†…å®¹é¡¹ å°†æŸ¥è¯¢å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦ä¸²
    def _run(self, history, **kwargs):
        query = self.get_input()
        query = str(query[&quot;content&quot;][0]) if &quot;content&quot; in query else &quot;&quot;
    # ä»çŸ¥è¯†åº“æœåŠ¡ä¸­è·å–æŒ‡å®š ID çš„çŸ¥è¯†åº“ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„çŸ¥è¯†åº“ï¼Œè¿”å›ç©ºçš„å“åº”ã€‚
        kbs = KnowledgebaseService.get_by_ids(self._param.kb_ids)
        if not kbs:
            return Retrieval.be_output(&quot;&quot;)
# è·å–æ‰€æœ‰çŸ¥è¯†åº“çš„åµŒå…¥æ¨¡å‹ IDï¼ˆembd_idï¼‰ï¼Œç¡®ä¿æ‰€æœ‰çŸ¥è¯†åº“ä½¿ç”¨ç›¸åŒçš„åµŒå…¥æ¨¡å‹ã€‚
# å¦‚æœä½¿ç”¨çš„åµŒå…¥æ¨¡å‹ä¸ä¸€è‡´ï¼ŒæŠ›å‡ºå¼‚å¸¸
        embd_nms = list(set([kb.embd_id for kb in kbs]))
        assert len(embd_nms) == 1, &quot;Knowledge bases use different embedding models.&quot;

##### LLMBundle???
# åˆ›å»º LLMBundle å®ä¾‹æ¥å°è£…åµŒå…¥æ¨¡å‹ï¼Œä½¿ç”¨ç”»å¸ƒçš„ç§Ÿæˆ· ID å’ŒåµŒå…¥æ¨¡å‹çš„ ID é…ç½®åµŒå…¥æ¨¡å‹ï¼Œå¹¶è®¾ç½®åˆ°ç”»å¸ƒ
        embd_mdl = LLMBundle(self._canvas.get_tenant_id(), LLMType.EMBEDDING, embd_nms[0])
        self._canvas.set_embedding_model(embd_nms[0])

   # è‹¥æä¾›äº† rerank_idï¼Œåˆ™åŠ è½½é‡æ–°æ’åºçš„æ¨¡å‹
        rerank_mdl = None
        if self._param.rerank_id:
            rerank_mdl = LLMBundle(kbs[0].tenant_id, LLMType.RERANK, self._param.rerank_id)

  # ä½¿ç”¨ settings.retrievaler.retrieval æ–¹æ³•æ‰§è¡ŒçŸ¥è¯†æ£€ç´¢æ“ä½œï¼Œä¼ å…¥æŸ¥è¯¢å’Œå„ç§é…ç½®å‚æ•°
# query:ç”¨æˆ·æŸ¥è¯¢   embd_mdl:åµŒå…¥æ¨¡å‹    å…¶ä»–å‚æ•°åŒ…æ‹¬çŸ¥è¯†åº“ IDã€ç›¸ä¼¼åº¦é˜ˆå€¼ã€å…³é”®è¯ç›¸ä¼¼åº¦æƒé‡ç­‰
        kbinfos = settings.retrievaler.retrieval(query, embd_mdl, kbs[0].tenant_id, self._param.kb_ids,
                                        1, self._param.top_n,
                                        self._param.similarity_threshold, 1 - self._param.keywords_similarity_weight,
                                        aggs=False, rerank_mdl=rerank_mdl,
                                        rank_feature=label_question(query, kbs))
# å¦‚æœæ£€ç´¢ç»“æœä¸ºç©ºï¼ˆæ²¡æœ‰æ‰¾åˆ°ç›¸å…³å†…å®¹ï¼‰ï¼Œåˆ™è¿”å›ç©ºå“åº”
# å¦‚æœè®¾ç½®äº† empty_responseï¼Œåˆ™åœ¨å“åº”ä¸­è¿”å›è¯¥å†…å®¹ã€‚
        if not kbinfos[&quot;chunks&quot;]:
            df = Retrieval.be_output(&quot;&quot;)
            if self._param.empty_response and self._param.empty_response.strip():
                df[&quot;empty_response&quot;] = self._param.empty_response
            return df
&#39;&#39;&#39;
å¦‚æœæœ‰æ£€ç´¢ç»“æœï¼Œå°†ç»“æœè½¬æ¢ä¸º Pandas çš„ DataFrame æ ¼å¼ã€‚
å°† content_with_weight é‡å‘½åä¸º contentï¼Œç„¶ååˆ é™¤ content_with_weight åˆ—ã€‚
è¾“å‡ºè°ƒè¯•æ—¥å¿—ï¼Œè®°å½•æŸ¥è¯¢å’Œæ£€ç´¢ç»“æœã€‚
&#39;&#39;&#39;
        df = pd.DataFrame(kbinfos[&quot;chunks&quot;])
        df[&quot;content&quot;] = df[&quot;content_with_weight&quot;]
        del df[&quot;content_with_weight&quot;]
        logging.debug(&quot;&#123;&#125; &#123;&#125;&quot;.format(query, df))
        return df
</code></pre>
<blockquote>
<p>å¦‚æœä½ éœ€è¦ä¸€ä¸ª <strong>å®šåˆ¶çš„ä»£ç†ç»„ä»¶</strong>ï¼Œæˆ‘å¯ä»¥åŸºäºè¿™ä¸ª <code>Retrieval</code> ç»„ä»¶çš„æ¶æ„ï¼Œä¸ºä½ è®¾è®¡ä¸€ä¸ªç±»ä¼¼çš„ç»„ä»¶ï¼Œæ»¡è¶³ä½ çš„ç‰¹å®šéœ€æ±‚ã€‚</p>
<p>ä½ å¯ä»¥å‘Šè¯‰æˆ‘ï¼š</p>
<ol>
<li><strong>ä»£ç†ç»„ä»¶çš„å…·ä½“ç”¨é€”</strong>ï¼ˆæ¯”å¦‚ï¼šè¯·æ±‚è½¬å‘ã€æ™ºèƒ½è·¯ç”±ã€æµé‡æ§åˆ¶ã€è´Ÿè½½å‡è¡¡ã€èº«ä»½éªŒè¯ç­‰ï¼‰ã€‚</li>
<li><strong>éœ€è¦æ”¯æŒçš„å‚æ•°</strong>ï¼ˆæ¯”å¦‚ï¼šä»£ç†åœ°å€ã€è¶…æ—¶æ—¶é—´ã€è®¤è¯æ–¹å¼ç­‰ï¼‰ã€‚</li>
<li><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼ˆæ¯”å¦‚ï¼šæ—¥å¿—è®°å½•ã€è¯·æ±‚ç¼“å­˜ã€æ•…éšœæ¢å¤ç­‰ï¼‰ã€‚</li>
<li><strong>é›†æˆçš„å…¶ä»–æœåŠ¡</strong>ï¼ˆæ¯”å¦‚ï¼šRedisã€RabbitMQã€æ•°æ®åº“ç­‰ï¼‰ã€‚</li>
</ol>
<p>å¦‚æœä½ å¸Œæœ›å®ƒéµå¾ª <code>ComponentBase</code> ç»„ä»¶æ¡†æ¶ï¼Œæˆ‘å¯ä»¥æŒ‰ç…§è¯¥æ¨¡å¼æ¥å®ç°ï¼Œè®©å®ƒå¯ä»¥ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼å¯¹æ¥ï¼</p>
</blockquote>
<h6 id="ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„"><a href="#ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„" class="headerlink" title="ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„"></a>ä¸‹é¢çš„æ˜¯å¼•ç”¨çš„é‡è¦æ–¹æ³•<del>ä¸Šä¸€ä¸ªä»£ç å—é‡Œçš„</del></h6><p><code>retrieval.py</code> â†’ <code>base.py</code></p>
<pre><code class="python">**kwargs å…è®¸è°ƒç”¨ _run() æ–¹æ³•æ—¶ ä¼ å…¥ä»»æ„æ•°é‡çš„é¢å¤–å‚æ•°ï¼Œå³ä½¿è¿™äº›å‚æ•°æ²¡æœ‰åœ¨æ–¹æ³•ç­¾åä¸­æ˜¾å¼åˆ—å‡º#ä¸Šæ–¹ä»£ç ç´¢å¼•ï¼š#### check_decimal_float???
# check()ï¼šå¯¹å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿ã€ç›¸ä¼¼åº¦é˜ˆå€¼ã€‘å’Œã€æƒé‡ã€‘ä¸ºæœ‰æ•ˆçš„å°æ•°ï¼Œä¸” top_n æ˜¯æ­£æ•°ã€‚
    def check(self):
        # &quot;ç›¸ä¼¼æ€§é˜ˆå€¼&quot;
        self.check_decimal_float(self.similarity_threshold, &quot;[Retrieval] Similarity threshold&quot;)
        # &quot;å…³é”®è¯ç›¸ä¼¼åº¦æƒé‡&quot;
        self.check_decimal_float(self.keywords_similarity_weight, &quot;[Retrieval] Keyword similarity weight&quot;)
        self.check_positive_number(self.top_n, &quot;[Retrieval] Top N&quot;)
---------------------------  â˜† ä¸Šæ–¹ä»£ç å—ç‰‡æ®µ â˜†  ---------------------------

# æ ¡éªŒæ£€ç´¢ç›¸å…³å‚æ•°çš„åˆæ³•æ€§
# è¿™æ˜¯ä¸€ä¸ª é™æ€æ–¹æ³•ï¼Œç”¨äºæ ¡éªŒå‚æ•° param æ˜¯å¦æ˜¯ 0 åˆ° 1 ä¹‹é—´çš„æµ®ç‚¹æ•°æˆ–æ•´æ•°

&#39;&#39;&#39;
æ ¡éªŒé€»è¾‘ï¼š
param å¿…é¡»æ˜¯ float æˆ– int ç±»å‹ï¼ˆä¸å…è®¸ strã€list ç­‰ï¼‰ã€‚
param éœ€è¦åœ¨ [0, 1] ä¹‹é—´ï¼Œå¦åˆ™æŠ›å‡º ValueError å¼‚å¸¸ï¼Œå¹¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­åŒ…å« descr æè¿°ã€‚
&#39;&#39;&#39;
# è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯0-1 ä¸èƒ½è¶…è¿‡1ï¼Ÿ å¦‚æœ similarity_threshold = 1.2ï¼Œä¼šè§¦å‘ check_decimal_float çš„å¼‚å¸¸æŠ›å‡ºï¼Œæç¤ºè¶…å‡º [0,1] èŒƒå›´ã€‚è€Œä¸”åœ¨å‰ç«¯çš„æ‹–æ‹‰ä¸­ä¹Ÿåªä¼šæ˜¯0~1ä¹‹é—´ã€‚å› ä¸ºè¿™äº›å‚æ•°ä»£è¡¨ å½’ä¸€åŒ–ï¼ˆnormalizedï¼‰åçš„æ¯”ä¾‹æˆ–æƒé‡ï¼Œå®ƒä»¬çš„å€¼é€šå¸¸ä¸èƒ½è¶…è¿‡ 1
# ã€0è¡¨ç¤ºç¤ºå®Œå…¨ç›¸åŒã€‘
    @staticmethod
    def check_decimal_float(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;] or param &lt; 0 or param &gt; 1:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be a float number in range [0, 1]&quot;.format(
                    param
                )
            )
&#39;&#39;&#39;
è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ @staticmethodï¼Ÿ
1. é¿å…åˆ›å»ºå¯¹è±¡ï¼Œæé«˜æ•ˆç‡ ğŸ‘‰ ç”±äºé™æ€æ–¹æ³•ä¸ä¾èµ–å®ä½“å±æ€§æˆ–æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥ç›´æ¥é€šè¿‡ç±»è°ƒç”¨ï¼Œè€Œä¸å¿…åˆ›å»ºå¯¹è±¡
2. ä»£ç ç»„ç»‡æ¸…æ™° ğŸ‘‰ é€‚ç”¨äºé€»è¾‘ç‹¬ç«‹çš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä»£ç æ›´å®¹æ˜“è¯»ã€æ›´ç»“æ„åŒ–
3. é˜²æ­¢ä¿®æ”¹å®ä¾‹çŠ¶æ€ ğŸ‘‰ ç”±äºé™æ€æ–¹æ³•ä¸èƒ½è®¿é—®selfï¼Œå› æ­¤ä¸ä¼šä¿®æ”¹å®ä¾‹çš„çŠ¶æ€ï¼Œä¿è¯äº†æ–¹æ³•çš„çº¯å‡½æ•°ç‰¹å¾
-------- -------- -------- ç»“åˆä»£ç è§£æ -------- -------- -------- 
4. è¿™ä¸ªæ–¹æ³• ä¸è®¿é—®å®ä¾‹å˜é‡ï¼Œå®ƒåª æ£€æŸ¥å‚æ•° æ˜¯å¦ç¬¦åˆ 0~1 ä¹‹é—´çš„èŒƒå›´
5. é€‚ç”¨äº å·¥å…·æ–¹æ³•ï¼Œå±äº æ•°æ®éªŒè¯é€»è¾‘ï¼Œä¸ä¾èµ– self
6. å¯ä»¥ç›´æ¥é€šè¿‡ç±»è°ƒç”¨ï¼š
Retrieval.check_decimal_float(0.8, &quot;Threshold&quot;)  # æ­£å¸¸
Retrieval.check_decimal_float(1.2, &quot;Threshold&quot;)  # æŠ›å‡º ValueError
&#39;&#39;&#39;
==========================================================================
#ä¸Šæ–¹ä»£ç ç´¢å¼•ï¼š##### history, **kwargs???
    def _run(self, history, **kwargs):
        query = self.get_input()
        query = str(query[&quot;content&quot;][0]) if &quot;content&quot; in query else &quot;&quot;
        ......
# è®²è§£é‡ç‚¹ï¼šã€**kwargsã€‘
# [**kwargs] å…è®¸è°ƒç”¨ _run() æ–¹æ³•æ—¶ ä¼ å…¥ä»»æ„æ•°é‡çš„é¢å¤–å‚æ•°ï¼Œå³ä½¿è¿™äº›å‚æ•°æ²¡æœ‰åœ¨æ–¹æ³•ç­¾åä¸­æ˜¾å¼åˆ—å‡º æ¯”å¦‚ï¼šğŸ‘‡
    _run(self, history, user_id=123, debug=True, mode=&quot;fast&quot;)
# åœ¨ _run() æ–¹æ³•å†…éƒ¨ï¼Œè¿™äº›å‚æ•°å¯ä»¥é€šè¿‡ kwargs[&quot;user_id&quot;]ã€kwargs[&quot;debug&quot;] è®¿é—®ï¼Œä½† å½“å‰ä»£ç é‡Œæ²¡æœ‰ä½¿ç”¨ kwargsï¼Œæ‰€ä»¥å®ƒåªæ˜¯ç”¨æ¥å…¼å®¹å¯èƒ½çš„æ‰©å±•ã€‚
&#39;&#39;&#39;
ç›®å‰ **kwargs æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š

æ‰©å±•æ€§ï¼šå¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°è€Œä¸ä¿®æ”¹å‡½æ•°ç­¾å
å…¼å®¹æ€§ï¼šå…è®¸ä¸åŒè°ƒç”¨æ–¹ä¼ é€’ä¸åŒçš„å‚æ•°ï¼Œè€Œ _run() ä»èƒ½æ­£å¸¸è¿è¡Œ
é€‚ç”¨åœºæ™¯ï¼šæœªæ¥éœ€è¦é¢å¤–å‚æ•°
ç›®å‰ **kwargs åªæ˜¯ å ä½ç¬¦ï¼Œä½†å®ƒæä¾›äº†æœªæ¥æ‰©å±•çš„å¯èƒ½æ€§
&#39;&#39;&#39;
</code></pre>
<table>
<thead>
<tr>
<th align="center">ç‰¹å¾</th>
<th align="center">æ™®é€šæ–¹æ³•(self)</th>
<th align="center">é™æ€æ–¹æ³•(@staticmethod)</th>
<th align="center">ç±»æ–¹æ³•(@classmethod)</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ä¾èµ–å®ä¾‹(self)</td>
<td align="center">âˆš</td>
<td align="center">Ã—</td>
<td align="center">Ã—</td>
</tr>
<tr>
<td align="center">ä¾èµ–ç±»(cls)</td>
<td align="center">Ã—</td>
<td align="center">Ã—</td>
<td align="center">âˆš</td>
</tr>
<tr>
<td align="center">è®¿é—®å®ä¾‹å˜é‡</td>
<td align="center">âˆš</td>
<td align="center">Ã—</td>
<td align="center">Ã—</td>
</tr>
<tr>
<td align="center">è®¿é—®ç±»å˜é‡</td>
<td align="center">âˆš</td>
<td align="center">Ã—</td>
<td align="center">âˆš</td>
</tr>
<tr>
<td align="center">é€‚ç”¨äº</td>
<td align="center">éœ€è¦è®¿é—®å®ä¾‹</td>
<td align="center">å·¥å…·æ–¹æ³•ã€éªŒè¯æ–¹æ³•</td>
<td align="center">éœ€è¦ä¿®æ”¹ç±»å˜é‡</td>
</tr>
</tbody></table>
<p><code>retrieval.py</code> â†’ </p>
<hr>
<hr>
<hr>
<h6 id="è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹"><a href="#è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹" class="headerlink" title="è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹"></a><span style="color:green">è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹</span></h6><p><strong>ç™¾åº¦ç¿»è¯‘</strong>ï¼š<code>baidufanyi.py</code>      è·¯å¾„ â†’ <code>agent/component/baidufanyi.py</code></p>
<pre><code class="python"># 
import random
# æŠ½è±¡åŸºç±»æ¨¡å— ç”¨äºå®šä¹‰ç»„ä»¶çš„åŸºç±»
from abc import ABC
# ç”¨äºå‘é€ HTTP è¯·æ±‚ï¼Œä¸ ç™¾åº¦ç¿»è¯‘ API äº¤äº’
import requests
# åŸºç¡€ç»„ä»¶ç±»ï¼Œäºæ„å»ºæ­¤ç»„ä»¶çš„çˆ¶ç±»ï¼Œå®šä¹‰ç»„ä»¶çš„åŸºæœ¬ç»“æ„å’Œå‚æ•°ã€‚
from agent.component.base import ComponentBase, ComponentParamBase
# ç”¨äºç”Ÿæˆç™¾åº¦ç¿»è¯‘ API è¯·æ±‚ç­¾åï¼ˆåŠ å¯†å“ˆå¸Œï¼‰
from hashlib import md5

# ç™¾åº¦ç¿»è¯‘ç»„ä»¶çš„å‚æ•°å®šä¹‰ç±» ç»§æ‰¿ComponentParamBase
class BaiduFanyiParam(ComponentParamBase):
    &quot;&quot;&quot;
    Define the BaiduFanyi component parameters.
    &quot;&quot;&quot;

    def __init__(self):
        super().__init__()
   # appid å’Œ secret_key æ˜¯ç™¾åº¦ç¿»è¯‘ API çš„ èº«ä»½éªŒè¯ ä¿¡æ¯ï¼ˆéœ€è¦åœ¨ç™¾åº¦ç¿»è¯‘å¼€æ”¾å¹³å°è·å–ï¼‰
        self.appid = &quot;xxx&quot;
        self.secret_key = &quot;xxx&quot;
   # translateï¼šæ™®é€šç¿»è¯‘   fieldtranslateï¼šä¸“ä¸šé¢†åŸŸç¿»è¯‘
        self.trans_type = &#39;translate&#39;
        self.parameters = []
   # source_lang ç¿»è¯‘çš„æºè¯­è¨€   target_lang ç¿»è¯‘çš„ç›®æ ‡è¯­è¨€
        self.source_lang = &#39;auto&#39;
        self.target_lang = &#39;auto&#39;
   # domain å¦‚æœä½¿ç”¨ä¸“ä¸šé¢†åŸŸç¿»è¯‘ï¼Œéœ€æŒ‡å®šé¢†åŸŸï¼ˆå¦‚ finance è¡¨ç¤º é‡‘è é¢†åŸŸï¼‰
        self.domain = &#39;finance&#39;
# æ£€æŸ¥å‚æ•°åˆæ³•æ€§
    def check(self):
    # check_empty()ï¼šç¡®ä¿ appid å’Œ secret_key ä¸èƒ½ä¸ºç©ºã€‚
        self.check_empty(self.appid, &quot;BaiduFanyi APPID&quot;)
        self.check_empty(self.secret_key, &quot;BaiduFanyi Secret Key&quot;)
# check_valid_value()ï¼šç¡®ä¿ trans_typeã€source_langã€target_langã€domain çš„å€¼åœ¨åˆæ³•é€‰é¡¹ä¹‹å†…
        self.check_valid_value(self.trans_type, &quot;Translate type&quot;, [&#39;translate&#39;, &#39;fieldtranslate&#39;])
# ä»¥ä¸‹æ˜¯åˆ—ä¸¾å„ç§è¯­è¨€
        self.check_valid_value(self.source_lang, &quot;Source language&quot;,
                               [&#39;auto&#39;, &#39;zh&#39;, &#39;en&#39;, &#39;yue&#39;, &#39;wyw&#39;, &#39;jp&#39;, &#39;kor&#39;, &#39;fra&#39;, &#39;spa&#39;, &#39;th&#39;, &#39;ara&#39;, &#39;ru&#39;, &#39;pt&#39;,
                                &#39;de&#39;, &#39;it&#39;, &#39;el&#39;, &#39;nl&#39;, &#39;pl&#39;, &#39;bul&#39;, &#39;est&#39;, &#39;dan&#39;, &#39;fin&#39;, &#39;cs&#39;, &#39;rom&#39;, &#39;slo&#39;, &#39;swe&#39;,
                                &#39;hu&#39;, &#39;cht&#39;, &#39;vie&#39;])
        self.check_valid_value(self.target_lang, &quot;Target language&quot;,
                               [&#39;auto&#39;, &#39;zh&#39;, &#39;en&#39;, &#39;yue&#39;, &#39;wyw&#39;, &#39;jp&#39;, &#39;kor&#39;, &#39;fra&#39;, &#39;spa&#39;, &#39;th&#39;, &#39;ara&#39;, &#39;ru&#39;, &#39;pt&#39;,
                                &#39;de&#39;, &#39;it&#39;, &#39;el&#39;, &#39;nl&#39;, &#39;pl&#39;, &#39;bul&#39;, &#39;est&#39;, &#39;dan&#39;, &#39;fin&#39;, &#39;cs&#39;, &#39;rom&#39;, &#39;slo&#39;, &#39;swe&#39;,
                                &#39;hu&#39;, &#39;cht&#39;, &#39;vie&#39;])
# ä»¥ä¸‹æ˜¯åˆ—ä¸¾ä¸åŒä¸“ä¸šé¢†åŸŸ
        self.check_valid_value(self.domain, &quot;Translate field&quot;,
                               [&#39;it&#39;, &#39;finance&#39;, &#39;machinery&#39;, &#39;senimed&#39;, &#39;novel&#39;, &#39;academic&#39;, &#39;aerospace&#39;, &#39;wiki&#39;,
                                &#39;news&#39;, &#39;law&#39;, &#39;contract&#39;])

# ç»§æ‰¿ComponentBaseå’ŒABC
class BaiduFanyi(ComponentBase, ABC):
 # å®šä¹‰ç»„ä»¶åç§°åœ¨ç³»ç»Ÿå†…å”¯ä¸€æ ‡è¯†è¯¥ç»„ä»¶
    component_name = &quot;BaiduFanyi&quot;
    # _run()æ˜¯ç»„ä»¶çš„ æ ¸å¿ƒæ‰§è¡Œå‡½æ•°ï¼Œç”¨äºå¤„ç†ç¿»è¯‘è¯·æ±‚ã€‚
# **kwargsï¼šå¯ä»¥è®©å‡½æ•°æ›´åŠ çµæ´»ï¼Œå› ä¸ºå®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‘½åå‚æ•°
# åœ¨å‡½æ•°å†…éƒ¨ï¼Œkwargs æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†æ‰€æœ‰ä¼ é€’ç»™å‡½æ•°çš„é¢å¤–å‘½åå‚æ•°ã€‚
    def _run(self, history, **kwargs):
&#39;&#39;&#39;
self.get_input() è·å–è¾“å…¥å†…å®¹ã€‚
å¦‚æœ content å­˜åœ¨ï¼Œåˆ™ç”¨ - è¿æ¥å¤šä¸ªå†…å®¹ï¼ˆæ‹¼æ¥æˆå•ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚
å¦‚æœ ans ä¸ºç©ºï¼Œç›´æ¥è¿”å› &quot;&quot;
&#39;&#39;&#39;
        ans = self.get_input()
        ans = &quot; - &quot;.join(ans[&quot;content&quot;]) if &quot;content&quot; in ans else &quot;&quot;
        if not ans:
            return BaiduFanyi.be_output(&quot;&quot;)

        try:
&#39;&#39;&#39;
source_lang å’Œ target_langï¼šæ¥æºå’Œç›®æ ‡è¯­è¨€ã€‚
appidï¼šç™¾åº¦ç¿»è¯‘ API çš„ åº”ç”¨ IDã€‚
saltï¼šéšæœºæ•°ï¼ˆç™¾åº¦ API éœ€è¦æ­¤å‚æ•°ï¼‰ã€‚
secret_keyï¼šç™¾åº¦ API çš„ å¯†é’¥
&#39;&#39;&#39;
            source_lang = self._param.source_lang
            target_lang = self._param.target_lang
            appid = self._param.appid
            salt = random.randint(32768, 65536)
            secret_key = self._param.secret_key
-------------------------- â˜† æ™®é€šç¿»è¯‘APIè¯·æ±‚ â˜† --------------------------
            if self._param.trans_type == &#39;translate&#39;:
            # md5ç­¾åï¼Œé˜²æ­¢è¯·æ±‚è¢«ç¯¡æ”¹
                sign = md5((appid + ans + salt + secret_key).encode(&#39;utf-8&#39;)).hexdigest()
     # å‘é€ HTTP POST è¯·æ±‚ è®¿é—® ç™¾åº¦ç¿»è¯‘ API
                url = &#39;http://api.fanyi.baidu.com/api/trans/vip/translate?&#39; + &#39;q=&#39; + ans + &#39;&amp;from=&#39; + source_lang + &#39;&amp;to=&#39; + target_lang + &#39;&amp;appid=&#39; + appid + &#39;&amp;salt=&#39; + salt + &#39;&amp;sign=&#39; + sign
                headers = &#123;&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;&#125;
            # è§£æè¿”å›ç»“æœ
                response = requests.post(url=url, headers=headers).json()

                if response.get(&#39;error_code&#39;):
                    BaiduFanyi.be_output(&quot;**Error**:&quot; + response[&#39;error_msg&#39;])

                return BaiduFanyi.be_output(response[&#39;trans_result&#39;][0][&#39;dst&#39;])
-------------------------- â˜… ä¸“ä¸šç¿»è¯‘APIè¯·æ±‚ â˜… --------------------------
            elif self._param.trans_type == &#39;fieldtranslate&#39;:
                domain = self._param.domain
                sign = md5((appid + ans + salt + domain + secret_key).encode(&#39;utf-8&#39;)).hexdigest()
                url = &#39;http://api.fanyi.baidu.com/api/trans/vip/fieldtranslate?&#39; + &#39;q=&#39; + ans + &#39;&amp;from=&#39; + source_lang + &#39;&amp;to=&#39; + target_lang + &#39;&amp;appid=&#39; + appid + &#39;&amp;salt=&#39; + salt + &#39;&amp;domain=&#39; + domain + &#39;&amp;sign=&#39; + sign
                headers = &#123;&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;&#125;
                response = requests.post(url=url, headers=headers).json()

                if response.get(&#39;error_code&#39;):
                    BaiduFanyi.be_output(&quot;**Error**:&quot; + response[&#39;error_msg&#39;])

                return BaiduFanyi.be_output(response[&#39;trans_result&#39;][0][&#39;dst&#39;])
        # æ•è· æ‰€æœ‰å¼‚å¸¸ï¼Œé˜²æ­¢ç¨‹åºå´©æºƒ
        except Exception as e:
            BaiduFanyi.be_output(&quot;**Error**:&quot; + str(e))
</code></pre>
<h3 id="æ·±å±‚æ¬¡ç ”ç©¶"><a href="#æ·±å±‚æ¬¡ç ”ç©¶" class="headerlink" title="æ·±å±‚æ¬¡ç ”ç©¶"></a><strong>æ·±å±‚æ¬¡ç ”ç©¶</strong></h3><p><code>from agent.component.base import ComponentBase, ComponentParamBase</code></p>
<p>ä¸»è¦ç”¨äºå¤„ç†ã€æ›´æ–°ã€éªŒè¯å’Œè­¦å‘Šç»„ä»¶å‚æ•°ï¼Œé€‚ç”¨äºé‚£äº›éœ€è¦åŠ¨æ€é…ç½®ã€é€’å½’åµŒå¥—ç»“æ„ä¸”è¦æ±‚é«˜å¯æ‰©å±•æ€§çš„ç³»ç»Ÿ</p>
<pre><code class="python">class ComponentParamBase(ABC):
    def __init__(self):
        # åˆå§‹åŒ–è¾“å‡ºå˜é‡å
        self.output_var_name = &quot;output&quot;
        # åˆå§‹åŒ–æ¶ˆæ¯å†å²çª—å£å¤§å°
        self.message_history_window_size = 22
        # åˆå§‹åŒ–æŸ¥è¯¢å‚æ•°
        self.query = []
        # åˆå§‹åŒ–è¾“å…¥å‚æ•°
        self.inputs = []
        # åˆå§‹åŒ–è°ƒè¯•è¾“å…¥å‚æ•°
        self.debug_inputs = []
    # è®¾ç½®ç»„ä»¶çš„åç§°ï¼Œå¹¶è¿”å›å½“å‰å¯¹è±¡ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
    def set_name(self, name: str):
        self._name = name
        return self

    # æŠ½è±¡æ–¹æ³• å­ç±»å¿…é¡»å®ç° å®ƒçš„ç›®çš„æ˜¯æ£€æŸ¥å‚æ•°æ˜¯å¦æœ‰æ•ˆ
    def check(self):
        raise NotImplementedError(&quot;Parameter Object should be checked.&quot;)

    # ç±»æ–¹æ³• ç”¨äºæ£€æŸ¥ç±»æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§ _DEPRECATED_PARAMS å¦‚æœæ²¡æœ‰ åˆ™åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆ
    @classmethod
    def _get_or_init_deprecated_params_set(cls):
        if not hasattr(cls, _DEPRECATED_PARAMS):
            setattr(cls, _DEPRECATED_PARAMS, set())
        return getattr(cls, _DEPRECATED_PARAMS)
    # ç”¨äºæ£€æŸ¥å’Œåˆå§‹åŒ–å®ä¾‹çš„å·²åºŸå¼ƒå‚æ•°é›†åˆ
    def _get_or_init_feeded_deprecated_params_set(self, conf=None):
        if not hasattr(self, _FEEDED_DEPRECATED_PARAMS):
            if conf is None:
                setattr(self, _FEEDED_DEPRECATED_PARAMS, set())
            else:
                setattr(
                    self,
                    _FEEDED_DEPRECATED_PARAMS,
                    set(conf[_FEEDED_DEPRECATED_PARAMS]),
                )
        return getattr(self, _FEEDED_DEPRECATED_PARAMS)
    # ç”¨äºæ£€æŸ¥å’Œåˆå§‹åŒ–å®ä¾‹çš„å·²åºŸå¼ƒå‚æ•°é›†åˆ
    def _get_or_init_user_feeded_params_set(self, conf=None):
        if not hasattr(self, _USER_FEEDED_PARAMS):
            if conf is None:
                setattr(self, _USER_FEEDED_PARAMS, set())
            else:
                setattr(self, _USER_FEEDED_PARAMS, set(conf[_USER_FEEDED_PARAMS]))
        return getattr(self, _USER_FEEDED_PARAMS)
    # è¿”å›ç”¨æˆ·æä¾›çš„å‚æ•°
    def get_user_feeded(self):
        return self._get_or_init_user_feeded_params_set()
    # è¿”å›å·²åºŸå¼ƒçš„å‚æ•°é›†åˆ
    def get_feeded_deprecated_params(self):
        return self._get_or_init_feeded_deprecated_params_set()
    
    # @è£…é¥°å™¨ å®šä¹‰äº† _deprecated_params_set å±æ€§ å®ƒè¿”å›å·²åºŸå¼ƒçš„å‚æ•°é›†åˆ
    @property
    def _deprecated_params_set(self):
        return &#123;name: True for name in self.get_feeded_deprecated_params()&#125;
    
    # å°†å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²
    def __str__(self):
        return json.dumps(self.as_dict(), ensure_ascii=False)

    # é€’å½’åœ°å°†å¯¹è±¡çš„å±æ€§è½¬æ¢æˆå­—å…¸ é€‚ç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æˆ–è¿›è¡Œå…¶ä»–æ“ä½œ
    def as_dict(self):
        def _recursive_convert_obj_to_dict(obj):
            ret_dict = &#123;&#125;
            for attr_name in list(obj.__dict__):
                if attr_name in [_FEEDED_DEPRECATED_PARAMS, _DEPRECATED_PARAMS, _USER_FEEDED_PARAMS, _IS_RAW_CONF]:
                    continue
                # get attr
                attr = getattr(obj, attr_name)
                if isinstance(attr, pd.DataFrame):
                    ret_dict[attr_name] = attr.to_dict()
                    continue
                if attr and type(attr).__name__ not in dir(builtins):
                    ret_dict[attr_name] = _recursive_convert_obj_to_dict(attr)
                else:
                    ret_dict[attr_name] = attr

            return ret_dict

        return _recursive_convert_obj_to_dict(self)

    # ç”¨äºæ›´æ–°å¯¹è±¡çš„å‚æ•°ï¼Œå¹¶æ ¹æ®ä¼ å…¥çš„é…ç½®è¿›è¡Œä¿®æ”¹ å®ƒå¤„ç†é€’å½’æ›´æ–°å‚æ•°ã€æ£€æŸ¥å†—ä½™å±æ€§ç­‰
    def update(self, conf, allow_redundant=False):
        update_from_raw_conf = conf.get(_IS_RAW_CONF, True)
        if update_from_raw_conf:
            deprecated_params_set = self._get_or_init_deprecated_params_set()
            feeded_deprecated_params_set = (
                self._get_or_init_feeded_deprecated_params_set()
            )
            user_feeded_params_set = self._get_or_init_user_feeded_params_set()
            setattr(self, _IS_RAW_CONF, False)
        else:
            feeded_deprecated_params_set = (
                self._get_or_init_feeded_deprecated_params_set(conf)
            )
            user_feeded_params_set = self._get_or_init_user_feeded_params_set(conf)

        def _recursive_update_param(param, config, depth, prefix):
            if depth &gt; settings.PARAM_MAXDEPTH:
                raise ValueError(&quot;Param define nesting too deep!!!, can not parse it&quot;)

            inst_variables = param.__dict__
            redundant_attrs = []
            for config_key, config_value in config.items():
                # redundant attr
                if config_key not in inst_variables:
                    if not update_from_raw_conf and config_key.startswith(&quot;_&quot;):
                        setattr(param, config_key, config_value)
                    else:
                        setattr(param, config_key, config_value)
                        # redundant_attrs.append(config_key)
                    continue

                full_config_key = f&quot;&#123;prefix&#125;&#123;config_key&#125;&quot;

                if update_from_raw_conf:
                    # add user feeded params
                    user_feeded_params_set.add(full_config_key)

                    # update user feeded deprecated param set
                    if full_config_key in deprecated_params_set:
                        feeded_deprecated_params_set.add(full_config_key)

                # supported attr
                attr = getattr(param, config_key)
                if type(attr).__name__ in dir(builtins) or attr is None:
                    setattr(param, config_key, config_value)

                else:
                    # recursive set obj attr
                    sub_params = _recursive_update_param(
                        attr, config_value, depth + 1, prefix=f&quot;&#123;prefix&#125;&#123;config_key&#125;.&quot;
                    )
                    setattr(param, config_key, sub_params)

            if not allow_redundant and redundant_attrs:
                raise ValueError(
                    f&quot;cpn `&#123;getattr(self, &#39;_name&#39;, type(self))&#125;` has redundant parameters: `&#123;[redundant_attrs]&#125;`&quot;
                )

            return param

        return _recursive_update_param(param=self, config=conf, depth=0, prefix=&quot;&quot;)

    # ç”¨äºæå–æ‰€æœ‰éå†…ç½®ç±»å‹çš„å±æ€§ é€’å½’åœ°éå†å¯¹è±¡çš„å±æ€§
    def extract_not_builtin(self):
        def _get_not_builtin_types(obj):
            ret_dict = &#123;&#125;
            for variable in obj.__dict__:
                attr = getattr(obj, variable)
                if attr and type(attr).__name__ not in dir(builtins):
                    ret_dict[variable] = _get_not_builtin_types(attr)

            return ret_dict

        return _get_not_builtin_types(self)
    
    # validate æ–¹æ³•ç”¨äºéªŒè¯å¯¹è±¡çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„å®šä¹‰çš„è§„åˆ™ è§„åˆ™å­˜å‚¨åœ¨ JSON æ–‡ä»¶ä¸­
    def validate(self):
        self.builtin_types = dir(builtins)
        self.func = &#123;
            &quot;ge&quot;: self._greater_equal_than,
            &quot;le&quot;: self._less_equal_than,
            &quot;in&quot;: self._in,
            &quot;not_in&quot;: self._not_in,
            &quot;range&quot;: self._range,
        &#125;
        home_dir = os.path.abspath(os.path.dirname(os.path.realpath(__file__)))
        param_validation_path_prefix = home_dir + &quot;/param_validation/&quot;

        param_name = type(self).__name__
        param_validation_path = &quot;/&quot;.join(
            [param_validation_path_prefix, param_name + &quot;.json&quot;]
        )

        validation_json = None

        try:
            with open(param_validation_path, &quot;r&quot;) as fin:
                validation_json = json.loads(fin.read())
        except BaseException:
            return

        self._validate_param(self, validation_json)

    def _validate_param(self, param_obj, validation_json):
        default_section = type(param_obj).__name__
        var_list = param_obj.__dict__

        for variable in var_list:
            attr = getattr(param_obj, variable)

            if type(attr).__name__ in self.builtin_types or attr is None:
                if variable not in validation_json:
                    continue

                validation_dict = validation_json[default_section][variable]
                value = getattr(param_obj, variable)
                value_legal = False

                for op_type in validation_dict:
                    if self.func[op_type](value, validation_dict[op_type]):
                        value_legal = True
                        break

                if not value_legal:
                    raise ValueError(
                        &quot;Plase check runtime conf, &#123;&#125; = &#123;&#125; does not match user-parameter restriction&quot;.format(
                            variable, value
                        )
                    )

            elif variable in validation_json:
                self._validate_param(attr, validation_json)

    # ç”¨äºéªŒè¯å‚æ•°çš„ç±»å‹å’ŒèŒƒå›´ ç¡®ä¿ç¬¦åˆé¢„æœŸ          
    @staticmethod
    def check_string(param, descr):
        if type(param).__name__ not in [&quot;str&quot;]:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be string type&quot;.format(param)
            )

    @staticmethod
    def check_empty(param, descr):
        if not param:
            raise ValueError(
                descr + &quot; does not support empty value.&quot;
            )

    @staticmethod
    def check_positive_integer(param, descr):
        if type(param).__name__ not in [&quot;int&quot;, &quot;long&quot;] or param &lt;= 0:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be positive integer&quot;.format(param)
            )

    @staticmethod
    def check_positive_number(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;, &quot;long&quot;] or param &lt;= 0:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be positive numeric&quot;.format(param)
            )

    @staticmethod
    def check_nonnegative_number(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;, &quot;long&quot;] or param &lt; 0:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be non-negative numeric&quot;.format(param)
            )

    @staticmethod
    def check_decimal_float(param, descr):
        if type(param).__name__ not in [&quot;float&quot;, &quot;int&quot;] or param &lt; 0 or param &gt; 1:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be a float number in range [0, 1]&quot;.format(
                    param
                )
            )

    @staticmethod
    def check_boolean(param, descr):
        if type(param).__name__ != &quot;bool&quot;:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be bool type&quot;.format(param)
            )

    @staticmethod
    def check_open_unit_interval(param, descr):
        if type(param).__name__ not in [&quot;float&quot;] or param &lt;= 0 or param &gt;= 1:
            raise ValueError(
                descr + &quot; should be a numeric number between 0 and 1 exclusively&quot;
            )

    @staticmethod
    def check_valid_value(param, descr, valid_values):
        if param not in valid_values:
            raise ValueError(
                descr
                + &quot; &#123;&#125; is not supported, it should be in &#123;&#125;&quot;.format(param, valid_values)
            )

    @staticmethod
    def check_defined_type(param, descr, types):
        if type(param).__name__ not in types:
            raise ValueError(
                descr + &quot; &#123;&#125; not supported, should be one of &#123;&#125;&quot;.format(param, types)
            )

    @staticmethod
    def check_and_change_lower(param, valid_list, descr=&quot;&quot;):
        if type(param).__name__ != &quot;str&quot;:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be one of &#123;&#125;&quot;.format(param, valid_list)
            )

        lower_param = param.lower()
        if lower_param in valid_list:
            return lower_param
        else:
            raise ValueError(
                descr
                + &quot; &#123;&#125; not supported, should be one of &#123;&#125;&quot;.format(param, valid_list)
            )

    @staticmethod
    def _greater_equal_than(value, limit):
        return value &gt;= limit - settings.FLOAT_ZERO

    @staticmethod
    def _less_equal_than(value, limit):
        return value &lt;= limit + settings.FLOAT_ZERO

    @staticmethod
    def _range(value, ranges):
        in_range = False
        for left_limit, right_limit in ranges:
            if (
                    left_limit - settings.FLOAT_ZERO
                    &lt;= value
                    &lt;= right_limit + settings.FLOAT_ZERO
            ):
                in_range = True
                break

        return in_range

    @staticmethod
    def _in(value, right_value_list):
        return value in right_value_list

    @staticmethod
    def _not_in(value, wrong_value_list):
        return value not in wrong_value_list

    def _warn_deprecated_param(self, param_name, descr):
        if self._deprecated_params_set.get(param_name):
            logging.warning(
                f&quot;&#123;descr&#125; &#123;param_name&#125; is deprecated and ignored in this version.&quot;
            )

    def _warn_to_deprecate_param(self, param_name, descr, new_param):
        if self._deprecated_params_set.get(param_name):
            logging.warning(
                f&quot;&#123;descr&#125; &#123;param_name&#125; will be deprecated in future release; &quot;
                f&quot;please use &#123;new_param&#125; instead.&quot;
            )
            return True
        return False
</code></pre>
<h5 id="è¿™é‡Œè¿ç”¨åˆ°json-ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ"><a href="#è¿™é‡Œè¿ç”¨åˆ°json-ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ" class="headerlink" title="è¿™é‡Œè¿ç”¨åˆ°json ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ"></a>è¿™é‡Œè¿ç”¨åˆ°json ä¸ºä»€ä¹ˆè¦ç”¨jsonï¼Ÿ</h5><ul>
<li><strong>æ–¹ä¾¿åºåˆ—åŒ–</strong>ï¼š<code>json.dumps()</code>å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¯ä»¥è½»æ¾åœ°ä¿å­˜æˆ–ä¼ è¾“å¯¹è±¡æ•°æ®ã€‚</li>
<li><strong>æ–¹ä¾¿è°ƒè¯•å’Œå±•ç¤º</strong>ï¼šåœ¨ <code>__str__</code> æ–¹æ³•ä¸­è¿”å› JSON å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹å¯¹è±¡çš„å†…å®¹ã€‚å°¤å…¶æ˜¯åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œç›´æ¥æ‰“å°å‡ºå¯¹è±¡çš„ JSON æ ¼å¼å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜å¿«é€ŸæŸ¥çœ‹å¯¹è±¡çš„çŠ¶æ€åŠå…¶å†…éƒ¨æ•°æ®ç»“æ„</li>
<li><strong>ä¸å¤§æ¨¡å‹äº¤äº’</strong>ï¼šå½“æ¶‰åŠåˆ°ä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ GPTï¼‰æˆ–å…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹çš„äº¤äº’æ—¶ï¼ŒJSON æ ¼å¼çš„æ•°æ®é€šå¸¸æ˜¯æ ‡å‡†çš„è¾“å…¥å’Œè¾“å‡ºæ ¼å¼ã€‚å°†å¯¹è±¡è½¬ä¸º JSON å­—ç¬¦ä¸²ï¼Œèƒ½å¤Ÿæ›´å®¹æ˜“åœ°å°†æ•°æ®ä¼ é€’ç»™æ¨¡å‹è¿›è¡Œå¤„ç†æˆ–åˆ†æï¼Œæ¨¡å‹é€šå¸¸ä¼šæ¥å— JSON æ ¼å¼çš„æ•°æ®è¿›è¡Œè®­ç»ƒæˆ–æ¨ç†ã€‚</li>
</ul>
<h5 id="å¦‚ä½•å»è¿ç”¨ï¼Ÿ"><a href="#å¦‚ä½•å»è¿ç”¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•å»è¿ç”¨ï¼Ÿ"></a>å¦‚ä½•å»è¿ç”¨ï¼Ÿ</h5><ul>
<li><strong>æ•°æ®äº¤æ¢</strong>ï¼šå¯ä»¥å°†è¿™ä¸ª JSON å­—ç¬¦ä¸²ç”¨ä½œ API è¯·æ±‚æˆ–å“åº”çš„æ•°æ®æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†è¿™ä¸ªå¯¹è±¡ä½œä¸º HTTP è¯·æ±‚çš„ body å‘é€ï¼Œæˆ–è€…ä»ç½‘ç»œä¸­è·å– JSON æ ¼å¼çš„æ•°æ®ï¼Œç„¶åè§£æå›å¯¹è±¡ã€‚</li>
<li><strong>æŒä¹…åŒ–å­˜å‚¨</strong>ï¼šå¦‚æœä½ éœ€è¦å°†å¯¹è±¡æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿï¼ŒJSON æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­˜å‚¨æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œå°†å¯¹è±¡æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ä¸­æˆ–æ•°æ®åº“è¡¨çš„ JSON ç±»å‹å­—æ®µä¸­ï¼Œä¾¿äºæœªæ¥è¯»å–å’Œæ“ä½œã€‚</li>
<li><strong>é…ç½®å’Œå‚æ•°æ›´æ–°</strong>ï¼š<code>update</code> æ–¹æ³•ä¸­æ¥æ”¶åˆ°çš„ <code>conf</code> å‚æ•°å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—å…¸å¯¹è±¡ï¼Œå®ƒé€šè¿‡é€’å½’çš„æ–¹å¼æ›´æ–°å¯¹è±¡çš„å±æ€§ã€‚å¦‚æœä½ å°†å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æ ¼å¼åï¼Œå¯ä»¥å°† JSON ä½œä¸ºé…ç½®æ–‡ä»¶ä¼ é€’ç»™åº”ç”¨ï¼Œåº”ç”¨æ ¹æ®è¯¥é…ç½®åŠ¨æ€è°ƒæ•´å…¶è¡Œä¸ºã€‚è¿™ä½¿å¾—ç³»ç»Ÿæ›´åŠ çµæ´»å’Œå¯é…ç½®ã€‚</li>
<li><strong>éªŒè¯ä¸æ ¡éªŒ</strong>ï¼š<code>validate</code> æ–¹æ³•åˆ©ç”¨å­˜å‚¨åœ¨ JSON æ–‡ä»¶ä¸­çš„è§„åˆ™å¯¹å¯¹è±¡è¿›è¡Œå‚æ•°éªŒè¯ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„æ–¹å¼æ¥ç¡®ä¿è¾“å…¥çš„æ•°æ®ç¬¦åˆç‰¹å®šçš„æ ¼å¼æˆ–é™åˆ¶ã€‚å¯ä»¥é€šè¿‡åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶æ¥éªŒè¯å¯¹è±¡çš„æ•°æ®ï¼Œä¿è¯æ•°æ®çš„åˆæ³•æ€§ã€‚</li>
</ul>
<p>æ€ä¹ˆå’Œå¤§æ¨¡å‹äº¤äº’ jsonæ˜¯ä»¥ä»€ä¹ˆè§„èŒƒ æ˜¯å¦è®©æœºå™¨æ›´å¥½çš„ç†è§£ï¼Ÿ</p>
<h2 id="å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ"><a href="#å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ"></a><span style="color:blue">å¦‚æœè‡ªå·±å¼€å‘äº†ä¸€ä¸ªä»£ç†ç»„ä»¶åå¦‚ä½•å»èå…¥å‘¢ï¼Ÿ</span></h2><h4 id="index-tsx"><a href="#index-tsx" class="headerlink" title="index.tsx"></a><span style = "color:red"><strong>index.tsx</strong></span></h4><p>è·¯å¾„<code>web/src/pages/flow/form/baidu-fanyi-form/index.tsx</code> </p>
<p><code>BaiduFanyiForm</code> æ˜¯ä¸€ä¸ªç”¨äºé…ç½®ç™¾åº¦ç¿»è¯‘ï¼ˆBaidu Fanyiï¼‰æ¥å£å‚æ•°çš„è¡¨å•ç»„ä»¶ã€‚è¯¥ç»„ä»¶åŸºäº Ant Design (<code>antd</code>) çš„ <code>Form</code> ç»„ä»¶ï¼Œå…è®¸ç”¨æˆ·è¾“å…¥ç¿»è¯‘æ‰€éœ€çš„ <strong>AppIDã€å¯†é’¥ã€ç¿»è¯‘ç±»å‹ã€é¢†åŸŸã€æºè¯­è¨€å’Œç›®æ ‡è¯­è¨€</strong>ã€‚</p>
<pre><code class="tsx">// useTranslate(&#39;flow&#39;)ï¼šè‡ªå®šä¹‰ Hookï¼Œæä¾›å›½é™…åŒ–ç¿»è¯‘èƒ½åŠ›
import &#123; useTranslate &#125; from &#39;@/hooks/common-hooks&#39;;
// Form, Input, Selectï¼šAnt Design è¡¨å•ç»„ä»¶
import &#123; Form, Input, Select &#125; from &#39;antd&#39;;
// useMemoï¼šä¼˜åŒ–è®¡ç®—ã€æé«˜æ€§èƒ½ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°è®¡ç®—
import &#123; useMemo &#125; from &#39;react&#39;;
// ä» constant ä¸­å¼•å…¥ç¿»è¯‘é¢†åŸŸå’Œè¯­è¨€é€‰é¡¹
import &#123;
  BaiduFanyiDomainOptions,
  BaiduFanyiSourceLangOptions,
&#125; from &#39;../../constant&#39;;
// è¡¨å•ç»„ä»¶çš„ç±»å‹å®šä¹‰ï¼ŒåŒ…å« onValuesChange, form, node ç­‰å‚æ•°
import &#123; IOperatorForm &#125; from &#39;../../interface&#39;;
// åŠ¨æ€è¾“å…¥ç»„ä»¶ï¼Œå¯èƒ½ç”¨äºå˜é‡æ›¿æ¢
import DynamicInputVariable from &#39;../components/dynamic-input-variable&#39;;

/*
ç”Ÿæˆ trans_typeï¼ˆç¿»è¯‘ç±»å‹ï¼‰çš„ Select é€‰é¡¹ï¼š
translateï¼šæ™®é€šç¿»è¯‘
fieldtranslateï¼šä¸“ä¸šé¢†åŸŸç¿»è¯‘
é€‰é¡¹çš„ label é€šè¿‡ t() è¿›è¡Œå›½é™…åŒ–ç¿»è¯‘ã€‚
*/
const BaiduFanyiForm = (&#123; onValuesChange, form, node &#125;: IOperatorForm) =&gt; &#123;
  const &#123; t &#125; = useTranslate(&#39;flow&#39;);
  const options = useMemo(() =&gt; &#123;
    return [&#39;translate&#39;, &#39;fieldtranslate&#39;].map((x) =&gt; (&#123;
      value: x,
      label: t(`baiduSecretKeyOptions.$&#123;x&#125;`),
    &#125;));
  &#125;, [t]);
// ç”Ÿæˆ é¢†åŸŸç¿»è¯‘ é€‰é¡¹ï¼ˆå¦‚åŒ»å­¦ã€æ³•å¾‹ç­‰ï¼‰
  const baiduFanyiOptions = useMemo(() =&gt; &#123;
    return BaiduFanyiDomainOptions.map((x) =&gt; (&#123;
      value: x,
      label: t(`baiduDomainOptions.$&#123;x&#125;`),
    &#125;));
  &#125;, [t]);
// æºè¯­è¨€ï¼ˆsource_langï¼‰å’Œ ç›®æ ‡è¯­è¨€ï¼ˆtarget_langï¼‰
  const baiduFanyiSourceLangOptions = useMemo(() =&gt; &#123;
    return BaiduFanyiSourceLangOptions.map((x) =&gt; (&#123;
      value: x,
      label: t(`baiduSourceLangOptions.$&#123;x&#125;`),
    &#125;));
  &#125;, [t]);

  return (
    &lt;Form
      name=&quot;basic&quot; //è¡¨å•åç§°
      autoComplete=&quot;off&quot; //å…³é—­è‡ªåŠ¨å¡«å……
      form=&#123;form&#125; //ç»‘å®š Ant Design è¡¨å•å®ä¾‹ï¼Œå…è®¸åŠ¨æ€è®¾ç½®è¡¨å•å€¼
      onValuesChange=&#123;onValuesChange&#125; //è¡¨å•å€¼å˜æ›´æ—¶è§¦å‘å¤–éƒ¨å›è°ƒ
      layout=&#123;&#39;vertical&#39;&#125;
    &gt;
          &lt;!-- å…è®¸ç”¨æˆ·è¾“å…¥ AppID å’Œ å¯†é’¥ï¼Œç”¨äºèº«ä»½éªŒè¯ --&gt;
      &lt;DynamicInputVariable node=&#123;node&#125;&gt;&lt;/DynamicInputVariable&gt;
      &lt;Form.Item label=&#123;t(&#39;appid&#39;)&#125; name=&#123;&#39;appid&#39;&#125;&gt;
        &lt;Input&gt;&lt;/Input&gt;
      &lt;/Form.Item&gt;
      &lt;Form.Item label=&#123;t(&#39;secretKey&#39;)&#125; name=&#123;&#39;secret_key&#39;&#125;&gt;
        &lt;Input&gt;&lt;/Input&gt;
      &lt;/Form.Item&gt;
          &lt;!-- ç¿»è¯‘ç±»å‹ --&gt;
      &lt;Form.Item label=&#123;t(&#39;transType&#39;)&#125; name=&#123;&#39;trans_type&#39;&#125;&gt;
        &lt;Select options=&#123;options&#125;&gt;&lt;/Select&gt;
      &lt;/Form.Item&gt;
          &lt;!-- é¢†åŸŸç¿»è¯‘ ä»…åœ¨ fieldtranslate é€‰ä¸­æ—¶æ˜¾ç¤º --&gt;
  &lt;!-- dependencies=&#123;[&#39;model_type&#39;]&#125;ï¼šç›‘å¬ model_type å­—æ®µçš„å˜åŒ– --&gt;
      &lt;Form.Item noStyle dependencies=&#123;[&#39;model_type&#39;]&#125;&gt;
        &#123;(&#123; getFieldValue &#125;) =&gt;
          getFieldValue(&#39;trans_type&#39;) === &#39;fieldtranslate&#39; &amp;&amp; (
            &lt;Form.Item label=&#123;t(&#39;domain&#39;)&#125; name=&#123;&#39;domain&#39;&#125;&gt;
              &lt;Select options=&#123;baiduFanyiOptions&#125;&gt;&lt;/Select&gt;
            &lt;/Form.Item&gt;
          )
        &#125;
      &lt;/Form.Item&gt;
      &lt;Form.Item label=&#123;t(&#39;sourceLang&#39;)&#125; name=&#123;&#39;source_lang&#39;&#125;&gt;
        &lt;Select options=&#123;baiduFanyiSourceLangOptions&#125;&gt;&lt;/Select&gt;
      &lt;/Form.Item&gt;
      &lt;Form.Item label=&#123;t(&#39;targetLang&#39;)&#125; name=&#123;&#39;target_lang&#39;&#125;&gt;
        &lt;Select options=&#123;baiduFanyiSourceLangOptions&#125;&gt;&lt;/Select&gt;
      &lt;/Form.Item&gt;
    &lt;/Form&gt;
  );
&#125;;
export default BaiduFanyiForm;
</code></pre>
<p><code>BaiduFanyiForm</code> ç»„ä»¶æ˜¯ç™¾åº¦ç¿»è¯‘ API å‚æ•°çš„å‰ç«¯é…ç½®è¡¨å•ï¼Œæ”¯æŒåŠ¨æ€äº¤äº’ï¼ˆå¦‚ <code>trans_type</code> é€‰æ‹© <code>fieldtranslate</code> æ—¶åŠ¨æ€æ˜¾ç¤º <code>domain</code> é€‰é¡¹ï¼‰ã€‚è¯¥ç»„ä»¶ç”¨äºæŸä¸ªæµç¨‹ï¼ˆflowï¼‰ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·è¾“å…¥ç¿»è¯‘ API ç›¸å…³ä¿¡æ¯ï¼Œå¹¶æä¾› <strong>å›½é™…åŒ–æ”¯æŒ</strong>ï¼ˆ<code>useTranslate()</code>ï¼‰</p>
<hr>
<hr>
<h4 id="init-py"><a href="#init-py" class="headerlink" title="_ _ init _ _.py"></a><span style = "color:red">_ _ init _ _.py</span></h4><p>é¦–å…ˆåœ¨ <code>agent/component/__init__.py</code> åœ¨ç»„ä»¶åŒçº§ç›®å½•ä¸‹æœ‰ä¸€ä¸ª<code>__init__.py</code><br>å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯**<u>å¯¼å…¥å¹¶ç®¡ç†å„ç§ç»„ä»¶</u><strong>ï¼Œè¿™äº›ç»„ä»¶ç”¨äº</strong><u>æ•°æ®å¤„ç†ã€ä¿¡æ¯æ£€ç´¢ã€ç¿»è¯‘ã€SQLæ‰§è¡Œã€è´¢ç»æ•°æ®è·å–</u>ç­‰**ä¸åŒåŠŸèƒ½ã€‚å…¶ä¸­çš„é‡è¦ä»£ç :</p>
<pre><code class="python"># import importlibï¼šç”¨äºåŠ¨æ€å¯¼å…¥æ¨¡å—ï¼ˆåœ¨ component_class æ–¹æ³•ä¸­ä½¿ç”¨ï¼‰
# è¿™äº›ç»„ä»¶åˆ†å¸ƒåœ¨ agent.component æ¨¡å—ä¸‹ï¼Œæä¾›ä¸åŒçš„åŠŸèƒ½

&#39;&#39;&#39;
è¯¥å‡½æ•°ç”¨äºåŠ¨æ€åŠ è½½ç»„ä»¶ï¼Œé€šè¿‡ importlib.import_module(&quot;agent.component&quot;) å¯¼å…¥ agent.component æ¨¡å—ï¼Œç„¶åä½¿ç”¨ getattr(m, class_name) è·å–ç±»ï¼Œä»è€Œè¿”å›å¯¹åº”çš„ç»„ä»¶ç±»ã€‚
&#39;&#39;&#39;
def component_class(class_name):
    m = importlib.import_module(&quot;agent.component&quot;)
    c = getattr(m, class_name)
    return c

&#39;&#39;&#39;
__all__ åˆ—è¡¨ï¼šæŒ‡å®šæ¨¡å—å¯¹å¤–æš´éœ²çš„æ‰€æœ‰ç»„ä»¶
ä½¿å…¶æˆä¸º from module import * æ—¶å¯ä»¥è¢«è®¿é—®çš„å¯¹è±¡ã€‚
&#39;&#39;&#39;
__all__ = [
    &quot;GitHub&quot;,
    &quot;GitHubParam&quot;,
    &quot;BaiduFanyi&quot;,
    &quot;BaiduFanyiParam&quot;,
]
</code></pre>
<h4 id="web-x2F-src-x2F-pages-x2F-flow-x2F-flow-drawer-x2F-index-tsx"><a href="#web-x2F-src-x2F-pages-x2F-flow-x2F-flow-drawer-x2F-index-tsx" class="headerlink" title="web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsx"></a><span style = "color:red">web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsx</span></h4><p>åœ¨<code>web/src/pages/flow/flow-drawer/index.tsx</code>é‡Œæœ‰è¿™æ ·ä¸€è¡Œä»£ç <br><code>import BaiduFanyiForm from &#39;../form/baidu-fanyi-form&#39;;</code><br>è¯¥æ–‡ä»¶ <code>index.tsx</code> ä¸»è¦ç”¨äº**è¡¨å•æŠ½å±‰ç»„ä»¶ (<code>FormDrawer</code>)**ï¼Œç”¨äºåœ¨ UI ä¸­å±•ç¤ºä¸åŒæ“ä½œèŠ‚ç‚¹çš„è¡¨å•ï¼Œå¹¶æ”¯æŒç¼–è¾‘ã€è°ƒè¯•ç­‰åŠŸèƒ½ã€‚</p>
<h5 id="ä»£ç åŠŸèƒ½æ¦‚è§ˆ"><a href="#ä»£ç åŠŸèƒ½æ¦‚è§ˆ" class="headerlink" title="ä»£ç åŠŸèƒ½æ¦‚è§ˆ"></a><strong>ä»£ç åŠŸèƒ½æ¦‚è§ˆ</strong></h5><p> ğŸ”¹ <strong>åŠ¨æ€æ¸²æŸ“ä¸åŒçš„è¡¨å•ç»„ä»¶</strong>ï¼ˆ<code>BaiduFanyiForm</code> ç­‰ï¼‰<br> ğŸ”¹ <strong>æ”¯æŒä¸åŒç±»å‹çš„æ“ä½œèŠ‚ç‚¹ï¼ˆOperatorï¼‰</strong>ï¼ˆå¦‚ <code>BaiduFanyi</code>, <code>Google</code>, <code>Generate</code> ç­‰ï¼‰<br> ğŸ”¹ <strong>æä¾›è¡¨å•è¾“å…¥äº¤äº’ï¼Œå¹¶æ”¯æŒå•æ­¥è°ƒè¯•</strong><br> ğŸ”¹ <strong>ä½¿ç”¨ <code>Drawer</code> ç»„ä»¶ä½œä¸ºä¾§è¾¹æ å¼¹å‡ºçª—å£</strong></p>
<h4 id="â˜…-ç»„ä»¶å¯¼å…¥"><a href="#â˜…-ç»„ä»¶å¯¼å…¥" class="headerlink" title="â˜… ç»„ä»¶å¯¼å…¥"></a>â˜… ç»„ä»¶å¯¼å…¥</h4><pre><code class="python">import &#123; Drawer, Flex, Form, Input &#125; from &#39;antd&#39;;
import &#123; get, isPlainObject, lowerFirst &#125; from &#39;lodash&#39;;
import &#123; Play &#125; from &#39;lucide-react&#39;;
import &#123; CloseOutlined &#125; from &#39;@ant-design/icons&#39;;
...
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼šå¼•å…¥ <strong>Ant Design</strong> ç»„ä»¶ï¼ˆ<code>Drawer</code>ã€<code>Form</code>ã€<code>Input</code>ï¼‰ã€<code>lodash</code> å·¥å…·åº“ä»¥åŠ <code>Play</code>ï¼ˆè°ƒè¯•æŒ‰é’®ï¼‰ã€<code>CloseOutlined</code>ï¼ˆå…³é—­æŒ‰é’®ï¼‰ã€‚</p>
<h4 id="â˜…-å¼•å…¥è¡¨å•ç»„ä»¶"><a href="#â˜…-å¼•å…¥è¡¨å•ç»„ä»¶" class="headerlink" title="â˜… å¼•å…¥è¡¨å•ç»„ä»¶"></a>â˜… å¼•å…¥è¡¨å•ç»„ä»¶</h4><pre><code class="python"># å½“ç„¶ä¸èƒ½å¿˜äº†æˆ‘ä»¬çš„ç™¾åº¦ç¿»è¯‘
import BaiduFanyiForm from &#39;../form/baidu-fanyi-form&#39;;
import GoogleForm from &#39;../form/google-form&#39;;
import GenerateForm from &#39;../form/generate-form&#39;;
import RetrievalForm from &#39;../form/retrieval-form&#39;;
...
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼šå¼•å…¥ <code>BaiduFanyiForm</code> ç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºç™¾åº¦ç¿»è¯‘çš„è¡¨å•äº¤äº’ã€‚</p>
<p>âœ… è¿™äº›è¡¨å•ç»„ä»¶ç”¨äºä¸åŒçš„ <code>Operator</code> æ“ä½œï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>BaiduFanyiForm</code> â†’ <strong>ç™¾åº¦ç¿»è¯‘è¡¨å•</strong></li>
<li><code>GoogleForm</code> â†’ <strong>Google æœç´¢è¡¨å•</strong></li>
<li><code>GenerateForm</code> â†’ <strong>æ–‡æœ¬ç”Ÿæˆè¡¨å•</strong></li>
<li><code>RetrievalForm</code> â†’ <strong>ä¿¡æ¯æ£€ç´¢è¡¨å•</strong></li>
</ul>
<h4 id="â˜…-FormMap-æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„"><a href="#â˜…-FormMap-æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„" class="headerlink" title="â˜… FormMap(æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„)"></a>â˜… FormMap(æ“ä½œç±»å‹ä¸è¡¨6å•ç»„ä»¶çš„æ˜ å°„)</h4><pre><code class="python">const FormMap = &#123;
  [Operator.BaiduFanyi]: BaiduFanyiForm,
  [Operator.Google]: GoogleForm,
  [Operator.Generate]: GenerateForm,
  [Operator.Retrieval]: RetrievalForm,
&#125;;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š<br> âœ… <strong>åŠ¨æ€åŒ¹é…</strong> <code>Operator</code>ï¼ˆæ“ä½œç±»å‹ï¼‰ä¸ <strong>å¯¹åº”è¡¨å•ç»„ä»¶</strong><br> âœ… <strong>å½“ <code>Operator</code> ä¸º <code>BaiduFanyi</code> æ—¶ï¼Œæ¸²æŸ“ <code>BaiduFanyiForm</code></strong><br> âœ… <strong>å¯ä»¥æ‰©å±•ä¸åŒçš„è¡¨å•ç±»å‹</strong></p>
<h4 id="â˜†-FormDrawerç»„ä»¶"><a href="#â˜†-FormDrawerç»„ä»¶" class="headerlink" title="â˜† FormDrawerç»„ä»¶"></a>â˜† FormDrawerç»„ä»¶</h4><pre><code class="python">const FormDrawer = (&#123; visible, hideModal, node, singleDebugDrawerVisible, hideSingleDebugDrawer, showSingleDebugDrawer &#125;: IModalProps&lt;any&gt; &amp; IProps) =&gt; &#123;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š<code>FormDrawer</code> æ˜¯ä¸€ä¸ª <strong>è¡¨å•æŠ½å±‰ç»„ä»¶</strong>ï¼Œç”¨äºå±•ç¤ºä¸åŒç±»å‹çš„è¡¨å•ã€‚</p>
<h4 id="â˜†-åŠ¨æ€æ¸²æŸ“è¡¨å•"><a href="#â˜†-åŠ¨æ€æ¸²æŸ“è¡¨å•" class="headerlink" title="â˜† åŠ¨æ€æ¸²æŸ“è¡¨å•"></a>â˜† åŠ¨æ€æ¸²æŸ“è¡¨å•</h4><pre><code class="python">const OperatorForm = FormMap[operatorName] ?? EmptyContent;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š âœ… <strong>æ ¹æ® <code>Operator</code>ï¼ˆæ“ä½œç±»å‹ï¼‰é€‰æ‹©å¯¹åº”çš„è¡¨å•ç»„ä»¶</strong><br> âœ… å¦‚æœ <code>Operator</code> ä¸åœ¨ <code>FormMap</code> ä¸­ï¼Œåˆ™æ˜¾ç¤º <code>EmptyContent</code>ï¼ˆç©ºç»„ä»¶ï¼‰</p>
<h4 id="â˜†-å¤„ç†è¡¨å•æ•°æ®"><a href="#â˜†-å¤„ç†è¡¨å•æ•°æ®" class="headerlink" title="â˜† å¤„ç†è¡¨å•æ•°æ®"></a>â˜† å¤„ç†è¡¨å•æ•°æ®</h4><pre><code class="python">useEffect(() =&gt; &#123;
  if (visible) &#123;
    form.resetFields();
    form.setFieldsValue(node?.data?.form);
  &#125;
&#125;, [visible, form, node?.data?.form]);
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š âœ… <strong>å½“æŠ½å±‰å¯è§æ—¶ï¼Œé‡ç½®è¡¨å•å¹¶å¡«å……æ•°æ®</strong><br> âœ… <strong>å¦‚æœ <code>Operator</code> æ˜¯ <code>Categorize</code>ï¼Œåˆ™ç‰¹æ®Šå¤„ç†åˆ†ç±»æ•°æ®</strong></p>
<h4 id="â˜†-ä¾§è¾¹æ -Drawer"><a href="#â˜†-ä¾§è¾¹æ -Drawer" class="headerlink" title="â˜† ä¾§è¾¹æ  (Drawer)"></a>â˜† ä¾§è¾¹æ  (<code>Drawer</code>)</h4><pre><code class="python">&lt;Drawer
  title=&#123;
    &lt;Flex&gt;
      &lt;OperatorIcon name=&#123;operatorName&#125; /&gt;
      &lt;Input value=&#123;name&#125; onChange=&#123;handleNameChange&#125; /&gt;
      &lt;Play onClick=&#123;showSingleDebugDrawer&#125; /&gt;
      &lt;CloseOutlined onClick=&#123;hideModal&#125; /&gt;
    &lt;/Flex&gt;
  &#125;
  open=&#123;visible&#125;
&gt;
  &lt;OperatorForm onValuesChange=&#123;handleValuesChange&#125; form=&#123;form&#125; node=&#123;node&#125; /&gt;
&lt;/Drawer&gt;
</code></pre>
<p>ğŸ“Œ <strong>ä½œç”¨</strong>ï¼š âœ… <strong>æ ‡é¢˜åŒºåŸŸåŒ…å«æ“ä½œå›¾æ ‡ã€è¾“å…¥æ¡†ã€è°ƒè¯•æŒ‰é’®ã€å…³é—­æŒ‰é’®</strong><br> âœ… <strong>ä½¿ç”¨ <code>OperatorForm</code> ç»„ä»¶æ¸²æŸ“è¡¨å•</strong><br> âœ… <strong>ç‚¹å‡» <code>Play</code> æŒ‰é’®æ‰“å¼€è°ƒè¯•æ¨¡å¼</strong></p>
<hr>
<p>â˜… â˜… <u>æ€»ç»“ä¸€ä¸‹<code>BaiduFanyiForm</code>ç›¸å…³é€»è¾‘</u> â˜… â˜…<br>åœ¨ <code>index.tsx</code> é‡Œï¼Œ<code>BaiduFanyiForm</code> è¢«æ³¨å†Œåˆ° <code>FormMap</code>ï¼Œç„¶åé€šè¿‡ <code>FormDrawer</code> ç»„ä»¶</p>
<p>ğŸš€ <strong>å¦‚ä½•æ¸²æŸ“ <code>BaiduFanyiForm</code>ï¼Ÿ</strong></p>
<ol>
<li><code>Operator.BaiduFanyi</code> è§¦å‘ <code>BaiduFanyiForm</code></li>
<li><code>FormDrawer</code> ç»„ä»¶åŠ¨æ€åŒ¹é… <code>FormMap[Operator.BaiduFanyi]</code></li>
<li><code>BaiduFanyiForm</code> æ¸²æŸ“åœ¨ <code>Drawer</code> ä¸­</li>
</ol>
<p>ğŸ“Œ <strong>ç»“è®º</strong>ï¼š âœ… <strong><code>BaiduFanyiForm</code> åªæ˜¯ä¼—å¤šè¡¨å•ç»„ä»¶ä¹‹ä¸€ï¼Œä¸“é—¨ç”¨äºç™¾åº¦ç¿»è¯‘çš„åŠŸèƒ½</strong><br> âœ… <strong><code>index.tsx</code> ä¸»è¦æ˜¯è¡¨å•çš„åŠ¨æ€åŠ è½½å™¨ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰ <code>Operator</code> ç±»å‹</strong><br> âœ… <strong><code>FormDrawer</code> è´Ÿè´£ UI æ¸²æŸ“ã€æ•°æ®å¡«å……ã€è°ƒè¯•äº¤äº’ç­‰</strong></p>
<hr>
<p>â‘  <span style = "color:red">agent&#x2F;component&#x2F;baidufanyi.py</span> ã€åç«¯ä»£ç ã€‘<br>â‘¡ <span style = "color:red">agent&#x2F;component&#x2F;_ _ init _ _.py</span>  ã€åˆå§‹åŒ–ã€‘<br>â‘¢ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;flow-drawer&#x2F;index.tsxã€è¡¨å•æŠ½å±‰ç»„ä»¶ UIå±•ç¤ºã€‘<br>â‘£ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;form&#x2F;baidu-fanyi-form&#x2F;index.tsx ã€æä¾›ç”¨æˆ·ç•Œé¢è®©ç”¨æˆ·èƒ½é…ç½®å¹¶æäº¤å‚æ•°ã€‘<br>â‘¤ web&#x2F;src&#x2F;pages&#x2F;flow&#x2F;constant.tsx ã€å®šä¹‰ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å„ç§å›¾æ ‡ã€å¸¸é‡ã€æšä¸¾ã€æ¥å£ã€çŠ¶æ€å’Œå‡½æ•°ã€‘<br>â‘¥ web&#x2F;src&#x2F;locales&#x2F;zh.ts ã€æŠŠæ‰€æœ‰è¦æ˜¾ç¤ºçš„æåˆ°zh.tsä¸­(å‰ç«¯ç»„ä»¶æè¿°)ã€‘<br>â‘¦ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;constant.tsxã€å¼•å…¥ç»„ä»¶æ‰€éœ€çš„å„ç§å›¾æ ‡ã€ä»¥åŠæ“ä½œé¡¹çš„æ ·å¼ã€åˆå§‹å€¼ã€è¯­è¨€ç­‰ã€‘<br>â‘§ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;form-sheet&#x2F;use-form-config-map.tsx ã€è¡¨å•é…ç½®æ˜ å°„ã€é…ç½®ä¸åŒæ“ä½œå¯¹åº”è¡¨å•ç»„ä»¶ã€‘<br>â‘¨ web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;form&#x2F;baidu-fanyi-form&#x2F;index.tsx ã€æ„å»ºé…ç½®è¡¨å• ã€‘<br>â‘© web&#x2F;src&#x2F;pages&#x2F;agent&#x2F;hooks.tsx ã€ç®¡ç†å›¾å½¢ç•Œé¢æµç¨‹å›¾ å„ç§é’©å­ â†’ å»ºæ•°æ®å¤„ç†æµç¨‹ã€‘</p>
<hr>
<p><img src="https://raw.githubusercontent.com/P-luminary/images/ddce11cf6c74dc31448ce098d9509fc9e2cbc2e2/RAGFlow%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%9B%E5%BB%BA%E4%BB%A3%E7%90%86%E7%BB%84%E4%BB%B6%E6%B5%81%E7%A8%8B.jpg"></p>

    </div>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <div id="comment">
        <div id="gitalk-container">
        </div>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            Â© 2018 - 2025 P-luminary
            <span class="footer-icon">
                <a-icon type="flag" theme="filled" /></span>
            @Asuna
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a>
<!--         & <a target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div> -->
        
    </div>

</footer>

<script src="/js/highlight.min.js"></script>
<script src="/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: 'hexo-theme-particle',      // The repository of store comments,
        owner: 'P-luminary',
        admin: ['P-luminary'],
        language: 'en',
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: true  // Facebook-like distraction free mode
    })
    gitalk.render('gitalk-container')
</script>

</body>

</html>